var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var f={},p=Object.create(new $jscomp.global.Proxy(f,{get:function(q,n,u){return q==f&&"q"==n&&u==p}}));return!0===p.q}catch(q){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,p,q){f!=Array.prototype&&f!=Object.prototype&&(f[p]=q.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var f=0;return function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+f++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(f){var p=0;return $jscomp.iteratorPrototype(function(){return p<f.length?{done:!1,value:f[p++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};$jscomp.makeIterator=function(f){$jscomp.initSymbolIterator();var p=f[Symbol.iterator];return p?p.call(f):$jscomp.arrayIterator(f)};$jscomp.owns=function(f,p){return Object.prototype.hasOwnProperty.call(f,p)};
$jscomp.polyfill=function(f,p,q,n){if(p){q=$jscomp.global;f=f.split(".");for(n=0;n<f.length-1;n++){var u=f[n];u in q||(q[u]={});q=q[u]}f=f[f.length-1];n=q[f];p=p(n);p!=n&&null!=p&&$jscomp.defineProperty(q,f,{configurable:!0,writable:!0,value:p})}};
$jscomp.polyfill("WeakMap",function(f){function p(){if(!f||!Object.seal)return!1;try{var b=Object.seal({}),e=Object.seal({}),d=new f([[b,2],[e,3]]);if(2!=d.get(b)||3!=d.get(e))return!1;d.delete(b);d.set(e,4);return!d.has(b)&&4==d.get(e)}catch(h){return!1}}function q(b){$jscomp.owns(b,u)||$jscomp.defineProperty(b,u,{value:{}})}function n(b){var e=Object[b];e&&(Object[b]=function(b){q(b);return e(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(f&&$jscomp.ES6_CONFORMANCE)return f}else if(p())return f;
var u="$jscomp_hidden_"+Math.random();n("freeze");n("preventExtensions");n("seal");var m=0,d=function(b){this.id_=(m+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var e;!(e=b.next()).done;)e=e.value,this.set(e[0],e[1])}};d.prototype.set=function(b,e){q(b);if(!$jscomp.owns(b,u))throw Error("WeakMap key fail: "+b);b[u][this.id_]=e;return this};d.prototype.get=function(b){return $jscomp.owns(b,u)?b[u][this.id_]:void 0};d.prototype.has=
function(b){return $jscomp.owns(b,u)&&$jscomp.owns(b[u],this.id_)};d.prototype.delete=function(b){return $jscomp.owns(b,u)&&$jscomp.owns(b[u],this.id_)?delete b[u][this.id_]:!1};return d},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(f){function p(){if($jscomp.ASSUME_NO_NATIVE_MAP||!f||"function"!=typeof f||!f.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new f($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var h=d.entries(),a=h.next();if(a.done||a.value[0]!=b||"s"!=a.value[1])return!1;a=h.next();return a.done||4!=a.value[0].x||"t"!=a.value[1]||!h.next().done?!1:!0}catch(t){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(f&&$jscomp.ES6_CONFORMANCE)return f}else if(p())return f;$jscomp.initSymbol();$jscomp.initSymbolIterator();var q=new WeakMap,n=function(b){this.data_={};this.head_=d();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var e;!(e=b.next()).done;)e=e.value,this.set(e[0],e[1])}};n.prototype.set=function(b,d){b=0===b?0:b;var e=u(this,b);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=d:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:d},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};n.prototype.delete=function(b){b=u(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};n.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=d();this.size=0};n.prototype.has=function(b){return!!u(this,b).entry};
n.prototype.get=function(b){return(b=u(this,b).entry)&&b.value};n.prototype.entries=function(){return m(this,function(b){return[b.key,b.value]})};n.prototype.keys=function(){return m(this,function(b){return b.key})};n.prototype.values=function(){return m(this,function(b){return b.value})};n.prototype.forEach=function(b,d){for(var e=this.entries(),a;!(a=e.next()).done;)a=a.value,b.call(d,a[1],a[0],this)};n.prototype[Symbol.iterator]=n.prototype.entries;var u=function(d,m){var e=m&&typeof m;"object"==
e||"function"==e?q.has(m)?e=q.get(m):(e=""+ ++b,q.set(m,e)):e="p_"+m;var a=d.data_[e];if(a&&$jscomp.owns(d.data_,e))for(d=0;d<a.length;d++){var t=a[d];if(m!==m&&t.key!==t.key||m===t.key)return{id:e,list:a,index:d,entry:t}}return{id:e,list:a,index:-1,entry:void 0}},m=function(b,d){var e=b.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=b.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:d(e)};e=null}return{done:!0,value:void 0}})},d=function(){var b={};return b.previous=
b.next=b.head=b},b=0;return n},"es6","es3");
$jscomp.polyfill("Set",function(f){function p(){if($jscomp.ASSUME_NO_NATIVE_SET||!f||"function"!=typeof f||!f.prototype.entries||"function"!=typeof Object.seal)return!1;try{var p=Object.seal({x:4}),q=new f($jscomp.makeIterator([p]));if(!q.has(p)||1!=q.size||q.add(p)!=q||1!=q.size||q.add({x:4})!=q||2!=q.size)return!1;var m=q.entries(),d=m.next();if(d.done||d.value[0]!=p||d.value[1]!=p)return!1;d=m.next();return d.done||d.value[0]==p||4!=d.value[0].x||d.value[1]!=d.value[0]?!1:m.next().done}catch(b){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(f&&$jscomp.ES6_CONFORMANCE)return f}else if(p())return f;$jscomp.initSymbol();$jscomp.initSymbolIterator();var q=function(f){this.map_=new Map;if(f){f=$jscomp.makeIterator(f);for(var p;!(p=f.next()).done;)this.add(p.value)}this.size=this.map_.size};q.prototype.add=function(f){f=0===f?0:f;this.map_.set(f,f);this.size=this.map_.size;return this};q.prototype.delete=function(f){f=this.map_.delete(f);this.size=this.map_.size;return f};q.prototype.clear=
function(){this.map_.clear();this.size=0};q.prototype.has=function(f){return this.map_.has(f)};q.prototype.entries=function(){return this.map_.entries()};q.prototype.values=function(){return this.map_.values()};q.prototype.keys=q.prototype.values;q.prototype[Symbol.iterator]=q.prototype.values;q.prototype.forEach=function(f,p){var m=this;this.map_.forEach(function(d){return f.call(p,d,d,m)})};return q},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(f){function p(){this.batch_=null}function q(d){return d instanceof u?d:new u(function(b,e){b(d)})}if(f&&!$jscomp.FORCE_POLYFILL_PROMISE)return f;p.prototype.asyncExecute=function(d){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(d);return this};p.prototype.asyncExecuteBatch_=function(){var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})};var n=$jscomp.global.setTimeout;p.prototype.asyncExecuteFunction=function(d){n(d,
0)};p.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var d=this.batch_;this.batch_=[];for(var b=0;b<d.length;++b){var e=d[b];d[b]=null;try{e()}catch(w){this.asyncThrow_(w)}}}this.batch_=null};p.prototype.asyncThrow_=function(d){this.asyncExecuteFunction(function(){throw d;})};var u=function(d){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{d(b.resolve,b.reject)}catch(e){b.reject(e)}};u.prototype.createResolveAndReject_=
function(){function d(d){return function(h){e||(e=!0,d.call(b,h))}}var b=this,e=!1;return{resolve:d(this.resolveTo_),reject:d(this.reject_)}};u.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof u)this.settleSameAsPromise_(d);else{a:switch(typeof d){case "object":var b=null!=d;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};u.prototype.resolveToNonPromiseObj_=function(d){var b=
void 0;try{b=d.then}catch(e){this.reject_(e);return}"function"==typeof b?this.settleSameAsThenable_(b,d):this.fulfill_(d)};u.prototype.reject_=function(d){this.settle_(2,d)};u.prototype.fulfill_=function(d){this.settle_(1,d)};u.prototype.settle_=function(d,b){if(0!=this.state_)throw Error("Cannot settle("+d+", "+b+"): Promise already settled in state"+this.state_);this.state_=d;this.result_=b;this.executeOnSettledCallbacks_()};u.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=
0;d<this.onSettledCallbacks_.length;++d)m.asyncExecute(this.onSettledCallbacks_[d]);this.onSettledCallbacks_=null}};var m=new p;u.prototype.settleSameAsPromise_=function(d){var b=this.createResolveAndReject_();d.callWhenSettled_(b.resolve,b.reject)};u.prototype.settleSameAsThenable_=function(d,b){var e=this.createResolveAndReject_();try{d.call(b,e.resolve,e.reject)}catch(w){e.reject(w)}};u.prototype.then=function(d,b){function e(b,a){return"function"==typeof b?function(a){try{m(b(a))}catch(A){h(A)}}:
a}var m,h,a=new u(function(b,a){m=b;h=a});this.callWhenSettled_(e(d,m),e(b,h));return a};u.prototype.catch=function(d){return this.then(void 0,d)};u.prototype.callWhenSettled_=function(d,b){function e(){switch(f.state_){case 1:d(f.result_);break;case 2:b(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?m.asyncExecute(e):this.onSettledCallbacks_.push(e)};u.resolve=q;u.reject=function(d){return new u(function(b,e){e(d)})};u.race=function(d){return new u(function(b,
e){for(var m=$jscomp.makeIterator(d),h=m.next();!h.done;h=m.next())q(h.value).callWhenSettled_(b,e)})};u.all=function(d){var b=$jscomp.makeIterator(d),e=b.next();return e.done?q([]):new u(function(d,h){function a(b){return function(a){t[b]=a;m--;0==m&&d(t)}}var t=[],m=0;do t.push(void 0),m++,q(e.value).callWhenSettled_(a(t.length-1),h),e=b.next();while(!e.done)})};return u},"es6","es3");
$jscomp.polyfill("Object.is",function(f){return f?f:function(f,q){return f===q?0!==f||1/f===1/q:f!==f&&q!==q}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(f){return f?f:function(f,q){var p=this;p instanceof String&&(p=String(p));var u=p.length;q=q||0;for(0>q&&(q=Math.max(q+u,0));q<u;q++){var m=p[q];if(m===f||Object.is(m,f))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(f,p,q){if(null==f)throw new TypeError("The 'this' value for String.prototype."+q+" must not be null or undefined");if(p instanceof RegExp)throw new TypeError("First argument to String.prototype."+q+" must not be a regular expression");return f+""};$jscomp.polyfill("String.prototype.includes",function(f){return f?f:function(f,q){return-1!==$jscomp.checkStringArgs(this,f,"includes").indexOf(f,q||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(f){return f?f:function(f){f=Number(f);return 0===f||isNaN(f)?f:0<f?1:-1}},"es6","es3");window.cr={};cr.plugins_={};cr.behaviors={};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(f){return f.__proto__}:function(f){return f.constructor.prototype});
(function(){function f(c,g){this.x=c;this.y=g;cr.seal(this)}function p(c,g,b,a){this.set(c,g,b,a);cr.seal(this)}function q(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr.seal(this)}function n(c,g,b,a){c<g?b<a?(A=c<b?c:b,k=g>a?g:a):(A=c<a?c:a,k=g>b?g:b):b<a?(A=g<b?g:b,k=c>a?c:a):(A=g<a?g:a,k=c>b?c:b)}function u(){this.items=this.s=null;this.item_count=0;G&&(this.s=new Set);this.values_cache=[];this.cache_valid=!0;cr.seal(this)}function m(c){N[U++]=c}function d(){this.sum=
this.t=this.y=this.c=0;cr.seal(this)}function b(c){this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.set_pts(c);cr.seal(this)}function e(c,g){this.cellwidth=c;this.cellheight=g;this.cells={}}function w(c,g){this.cellwidth=c;this.cellheight=g;this.cells={}}function h(v,g,b){e.prototype.totalCellCount++;if(c.length){var a=c.pop();a.grid=v;a.x=g;a.y=b;return a}return new cr.GridCell(v,g,b)}function a(c,g,b){this.grid=c;this.x=g;this.y=b;this.objects=
new cr.ObjectSet}function t(c,b,a){w.prototype.totalCellCount++;if(g.length){var v=g.pop();v.grid=c;v.x=b;v.y=a;return v}return new cr.RenderCell(c,b,a)}function y(c,g,b){this.grid=c;this.x=g;this.y=b;this.objects=[];this.is_sorted=!0;this.pending_removal=new cr.ObjectSet;this.any_pending_removal=!1}function z(c,g){return c.zindex-g.zindex}cr.logexport=function(c){window.console&&window.console.log&&window.console.log(c)};cr.logerror=function(c){window.console&&window.console.error&&window.console.error(c)};
cr.seal=function(c){return c};cr.freeze=function(c){return c};cr.is_undefined=function(c){return"undefined"===typeof c};cr.is_number=function(c){return"number"===typeof c};cr.is_string=function(c){return"string"===typeof c};cr.isPOT=function(c){return 0<c&&0===(c-1&c)};cr.nextHighestPowerOfTwo=function(c){--c;for(var v=1;32>v;v<<=1)c|=c>>v;return c+1};cr.abs=function(c){return 0>c?-c:c};cr.max=function(c,g){return c>g?c:g};cr.min=function(c,g){return c<g?c:g};cr.PI=Math.PI;cr.round=function(c){return c+
.5|0};cr.floor=function(c){return 0<=c?c|0:(c|0)-1};cr.ceil=function(c){var v=c|0;return v===c?v:v+1};f.prototype.offset=function(c,g){this.x+=c;this.y+=g;return this};f.prototype.mul=function(c,g){this.x*=c;this.y*=g;return this};cr.vector2=f;cr.segments_intersect=function(c,g,b,a,l,d,k,x){if(c<b){var v=c;var e=b}else v=b,e=c;if(l<k){var t=l;var h=k}else t=k,h=l;if(e<t||v>h)return!1;g<a?(v=g,e=a):(v=a,e=g);d<x?(t=d,h=x):(t=x,h=d);if(e<t||v>h)return!1;e=l-c+k-b;v=d-g+x-a;c=b-c;g=a-g;l=k-l;d=x-d;x=
cr.abs(g*l-d*c);return cr.abs(l*v-d*e)>x?!1:cr.abs(c*v-g*e)<=x};p.prototype.set=function(c,g,b,a){this.left=c;this.top=g;this.right=b;this.bottom=a};p.prototype.copy=function(c){this.left=c.left;this.top=c.top;this.right=c.right;this.bottom=c.bottom};p.prototype.width=function(){return this.right-this.left};p.prototype.height=function(){return this.bottom-this.top};p.prototype.offset=function(c,g){this.left+=c;this.top+=g;this.right+=c;this.bottom+=g;return this};p.prototype.normalize=function(){if(this.left>
this.right){var c=this.left;this.left=this.right;this.right=c}this.top>this.bottom&&(c=this.top,this.top=this.bottom,this.bottom=c)};p.prototype.intersects_rect=function(c){return!(c.right<this.left||c.bottom<this.top||c.left>this.right||c.top>this.bottom)};p.prototype.intersects_rect_off=function(c,g,b){return!(c.right+g<this.left||c.bottom+b<this.top||c.left+g>this.right||c.top+b>this.bottom)};p.prototype.contains_pt=function(c,g){return c>=this.left&&c<=this.right&&g>=this.top&&g<=this.bottom};
p.prototype.equals=function(c){return this.left===c.left&&this.top===c.top&&this.right===c.right&&this.bottom===c.bottom};cr.rect=p;q.prototype.set_from_rect=function(c){this.tlx=c.left;this.tly=c.top;this.trx=c.right;this.try_=c.top;this.brx=c.right;this.bry=c.bottom;this.blx=c.left;this.bly=c.bottom};q.prototype.set_from_rotated_rect=function(c,g){if(0===g)this.set_from_rect(c);else{var b=Math.sin(g),a=Math.cos(g);g=c.left*b;var v=c.top*b,l=c.right*b;b*=c.bottom;var d=c.left*a,x=c.top*a,k=c.right*
a;c=c.bottom*a;this.tlx=d-v;this.tly=x+g;this.trx=k-v;this.try_=x+l;this.brx=k-b;this.bry=c+l;this.blx=d-b;this.bly=c+g}};q.prototype.offset=function(c,g){this.tlx+=c;this.tly+=g;this.trx+=c;this.try_+=g;this.brx+=c;this.bry+=g;this.blx+=c;this.bly+=g;return this};var A=0,k=0;q.prototype.bounding_box=function(c){n(this.tlx,this.trx,this.brx,this.blx);c.left=A;c.right=k;n(this.tly,this.try_,this.bry,this.bly);c.top=A;c.bottom=k};q.prototype.contains_pt=function(c,g){var b=this.tlx,a=this.tly,v=this.trx-
b,l=this.try_-a,d=this.brx-b,x=this.bry-a;c-=b;g-=a;var k=v*v+l*l,e=v*d+l*x;l=v*c+l*g;var t=d*d+x*x,h=d*c+x*g,B=1/(k*t-e*e);v=(t*l-e*h)*B;k=(k*h-e*l)*B;if(0<=v&&0<k&&1>v+k)return!0;v=this.blx-b;l=this.bly-a;k=v*v+l*l;e=v*d+l*x;l=v*c+l*g;B=1/(k*t-e*e);v=(t*l-e*h)*B;k=(k*h-e*l)*B;return 0<=v&&0<k&&1>v+k};q.prototype.at=function(c,g){if(g)switch(c){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(c){case 0:return this.tly;
case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};q.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};q.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4};q.prototype.intersects_segment=function(c,g,b,a){if(this.contains_pt(c,g)||this.contains_pt(b,a))return!0;var v;for(v=0;4>v;v++){var l=this.at(v,!0);var d=this.at(v,!1);var x=this.at(v+1,!0);var k=this.at(v+1,!1);if(cr.segments_intersect(c,
g,b,a,l,d,x,k))return!0}return!1};q.prototype.intersects_quad=function(c){var g=c.midX(),b=c.midY();if(this.contains_pt(g,b))return!0;g=this.midX();b=this.midY();if(c.contains_pt(g,b))return!0;var a,v;for(a=0;4>a;a++)for(v=0;4>v;v++){g=this.at(a,!0);b=this.at(a,!1);var l=this.at(a+1,!0);var d=this.at(a+1,!1);var x=c.at(v,!0);var k=c.at(v,!1);var e=c.at(v+1,!0);var t=c.at(v+1,!1);if(cr.segments_intersect(g,b,l,d,x,k,e,t))return!0}return!1};cr.quad=q;cr.RGB=function(c,g,b){return Math.max(Math.min(c,
255),0)|Math.max(Math.min(g,255),0)<<8|Math.max(Math.min(b,255),0)<<16};cr.RGBAEx=function(c,g,b,a){c=cr.clamp(Math.floor(1024*c),-8192,8191);g=cr.clamp(Math.floor(1024*g),-8192,8191);b=cr.clamp(Math.floor(1024*b),-8192,8191);a=cr.clamp(Math.floor(1024*a),0,1024);0>c&&(c+=16384);0>g&&(g+=16384);0>b&&(b+=16384);return-(274877906944*c+16777216*g+1024*b+a)};cr.RGBEx=function(c,g,b){return cr.RGBAEx(c,g,b,1)};cr.GetRValue=function(c){if(0<=c)return(c&255)/255;c=Math.floor(-c/274877906944);8191<c&&(c-=
16384);return c/1024};cr.GetGValue=function(c){if(0<=c)return((c&65280)>>8)/255;c=Math.floor(-c%274877906944/16777216);8191<c&&(c-=16384);return c/1024};cr.GetBValue=function(c){if(0<=c)return((c&16711680)>>16)/255;c=Math.floor(-c%16777216/1024);8191<c&&(c-=16384);return c/1024};cr.GetAValue=function(c){return 0===c&&0>1/c?0:0<=c?1:Math.floor(-c%1024)/1024};cr.shallowCopy=function(c,g,b){for(var a in g)g.hasOwnProperty(a)&&(c[a]=g[a]);return c};cr.arrayRemove=function(c,g){var b;g=cr.floor(g);if(!(0>
g||g>=c.length)){for(b=c.length-1;g<b;g++)c[g]=c[g+1];cr.truncateArray(c,b)}};cr.truncateArray=function(c,g){c.length=g};cr.clearArray=function(c){cr.truncateArray(c,0)};cr.shallowAssignArray=function(c,g){cr.clearArray(c);var b;var a=0;for(b=g.length;a<b;++a)c[a]=g[a]};cr.appendArray=function(c,g){c.push.apply(c,g)};cr.fastIndexOf=function(c,g){var b;var a=0;for(b=c.length;a<b;++a)if(c[a]===g)return a;return-1};cr.arrayFindRemove=function(c,g){g=cr.fastIndexOf(c,g);-1!==g&&cr.arrayRemove(c,g)};cr.clamp=
function(c,g,b){return c<g?g:c>b?b:c};cr.to_radians=function(c){return c/(180/cr.PI)};cr.to_degrees=function(c){return 180/cr.PI*c};cr.clamp_angle_degrees=function(c){c%=360;0>c&&(c+=360);return c};cr.clamp_angle=function(c){c%=2*cr.PI;0>c&&(c+=2*cr.PI);return c};cr.to_clamped_degrees=function(c){return cr.clamp_angle_degrees(cr.to_degrees(c))};cr.to_clamped_radians=function(c){return cr.clamp_angle(cr.to_radians(c))};cr.angleTo=function(c,g,b,a){return Math.atan2(a-g,b-c)};cr.angleDiff=function(c,
g){if(c===g)return 0;c=Math.sin(c)*Math.sin(g)+Math.cos(c)*Math.cos(g);return 1<=c?0:-1>=c?cr.PI:Math.acos(c)};cr.angleRotate=function(c,g,b){var a=Math.sin(c),l=Math.cos(c),v=Math.sin(g),d=Math.cos(g);return Math.acos(a*v+l*d)>b?0<l*v-a*d?cr.clamp_angle(c+b):cr.clamp_angle(c-b):cr.clamp_angle(g)};cr.angleClockwise=function(c,g){return 0>=Math.cos(c)*Math.sin(g)-Math.sin(c)*Math.cos(g)};cr.rotatePtAround=function(c,g,b,a,l,d){if(0===b)return d?c:g;var v=Math.sin(b);b=Math.cos(b);c-=a;g-=l;var x=c*
v;c=c*b-g*v;return d?c+a:g*b+x+l};cr.distanceTo=function(c,g,b,a){c=b-c;g=a-g;return Math.sqrt(c*c+g*g)};cr.xor=function(c,g){return!c!==!g};cr.lerp=function(c,g,b){return c+(g-c)*b};cr.unlerp=function(c,g,b){return c===g?0:(b-c)/(g-c)};cr.anglelerp=function(c,g,b){var a=cr.angleDiff(c,g);return cr.angleClockwise(g,c)?c+a*b:c-a*b};cr.qarp=function(c,g,b,a){return cr.lerp(cr.lerp(c,g,a),cr.lerp(g,b,a),a)};cr.cubic=function(c,g,b,a,l){return cr.lerp(cr.qarp(c,g,b,l),cr.qarp(g,b,a,l),l)};cr.cosp=function(c,
g,b){return(c+g+(c-g)*Math.cos(b*Math.PI))/2};cr.hasAnyOwnProperty=function(c){for(var g in c)if(c.hasOwnProperty(g))return!0;return!1};cr.wipe=function(c){for(var g in c)c.hasOwnProperty(g)&&delete c[g]};var l=+new Date;cr.performance_now=function(){if("undefined"!==typeof window.performance){var c=window.performance;if("undefined"!==typeof c.now)return c.now();if("undefined"!==typeof c.webkitNow)return c.webkitNow();if("undefined"!==typeof c.mozNow)return c.mozNow();if("undefined"!==typeof c.msNow)return c.msNow()}return Date.now()-
l};var B=!1;"undefined"!==typeof window&&(B=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),!B&&/safari/i.test(navigator.userAgent),/(iphone|ipod|ipad)/i.test(navigator.userAgent));var G="undefined"!==typeof Set&&"undefined"!==typeof Set.prototype.forEach;u.prototype.contains=function(c){return this.isEmpty()?!1:G?this.s.has(c):this.items&&this.items.hasOwnProperty(c)};u.prototype.add=function(c){if(G)this.s.has(c)||(this.s.add(c),this.cache_valid=!1);else{var g=c.toString(),
b=this.items;b?b.hasOwnProperty(g)||(b[g]=c,this.item_count++,this.cache_valid=!1):(this.items={},this.items[g]=c,this.item_count=1,this.cache_valid=!1)}};u.prototype.remove=function(c){if(!this.isEmpty())if(G)this.s.has(c)&&(this.s["delete"](c),this.cache_valid=!1);else if(this.items){c=c.toString();var g=this.items;g.hasOwnProperty(c)&&(delete g[c],this.item_count--,this.cache_valid=!1)}};u.prototype.clear=function(){this.isEmpty()||(G?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),
this.cache_valid=!0)};u.prototype.isEmpty=function(){return 0===this.count()};u.prototype.count=function(){return G?this.s.size:this.item_count};var N=null,U=0;u.prototype.update_cache=function(){if(!this.cache_valid){if(G)cr.clearArray(this.values_cache),N=this.values_cache,U=0,this.s.forEach(m),N=null,U=0;else{var c=this.values_cache;cr.clearArray(c);var g,b=0,a=this.items;if(a)for(g in a)a.hasOwnProperty(g)&&(c[b++]=a[g])}this.cache_valid=!0}};u.prototype.valuesRef=function(){this.update_cache();
return this.values_cache};cr.ObjectSet=u;var H=new cr.ObjectSet;cr.removeArrayDuplicates=function(c){var g;var b=0;for(g=c.length;b<g;++b)H.add(c[b]);cr.shallowAssignArray(c,H.valuesRef());H.clear()};cr.arrayRemoveAllFromObjectSet=function(c,g){G?cr.arrayRemoveAll_set(c,g.s):cr.arrayRemoveAll_arr(c,g.valuesRef())};cr.arrayRemoveAll_set=function(c,g){var b,a;var l=b=0;for(a=c.length;b<a;++b){var d=c[b];g.has(d)||(c[l++]=d)}cr.truncateArray(c,l)};cr.arrayRemoveAll_arr=function(c,g){var b,a;var l=b=
0;for(a=c.length;b<a;++b){var d=c[b];-1===cr.fastIndexOf(g,d)&&(c[l++]=d)}cr.truncateArray(c,l)};d.prototype.add=function(c){this.y=c-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};d.prototype.reset=function(){this.sum=this.t=this.y=this.c=0};cr.KahanAdder=d;cr.regexp_escape=function(c){return c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};b.prototype.set_pts=function(c){this.pts_array=c;this.pts_count=c.length/2;this.pts_cache.length=c.length;this.cache_height=this.cache_width=
-1;this.cache_angle=0};b.prototype.is_empty=function(){return!this.pts_array.length};b.prototype.update_bbox=function(){for(var c=this.pts_cache,g=c[0],b=g,a=c[1],l=a,d,k,x=1,e=this.pts_count;x<e;++x)k=2*x,d=c[k],k=c[k+1],d<g&&(g=d),d>b&&(b=d),k<a&&(a=k),k>l&&(l=k);this.bboxLeft=g;this.bboxRight=b;this.bboxTop=a;this.bboxBottom=l};b.prototype.set_from_rect=function(c,g,b){this.pts_cache.length=8;this.pts_count=4;var a=this.pts_cache;a[0]=c.left-g;a[1]=c.top-b;a[2]=c.right-g;a[3]=c.top-b;a[4]=c.right-
g;a[5]=c.bottom-b;a[6]=c.left-g;a[7]=c.bottom-b;this.cache_width=c.right-c.left;this.cache_height=c.bottom-c.top;this.update_bbox()};b.prototype.set_from_quad=function(c,g,b,a,l){this.pts_cache.length=8;this.pts_count=4;var d=this.pts_cache;d[0]=c.tlx-g;d[1]=c.tly-b;d[2]=c.trx-g;d[3]=c.try_-b;d[4]=c.brx-g;d[5]=c.bry-b;d[6]=c.blx-g;d[7]=c.bly-b;this.cache_width=a;this.cache_height=l;this.update_bbox()};b.prototype.set_from_poly=function(c){this.pts_count=c.pts_count;cr.shallowAssignArray(this.pts_cache,
c.pts_cache);this.bboxLeft=c.bboxLeft;this.bboxTop-c.bboxTop;this.bboxRight=c.bboxRight;this.bboxBottom=c.bboxBottom};b.prototype.cache_poly=function(c,g,b){if(this.cache_width!==c||this.cache_height!==g||this.cache_angle!==b){this.cache_width=c;this.cache_height=g;this.cache_angle=b;var a,l=0,d=1,k=this.pts_array,x=this.pts_cache;0!==b&&(l=Math.sin(b),d=Math.cos(b));b=0;for(a=this.pts_count;b<a;b++){var e=2*b;var v=e+1;var t=k[e]*c;var h=k[v]*g;x[e]=t*d-h*l;x[v]=h*d+t*l}this.update_bbox()}};b.prototype.contains_pt=
function(c,g){var b=this.pts_cache;if(c===b[0]&&g===b[1])return!0;var a,l=this.pts_count,d=this.bboxLeft-110,k=this.bboxTop-101,x=this.bboxRight+131,e=this.bboxBottom+120,v=0,t=0;for(a=0;a<l;a++){var h=2*a;var B=(a+1)%l*2;var r=b[h];h=b[h+1];var m=b[B];B=b[B+1];cr.segments_intersect(d,k,c,g,r,h,m,B)&&v++;cr.segments_intersect(x,e,c,g,r,h,m,B)&&t++}return 1===v%2||1===t%2};b.prototype.intersects_poly=function(c,g,b){var a=c.pts_cache,l=this.pts_cache;if(this.contains_pt(a[0]+g,a[1]+b)||c.contains_pt(l[0]-
g,l[1]-b))return!0;var d,k;var x=0;for(d=this.pts_count;x<d;x++){var e=2*x;var v=(x+1)%d*2;var t=l[e];e=l[e+1];var h=l[v];var B=l[v+1];v=0;for(k=c.pts_count;v<k;v++){var r=2*v;var m=(v+1)%k*2;var f=a[r]+g;r=a[r+1]+b;var z=a[m]+g;m=a[m+1]+b;if(cr.segments_intersect(t,e,h,B,f,r,z,m))return!0}}return!1};b.prototype.intersects_segment=function(c,g,b,a,l,d){var k=this.pts_cache;if(this.contains_pt(b-c,a-g))return!0;var x;var e=0;for(x=this.pts_count;e<x;e++){var v=2*e;var t=(e+1)%x*2;var h=k[v]+c;v=k[v+
1]+g;var B=k[t]+c;t=k[t+1]+g;if(cr.segments_intersect(b,a,l,d,h,v,B,t))return!0}return!1};b.prototype.mirror=function(c){var g;var b=0;for(g=this.pts_count;b<g;++b){var a=2*b;this.pts_cache[a]=2*c-this.pts_cache[a]}};b.prototype.flip=function(c){var g;var b=0;for(g=this.pts_count;b<g;++b){var a=2*b+1;this.pts_cache[a]=2*c-this.pts_cache[a]}};b.prototype.diag=function(){var c;var g=0;for(c=this.pts_count;g<c;++g){var b=2*g;var a=b+1;var l=this.pts_cache[b];this.pts_cache[b]=this.pts_cache[a];this.pts_cache[a]=
l}};cr.CollisionPoly=b;e.prototype.totalCellCount=0;e.prototype.getCell=function(c,g,b){var a=this.cells[c];return a?(a=a[g])?a:b?(a=h(this,c,g),this.cells[c][g]=a):null:b?(a=h(this,c,g),this.cells[c]={},this.cells[c][g]=a):null};e.prototype.XToCell=function(c){return cr.floor(c/this.cellwidth)};e.prototype.YToCell=function(c){return cr.floor(c/this.cellheight)};e.prototype.update=function(g,b,a){var l,d,k;if(b){var v=b.left;for(l=b.right;v<=l;++v){var x=b.top;for(d=b.bottom;x<=d;++x)if(!a||!a.contains_pt(v,
x))if(k=this.getCell(v,x,!1))k.remove(g),k.isEmpty()&&(e.prototype.totalCellCount--,k.objects.clear(),1E3>c.length&&c.push(k),this.cells[v][x]=null)}}if(a)for(v=a.left,l=a.right;v<=l;++v)for(x=a.top,d=a.bottom;x<=d;++x)b&&b.contains_pt(v,x)||this.getCell(v,x,!0).insert(g)};e.prototype.queryRange=function(c,g){var b,a;var l=this.XToCell(c.left);var d=this.YToCell(c.top);var k=this.XToCell(c.right);for(b=this.YToCell(c.bottom);l<=k;++l)for(c=d;c<=b;++c)(a=this.getCell(l,c,!1))&&a.dump(g)};cr.SparseGrid=
e;w.prototype.totalCellCount=0;w.prototype.getCell=function(c,g,b){var a=this.cells[c];return a?(a=a[g])?a:b?(a=t(this,c,g),this.cells[c][g]=a):null:b?(a=t(this,c,g),this.cells[c]={},this.cells[c][g]=a):null};w.prototype.XToCell=function(c){return cr.floor(c/this.cellwidth)};w.prototype.YToCell=function(c){return cr.floor(c/this.cellheight)};w.prototype.update=function(c,b,a){var l,d,k;if(b){var e=b.left;for(l=b.right;e<=l;++e){var x=b.top;for(d=b.bottom;x<=d;++x)if(!a||!a.contains_pt(e,x))if(k=this.getCell(e,
x,!1))k.remove(c),k.isEmpty()&&(w.prototype.totalCellCount--,k.reset(),1E3>g.length&&g.push(k),this.cells[e][x]=null)}}if(a)for(e=a.left,l=a.right;e<=l;++e)for(x=a.top,d=a.bottom;x<=d;++x)b&&b.contains_pt(e,x)||this.getCell(e,x,!0).insert(c)};w.prototype.queryRange=function(c,g,b,a,l){var d,k;c=this.XToCell(c);g=this.YToCell(g);b=this.XToCell(b);for(d=this.YToCell(a);c<=b;++c)for(a=g;a<=d;++a)(k=this.getCell(c,a,!1))&&k.dump(l)};w.prototype.markRangeChanged=function(c){var g,b;var a=c.left;var l=
c.top;var d=c.right;for(g=c.bottom;a<=d;++a)for(c=l;c<=g;++c)if(b=this.getCell(a,c,!1))b.is_sorted=!1};cr.RenderGrid=w;var c=[];a.prototype.isEmpty=function(){return this.objects.isEmpty()};a.prototype.insert=function(c){this.objects.add(c)};a.prototype.remove=function(c){this.objects.remove(c)};a.prototype.dump=function(c){cr.appendArray(c,this.objects.valuesRef())};cr.GridCell=a;var g=[];y.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;
this.flush_pending();return!0};y.prototype.insert=function(c){this.pending_removal.contains(c)?(this.pending_removal.remove(c),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>c.get_zindex()&&(this.is_sorted=!1),this.objects.push(c)):(this.objects.push(c),this.is_sorted=!0)};y.prototype.remove=function(c){this.pending_removal.add(c);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};
y.prototype.flush_pending=function(){this.any_pending_removal&&(this.pending_removal.count()===this.objects.length?this.reset():(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};y.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(z),this.is_sorted=!0)};y.prototype.reset=function(){cr.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};y.prototype.dump=function(c){this.flush_pending();
this.ensure_sorted();this.objects.length&&c.push(this.objects)};cr.RenderCell=y;var r="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr.effectToCompositeOp=function(c){return 0>=c||11<=c?"source-over":r[c-1]};cr.setGLBlend=function(c,g,b){if(b)switch(c.srcBlend=b.ONE,c.destBlend=b.ONE_MINUS_SRC_ALPHA,g){case 1:c.srcBlend=b.ONE;c.destBlend=b.ONE;break;case 3:c.srcBlend=b.ONE;c.destBlend=b.ZERO;break;case 4:c.srcBlend=
b.ONE_MINUS_DST_ALPHA;c.destBlend=b.ONE;break;case 5:c.srcBlend=b.DST_ALPHA;c.destBlend=b.ZERO;break;case 6:c.srcBlend=b.ZERO;c.destBlend=b.SRC_ALPHA;break;case 7:c.srcBlend=b.ONE_MINUS_DST_ALPHA;c.destBlend=b.ZERO;break;case 8:c.srcBlend=b.ZERO;c.destBlend=b.ONE_MINUS_SRC_ALPHA;break;case 9:c.srcBlend=b.DST_ALPHA;c.destBlend=b.ONE_MINUS_SRC_ALPHA;break;case 10:c.srcBlend=b.ONE_MINUS_DST_ALPHA,c.destBlend=b.SRC_ALPHA}};cr.round6dp=function(c){return Math.round(1E6*c)/1E6};cr.equals_nocase=function(c,
g){return"string"!==typeof c||"string"!==typeof g||c.length!==g.length?!1:c===g?!0:c.toLowerCase()===g.toLowerCase()};cr.cssToCamelCase=function(c){var g="",b,a=!1;var l=0;for(b=c.length;l<b;++l){var d=c.charAt(l);"-"===d?a=!0:a?(g+=d.toUpperCase(),a=!1):g+=d}return g};cr.isCanvasInputEvent=function(c){c=c.target;return!c||c===document||c===window||document&&document.body&&c===document.body||cr.equals_nocase(c.tagName,"canvas")?!0:!1}})();
(function(){function f(c){var g=c.canvas,b=c.projectDataUrl;g||(g=document.createElement("canvas"),document.body.appendChild(g));if(g&&g.getContext){window.c3runtime=this;window.c3canvas=g;var a=this;this.exportType=c.exportType;this.isPreview="preview"===this.exportType;this.isRemotePreview=!!c.isRemotePreview;this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk);this.isPhoneGap=this.isCordova=
"cordova"===this.exportType;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;
this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad;this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=
this.isNWjs="nwjs"===this.exportType||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="scirra-arcade"===this.exportType;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10="windows-uwp"===this.exportType;this.isWinJS=
this.isWindows8App||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&!this.isFirefox&&!this.isAmazonWebApp;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));
this.isWKWebView=!(!this.isiOS||!this.isCordova);this.isPreview&&!this.isNWjs&&("?nw"===window.location.search||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent))&&(this.isNWjs=!0);this.isDebug=this.isPreview&&-1<window.location.search.indexOf("debug");this.useFbInstant="undefined"!==typeof FBInstant&&!this.isPreview&&!this.isCordova;this.hasInitialized=!1;this.canvas=g;this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=
0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=0;this.canvas.oncontextmenu=function(c){c.preventDefault&&c.preventDefault();return!1};this.canvas.onselectstart=function(c){c.preventDefault&&c.preventDefault();return!1};this.canvas.ontouchstart=function(c){c.preventDefault&&c.preventDefault();return!1};this.isNWjs&&(window.ondragover=function(c){c.preventDefault();return!1},window.ondrop=function(c){c.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
this.projectDataUrl=b||"";this.width=g.width;this.height=g.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_lowercase={};this.types_by_index=[];this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets=
{};this.eventsheets_by_index=[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=
!1;this.fireOnCreateAfterLoad=[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr.KahanAdder;this.wallTime=new cr.KahanAdder;this.gpuTimeEndFrame=this.gpuTimeStartFrame=this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.gpuCurUtilisation=-1;this.gpuLastUtilisation=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=[];this.event_stack_index=
-1;this.localvar_stack=[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.stackLocalCount=this.loadingprogress=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr.ObjectSet;this.objects_to_tick=new cr.ObjectSet;this.objects_to_tick2=
new cr.ObjectSet;this.registered_collisions=[];this.temp_poly=new cr.CollisionPoly([]);this.temp_poly2=new cr.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder="";
this.objectsByUid={};this.webFontNames=this.loaderlogos=null;this.enhancedAccelerationPrecision=!0;this.snapshotCanvas=null;this.snapshotData="";this.objectRefTable=[];"html5"===this.exportType&&"file"===location.protocol.substr(0,4);this.useFbInstant?(FBInstant.initializeAsync().then(function(){a.requestProjectData()}).catch(function(c){console.warn("[Instant Games] Unable to load: ",
c);a.requestProjectData()}),window.setTimeout(function(){a.hasInitialized||(console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."),a.useFbInstant=!1,a.requestProjectData())},4E3)):this.requestProjectData()}}function p(){try{return!!window.indexedDB}catch(x){return!1}}function q(c){c.target.result.createObjectStore("saves",{keyPath:"slot"})}function n(c,g,b,a){try{var x=indexedDB.open("_C2SaveStates");x.onupgradeneeded=q;x.onerror=a;x.onsuccess=
function(x){x=x.target.result;x.onerror=a;x.transaction(["saves"],"readwrite").objectStore("saves").put({slot:c,data:g}).onsuccess=b}}catch(P){a(P)}}function u(c,g,b){try{var a=indexedDB.open("_C2SaveStates");a.onupgradeneeded=q;a.onerror=b;a.onsuccess=function(a){a=a.target.result;a.onerror=b;var x=a.transaction(["saves"]).objectStore("saves").get(c);x.onsuccess=function(c){x.result?g(x.result.data):g(null)}}}catch(F){b(F)}}function m(){cr.logexport("Reloading for continuous preview");-1<window.location.search.indexOf("continuous")?
window.location.reload(!0):window.location+="?continuous"}function d(c){var g,b={};for(g in c)!c.hasOwnProperty(g)||c[g]instanceof cr.ObjectSet||c[g]&&"undefined"!==typeof c[g].c2userdata||"spriteCreatedDestroyCallback"!==g&&(b[g]=c[g]);return b}var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,e=new Audio,w={"audio/webm; codecs=opus":!!e.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!e.canPlayType("audio/ogg; codecs=opus"),
"audio/webm; codecs=vorbis":!!e.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!e.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!e.canPlayType("audio/mp4"),"audio/mpeg":!!e.canPlayType("audio/mpeg")};e=null;f.prototype.requestProjectData=function(){if(!this.hasInitialized){this.hasInitialized=!0;var c=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",function(g){c.loadProject(JSON.parse(g))},function(c){alert("Error fetching data.js")});else{var g=
this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var b=this.projectDataUrl||"data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)b="data.json";g.open("GET",b,!0);var a=!1;if("response"in g&&"responseType"in g)try{g.responseType="json",a="json"===g.responseType}catch(F){a=!1}if(!a&&"responseType"in g)try{g.responseType="text"}catch(F){}if("overrideMimeType"in g)try{g.overrideMimeType("application/json; charset=utf-8")}catch(F){}this.isWindowsPhone8?
g.onreadystatechange=function(){4===g.readyState&&c.loadProject(JSON.parse(g.responseText))}:(g.onload=function(){a?c.loadProject(g.response):c.loadProject(JSON.parse(g.responseText))},g.onerror=function(c){cr.logerror("Error requesting "+b+":");cr.logerror(c)});g.send()}}};f.prototype.initRendererAndLoader=function(){var c=this,g,b;this.isRetina=this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);var a=window.devicePixelRatio||window.webkitDevicePixelRatio||
window.mozDevicePixelRatio||window.msDevicePixelRatio||1;this.devicePixelRatio=this.isRetina?a:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();"object"===typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,window.innerHeight,!0);try{if(this.enableWebGL){var l={alpha:!0,depth:!1,antialias:!1,failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",l));this.gl||
(this.gl=this.canvas.getContext("webgl",l)||this.canvas.getContext("experimental-webgl",l))}}catch(Q){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(a=this.gl.getExtension("WEBGL_debug_renderer_info"))l=this.gl.getParameter(a.UNMASKED_VENDOR_WEBGL),this.glUnmaskedRenderer=this.gl.getParameter(a.UNMASKED_RENDERER_WEBGL)+" ["+l+"]";this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.overlay_canvas=document.createElement("canvas");this.canvas.parentNode.appendChild(this.overlay_canvas);
this.overlay_canvas.oncontextmenu=function(c){return!1};this.overlay_canvas.onselectstart=function(c){return!1};this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio);this.overlay_canvas.height=Math.round(this.cssHeight*this.devicePixelRatio);this.overlay_canvas.style.width=this.cssWidth+"px";this.overlay_canvas.style.height=this.cssHeight+"px";this.overlay_canvas.style.position="absolute";this.overlay_ctx=this.overlay_canvas.getContext("2d");this.glwrap=new cr.GLWrap(this.gl,this.isMobile,
this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;this.canvas.addEventListener("webglcontextlost",function(g){g.preventDefault();c.onContextLost();cr.logexport("[Construct 2] WebGL context lost");window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(g){c.glwrap.initState();c.glwrap.setSize(c.glwrap.width,c.glwrap.height,!0);c.layer_tex=null;c.layout_tex=null;
c.fx_tex[0]=null;c.fx_tex[1]=null;c.onContextRestored();c.redraw=!0;cr.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);this.glwrap.supportsGpuProfiling()||(this.gpuLastUtilisation=NaN);a=0;for(l=this.types_by_index.length;a<l;a++){var d=this.types_by_index[a];var k=0;for(g=d.effect_types.length;k<g;k++){var e=d.effect_types[k];e.shaderindex=this.glwrap.getShaderIndex(e.id);e.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(e.shaderindex);this.uses_background_blending=
this.uses_background_blending||this.glwrap.programUsesDest(e.shaderindex)}}a=0;for(l=this.layouts_by_index.length;a<l;a++){var t=this.layouts_by_index[a];k=0;for(g=t.effect_types.length;k<g;k++)e=t.effect_types[k],e.shaderindex=this.glwrap.getShaderIndex(e.id),e.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(e.shaderindex);t.updateActiveEffects();k=0;for(g=t.layers.length;k<g;k++){var h=t.layers[k];d=0;for(b=h.effect_types.length;d<b;d++)e=h.effect_types[d],e.shaderindex=this.glwrap.getShaderIndex(e.id),
e.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(e.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(e.shaderindex);h.updateActiveEffects()}}}else l={alpha:!0},this.ctx=this.canvas.getContext("2d",l),this.ctx.imageSmoothingEnabled=this.linearSampling,this.overlay_ctx=this.overlay_canvas=null,this.gpuLastUtilisation=NaN,this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=!0;this.tickFunc=function(g){c.tick(!1,g)};window==window.top||
this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));this.isPreview&&(-1<window.location.search.indexOf("continuous")&&(cr.logexport("Reloading for continuous preview"),this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(window.addEventListener("focus",function(){c.setSuspended(!1)}),window.addEventListener("blur",function(){var g=
window.parent;g&&g.document.hasFocus()||c.setSuspended(!0)})));window.addEventListener("blur",function(){c.onWindowBlur()});a=function(c){"mousedown"===c.type&&1===c.button&&c.preventDefault();if(cr.isCanvasInputEvent(c)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(T){}};"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",a):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",
a):document.addEventListener("touchstart",a);document.addEventListener("mousedown",a);0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio?this.setSize(this.original_width,this.original_height,!0):this.setSize(window.innerWidth,window.innerHeight,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr.seal(this)};f.prototype.setSize=function(c,g,b){var a=0,x=0;if(this.lastWindowWidth!==c||this.lastWindowHeight!==g||b){if(this.isiPhone&&this.isCordova&&window.screen){var l=
document.documentElement.style;var d=document.body.style;var k=window.innerWidth<window.innerHeight;var e=k?window.screen.height:window.screen.width;k=k?window.screen.width:window.screen.height;e&&k&&(d.height=l.height=e+"px",d.width=l.width=k+"px")}this.lastWindowWidth=c;this.lastWindowHeight=g;l=this.fullscreen_mode;if((d=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen)&&!this.isCordova)||0!==this.fullscreen_mode||b)d&&(l=this.fullscreen_scaling),
b=this.devicePixelRatio,4<=l?(5===l&&1!==b&&(c+=1,g+=1),d=this.original_width/this.original_height,c/g>d?(d*=g,5===l?(a=d*b/this.original_width,1<a?a=Math.floor(a):1>a&&(a=1/Math.ceil(1/a)),d=this.original_width*a/b,e=this.original_height*a/b,a=(c-d)/2,x=(g-e)/2,c=d,g=e):(a=(c-d)/2,c=d)):(e=c/d,5===l?(a=e*b/this.original_height,1<a?a=Math.floor(a):1>a&&(a=1/Math.ceil(1/a)),d=this.original_width*a/b,e=this.original_height*a/b,a=(c-d)/2,x=(g-e)/2,c=d):x=(g-e)/2,g=e)):d&&0===l&&(a=Math.floor((c-this.original_width)/
2),x=Math.floor((g-this.original_height)/2),c=this.original_width,g=this.original_height),2>l&&(this.aspect_scale=b),this.cssWidth=Math.round(c),this.cssHeight=Math.round(g),this.width=Math.round(c*b),this.height=Math.round(g*b),this.redraw=!0,this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===l?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=
!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===l?(d=this.original_width/this.original_height,l=this.lastWindowWidth/this.lastWindowHeight,l<d?this.draw_width=this.draw_height*l:l>d&&(this.draw_height=this.draw_width/l)):3===l&&(d=this.original_width/this.original_height,l=this.lastWindowWidth/this.lastWindowHeight,l>d?this.draw_width=this.draw_height*l:l<d&&(this.draw_height=this.draw_width/l))),this.canvas&&(this.canvas.width=Math.round(c*
b),this.canvas.height=Math.round(g*b),this.isRetina&&(this.canvas.style.width=Math.round(c)+"px",this.canvas.style.height=Math.round(g)+"px"),this.canvas.style.marginLeft=Math.floor(a)+"px",this.canvas.style.marginTop=Math.floor(x)+"px"),this.overlay_canvas&&(this.overlay_canvas.width=Math.round(c*b),this.overlay_canvas.height=Math.round(g*b),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px",this.overlay_canvas.style.left=Math.floor(a)+"px",this.overlay_canvas.style.top=
Math.floor(x)+"px"),this.glwrap&&this.glwrap.setSize(Math.round(c*b),Math.round(g*b)),this.ctx&&(this.ctx.imageSmoothingEnabled=this.linearSampling),this.tryLockOrientation(),this.isiPhone&&!this.isCordova&&window.scrollTo(0,0)}};f.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var c="portrait";2===this.orientations&&(c="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(c).catch(function(){}):screen.lockOrientation?screen.lockOrientation(c):
screen.webkitLockOrientation?screen.webkitLockOrientation(c):screen.mozLockOrientation?screen.mozLockOrientation(c):screen.msLockOrientation&&screen.msLockOrientation(c)}catch(W){console&&console.warn&&console.warn("Failed to lock orientation: ",W)}}};f.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var c;var g=0;for(c=this.types_by_index.length;g<c;g++){var b=this.types_by_index[g];if(b.onLostWebGLContext)b.onLostWebGLContext()}};f.prototype.onContextRestored=
function(){this.is_WebGL_context_lost=!1;var c;var g=0;for(c=this.types_by_index.length;g<c;g++){var b=this.types_by_index[g];if(b.onRestoreWebGLContext)b.onRestoreWebGLContext()}};var h=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;f.prototype.setSuspended=function(c){var g;if(c&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&h(this.raf_id),
-1!==this.timeout_id&&clearTimeout(this.timeout_id),c=0,g=this.suspend_events.length;c<g;c++)this.suspend_events[c](!0);else if(!c&&this.isSuspended){cr.logexport("[Construct 2] Resuming");this.isSuspended=!1;this.last_tick_time=cr.performance_now();this.last_fps_time=cr.performance_now();c=this.logictime=this.framecount=0;for(g=this.suspend_events.length;c<g;c++)this.suspend_events[c](!1);this.tick(!1)}};f.prototype.addSuspendCallback=function(c){this.suspend_events.push(c)};f.prototype.GetObjectReference=
function(c){return this.objectRefTable[c]};f.prototype.loadProject=function(c){c&&c.project||cr.logerror("Project model unavailable");c=c.project;this.name=c[0];this.first_layout=c[1];this.fullscreen_mode=c[12];this.fullscreen_mode_set=c[12];this.original_width=c[10];this.original_height=c[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=this.original_height/2;this.uses_loader_layout=c[18];this.loaderstyle=c[19];this.iconsFolder=c[28];this.webFontNames=c[29].map(function(c){return c[0]});
if(0===this.loaderstyle){var g=new Image;g.crossOrigin="anonymous";var b=this.loaderlogos={logo:g};g.addEventListener("error",function(){b.logo=null});var a=this.isPreview?this.getProjectFileUrl("loading-logo.png"):this.iconsFolder+"loading-logo.png";this.setImageSrc(g,a)}else if(4===this.loaderstyle){g=new Image;g.src="splash-images/splash-logo.svg";a=new Image;a.src="splash-images/splash-poweredby-512.png";var l=new Image;l.src="splash-images/splash-poweredby-256.png";var x=new Image;x.src="splash-images/splash-poweredby-128.png";
var d=new Image;d.src="splash-images/splash-website-512.png";var k=new Image;k.src="splash-images/splash-website-256.png";var e=new Image;e.src="splash-images/splash-website-128.png";this.loaderlogos={logo:g,powered:[a,l,x],website:[d,k,e]}}this.next_uid=c[21];this.objectRefTable=cr.getObjectRefTable();this.system=new cr.system_object(this);g=0;for(a=c[2].length;g<a;g++){e=c[2][g];l=this.GetObjectReference(e[0]);cr.add_common_aces(e,l.prototype);var t=new l(this);t.singleglobal=e[1];t.is_world=e[2];
t.is_rotatable=e[5];t.must_predraw=e[9];if(t.onCreate)t.onCreate();cr.seal(t);this.plugins.push(t)}this.objectRefTable=cr.getObjectRefTable();g=0;for(a=c[3].length;g<a;g++){e=c[3][g];d=this.GetObjectReference(e[1]);t=null;l=0;for(x=this.plugins.length;l<x;l++)if(this.plugins[l]instanceof d){t=this.plugins[l];break}var h=new t.Type(t);h.name=e[0];h.is_family=e[2];h.instvar_sids=e[3].slice(0);h.vars_count=e[3].length;h.behs_count=e[4];h.fx_count=e[5];h.sid=e[11];h.is_family?(h.members=[],h.family_index=
this.family_count++,h.families=null):(h.members=null,h.family_index=-1,h.families=[]);h.family_var_map=null;h.family_beh_map=null;h.family_fx_map=null;h.is_contained=!1;h.container=null;e[6]?(h.texture_file=e[6][0],h.texture_filesize=e[6][1],h.texture_pixelformat=e[6][2],h.texture_data=e[6]):(h.texture_file=null,h.texture_filesize=0,h.texture_pixelformat=0,h.texture_data=null);h.animations=e[7]?e[7]:null;h.index=g;h.instances=[];h.deadCache=[];h.solstack=[new cr.selection(h)];h.cur_sol=0;h.default_instance=
null;h.default_layerindex=0;h.stale_iids=!0;h.updateIIDs=cr.type_updateIIDs;h.getFirstPicked=cr.type_getFirstPicked;h.getPairedInstance=cr.type_getPairedInstance;h.getCurrentSol=cr.type_getCurrentSol;h.pushCleanSol=cr.type_pushCleanSol;h.pushCopySol=cr.type_pushCopySol;h.popSol=cr.type_popSol;h.getBehaviorByName=cr.type_getBehaviorByName;h.getBehaviorIndexByName=cr.type_getBehaviorIndexByName;h.getEffectIndexByName=cr.type_getEffectIndexByName;h.applySolToContainer=cr.type_applySolToContainer;h.getInstanceByIID=
cr.type_getInstanceByIID;h.collision_grid=new cr.SparseGrid(this.original_width,this.original_height);h.any_cell_changed=!0;h.any_instance_parallaxed=!1;h.extra={};h.toString=cr.type_toString;h.behaviors=[];l=0;for(x=e[8].length;l<x;l++){var B=e[8][l];var v=this.GetObjectReference(B[1]),r=null;d=0;for(k=this.behaviors.length;d<k;d++)if(this.behaviors[d]instanceof v){r=this.behaviors[d];break}if(!r){r=new v(this);r.my_types=[];r.my_instances=new cr.ObjectSet;if(r.onCreate)r.onCreate();cr.seal(r);this.behaviors.push(r);
cr.behaviors.solid&&r instanceof cr.behaviors.solid&&(this.solidBehavior=r);cr.behaviors.jumpthru&&r instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=r);cr.behaviors.shadowcaster&&r instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=r)}-1===r.my_types.indexOf(h)&&r.my_types.push(h);d=new r.Type(r,h);d.name=B[0];d.sid=B[2];d.onCreate();cr.seal(d);h.behaviors.push(d)}h.global=e[9];h.isOnLoaderLayout=e[10];h.effect_types=[];l=0;for(x=e[12].length;l<x;l++)h.effect_types.push({id:e[12][l][0],
name:e[12][l][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:l});h.tile_poly_data=e[13];if(!this.uses_loader_layout||h.is_family||h.isOnLoaderLayout||!t.is_world)h.onCreate(),cr.seal(h);h.name&&(this.types[h.name]=h,this.types_lowercase[h.name.toLowerCase()]=h);this.types_by_index.push(h);t.singleglobal&&(l=new t.Instance(h),l.uid=this.next_uid++,l.puid=this.next_puid++,l.iid=0,l.get_iid=cr.inst_get_iid,l.toString=cr.inst_toString,l.properties=e[14],l.onCreate(),cr.seal(l),h.instances.push(l),
this.objectsByUid[l.uid.toString()]=l)}g=0;for(a=c[4].length;g<a;g++)for(d=c[4][g],k=this.types_by_index[d[0]],l=1,x=d.length;l<x;l++)e=this.types_by_index[d[l]],e.families.push(k),k.members.push(e);g=0;for(a=c[27].length;g<a;g++){d=c[27][g];k=[];l=0;for(x=d.length;l<x;l++)k.push(this.types_by_index[d[l]]);l=0;for(x=k.length;l<x;l++)k[l].is_contained=!0,k[l].container=k}if(0<this.family_count)for(g=0,a=this.types_by_index.length;g<a;g++)if(e=this.types_by_index[g],!e.is_family&&e.families.length){e.family_var_map=
Array(this.family_count);e.family_beh_map=Array(this.family_count);e.family_fx_map=Array(this.family_count);h=[];l=r=v=B=0;for(x=e.families.length;l<x;l++)for(t=e.families[l],e.family_var_map[t.family_index]=B,B+=t.vars_count,e.family_beh_map[t.family_index]=v,v+=t.behs_count,e.family_fx_map[t.family_index]=r,r+=t.fx_count,d=0,k=t.effect_types.length;d<k;d++)h.push(cr.shallowCopy({},t.effect_types[d]));e.effect_types=h.concat(e.effect_types);l=0;for(x=e.effect_types.length;l<x;l++)e.effect_types[l].index=
l}g=0;for(a=c[5].length;g<a;g++)e=c[5][g],l=new cr.layout(this,e),cr.seal(l),this.layouts[l.name]=l,this.layouts_by_index.push(l);g=0;for(a=c[6].length;g<a;g++)e=c[6][g],l=new cr.eventsheet(this,e),cr.seal(l),this.eventsheets[l.name]=l,this.eventsheets_by_index.push(l);g=0;for(a=this.eventsheets_by_index.length;g<a;g++)this.eventsheets_by_index[g].postInit();g=0;for(a=this.eventsheets_by_index.length;g<a;g++)this.eventsheets_by_index[g].updateDeepIncludes();g=0;for(a=this.triggers_to_postinit.length;g<
a;g++)this.triggers_to_postinit[g].postInit();cr.clearArray(this.triggers_to_postinit);this.audio_files_info=c[7];this.audio_files_map={};g=0;for(a=this.audio_files_info.length;g<a;++g)l=this.audio_files_info[g],this.audio_files_map[l[0]]=l[1];this.files_subfolder=c[8];this.pixel_rounding=c[9];this.aspect_scale=1;this.enableWebGL=c[13];this.linearSampling=c[14];this.clearBackground=c[15];this.versionstr=c[16];this.useHighDpi=c[17];this.orientations=c[20];this.autoLockOrientation=0<this.orientations;
this.pauseOnBlur=c[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=c[23];this.downscalingQuality=c[24];this.preloadSounds=c[25];this.enableFrontToBack=c[26]&&!this.isIE;this.enhancedAccelerationPrecision=c[30];this.start_time=Date.now();cr.clearArray(this.objectRefTable);this.preloadSounds||w["audio/webm; codecs=opus"]||!window.OpusDecoder||window.OpusDecoder.Initialise();this.initRendererAndLoader()};var a=!1;f.prototype.waitForImageLoad=function(c,g){window.cr_remotePreviewImageFiles&&
g&&"blob:"!==g.substr(0,5)&&(g=window.cr_remotePreviewImageFiles[g]);c.onerror=function(g){a=c.c2error=!0;console&&console.error&&console.error("Error loading image '"+c.src+"': ",g)};c.src||("undefined"!==typeof XAPKReader?XAPKReader.get(g,function(g){c.src=g},function(b){a=c.c2error=!0;console&&console.error&&console.error("Error extracting image '"+g+"' from expansion file: ",b)}):(c.crossOrigin="anonymous",this.setImageSrc(c,g)));this.wait_for_textures.push(c)};f.prototype.findWaitingTexture=
function(c){var g;var b=0;for(g=this.wait_for_textures.length;b<g;b++)if(this.wait_for_textures[b].cr_src===c)return this.wait_for_textures[b];return null};var t=0,y=!1;f.prototype.getready=function(){if(this.audioInstance&&this.preloadSounds){var c=[],g;var b=0;for(g=this.audio_files_info.length;b<g;++b){var a=this.audio_files_info[b];var l=a[0];var d=a[2];(a=this.getPreferredAudioFile(l))&&!d&&c.push({filename:l+a[1],size:a[2],type:a[0]})}t=this.audioInstance.setPreloadList(c)}};f.prototype.areAllTexturesAndSoundsLoaded=
function(){var c=t,g=0,b=!0,a;var l=0;for(a=this.wait_for_textures.length;l<a;l++){var d=this.wait_for_textures[l];var e=d.cr_filesize;if(!e||0>=e)e=5E4;c+=e;d.src&&d.complete&&!d.c2error?g+=e:b=!1}b&&this.preloadSounds&&this.audioInstance&&(y||(this.audioInstance.startPreloads(),y=!0),l=this.audioInstance.getPreloadedSize(),g+=l,l<t&&(b=!1));this.progress=0==c?1:g/c;return b};var z=!1;f.prototype.go=function(){if(this.ctx||this.glwrap){var c=this.ctx||this.overlay_ctx;if(0<this.fullscreen_mode){var g=
window.innerWidth,l=window.innerHeight;this.lastWindowWidth===g&&this.lastWindowHeight===l||this.setSize(g,l)}this.progress=0;this.last_progress=-1;var d=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||z))this.useFbInstant?FBInstant.startGameAsync().then(function(){d.go_loading_finished()}):this.go_loading_finished();else{this.useFbInstant&&FBInstant.setLoadingProgress(100*this.progress);l=Date.now()-this.start_time;if(c){var e=this.width,k=this.height;g=this.devicePixelRatio;
if(3>this.loaderstyle&&500<=l&&this.last_progress!=this.progress){c.clearRect(0,0,e,k);l=e/2;k/=2;e=0===this.loaderstyle&&this.loaderlogos.logo&&this.loaderlogos.logo.complete;var h=40*g,t=0,B=80*g;if(e){var v=this.loaderlogos.logo;B=v.width*g;var r=v.height*g;h=B/2;t=r/2;c.drawImage(v,cr.floor(l-h),cr.floor(k-t),B,r)}1>=this.loaderstyle?(k+=t+(e?12*g:0),l=cr.floor(l-h)+.5,k=cr.floor(k)+.5,c.fillStyle=a?"red":"DodgerBlue",c.fillRect(l,k,Math.floor(B*this.progress),6*g),c.strokeStyle="black",c.strokeRect(l,
k,B,6*g),c.strokeStyle="white",c.strokeRect(l-1*g,k-1*g,B+2*g,8*g)):2===this.loaderstyle&&(c.font="12pt Arial",c.fillStyle=a?"#f00":"#999",c.textBaseLine="middle",g=Math.round(100*this.progress)+"%",e=c.measureText?c.measureText(g):null,c.fillText(g,l-(e?e.width:0)/2,k));this.last_progress=this.progress}else if(4===this.loaderstyle){this.draw_c3_splash_loader(c);b?b(function(){d.go()}):setTimeout(function(){d.go()},16);return}}setTimeout(function(){d.go()},100)}}};var A=-1,k=!0,l=!1,B=0,G=0,N=null,
U=null,H=0;f.prototype.draw_c3_splash_loader=function(c){if(!z){var g=this.isPreview||this.useFbInstant,b=g?0:200,d=g?0:3E3,x=Math.ceil(this.width),e=Math.ceil(this.height),h=this.loaderlogos.logo,t=this.loaderlogos.powered,v=this.loaderlogos.website;if(h.complete){for(var r=0;3>r;++r)if(!t[r].complete||!v[r].complete)return;0===H&&(A=Date.now());r=Date.now();var m=!1,f=c;k||l?(c.clearRect(0,0,x,e),N&&N.width===x&&N.height===e||(N=document.createElement("canvas"),N.width=x,N.height=e,U=N.getContext("2d")),
f=U,m=!0,k&&1===H&&(A=Date.now())):c.globalAlpha=1;f.fillStyle="#3B4045";f.fillRect(0,0,x,e);try{if(256<this.cssHeight){var y=1.5*cr.clamp(.22*e,105,.6*x);var w=y/8;f.drawImage(128>=y?t[2]:256>=y?t[1]:t[0],.5*x-y/2,.2*e-w/2,y,w);w=y=Math.min(.395*e,.95*x);f.drawImage(h,.5*x-y/2,.485*e-w/2,y,w);y=1.5*cr.clamp(.22*e,105,.6*x);w=y/8;f.drawImage(128>=y?v[2]:256>=y?v[1]:v[0],.5*x-y/2,.868*e-w/2,y,w);f.fillStyle="#4D565D";y=x;w=Math.max(.005*e,2);f.fillRect(0,.8*e-w/2,y,w);f.fillStyle=a?"red":"#29F3D0";
y=x*this.progress;f.fillRect(.5*x-y/2,.8*e-w/2,y,w)}else w=y=.55*e,f.drawImage(h,.5*x-y/2,.45*e-w/2,y,w),f.fillStyle="#4D565D",y=x,w=Math.max(.005*e,2),f.fillRect(0,.85*e-w/2,y,w),f.fillStyle=a?"red":"#29F3D0",y=x*this.progress,f.fillRect(.5*x-y/2,.85*e-w/2,y,w);m&&(k?c.globalAlpha=0===H?0:Math.min((r-A)/300,1):l&&(c.globalAlpha=Math.max(1-(r-G)/300,0)),c.drawImage(N,0,0,x,e))}catch(aa){}k&&300<=r-A&&2<=H&&(k=!1,B=r);!k&&r-B>=d&&!l&&1<=this.progress&&(l=!0,G=r);if(l&&r-G>=300+b||g&&1<=this.progress&&
500>Date.now()-A)z=!0,l=k=!1,this.loaderlogos=U=N=null;++H}}};f.prototype.go_loading_finished=function(){if(this.webFontNames.length&&document.fonts&&document.fonts.load){var c=this;Promise.all(this.webFontNames.map(function(c){return document.fonts.load("1em '"+c+"'")})).then(function(){c.start_first_layout()})}else this.start_first_layout()};f.prototype.start_first_layout=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=this.overlay_ctx=
null);this.start_time=Date.now();this.last_fps_time=cr.performance_now();var c;if(this.uses_loader_layout){var g=0;for(c=this.types_by_index.length;g<c;g++){var b=this.types_by_index[g];b.is_family||b.isOnLoaderLayout||!b.plugin.is_world||(b.onCreate(),cr.seal(b))}}else this.isloading=!1;g=0;for(c=this.layouts_by_index.length;g<c;g++)this.layouts_by_index[g].createGlobalNonWorlds();2<=this.fullscreen_mode&&(g=this.original_width/this.original_height,c=this.width/this.height,this.aspect_scale=2!==
this.fullscreen_mode&&c>g||2===this.fullscreen_mode&&c<g?this.height/this.original_height:this.width/this.original_width);g=0;for(c=this.types_by_index.length;g<c;g++)if(b=this.types_by_index[g],b.onBeforeAppBegin)b.onBeforeAppBegin();this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&window.C3_RegisterSW());
navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide();g=0;for(c=this.types_by_index.length;g<c;g++)if(b=this.types_by_index[g],b.onAppBegin)b.onAppBegin();g=function(){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):window.cr_setSuspended(!1)};document.addEventListener("visibilitychange",g,!1);document.addEventListener("mozvisibilitychange",g,!1);document.addEventListener("webkitvisibilitychange",g,!1);document.addEventListener("msvisibilitychange",
g,!1);this.isCordova&&(document.addEventListener("pause",function(){window.cr_setSuspended(!0)}),document.addEventListener("resume",function(){window.cr_setSuspended(!1)}));document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1)};f.prototype.tick=function(c,g,a){if(this.running_layout){var l=cr.performance_now();if(a||!this.isSuspended||c){c||(b?this.raf_id=b(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));
g=g||l;var e=this.fullscreen_mode;(a=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)&&0<this.fullscreen_scaling&&(e=this.fullscreen_scaling);if(0<e){e=window.innerWidth;var d=window.innerHeight;this.lastWindowWidth===e&&this.lastWindowHeight===d||this.setSize(e,d)}a?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/
this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height);this.isloading&&(a=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,a&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&window.C3_RegisterSW()));this.logic(g);!this.redraw||this.is_WebGL_context_lost||this.suspendDrawing||c||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),
this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr.performance_now()-l}}};f.prototype.logic=function(c){var g;1E3<=c-this.last_fps_time&&
(this.last_fps_time+=1E3,1E3<=c-this.last_fps_time&&(this.last_fps_time=c),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=Math.min(this.logictime,1E3),this.logictime=0,this.glwrap&&0===this.gpuTimeEndFrame&&(this.gpuTimeEndFrame=this.glwrap.getFrameNumber(),this.gpuCurUtilisation=-1));this.glwrap&&-1===this.gpuCurUtilisation&&this.glwrap.supportsGpuProfiling()&&(this.gpuCurUtilisation=this.glwrap.getFrameRangeTimerResults(this.gpuTimeStartFrame,this.gpuTimeEndFrame),-1!==this.gpuCurUtilisation&&
(this.glwrap.deleteTimerResultsToFrame(this.gpuTimeEndFrame),this.gpuLastUtilisation=Math.min(this.gpuCurUtilisation,1),this.gpuTimeStartFrame=this.gpuTimeEndFrame,this.gpuTimeEndFrame=0));if(0!==this.last_tick_time){var b=c-this.last_tick_time;0>b&&(b=0);this.dt1=b/1E3;.5<this.dt1?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate)}this.last_tick_time=c;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(this.dt1);c=(document.mozFullScreen||document.webkitIsFullScreen||
document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova;if(2<=this.fullscreen_mode||c&&0<this.fullscreen_scaling){b=this.original_width/this.original_height;var a=this.width/this.height;var l=this.fullscreen_mode;c&&0<this.fullscreen_scaling&&(l=this.fullscreen_scaling);this.aspect_scale=2!==l&&a>b||2===l&&a<b?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=
this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;a=this.objects_to_pretick.valuesRef();c=0;for(b=a.length;c<b;c++)a[c].pretick();c=0;for(b=this.types_by_index.length;c<b;c++){var e=this.types_by_index[c];if(!e.is_family&&(e.behaviors.length||e.families.length))for(a=0,l=e.instances.length;a<l;a++){var d=e.instances[a];var x=0;for(g=d.behavior_insts.length;x<g;x++)d.behavior_insts[x].tick()}}c=
0;for(b=this.types_by_index.length;c<b;c++)if(e=this.types_by_index[c],!e.is_family&&(e.behaviors.length||e.families.length))for(a=0,l=e.instances.length;a<l;a++)for(d=e.instances[a],x=0,g=d.behavior_insts.length;x<g;x++){var k=d.behavior_insts[x];k.posttick&&k.posttick()}a=this.objects_to_tick.valuesRef();c=0;for(b=a.length;c<b;c++)a[c].tick();this.isInOnDestroy--;this.handleSaveLoad();for(c=0;this.changelayout&&10>c++;)this.doChangeLayout(this.changelayout);c=0;for(b=this.eventsheets_by_index.length;c<
b;c++)this.eventsheets_by_index[c].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;c=0;for(b=this.types_by_index.length;c<b;c++)if(e=this.types_by_index[c],!e.is_family&&(e.behaviors.length||e.families.length))for(a=0,l=e.instances.length;a<l;a++)for(d=e.instances[a],x=0,g=d.behavior_insts.length;x<g;x++)k=d.behavior_insts[x],k.tick2&&k.tick2();a=this.objects_to_tick2.valuesRef();
c=0;for(b=a.length;c<b;c++)a[c].tick2();this.isInOnDestroy--};f.prototype.onWindowBlur=function(){var c,g,b;var a=0;for(c=this.types_by_index.length;a<c;a++){var l=this.types_by_index[a];if(!l.is_family){var e=0;for(g=l.instances.length;e<g;e++){var d=l.instances[e];if(d.onWindowBlur)d.onWindowBlur();if(d.behavior_insts){var k=0;for(b=d.behavior_insts.length;k<b;k++){var h=d.behavior_insts[k];if(h.onWindowBlur)h.onWindowBlur()}}}}}};f.prototype.doChangeLayout=function(c){var g=this.running_layout;
this.running_layout.stopRunning();var b;if(this.glwrap){var a=0;for(b=this.types_by_index.length;a<b;a++){var l=this.types_by_index[a];l.is_family||!l.unloadTextures||l.global&&0!==l.instances.length||-1!==c.initial_types.indexOf(l)||l.unloadTextures()}}g==c&&cr.clearArray(this.system.waits);cr.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);c.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=this.redraw=!0;this.ClearDeathRow()};f.prototype.runLayoutChangeMethods=
function(c){var g,b,a;var l=0;for(g=this.behaviors.length;l<g;l++){var e=this.behaviors[l];if(c){if(e.onBeforeLayoutChange)e.onBeforeLayoutChange()}else if(e.onLayoutChange)e.onLayoutChange()}l=0;for(g=this.types_by_index.length;l<g;l++)if(e=this.types_by_index[l],e.global||e.plugin.singleglobal){var d=0;for(b=e.instances.length;d<b;d++){var k=e.instances[d];if(c){if(k.onBeforeLayoutChange)k.onBeforeLayoutChange()}else if(k.onLayoutChange)k.onLayoutChange();if(k.behavior_insts){var x=0;for(a=k.behavior_insts.length;x<
a;x++){var h=k.behavior_insts[x];if(c){if(h.onBeforeLayoutChange)h.onBeforeLayoutChange()}else if(h.onLayoutChange)h.onLayoutChange()}}}}};f.prototype.pretickMe=function(c){this.objects_to_pretick.add(c)};f.prototype.unpretickMe=function(c){this.objects_to_pretick.remove(c)};f.prototype.tickMe=function(c){this.objects_to_tick.add(c)};f.prototype.untickMe=function(c){this.objects_to_tick.remove(c)};f.prototype.tick2Me=function(c){this.objects_to_tick2.add(c)};f.prototype.untick2Me=function(c){this.objects_to_tick2.remove(c)};
f.prototype.getDt=function(c){return c&&-1!==c.my_timescale?this.dt1*c.my_timescale:this.dt};f.prototype.draw=function(){this.running_layout.draw(this.ctx)};f.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));this.running_layout.drawGL(this.glwrap);this.glwrap.present()};f.prototype.addDestroyCallback=function(c){c&&this.destroycallbacks.push(c)};f.prototype.removeDestroyCallback=function(c){cr.arrayFindRemove(this.destroycallbacks,
c)};f.prototype.getObjectByUID=function(c){c=c.toString();return this.objectsByUid.hasOwnProperty(c)?this.objectsByUid[c]:null};var c=[];f.prototype.DestroyInstance=function(g){var b;var a=g.type.name;if(this.deathRow.hasOwnProperty(a)){var l=this.deathRow[a];if(l.contains(g))return}else l=c.length?c.pop():new cr.ObjectSet,this.deathRow[a]=l;g.isDestroyed=!0;l.add(g);this.hasPendingInstances=!0;if(g.is_contained)for(a=0,b=g.siblings.length;a<b;a++)this.DestroyInstance(g.siblings[a]);this.isInClearDeathRow&&
l.values_cache.push(g);this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(g.type.plugin).cnds.OnDestroyed,g),this.isInOnDestroy--)};f.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var c,g;this.isInClearDeathRow=!0;var b=0;for(c=this.createRow.length;b<c;++b){var a=this.createRow[b];var l=a.type;l.instances.push(a);var e=0;for(g=l.families.length;e<g;++e)l.families[e].instances.push(a),l.families[e].stale_iids=!0}cr.clearArray(this.createRow);this.IterateDeathRow();
cr.wipe(this.deathRow);this.hasPendingInstances=this.isInClearDeathRow=!1}};f.prototype.IterateDeathRow=function(){for(var c in this.deathRow)this.deathRow.hasOwnProperty(c)&&this.ClearDeathRowForType(this.deathRow[c])};f.prototype.ClearDeathRowForType=function(g){var b=g.valuesRef(),a=b[0].type,l,e;cr.arrayRemoveAllFromObjectSet(a.instances,g);a.stale_iids=!0;0===a.instances.length&&(a.any_instance_parallaxed=!1);var d=0;for(l=a.families.length;d<l;++d){var k=a.families[d];cr.arrayRemoveAllFromObjectSet(k.instances,
g);k.stale_iids=!0}d=0;for(l=this.system.waits.length;d<l;++d){var x=this.system.waits[d];x.sols.hasOwnProperty(a.index)&&cr.arrayRemoveAllFromObjectSet(x.sols[a.index].insts,g);if(!a.is_family){var h=0;for(e=a.families.length;h<e;++h)k=a.families[h],x.sols.hasOwnProperty(k.index)&&cr.arrayRemoveAllFromObjectSet(x.sols[k.index].insts,g)}}if(x=b[0].layer){if(x.useRenderCells)for(h=x.instances,d=0,l=h.length;d<l;++d)e=h[d],g.contains(e)&&(e.update_bbox(),x.render_grid.update(e,e.rendercells,null),e.rendercells.set(0,
0,-1,-1));cr.arrayRemoveAllFromObjectSet(x.instances,g);x.setZIndicesStaleFrom(0)}for(d=0;d<b.length;++d)this.ClearDeathRowForSingleInstance(b[d],a);g.clear();c.push(g);this.redraw=!0};f.prototype.ClearDeathRowForSingleInstance=function(c,g){var b;var a=0;for(b=this.destroycallbacks.length;a<b;++a)this.destroycallbacks[a](c);c.collcells&&g.collision_grid.update(c,c.collcells,null);(a=c.layer)&&a.removeFromInstanceList(c,!0);if(c.behavior_insts)for(a=0,b=c.behavior_insts.length;a<b;++a){var l=c.behavior_insts[a];
if(l.onDestroy)l.onDestroy();l.behavior.my_instances.remove(c)}this.objects_to_pretick.remove(c);this.objects_to_tick.remove(c);this.objects_to_tick2.remove(c);if(c.onDestroy)c.onDestroy();this.objectsByUid.hasOwnProperty(c.uid.toString())&&delete this.objectsByUid[c.uid.toString()];this.objectcount--;100>g.deadCache.length&&g.deadCache.push(c)};f.prototype.createInstance=function(c,g,a,b){if(c.is_family){var l=cr.floor(Math.random()*c.members.length);return this.createInstance(c.members[l],g,a,b)}return c.default_instance?
this.createInstanceFromInit(c.default_instance,g,!1,a,b,!1):null};var g=[];f.prototype.createInstanceFromInit=function(c,a,b,l,e,d){var k,x;if(!c)return null;var h=this.types_by_index[c[1]],t=h.plugin.is_world;if(this.isloading&&t&&!h.isOnLoaderLayout||t&&!this.glwrap&&11===c[0][11])return null;var B=a;t||(a=null);if(h.deadCache.length){var r=h.deadCache.pop();r.recycled=!0;h.plugin.Instance.call(r,h)}else r=new h.plugin.Instance(h),r.recycled=!1;!b||d||this.objectsByUid.hasOwnProperty(c[2].toString())?
r.uid=this.next_uid++:r.uid=c[2];this.objectsByUid[r.uid.toString()]=r;r.puid=this.next_puid++;r.iid=h.instances.length;var v=0;for(k=this.createRow.length;v<k;++v)this.createRow[v].type===h&&r.iid++;r.get_iid=cr.inst_get_iid;r.toString=cr.inst_toString;r.isDestroyed=!1;var m=c[3];if(r.recycled)cr.wipe(r.extra);else{r.extra={};if(this.isPreview)for(r.instance_var_names=[],r.instance_var_names.length=m.length,v=0,k=m.length;v<k;v++)r.instance_var_names[v]=m[v][1];r.instance_vars=[];r.instance_vars.length=
m.length}v=0;for(k=m.length;v<k;v++)r.instance_vars[v]=m[v][0];if(t){var f=c[0];r.x=cr.is_undefined(l)?f[0]:l;r.y=cr.is_undefined(e)?f[1]:e;r.z=f[2];r.width=f[3];r.height=f[4];r.depth=f[5];r.angle=f[6];r.opacity=f[7];r.hotspotX=f[8];r.hotspotY=f[9];r.blend_mode=f[10];v=f[11];!this.glwrap&&h.effect_types.length&&(r.blend_mode=v);r.compositeOp=cr.effectToCompositeOp(r.blend_mode);this.gl&&cr.setGLBlend(r,r.blend_mode,this.gl);if(r.recycled){v=0;for(k=f[12].length;v<k;v++)for(m=0,x=f[12][v].length;m<
x;m++)r.effect_params[v][m]=f[12][v][m],Array.isArray(r.effect_params[v][m])&&(r.effect_params[v][m]=r.effect_params[v][m].slice(0));r.bbox.set(0,0,0,0);r.collcells.set(0,0,-1,-1);r.rendercells.set(0,0,-1,-1);r.bquad.set_from_rect(r.bbox);cr.clearArray(r.bbox_changed_callbacks)}else{r.effect_params=f[12].slice(0);v=0;for(k=r.effect_params.length;v<k;v++)for(r.effect_params[v]=f[12][v].slice(0),m=0,x=r.effect_params[v].length;m<x;++m)Array.isArray(r.effect_params[v][m])&&(r.effect_params[v][m]=r.effect_params[v][m].slice(0));
r.active_effect_types=[];r.active_effect_flags=[];r.active_effect_flags.length=h.effect_types.length;r.bbox=new cr.rect(0,0,0,0);r.collcells=new cr.rect(0,0,-1,-1);r.rendercells=new cr.rect(0,0,-1,-1);r.bquad=new cr.quad;r.bbox_changed_callbacks=[];r.set_bbox_changed=cr.set_bbox_changed;r.add_bbox_changed_callback=cr.add_bbox_changed_callback;r.contains_pt=cr.inst_contains_pt;r.update_bbox=cr.update_bbox;r.update_render_cell=cr.update_render_cell;r.update_collision_cell=cr.update_collision_cell;r.get_zindex=
cr.inst_get_zindex}r.tilemap_exists=!1;r.tilemap_width=0;r.tilemap_height=0;r.tilemap_data=null;14===f.length&&(r.tilemap_exists=!0,r.tilemap_width=f[13][0],r.tilemap_height=f[13][1],r.tilemap_data=f[13][2]);v=0;for(k=h.effect_types.length;v<k;v++)r.active_effect_flags[v]=!0;r.shaders_preserve_opaqueness=!0;r.updateActiveEffects=cr.inst_updateActiveEffects;r.updateActiveEffects();r.uses_shaders=!!r.active_effect_types.length;r.bbox_changed=!0;r.cell_changed=!0;h.any_cell_changed=!0;r.visible=!0;r.my_timescale=
-1;r.layer=a;r.zindex=a.instances.length;r.earlyz_index=0;"undefined"===typeof r.collision_poly&&(r.collision_poly=null);this.redraw=r.collisionsEnabled=!0}cr.clearArray(g);v=0;for(k=h.families.length;v<k;v++)g.push.apply(g,h.families[v].behaviors);g.push.apply(g,h.behaviors);if(r.recycled)for(v=0,k=g.length;v<k;v++){var z=g[v];var y=r.behavior_insts[v];y.recycled=!0;z.behavior.Instance.call(y,z,r);f=c[4][v];m=0;for(x=f.length;m<x;m++)y.properties[m]=f[m];y.onCreate();z.behavior.my_instances.add(r)}else for(r.behavior_insts=
[],v=0,k=g.length;v<k;v++)z=g[v],y=new z.behavior.Instance(z,r),y.recycled=!1,y.properties=c[4][v].slice(0),y.onCreate(),cr.seal(y),r.behavior_insts.push(y),z.behavior.my_instances.add(r);f=c[5];if(r.recycled)for(v=0,k=f.length;v<k;v++)r.properties[v]=f[v];else r.properties=f.slice(0);this.createRow.push(r);this.hasPendingInstances=!0;a&&(a.appendToInstanceList(r,!0),1!==a.parallaxX||1!==a.parallaxY)&&(h.any_instance_parallaxed=!0);this.objectcount++;if(h.is_contained){if(r.is_contained=!0,r.recycled?
cr.clearArray(r.siblings):r.siblings=[],!b&&!d){v=0;for(k=h.container.length;v<k;v++)if(h.container[v]!==h){if(!h.container[v].default_instance)return null;r.siblings.push(this.createInstanceFromInit(h.container[v].default_instance,B,!1,t?r.x:l,t?r.y:e,!0))}v=0;for(k=r.siblings.length;v<k;v++)for(r.siblings[v].siblings.push(r),m=0;m<k;m++)v!==m&&r.siblings[v].siblings.push(r.siblings[m])}}else r.is_contained=!1,r.siblings=null;r.onCreate();r.recycled||cr.seal(r);v=0;for(k=r.behavior_insts.length;v<
k;v++)r.behavior_insts[v].postCreate&&r.behavior_insts[v].postCreate();return r};f.prototype.getLayerByName=function(c){var g;var a=0;for(g=this.running_layout.layers.length;a<g;a++){var b=this.running_layout.layers[a];if(cr.equals_nocase(b.name,c))return b}return null};f.prototype.getLayerByNumber=function(c){c=cr.floor(c);0>c&&(c=0);c>=this.running_layout.layers.length&&(c=this.running_layout.layers.length-1);return this.running_layout.layers[c]};f.prototype.getLayer=function(c){return cr.is_number(c)?
this.getLayerByNumber(c):this.getLayerByName(c.toString())};f.prototype.clearSol=function(c){var g;var a=0;for(g=c.length;a<g;a++)c[a].getCurrentSol().select_all=!0};f.prototype.pushCleanSol=function(c){var g;var a=0;for(g=c.length;a<g;a++)c[a].pushCleanSol()};f.prototype.pushCopySol=function(c){var g;var a=0;for(g=c.length;a<g;a++)c[a].pushCopySol()};f.prototype.popSol=function(c){var g;var a=0;for(g=c.length;a<g;a++)c[a].popSol()};f.prototype.updateAllCells=function(c){if(c.any_cell_changed){var g,
a=c.instances;var b=0;for(g=a.length;b<g;++b)a[b].update_collision_cell();a=this.createRow;b=0;for(g=a.length;b<g;++b)a[b].type===c&&a[b].update_collision_cell();c.any_cell_changed=!1}};f.prototype.getCollisionCandidates=function(c,g,a,b){var l,e=c?1!==c.parallaxX||1!==c.parallaxY:!1;if(g.is_family)for(c=0,l=g.members.length;c<l;++c){var d=g.members[c];e||d.any_instance_parallaxed?cr.appendArray(b,d.instances):(this.updateAllCells(d),d.collision_grid.queryRange(a,b))}else e||g.any_instance_parallaxed?
cr.appendArray(b,g.instances):(this.updateAllCells(g),g.collision_grid.queryRange(a,b))};f.prototype.getTypesCollisionCandidates=function(c,g,a,b){var l;var e=0;for(l=g.length;e<l;++e)this.getCollisionCandidates(c,g[e],a,b)};f.prototype.getSolidCollisionCandidates=function(c,g,a){var b=this.getSolidBehavior();if(!b)return null;this.getTypesCollisionCandidates(c,b.my_types,g,a)};f.prototype.getJumpthruCollisionCandidates=function(c,g,a){var b=this.getJumpthruBehavior();if(!b)return null;this.getTypesCollisionCandidates(c,
b.my_types,g,a)};f.prototype.testAndSelectCanvasPointOverlap=function(c,g,a,b){var l=c.getCurrentSol(),e,d=this.getCurrentEventStack().current_event.orblock;if(l.select_all){b||(l.select_all=!1,cr.clearArray(l.instances));var k=0;for(e=c.instances.length;k<e;k++){var h=c.instances[k];h.update_bbox();var x=h.layer.canvasToLayer(g,a,!0);var r=h.layer.canvasToLayer(g,a,!1);if(h.contains_pt(x,r)){if(b)return!1;l.instances.push(h)}else d&&l.else_instances.push(h)}}else{var t=0;var v=d?l.else_instances:
l.instances;k=0;for(e=v.length;k<e;k++)if(h=v[k],h.update_bbox(),x=h.layer.canvasToLayer(g,a,!0),r=h.layer.canvasToLayer(g,a,!1),h.contains_pt(x,r)){if(b)return!1;d?l.instances.push(h):(l.instances[t]=l.instances[k],t++)}b||(v.length=t)}c.applySolToContainer();return b?!0:l.hasObjects()};f.prototype.testOverlap=function(c,g){if(!(c&&g&&c!==g&&c.collisionsEnabled&&g.collisionsEnabled))return!1;c.update_bbox();g.update_bbox();var a=c.layer,b=g.layer,l;if(a===b||a.parallaxX===b.parallaxX&&b.parallaxY===
b.parallaxY&&a.scale===b.scale&&a.angle===b.angle&&a.zoomRate===b.zoomRate){if(!c.bbox.intersects_rect(g.bbox)||!c.bquad.intersects_quad(g.bquad)||c.tilemap_exists&&g.tilemap_exists)return!1;if(c.tilemap_exists)return this.testTilemapOverlap(c,g);if(g.tilemap_exists)return this.testTilemapOverlap(g,c);var e=c.collision_poly&&!c.collision_poly.is_empty();var d=g.collision_poly&&!g.collision_poly.is_empty();if(!e&&!d)return!0;e?(c.collision_poly.cache_poly(c.width,c.height,c.angle),e=c.collision_poly):
(this.temp_poly.set_from_quad(c.bquad,c.x,c.y,c.width,c.height),e=this.temp_poly);if(d){g.collision_poly.cache_poly(g.width,g.height,g.angle);var k=g.collision_poly}else this.temp_poly.set_from_quad(g.bquad,g.x,g.y,g.width,g.height),k=this.temp_poly;return e.intersects_poly(k,g.x-c.x,g.y-c.y)}e=c.collision_poly&&!c.collision_poly.is_empty();d=g.collision_poly&&!g.collision_poly.is_empty();e?(c.collision_poly.cache_poly(c.width,c.height,c.angle),this.temp_poly.set_from_poly(c.collision_poly)):this.temp_poly.set_from_quad(c.bquad,
c.x,c.y,c.width,c.height);e=this.temp_poly;d?(g.collision_poly.cache_poly(g.width,g.height,g.angle),this.temp_poly2.set_from_poly(g.collision_poly)):this.temp_poly2.set_from_quad(g.bquad,g.x,g.y,g.width,g.height);k=this.temp_poly2;d=0;for(l=e.pts_count;d<l;d++){var h=2*d;var r=h+1;var x=e.pts_cache[h];var t=e.pts_cache[r];e.pts_cache[h]=a.layerToCanvas(x+c.x,t+c.y,!0);e.pts_cache[r]=a.layerToCanvas(x+c.x,t+c.y,!1)}e.update_bbox();d=0;for(l=k.pts_count;d<l;d++)h=2*d,r=h+1,x=k.pts_cache[h],t=k.pts_cache[r],
k.pts_cache[h]=b.layerToCanvas(x+g.x,t+g.y,!0),k.pts_cache[r]=b.layerToCanvas(x+g.x,t+g.y,!1);k.update_bbox();return e.intersects_poly(k,0,0)};var r=new cr.quad,v=new cr.rect(0,0,0,0),K=[];f.prototype.testTilemapOverlap=function(c,g){var a,b=g.bbox,l=c.x,e=c.y;c.getCollisionRectCandidates(b,K);var d=g.collision_poly&&!g.collision_poly.is_empty();c=0;for(a=K.length;c<a;++c){var k=K[c];var h=k.rc;if(b.intersects_rect_off(h,l,e)&&(r.set_from_rect(h),r.offset(l,e),r.intersects_quad(g.bquad)))if(d)if(g.collision_poly.cache_poly(g.width,
g.height,g.angle),k.poly){if(k.poly.intersects_poly(g.collision_poly,g.x-(l+h.left),g.y-(e+h.top)))return cr.clearArray(K),!0}else{if(this.temp_poly.set_from_quad(r,0,0,h.right-h.left,h.bottom-h.top),this.temp_poly.intersects_poly(g.collision_poly,g.x,g.y))return cr.clearArray(K),!0}else if(k.poly){if(this.temp_poly.set_from_quad(g.bquad,0,0,g.width,g.height),k.poly.intersects_poly(this.temp_poly,-(l+h.left),-(e+h.top)))return cr.clearArray(K),!0}else return cr.clearArray(K),!0}cr.clearArray(K);return!1};
f.prototype.testRectOverlap=function(c,g){if(!g||!g.collisionsEnabled)return!1;g.update_bbox();if(!g.bbox.intersects_rect(c))return!1;if(g.tilemap_exists){g.getCollisionRectCandidates(c,K);var a,b=g.x,l=g.y;g=0;for(a=K.length;g<a;++g){var e=K[g];var d=e.rc;if(c.intersects_rect_off(d,b,l))if(e.poly){if(this.temp_poly.set_from_rect(c,0,0),e.poly.intersects_poly(this.temp_poly,-(b+d.left),-(l+d.top)))return cr.clearArray(K),!0}else return cr.clearArray(K),!0}cr.clearArray(K);return!1}r.set_from_rect(c);
if(!g.bquad.intersects_quad(r))return!1;if(!g.collision_poly||g.collision_poly.is_empty())return!0;g.collision_poly.cache_poly(g.width,g.height,g.angle);r.offset(-c.left,-c.top);this.temp_poly.set_from_quad(r,0,0,1,1);return g.collision_poly.intersects_poly(this.temp_poly,c.left-g.x,c.top-g.y)};f.prototype.testSegmentOverlap=function(c,g,a,b,l){if(!l||!l.collisionsEnabled)return!1;l.update_bbox();v.set(cr.min(c,a),cr.min(g,b),cr.max(c,a),cr.max(g,b));if(!l.bbox.intersects_rect(v))return!1;if(l.tilemap_exists){l.getCollisionRectCandidates(v,
K);var e,d=l.x,k=l.y;l=0;for(e=K.length;l<e;++l){var h=K[l];var t=h.rc;if(v.intersects_rect_off(t,d,k)&&(r.set_from_rect(t),r.offset(d,k),r.intersects_segment(c,g,a,b)))if(h.poly){if(h.poly.intersects_segment(d+t.left,k+t.top,c,g,a,b))return cr.clearArray(K),!0}else return cr.clearArray(K),!0}cr.clearArray(K);return!1}if(!l.bquad.intersects_segment(c,g,a,b))return!1;if(!l.collision_poly||l.collision_poly.is_empty())return!0;l.collision_poly.cache_poly(l.width,l.height,l.angle);return l.collision_poly.intersects_segment(l.x,
l.y,c,g,a,b)};f.prototype.typeHasBehavior=function(c,g){if(!g)return!1;var a,b;var l=0;for(a=c.behaviors.length;l<a;l++)if(c.behaviors[l].behavior instanceof g)return!0;if(!c.is_family)for(l=0,a=c.families.length;l<a;l++){var e=c.families[l];var d=0;for(b=e.behaviors.length;d<b;d++)if(e.behaviors[d].behavior instanceof g)return!0}return!1};f.prototype.typeHasNoSaveBehavior=function(c){return this.typeHasBehavior(c,cr.behaviors.NoSave)};f.prototype.typeHasPersistBehavior=function(c){return this.typeHasBehavior(c,
cr.behaviors.Persist)};f.prototype.getSolidBehavior=function(){return this.solidBehavior};f.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var O=[];f.prototype.testOverlapSolid=function(c){var g;c.update_bbox();this.getSolidCollisionCandidates(c.layer,c.bbox,O);var a=0;for(g=O.length;a<g;++a){var b=O[a];if(b.extra.solidEnabled&&this.testOverlap(c,b))return cr.clearArray(O),b}cr.clearArray(O);return null};f.prototype.testRectOverlapSolid=function(c){var g;this.getSolidCollisionCandidates(null,
c,O);var a=0;for(g=O.length;a<g;++a){var b=O[a];if(b.extra.solidEnabled&&this.testRectOverlap(c,b))return cr.clearArray(O),b}cr.clearArray(O);return null};var Z=[];f.prototype.testOverlapJumpThru=function(c,g){var a=null;g&&(a=Z,cr.clearArray(a));c.update_bbox();this.getJumpthruCollisionCandidates(c.layer,c.bbox,O);var b;var l=0;for(b=O.length;l<b;++l){var e=O[l];if(e.extra.jumpthruEnabled&&this.testOverlap(c,e))if(g)a.push(e);else return cr.clearArray(O),e}cr.clearArray(O);return a};f.prototype.pushOutSolid=
function(c,g,a,b,l,e){b=b||50;var d=c.x,k=c.y,h,r=null,t=null;for(h=0;h<b;h++)if(c.x=d+g*h,c.y=k+a*h,c.set_bbox_changed(),!this.testOverlap(c,r)&&((r=this.testOverlapSolid(c))&&(t=r),!r&&(l&&(r=e?this.testOverlap(c,e)?e:null:this.testOverlapJumpThru(c))&&(t=r),!r)))return t&&this.pushInFractional(c,g,a,t,16),!0;c.x=d;c.y=k;c.set_bbox_changed();return!1};f.prototype.pushOutSolidAxis=function(c,g,a,b){b=b||50;var l=c.x,e=c.y,d=null,k=null,h,r;for(h=0;h<b;++h)for(r=0;2>r;++r){var t=2*r-1;c.x=l+g*h*t;
c.y=e+a*h*t;c.set_bbox_changed();if(!this.testOverlap(c,d))if(d=this.testOverlapSolid(c))k=d;else return k&&this.pushInFractional(c,g*t,a*t,k,16),!0}c.x=l;c.y=e;c.set_bbox_changed();return!1};f.prototype.pushOut=function(c,g,a,b,l){b=b||50;var e=c.x,d=c.y,k;for(k=0;k<b;k++)if(c.x=e+g*k,c.y=d+a*k,c.set_bbox_changed(),!this.testOverlap(c,l))return!0;c.x=e;c.y=d;c.set_bbox_changed();return!1};f.prototype.pushInFractional=function(c,g,a,b,l){var e=2,d=!1;var k=!1;for(var h=c.x,r=c.y;e<=l;)k=1/e,e*=2,
c.x+=g*k*(d?1:-1),c.y+=a*k*(d?1:-1),c.set_bbox_changed(),this.testOverlap(c,b)?k=d=!0:(k=d=!1,h=c.x,r=c.y);k&&(c.x=h,c.y=r,c.set_bbox_changed())};f.prototype.pushOutSolidNearest=function(c,g){g=cr.is_undefined(g)?100:g;var a=0,b=c.x,l=c.y,e=0,d=0,k=0,h=this.testOverlapSolid(c);if(!h)return!0;for(;a<=g;){switch(e){case 0:d=0;k=-1;a++;break;case 1:d=1;k=-1;break;case 2:d=1;k=0;break;case 3:k=d=1;break;case 4:d=0;k=1;break;case 5:d=-1;k=1;break;case 6:d=-1;k=0;break;case 7:k=d=-1}e=(e+1)%8;c.x=cr.floor(b+
d*a);c.y=cr.floor(l+k*a);c.set_bbox_changed();if(!this.testOverlap(c,h)&&(h=this.testOverlapSolid(c),!h))return!0}c.x=b;c.y=l;c.set_bbox_changed();return!1};f.prototype.registerCollision=function(c,g){c.collisionsEnabled&&g.collisionsEnabled&&this.registered_collisions.push([c,g])};f.prototype.addRegisteredCollisionCandidates=function(c,g,a){var b;var l=0;for(b=this.registered_collisions.length;l<b;++l){var e=this.registered_collisions[l];if(e[0]===c)e=e[1];else if(e[1]===c)e=e[0];else continue;if(g.is_family){if(-1===
g.members.indexOf(g))continue}else if(e.type!==g)continue;-1===a.indexOf(e)&&a.push(e)}};f.prototype.checkRegisteredCollision=function(c,g){var a;var b=0;for(a=this.registered_collisions.length;b<a;b++){var l=this.registered_collisions[b];if(l[0]===c&&l[1]===g||l[0]===g&&l[1]===c)return!0}return!1};f.prototype.calculateSolidBounceAngle=function(c,g,a,b){var l=c.x,e=c.y,d=cr.max(10,cr.distanceTo(g,a,l,e)),k=cr.angleTo(g,a,l,e),h=b||this.testOverlapSolid(c);if(!h)return cr.clamp_angle(k+cr.PI);var r=
h,t,v=cr.to_radians(5);for(t=1;36>t;t++){var B=k-t*v;c.x=g+Math.cos(B)*d;c.y=a+Math.sin(B)*d;c.set_bbox_changed();if(!this.testOverlap(c,r)&&(r=b?null:this.testOverlapSolid(c),!r)){var x=B;break}}36===t&&(x=cr.clamp_angle(k+cr.PI));r=h;for(t=1;36>t;t++)if(B=k+t*v,c.x=g+Math.cos(B)*d,c.y=a+Math.sin(B)*d,c.set_bbox_changed(),!this.testOverlap(c,r)&&(r=b?null:this.testOverlapSolid(c),!r)){var m=B;break}36===t&&(m=cr.clamp_angle(k+cr.PI));c.x=l;c.y=e;c.set_bbox_changed();if(m===x)return m;c=cr.angleDiff(m,
x)/2;c=cr.angleClockwise(m,x)?cr.clamp_angle(x+c+cr.PI):cr.clamp_angle(m+c);x=Math.cos(k);k=Math.sin(k);m=Math.cos(c);c=Math.sin(c);g=x*m+k*c;return cr.angleTo(0,0,x-2*g*m,k-2*g*c)};var I=-1;f.prototype.trigger=function(c,g,a){if(!this.running_layout)return!1;var b=this.running_layout.event_sheet;if(!b)return!1;var l=!1,e;I++;var d=b.deep_includes;var k=0;for(e=d.length;k<e;++k){var h=this.triggerOnSheet(c,g,d[k],a);l=l||h}h=this.triggerOnSheet(c,g,b,a);I--;return l||h};f.prototype.triggerOnSheet=
function(c,g,a,b){var l=!1,e;if(g){var d=this.triggerOnSheetForTypeName(c,g,g.type.name,a,b);l=l||d;var k=g.type.families;var h=0;for(e=k.length;h<e;++h)d=this.triggerOnSheetForTypeName(c,g,k[h].name,a,b),l=l||d}else d=this.triggerOnSheetForTypeName(c,g,"system",a,b),l=l||d;return l};f.prototype.triggerOnSheetForTypeName=function(c,g,a,b,l){var e,d=!1;var k="undefined"!==typeof l;var h=(k?b.fasttriggers:b.triggers)[a];if(!h)return d;var r=null;b=0;for(e=h.length;b<e;++b)if(h[b].method==c){r=h[b].evs;
break}if(!r)return d;c=k?r[l]:r;if(!c)return null;b=0;for(e=c.length;b<e;b++)l=c[b][0],k=c[b][1],l=this.executeSingleTrigger(g,a,l,k),d=d||l;return d};f.prototype.executeSingleTrigger=function(c,g,a,b){var l,e=!1;this.trigger_depth++;var d=this.getCurrentEventStack().current_event;d&&this.pushCleanSol(d.solModifiersIncludingParents);var k=1<this.trigger_depth;this.pushCleanSol(a.solModifiersIncludingParents);k&&this.pushLocalVarStack();var h=this.pushEventStack(a);h.current_event=a;if(c){var r=this.types[g].getCurrentSol();
r.select_all=!1;cr.clearArray(r.instances);r.instances[0]=c;this.types[g].applySolToContainer()}c=!0;if(a.parent){g=h.temp_parents_arr;for(r=a.parent;r;)g.push(r),r=r.parent;g.reverse();r=0;for(l=g.length;r<l;r++)if(!g[r].run_pretrigger()){c=!1;break}}c&&(this.execcount++,a.orblock?a.run_orblocktrigger(b):a.run(),e=e||h.last_event_true);this.popEventStack();k&&this.popLocalVarStack();this.popSol(a.solModifiersIncludingParents);d&&this.popSol(d.solModifiersIncludingParents);this.hasPendingInstances&&
0===this.isInOnDestroy&&0===I&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return e};f.prototype.getCurrentCondition=function(){var c=this.getCurrentEventStack();return c.current_event.conditions[c.cndindex]};f.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};f.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};f.prototype.getCurrentAction=function(){var c=this.getCurrentEventStack();return c.current_event.actions[c.actindex]};
f.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};f.prototype.popLocalVarStack=function(){this.localvar_stack_index--};f.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};f.prototype.pushEventStack=function(c){this.event_stack_index++;this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var g=this.getCurrentEventStack();
g.reset(c);return g};f.prototype.popEventStack=function(){this.event_stack_index--};f.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};f.prototype.pushLoopStack=function(c){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:c,index:0,stopped:!1}));var g=this.getCurrentLoop();g.name=c;g.index=0;g.stopped=!1;return g};f.prototype.popLoopStack=function(){this.loop_stack_index--};f.prototype.getCurrentLoop=
function(){return this.loop_stack[this.loop_stack_index]};f.prototype.getEventVariableByName=function(c,g){for(var a,b,l,e,d;g;){a=0;for(b=g.subevents.length;a<b;a++)if(d=g.subevents[a],d instanceof cr.eventvariable&&cr.equals_nocase(c,d.name))return d;g=g.parent}a=0;for(b=this.eventsheets_by_index.length;a<b;a++)for(e=this.eventsheets_by_index[a],g=0,l=e.events.length;g<l;g++)if(d=e.events[g],d instanceof cr.eventvariable&&cr.equals_nocase(c,d.name))return d;return null};f.prototype.getLayoutBySid=
function(c){var g;var a=0;for(g=this.layouts_by_index.length;a<g;a++)if(this.layouts_by_index[a].sid===c)return this.layouts_by_index[a];return null};f.prototype.getObjectTypeBySid=function(c){var g;var a=0;for(g=this.types_by_index.length;a<g;a++)if(this.types_by_index[a].sid===c)return this.types_by_index[a];return null};f.prototype.getGroupBySid=function(c){var g;var a=0;for(g=this.allGroups.length;a<g;a++)if(this.allGroups[a].sid===c)return this.allGroups[a];return null};f.prototype.doCanvasSnapshot=
function(c,g){this.snapshotCanvas=[c,g];this.redraw=!0};f.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};f.prototype.handleSaveLoad=function(){var c=this,g=this.saveToSlot,a=this.lastSaveJson,b=this.loadFromSlot,l=!1;this.signalledContinuousPreview&&(l=!0,g="__c2_continuouspreview",this.signalledContinuousPreview=!1);if(g.length){this.ClearDeathRow();a=this.saveToJSONString();if(p())n(g,a,function(){cr.logexport("Saved state to IndexedDB storage ("+a.length+" bytes)");
c.lastSaveJson=a;c.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null);c.lastSaveJson="";l&&m()},function(b){try{localStorage.setItem("__c2save_"+g,a),cr.logexport("Saved state to WebStorage ("+a.length+" bytes)"),c.lastSaveJson=a,c.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),c.lastSaveJson="",l&&m()}catch(L){cr.logexport("Failed to save game state: "+b+"; "+L),c.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+g,a),
cr.logexport("Saved state to WebStorage ("+a.length+" bytes)"),c.lastSaveJson=a,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),c.lastSaveJson="",l&&m()}catch(P){cr.logexport("Error saving to WebStorage: "+P),c.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(b.length){if(p())u(b,function(g){g?(c.loadFromJson=g,cr.logexport("Loaded state from IndexedDB storage ("+c.loadFromJson.length+" bytes)")):(c.loadFromJson=
localStorage.getItem("__c2save_"+b)||"",cr.logexport("Loaded state from WebStorage ("+c.loadFromJson.length+" bytes)"));c.suspendDrawing=!1;c.loadFromJson||(c.loadFromJson=null,c.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))},function(g){c.loadFromJson=localStorage.getItem("__c2save_"+b)||"";cr.logexport("Loaded state from WebStorage ("+c.loadFromJson.length+" bytes)");c.suspendDrawing=!1;c.loadFromJson||(c.loadFromJson=null,c.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});
else{try{this.loadFromJson=localStorage.getItem("__c2save_"+b)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(P){this.loadFromJson=null}this.suspendDrawing=!1;c.loadFromJson||(c.loadFromJson=null,c.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,
null),this.lastSaveJson=""):c.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)};f.prototype.saveToJSONString=function(){var c,g,a,b={c2save:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var l=0;for(c=
this.types_by_index.length;l<c;l++){var e=this.types_by_index[l];if(!e.is_family&&!this.typeHasNoSaveBehavior(e)){var k={instances:[]};cr.hasAnyOwnProperty(e.extra)&&(k.ex=d(e.extra));var h=0;for(g=e.instances.length;h<g;h++)k.instances.push(this.saveInstanceToJSON(e.instances[h]));b.types[e.sid.toString()]=k}}l=0;for(c=this.layouts_by_index.length;l<c;l++)h=this.layouts_by_index[l],b.layouts[h.sid.toString()]=h.saveToJSON();g=b.events.groups;l=0;for(c=this.allGroups.length;l<c;l++)h=this.allGroups[l],
g[h.sid.toString()]=this.groups_by_name[h.group_name].group_active;c=b.events.cnds;for(a in this.cndsBySid)this.cndsBySid.hasOwnProperty(a)&&(l=this.cndsBySid[a],cr.hasAnyOwnProperty(l.extra)&&(c[a]={ex:d(l.extra)}));c=b.events.acts;for(a in this.actsBySid)this.actsBySid.hasOwnProperty(a)&&(l=this.actsBySid[a],cr.hasAnyOwnProperty(l.extra)&&(c[a]={ex:d(l.extra)}));c=b.events.vars;for(a in this.varsBySid)this.varsBySid.hasOwnProperty(a)&&(l=this.varsBySid[a],l.is_constant||l.parent&&!l.is_static||
(c[a]=l.data));b.system=this.system.saveToJSON();return JSON.stringify(b)};f.prototype.refreshUidMap=function(){var c,g;this.objectsByUid={};var a=0;for(c=this.types_by_index.length;a<c;a++){var b=this.types_by_index[a];if(!b.is_family){var l=0;for(g=b.instances.length;l<g;l++){var e=b.instances[l];this.objectsByUid[e.uid.toString()]=e}}}};f.prototype.loadFromJSONString=function(c){try{var g=JSON.parse(c)}catch(Q){return!1}if(!g.c2save||1<g.version)return!1;this.isLoadingState=!0;c=g.rt;this.kahanTime.reset();
this.kahanTime.sum=c.time;this.wallTime.reset();this.wallTime.sum=c.walltime||0;this.timescale=c.timescale;this.tickcount=c.tickcount;this.execcount=c.execcount;this.start_time=Date.now()-c.start_time_offset;var a=c.running_layout;if(a!==this.running_layout.sid)if(a=this.getLayoutBySid(a))this.doChangeLayout(a);else return;var b,l,e;var d=g.types;for(l in d)if(d.hasOwnProperty(l)&&(e=this.getObjectTypeBySid(parseInt(l,10)))&&!e.is_family&&!this.typeHasNoSaveBehavior(e)){d[l].ex?e.extra=d[l].ex:cr.wipe(e.extra);
var k=e.instances;var h=d[l].instances;a=0;for(b=cr.min(k.length,h.length);a<b;a++)this.loadInstanceFromJSON(k[a],h[a]);a=h.length;for(b=k.length;a<b;a++)this.DestroyInstance(k[a]);a=k.length;for(b=h.length;a<b;a++){k=null;if(e.plugin.is_world&&(k=this.running_layout.getLayerBySid(h[a].w.l),!k))continue;k=this.createInstanceFromInit(e.default_instance,k,!1,0,0,!0);this.loadInstanceFromJSON(k,h[a])}e.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();b=g.layouts;for(l in b)b.hasOwnProperty(l)&&
(a=this.getLayoutBySid(parseInt(l,10)))&&a.loadFromJSON(b[l]);b=g.events.groups;for(l in b)b.hasOwnProperty(l)&&(a=this.getGroupBySid(parseInt(l,10)))&&this.groups_by_name[a.group_name]&&this.groups_by_name[a.group_name].setGroupActive(b[l]);a=g.events.cnds;for(l in this.cndsBySid)this.cndsBySid.hasOwnProperty(l)&&(a.hasOwnProperty(l)?this.cndsBySid[l].extra=a[l].ex:this.cndsBySid[l].extra={});a=g.events.acts;for(l in this.actsBySid)this.actsBySid.hasOwnProperty(l)&&(a.hasOwnProperty(l)?this.actsBySid[l].extra=
a[l].ex:this.actsBySid[l].extra={});a=g.events.vars;for(l in a)a.hasOwnProperty(l)&&this.varsBySid.hasOwnProperty(l)&&(this.varsBySid[l].data=a[l]);this.next_uid=c.next_uid;this.isLoadingState=!1;a=0;for(b=this.fireOnCreateAfterLoad.length;a<b;++a)k=this.fireOnCreateAfterLoad[a],this.trigger(Object.getPrototypeOf(k.type.plugin).cnds.OnCreated,k);cr.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(g.system);a=0;for(b=this.types_by_index.length;a<b;a++)if(e=this.types_by_index[a],!e.is_family&&
!this.typeHasNoSaveBehavior(e))for(g=0,l=e.instances.length;g<l;g++){k=e.instances[g];if(e.is_contained)for(d=k.get_iid(),cr.clearArray(k.siblings),c=0,h=e.container.length;c<h;c++){var r=e.container[c];e!==r&&k.siblings.push(r.instances[d])}k.afterLoad&&k.afterLoad();if(k.behavior_insts)for(c=0,h=k.behavior_insts.length;c<h;c++)d=k.behavior_insts[c],d.afterLoad&&d.afterLoad()}return this.redraw=!0};f.prototype.saveInstanceToJSON=function(c,g){var a;var b=c.type;var l=b.plugin;var e={};g?e.c2=!0:
e.uid=c.uid;cr.hasAnyOwnProperty(c.extra)&&(e.ex=d(c.extra));if(c.instance_vars&&c.instance_vars.length)for(e.ivs={},g=0,a=c.instance_vars.length;g<a;g++)e.ivs[c.type.instvar_sids[g].toString()]=c.instance_vars[g];if(l.is_world){l={x:c.x,y:c.y,w:c.width,h:c.height,l:c.layer.sid,zi:c.get_zindex()};0!==c.angle&&(l.a=c.angle);1!==c.opacity&&(l.o=c.opacity);.5!==c.hotspotX&&(l.hX=c.hotspotX);.5!==c.hotspotY&&(l.hY=c.hotspotY);0!==c.blend_mode&&(l.bm=c.blend_mode);c.visible||(l.v=c.visible);c.collisionsEnabled||
(l.ce=c.collisionsEnabled);-1!==c.my_timescale&&(l.mts=c.my_timescale);if(b.effect_types.length)for(l.fx=[],g=0,a=b.effect_types.length;g<a;g++){var k=b.effect_types[g];l.fx.push({name:k.name,active:c.active_effect_flags[k.index],params:c.effect_params[k.index]})}e.w=l}if(c.behavior_insts&&c.behavior_insts.length)for(e.behs={},g=0,a=c.behavior_insts.length;g<a;g++)b=c.behavior_insts[g],b.saveToJSON&&(e.behs[b.type.sid.toString()]=b.saveToJSON());c.saveToJSON&&(e.data=c.saveToJSON());return e};f.prototype.getInstanceVarIndexBySid=
function(c,g){var a;var b=0;for(a=c.instvar_sids.length;b<a;b++)if(c.instvar_sids[b]===g)return b;return-1};f.prototype.getBehaviorIndexBySid=function(c,g){var a;var b=0;for(a=c.behavior_insts.length;b<a;b++)if(c.behavior_insts[b].type.sid===g)return b;return-1};f.prototype.loadInstanceFromJSON=function(c,g,a){var b,l;var e=c.type;var d=e.plugin;if(a){if(!g.c2)return}else c.uid=g.uid;g.ex?c.extra=g.ex:cr.wipe(c.extra);if(l=g.ivs)for(b in l)if(l.hasOwnProperty(b)){var k=this.getInstanceVarIndexBySid(e,
parseInt(b,10));if(!(0>k||k>=c.instance_vars.length)){var h=l[b];null===h&&(h=NaN);c.instance_vars[k]=h}}if(d.is_world){k=g.w;c.layer.sid!==k.l&&(l=c.layer,c.layer=this.running_layout.getLayerBySid(k.l),c.layer?(l.removeFromInstanceList(c,!0),c.layer.appendToInstanceList(c,!0),c.set_bbox_changed(),c.layer.setZIndicesStaleFrom(0)):(c.layer=l,a||this.DestroyInstance(c)));c.x=k.x;c.y=k.y;c.width=k.w;c.height=k.h;c.zindex=k.zi;c.angle=k.hasOwnProperty("a")?k.a:0;c.opacity=k.hasOwnProperty("o")?k.o:1;
c.hotspotX=k.hasOwnProperty("hX")?k.hX:.5;c.hotspotY=k.hasOwnProperty("hY")?k.hY:.5;c.visible=k.hasOwnProperty("v")?k.v:!0;c.collisionsEnabled=k.hasOwnProperty("ce")?k.ce:!0;c.my_timescale=k.hasOwnProperty("mts")?k.mts:-1;c.blend_mode=k.hasOwnProperty("bm")?k.bm:0;c.compositeOp=cr.effectToCompositeOp(c.blend_mode);this.gl&&cr.setGLBlend(c,c.blend_mode,this.gl);c.set_bbox_changed();if(k.hasOwnProperty("fx"))for(a=0,l=k.fx.length;a<l;a++)h=e.getEffectIndexByName(k.fx[a].name),0>h||(c.active_effect_flags[h]=
k.fx[a].active,c.effect_params[h]=k.fx[a].params);c.updateActiveEffects()}if(e=g.behs)for(b in e)e.hasOwnProperty(b)&&(a=this.getBehaviorIndexBySid(c,parseInt(b,10)),0>a||c.behavior_insts[a].loadFromJSON(e[b]));g.data&&c.loadFromJSON(g.data)};f.prototype.getProjectFileUrl=function(c){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(c.toLowerCase())?window.cr_previewProjectFiles[c.toLowerCase()]:c:this.files_subfolder+c};f.prototype.getProjectFileBlob=function(c){return this.isPreview?
window.cr_previewProjectFileBlobs&&window.cr_previewProjectFiles.hasOwnProperty(c.toLowerCase())?window.cr_previewProjectFileBlobs[c.toLowerCase()]:null:null};f.prototype.getLocalFileUrl=function(c){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(c.toLowerCase())?window.cr_previewProjectFiles[c.toLowerCase()]:c:c};f.prototype.fetchLocalFileViaCordova=function(c,g,a){window.resolveLocalFileSystemURL(window.cordova.file.applicationDirectory+"www/"+c,function(c){c.file(g,a)},a)};f.prototype.fetchLocalFileViaCordovaAsText=
function(c,g,a){this.fetchLocalFileViaCordova(c,function(c){var b=new FileReader;b.onload=function(c){g(c.target.result)};b.onerror=a;b.readAsText(c)},a)};var J=[],E=0;f.prototype.maybeStartNextArrayBufferRead=function(){if(J.length&&!(8<=E)){E++;var c=J.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(c.filename,c.successCallback,c.errorCallback)}};f.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(c,g,a){var b=this;J.push({filename:c,successCallback:function(c){E--;b.maybeStartNextArrayBufferRead();
g(c)},errorCallback:function(c){E--;b.maybeStartNextArrayBufferRead();a(c)}});this.maybeStartNextArrayBufferRead()};f.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(c,g,a){this.fetchLocalFileViaCordova(c,function(c){var a=new FileReader;a.onload=function(c){g(c.target.result)};a.readAsArrayBuffer(c)},a)};f.prototype.fetchLocalFileViaCordovaAsURL=function(c,g,a){var b="",l=c.toLowerCase(),e=l.substr(l.length-4);l=l.substr(l.length-5);".mp4"===e?b="video/mp4":".webm"===l?b="video/webm":
".m4a"===e?b="audio/mp4":".mp3"===e&&(b="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(c,function(c){c=new Blob([c],{type:b});c=URL.createObjectURL(c);g(c)},a)};f.prototype.isAbsoluteUrl=function(c){return/^(?:[a-z]+:)?\/\//.test(c)||"data:"===c.substr(0,5)||"blob:"===c.substr(0,5)};f.prototype.setImageSrc=function(c,g){this.isWKWebView&&!this.isAbsoluteUrl(g)?this.fetchLocalFileViaCordovaAsURL(g,function(g){c.src=g},function(c){alert("Failed to load image: "+c)}):this.isPreview&&!this.isAbsoluteUrl(g)?
c.src=this.getLocalFileUrl(g):(this.isAbsoluteUrl(g)||(g=g.toLowerCase()),c.src=g)};f.prototype.getPreferredAudioFile=function(c){c=c.toLowerCase();if(!this.audio_files_map.hasOwnProperty(c))return null;c=this.audio_files_map[c];var g=null,a;var b=0;for(a=c.length;b<a;++b){var l=c[b];var e=l[0];g||"audio/webm; codecs=opus"!==e||(g=l);if(w[e])return l}return g};f.prototype.getProjectAudioFileUrl=function(c){var g=c.toLowerCase();return(c=this.getPreferredAudioFile(c))?{url:this.getProjectFileUrl(g+
c[1]),type:c[0]}:null};f.prototype.getStatusInfo=function(){return{fps:this.fps,cpu:this.cpuutilisation/1E3,gpu:this.gpuLastUtilisation,layout:this.running_layout?this.running_layout.name:"",renderer:this.glUnmaskedRenderer}};f.prototype.accelerate=function(c,g,a,b,l){return this.enhancedAccelerationPrecision?cr.clamp(c*l+.5*b*l*l,g*l,a*l):c*l};cr.runtime=f;cr.createRuntime=function(c){return new f(c)};window.cr_createRuntime=cr.createRuntime})();
window.cr_getSnapshot=function(f,p){var q=window.c3runtime;q&&q.doCanvasSnapshot(f,p)};window.cr_sizeCanvas=function(f,p){if(0!==f&&0!==p){var q=window.c3runtime;q&&q.setSize(f,p)}};window.cr_setSuspended=function(f){var p=window.c3runtime;p&&p.setSuspended(f)};
(function(){function f(b,e){return b.zindex-e.zindex}function p(b,e){this.layout=b;this.runtime=b.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr.rect(0,0,0,0);this.tmpquad=new cr.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=e[0];this.index=e[1];this.sid=e[2];this.visible=e[3];this.background_color=e[4];this.transparent=e[5];this.parallaxX=e[6];this.parallaxY=
e[7];this.opacity=e[8];this.forceOwnTexture=e[9];this.useRenderCells=e[10];this.zoomRate=e[11];this.blend_mode=e[12];this.effect_fallback=e[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=q();this.render_list_stale=!0;this.last_render_cells=new cr.rect(0,0,-1,-1);this.cur_render_cells=new cr.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=
!1;b=e[14];var d;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var h=0;for(d=b.length;h<d;h++){var a=b[h],t=this.runtime.types_by_index[a[1]];t.default_instance||(t.default_instance=a,t.default_layerindex=this.index);this.initial_instances.push(a);-1===this.layout.initial_types.indexOf(t)&&this.layout.initial_types.push(t)}cr.shallowAssignArray(this.startup_initial_instances,this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=
!0;this.effect_params=[];h=0;for(d=e[15].length;h<d;h++)this.effect_types.push({id:e[15][h][0],name:e[15][h][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:h}),this.effect_params.push(e[15][h][2].slice(0));this.updateActiveEffects();this.rcTexBounce=new cr.rect(0,0,1,1);this.rcTexDest=new cr.rect(0,0,1,1);this.rcTexOrigin=new cr.rect(0,0,1,1)}function q(){return u.length?u.pop():[]}function n(b){cr.clearArray(b);u.push(b)}p.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);
this.shaders_preserve_opaqueness=!0;var b;var e=0;for(b=this.effect_types.length;e<b;e++){var d=this.effect_types[e];d.active&&(this.active_effect_types.push(d),d.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};p.prototype.getEffectByName=function(b){var e;var d=0;for(e=this.effect_types.length;d<e;d++){var h=this.effect_types[d];if(h.name===b)return h}return null};p.prototype.createInitialInstances=function(b){var e,d;var h=e=0;for(d=this.initial_instances.length;e<d;e++){var a=this.initial_instances[e];
var t=this.runtime.types_by_index[a[1]];var m=this.runtime.typeHasPersistBehavior(t);t=!0;if(!m||this.layout.first_visit){a=this.runtime.createInstanceFromInit(a,this,!0);if(!a)continue;b.push(a);a.type.global&&(t=!1,this.created_globals.push(a.uid))}t&&(this.initial_instances[h]=this.initial_instances[e],h++)}this.initial_instances.length=h;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr.effectToCompositeOp(this.blend_mode);
this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};p.prototype.recreateInitialObjects=function(b,e){var d,h=this.runtime.types_by_index,a=b.is_family,t=b.members;var m=0;for(d=this.initial_instances.length;m<d;++m){var f=this.initial_instances[m];var p=f[0];var k=p[0];p=p[1];if(e.contains_pt(k,p)){k=h[f[1]];if(k!==b)if(a){if(0>t.indexOf(k))continue}else continue;f=this.runtime.createInstanceFromInit(f,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(k.plugin).cnds.OnCreated,
f);if(f.is_contained)for(k=0,p=f.siblings.length;k<p;k++){var l=f.siblings[m];this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated,l)}this.runtime.isInOnDestroy--}}};p.prototype.removeFromInstanceList=function(b,e){var d=cr.fastIndexOf(this.instances,b);0>d||(e&&this.useRenderCells&&b.rendercells&&b.rendercells.right>=b.rendercells.left&&(b.update_bbox(),this.render_grid.update(b,b.rendercells,null),b.rendercells.set(0,0,-1,-1)),d===this.instances.length-1?this.instances.pop():
(cr.arrayRemove(this.instances,d),this.setZIndicesStaleFrom(d)),this.render_list_stale=!0)};p.prototype.appendToInstanceList=function(b,e){b.zindex=this.instances.length;this.instances.push(b);e&&this.useRenderCells&&b.rendercells&&b.set_bbox_changed();this.render_list_stale=!0};p.prototype.prependToInstanceList=function(b,e){this.instances.unshift(b);this.setZIndicesStaleFrom(0);e&&this.useRenderCells&&b.rendercells&&b.set_bbox_changed()};p.prototype.moveInstanceAdjacent=function(b,e,d){var h=b.get_zindex();
e=e.get_zindex();cr.arrayRemove(this.instances,h);h<e&&e--;d&&e++;e===this.instances.length?this.instances.push(b):this.instances.splice(e,0,b);this.setZIndicesStaleFrom(h<e?h:e)};p.prototype.setZIndicesStaleFrom=function(b){-1===this.zindices_stale_from?this.zindices_stale_from=b:b<this.zindices_stale_from&&(this.zindices_stale_from=b);this.render_list_stale=this.zindices_stale=!0};p.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=
0);var b;if(this.useRenderCells){var e=this.zindices_stale_from;for(b=this.instances.length;e<b;++e){var d=this.instances[e];d.zindex=e;this.render_grid.markRangeChanged(d.rendercells)}}else for(e=this.zindices_stale_from,b=this.instances.length;e<b;++e)this.instances[e].zindex=e;this.zindices_stale=!1;this.zindices_stale_from=-1}};p.prototype.getScale=function(b){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||b?this.runtime.aspect_scale:1)};p.prototype.getNormalScale=function(){return(this.scale*
this.layout.scale-1)*this.zoomRate+1};p.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var u=[],m=[],d=[];p.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,d);if(!d.length)return q();if(1===d.length){var b=q();cr.shallowAssignArray(b,d[0]);cr.clearArray(d);return b}for(var e=!0;1<d.length;){var f;b=d;var h=e;var a=0;for(f=b.length;a<
f-1;a+=2){var t=b[a];var y=b[a+1];e=q();var z=t,p=y,k=e,l=0,B=0,G=0,N=z.length,u=p.length;for(k.length=N+u;l<N&&B<u;++G){var H=z[l];var c=p[B];H.zindex<c.zindex?(k[G]=H,++l):(k[G]=c,++B)}for(;l<N;++l,++G)k[G]=z[l];for(;B<u;++B,++G)k[G]=p[B];h||(n(t),n(y));m.push(e)}1===f%2&&(h?(t=q(),cr.shallowAssignArray(t,b[f-1]),m.push(t)):m.push(b[f-1]));cr.shallowAssignArray(b,m);cr.clearArray(m);e=!1}b=d[0];cr.clearArray(d);return b};p.prototype.draw=function(b){this.render_offscreen=this.forceOwnTexture||1!==
this.opacity||0!==this.blend_mode;var e=this.runtime.canvas,d=b,h=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),e=this.runtime.layer_canvas,e.width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layer_ctx=e.getContext("2d"),h=!0),e=this.runtime.layer_canvas,d=this.runtime.layer_ctx,e.width!==this.runtime.draw_width&&(e.width=this.runtime.draw_width,h=!0),e.height!==this.runtime.draw_height&&(e.height=this.runtime.draw_height,
h=!0),h&&(d.imageSmoothingEnabled=this.runtime.linearSampling),this.transparent&&d.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));d.globalAlpha=1;d.globalCompositeOperation="source-over";this.transparent||(d.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",d.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));d.save();this.disableAngle=!0;h=this.canvasToLayer(0,0,!0,!0);var a=this.canvasToLayer(0,0,!1,!0);this.disableAngle=
!1;this.runtime.pixel_rounding&&(h=Math.round(h),a=Math.round(a));this.rotateViewport(h,a,d);var t=this.getScale();d.scale(t,t);d.translate(-h,-a);this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?
(n(this.last_render_list),h=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):h=this.last_render_list):h=this.instances;var m=null;a=0;for(t=h.length;a<t;++a){var f=h[a];f!==m&&(this.drawInstance(f,d),m=f)}this.useRenderCells&&(this.last_render_list=h);d.restore();this.render_offscreen&&(b.globalCompositeOperation=this.compositeOp,b.globalAlpha=this.opacity,b.drawImage(e,0,0))};p.prototype.drawInstance=function(b,e){if(b.visible&&0!==
b.width&&0!==b.height){b.update_bbox();var d=b.bbox;d.right<this.viewLeft||d.bottom<this.viewTop||d.left>this.viewRight||d.top>this.viewBottom||(e.globalCompositeOperation=b.compositeOp,b.draw(e))}};p.prototype.updateViewport=function(b){this.disableAngle=!0;var e=this.canvasToLayer(0,0,!0,!0),d=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(e=Math.round(e),d=Math.round(d));this.rotateViewport(e,d,b)};p.prototype.rotateViewport=function(b,e,d){var h=this.getScale();
this.viewLeft=b;this.viewTop=e;this.viewRight=b+1/h*this.runtime.draw_width;this.viewBottom=e+1/h*this.runtime.draw_height;b=this.getAngle();0!==b&&(d&&(d.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),d.rotate(-b),d.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
b),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};p.prototype.drawGL_earlyZPass=function(b){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var e=this.canvasToLayer(0,0,!0,!0),d=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(e=Math.round(e),d=Math.round(d));
this.rotateViewport(e,d,null);e=this.getScale();b.resetModelView();b.scale(e,e);b.rotateZ(-this.getAngle());b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);b.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(n(this.last_render_list),e=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):e=this.last_render_list):e=this.instances;var h=null;for(d=e.length-1;0<=d;--d){var a=e[d];a!==h&&(this.drawInstanceGL_earlyZPass(e[d],b),h=a)}this.useRenderCells&&(this.last_render_list=e);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,b.setEarlyZIndex(this.clear_earlyz_index),
b.setColorFillMode(1,1,1,1),b.fullscreenQuad(),b.restoreEarlyZMode())};p.prototype.drawGL=function(b){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&b.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(b.setEarlyZIndex(this.clear_earlyz_index),b.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),b.fullscreenQuad(),b.setTextureFillMode()):b.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var d=this.canvasToLayer(0,0,!0,!0);var m=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),m=Math.round(m));this.rotateViewport(d,m,null);d=this.getScale();b.resetModelView();b.scale(d,d);b.rotateZ(-this.getAngle());b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);b.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(n(this.last_render_list),m=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):m=this.last_render_list):m=this.instances;var h,a=null;if(2.220446049250313E-16<
this.getNormalScale()){var t=0;for(h=m.length;t<h;++t){var f=m[t];f!==a&&(this.drawInstanceGL(m[t],b),a=f)}}this.useRenderCells&&(this.last_render_list=m);this.render_offscreen&&(m=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,t=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!b.programUsesCrossSampling(m)&&1===this.opacity?(1===this.active_effect_types.length?(b.switchProgram(m),
b.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,0,0,1,1,d,this.getAngle(),this.runtime.kahanTime.sum,this.effect_params[t]),b.programIsAnimated(m)&&(this.runtime.redraw=!0)):b.switchProgram(0),b.setRenderingToTexture(this.layout.getRenderTarget()),b.setOpacity(this.opacity),b.setTexture(this.runtime.layer_tex),b.setBlend(this.srcBlend,this.destBlend),b.resetModelView(),
b.updateModelView(),d=this.runtime.draw_width/2,m=this.runtime.draw_height/2,b.quad(-d,m,d,m,d,-m,-d,-m),b.setTexture(null)):this.layout.renderEffectChain(b,this,null,this.layout.getRenderTarget()))};p.prototype.drawInstanceGL=function(b,d){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var e=b.bbox;e.right<this.viewLeft||e.bottom<this.viewTop||e.left>this.viewRight||e.top>this.viewBottom||(d.setEarlyZIndex(b.earlyz_index),b.uses_shaders?this.drawInstanceWithShadersGL(b,d):(d.switchProgram(0),
d.setBlend(b.srcBlend,b.destBlend),b.drawGL(d)))}};p.prototype.drawInstanceGL_earlyZPass=function(b,d){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var e=b.bbox;e.right<this.viewLeft||e.bottom<this.viewTop||e.left>this.viewRight||e.top>this.viewBottom||(b.earlyz_index=this.runtime.earlyz_index++,0===b.blend_mode&&1===b.opacity&&b.shaders_preserve_opaqueness&&b.drawGL_earlyZPass&&(d.setEarlyZIndex(b.earlyz_index),b.drawGL_earlyZPass(d)))}};p.prototype.drawInstanceWithShadersGL=function(b,
d){var e=b.active_effect_types[0].shaderindex,h=b.active_effect_types[0].index,a=this.getScale();if(1!==b.active_effect_types.length||d.programUsesCrossSampling(e)||d.programExtendsBox(e)||(b.angle||b.layer.getAngle())&&d.programUsesDest(e)||1!==b.opacity||b.type.plugin.must_predraw)this.layout.renderEffectChain(d,this,b,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),d.resetModelView(),d.scale(a,a),d.rotateZ(-this.getAngle()),d.translate((this.viewLeft+this.viewRight)/
-2,(this.viewTop+this.viewBottom)/-2),d.updateModelView();else{d.switchProgram(e);d.setBlend(b.srcBlend,b.destBlend);d.programIsAnimated(e)&&(this.runtime.redraw=!0);var t=0,m=0,f=0,p=0;d.programUsesDest(e)&&(p=b.bbox,t=this.layerToCanvas(p.left,p.top,!0,!0),m=this.layerToCanvas(p.left,p.top,!1,!0),f=this.layerToCanvas(p.right,p.bottom,!0,!0),p=this.layerToCanvas(p.right,p.bottom,!1,!0),t/=windowWidth,m=1-m/windowHeight,f/=windowWidth,p=1-p/windowHeight);var k=e=0,l=1,B=1,G=1/b.width,q=1/b.height;
b.curFrame&&b.curFrame.sheetTex&&(e=b.curFrame.sheetTex.left,k=b.curFrame.sheetTex.top,l=b.curFrame.sheetTex.right,B=b.curFrame.sheetTex.bottom,b.curFrame.texture_img&&(G=1/b.curFrame.texture_img.width,q=1/b.curFrame.texture_img.height));d.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),G,q,e,k,l,B,e,k,l,B,b.bbox.left,b.bbox.top,b.bbox.right,b.bbox.bottom,t,m,f,p,a,this.getAngle(),this.runtime.kahanTime.sum,b.effect_params[h]);b.drawGL(d)}};p.prototype.canvasToLayer=
function(b,d,m,h){var a=this.runtime.devicePixelRatio;this.runtime.isRetina&&(b*=a,d*=a);a=this.runtime.parallax_x_origin;var e=this.runtime.parallax_y_origin;a=(this.layout.scrollX-a)*this.parallaxX+a;e=(this.layout.scrollY-e)*this.parallaxY+e;var f=a,z=e,p=1/this.getScale(!h);h?(f-=this.runtime.draw_width*p/2,z-=this.runtime.draw_height*p/2):(f-=this.runtime.width*p/2,z-=this.runtime.height*p/2);f+=b*p;z+=d*p;d=this.getAngle();0!==d&&(f-=a,z-=e,b=Math.cos(d),d=Math.sin(d),h=f*b-z*d,z=z*b+f*d,f=
h+a,z+=e);return m?f:z};p.prototype.layerToCanvas=function(b,d,m,h){var a=this.runtime.parallax_x_origin,e=this.runtime.parallax_y_origin,f=(this.layout.scrollX-a)*this.parallaxX+a,z=(this.layout.scrollY-e)*this.parallaxY+e;e=f;a=z;var p=this.getAngle();if(0!==p){b-=f;d-=z;var k=Math.cos(-p);p=Math.sin(-p);var l=b*k-d*p;d=d*k+b*p;b=l+f;d+=z}f=1/this.getScale(!h);h?(e-=this.runtime.draw_width*f/2,a-=this.runtime.draw_height*f/2):(e-=this.runtime.width*f/2,a-=this.runtime.height*f/2);e=(b-e)/f;a=(d-
a)/f;b=this.runtime.devicePixelRatio;this.runtime.isRetina&&!h&&(e/=b,a/=b);return m?e:a};p.prototype.rotatePt=function(b,d,m){if(0===this.getAngle())return m?b:d;var e=this.layerToCanvas(b,d,!0);d=this.layerToCanvas(b,d,!1);this.disableAngle=!0;b=this.canvasToLayer(e,d,!0);e=this.canvasToLayer(e,d,!0);this.disableAngle=!1;return m?b:e};p.prototype.saveToJSON=function(){var b,d={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,
t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var m=0;for(b=this.effect_types.length;m<b;m++){var h=this.effect_types[m];d.fx.push({name:h.name,active:h.active,params:this.effect_params[h.index]})}return d};p.prototype.loadFromJSON=function(b){var d;this.scale=b.s;this.angle=b.a;this.viewLeft=b.vl;this.viewTop=b.vt;this.viewRight=b.vr;this.viewBottom=b.vb;this.visible=b.v;this.background_color=b.bc;this.transparent=
b.t;this.parallaxX=b.px;this.parallaxY=b.py;this.opacity=b.o;this.zoomRate=b.zr;this.created_globals=b.cg||[];cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);var m=new cr.ObjectSet;var h=0;for(d=this.created_globals.length;h<d;++h)m.add(this.created_globals[h]);var a=h=0;for(d=this.initial_instances.length;h<d;++h)m.contains(this.initial_instances[h][2])||(this.initial_instances[a]=this.initial_instances[h],++a);cr.truncateArray(this.initial_instances,a);a=b.fx;h=0;for(d=
a.length;h<d;h++)if(b=this.getEffectByName(a[h].name))b.active=a[h].active,this.effect_params[b.index]=a[h].params;this.updateActiveEffects();this.instances.sort(f);this.zindices_stale=!0};cr.layer=p})();
(function(){function f(d,b){this.runtime=d;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=b[0];this.originalWidth=b[1];this.originalHeight=b[2];this.width=b[1];this.height=b[2];this.unbounded_scrolling=b[3];this.sheetname=b[4];this.sid=b[5];var e=b[6],m;this.layers=[];this.initial_types=[];d=0;for(m=e.length;d<m;d++){var h=new cr.layer(this,e[d]);h.number=d;cr.seal(h);this.layers.push(h)}e=
b[7];this.initial_nonworld=[];d=0;for(m=e.length;d<m;d++){h=e[d];var a=this.runtime.types_by_index[h[1]];a.default_instance||(a.default_instance=h);this.initial_nonworld.push(h);-1===this.initial_types.indexOf(a)&&this.initial_types.push(a)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];d=0;for(m=b[8].length;d<m;d++)this.effect_types.push({id:b[8][d][0],name:b[8][d][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:d}),this.effect_params.push(b[8][d][2].slice(0));
this.updateActiveEffects();this.rcTexBounce=new cr.rect(0,0,1,1);this.rcTexDest=new cr.rect(0,0,1,1);this.rcTexOrigin=new cr.rect(0,0,1,1);this.viewRect=new cr.rect(0,0,0,0);this.persist_data={}}function p(d,b){return d.zindex-b.zindex}function q(d){return d.some(function(b){return b.plugin.is_world})}f.prototype.saveObjectToPersist=function(d){var b=d.type.sid.toString();this.persist_data.hasOwnProperty(b)||(this.persist_data[b]=[]);this.persist_data[b].push(this.runtime.saveInstanceToJSON(d))};
f.prototype.hasOpaqueBottomLayer=function(){var d=this.layers[0];return!d.transparent&&1===d.opacity&&!d.forceOwnTexture&&d.visible};f.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var d;var b=0;for(d=this.effect_types.length;b<d;b++){var e=this.effect_types[b];e.active&&(this.active_effect_types.push(e),e.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};f.prototype.getEffectByName=function(d){var b;var e=0;for(b=
this.effect_types.length;e<b;e++){var m=this.effect_types[e];if(m.name===d)return m}return null};var n=[],u=!0;f.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;var d,b;var e=0;for(d=this.runtime.types_by_index.length;e<
d;e++){var m=this.runtime.types_by_index[e];if(!m.is_family){var h=m.instances;m=0;for(b=h.length;m<b;m++){var a=h[m];if(a.layer){var t=a.layer.number;t>=this.layers.length&&(t=this.layers.length-1);a.layer=this.layers[t];-1===a.layer.instances.indexOf(a)&&a.layer.instances.push(a);a.layer.zindices_stale=!0}}}}if(!u)for(e=0,d=this.layers.length;e<d;++e)this.layers[e].instances.sort(p);cr.clearArray(n);this.boundScrolling();e=0;for(d=this.layers.length;e<d;e++)a=this.layers[e],a.createInitialInstances(n),
a.updateViewport(null);h=!1;if(!this.first_visit){for(f in this.persist_data)if(this.persist_data.hasOwnProperty(f)&&(m=this.runtime.getObjectTypeBySid(parseInt(f,10)))&&!m.is_family&&this.runtime.typeHasPersistBehavior(m)){b=this.persist_data[f];e=0;for(d=b.length;e<d;e++){a=null;if(m.plugin.is_world&&(a=this.getLayerBySid(b[e].w.l),!a))continue;a=this.runtime.createInstanceFromInit(m.default_instance,a,!1,0,0,!0);this.runtime.loadInstanceFromJSON(a,b[e]);h=!0;n.push(a)}cr.clearArray(b)}e=0;for(d=
this.layers.length;e<d;e++)this.layers[e].instances.sort(p),this.layers[e].zindices_stale=!0}h&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());this.createAndLinkContainerInstances(n);e=0;for(d=this.initial_nonworld.length;e<d;e++){var f=this.initial_nonworld[e];m=this.runtime.types_by_index[f[1]];m.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[e],null,!0)}this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx)for(e=0,d=this.runtime.types_by_index.length;e<
d;e++)f=this.runtime.types_by_index[e],!f.is_family&&f.instances.length&&f.preloadCanvas2D&&f.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,n);else for(e=0,d=n.length;e<d;e++)a=n[e],this.runtime.trigger(Object.getPrototypeOf(a.type.plugin).cnds.OnCreated,a);cr.clearArray(n);this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};f.prototype.createAndLinkContainerInstances=
function(d){var b,e;for(b=0;b<d.length;b++){var m=d[b];if(m.type.is_contained){var h=m.get_iid();var a=0;for(e=m.type.container.length;a<e;a++){var t=m.type.container[a];if(m.type!==t)if(t.instances.length>h)m.siblings.push(t.instances[h]);else if(t.default_instance){var f=this.runtime.createInstanceFromInit(t.default_instance,m.layer,!0,m.x,m.y,!0);this.runtime.ClearDeathRow();t.updateIIDs();m.siblings.push(f);d.push(f)}}}}};f.prototype.createGlobalNonWorlds=function(){var d,b,e=[];var m=d=0;for(b=
this.initial_nonworld.length;d<b;d++){var h=this.initial_nonworld[d];var a=this.runtime.types_by_index[h[1]];a.global?a.is_contained&&q(a.container)||e.push(this.runtime.createInstanceFromInit(h,null,!0)):(this.initial_nonworld[m]=h,m++)}cr.truncateArray(this.initial_nonworld,m);this.runtime.ClearDeathRow();this.createAndLinkContainerInstances(e)};f.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=
!0;cr.clearArray(this.runtime.system.waits);var d,b;if(!this.first_visit){var e=0;for(d=this.layers.length;e<d;e++){this.layers[e].updateZIndices();var m=this.layers[e].instances;var h=0;for(b=m.length;h<b;h++){var a=m[h];a.type.global||this.runtime.typeHasPersistBehavior(a.type)&&this.saveObjectToPersist(a)}}}e=0;for(d=this.layers.length;e<d;e++){m=this.layers[e].instances;h=0;for(b=m.length;h<b;h++)a=m[h],a.type.global||this.runtime.DestroyInstance(a);this.runtime.ClearDeathRow();cr.clearArray(m);
this.layers[e].zindices_stale=!0}e=0;for(d=this.runtime.types_by_index.length;e<d;e++)if(m=this.runtime.types_by_index[e],!(m.global||m.plugin.is_world||m.plugin.singleglobal||m.is_family)){h=0;for(b=m.instances.length;h<b;h++)this.runtime.DestroyInstance(m.instances[h]);this.runtime.ClearDeathRow()}u=!1;this.runtime.isEndingLayout=!1};var m=new cr.rect(0,0,0,0);f.prototype.recreateInitialObjects=function(d,b,e,f,h){m.set(b,e,f,h);b=0;for(e=this.layers.length;b<e;b++)this.layers[b].recreateInitialObjects(d,
m)};f.prototype.draw=function(d){var b=d,e=!1,m=!this.runtime.fullscreenScalingQuality;if(m){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=document.createElement("canvas");var h=this.runtime.layout_canvas;h.width=this.runtime.draw_width;h.height=this.runtime.draw_height;this.runtime.layout_ctx=h.getContext("2d");e=!0}h=this.runtime.layout_canvas;b=this.runtime.layout_ctx;h.width!==this.runtime.draw_width&&(h.width=this.runtime.draw_width,e=!0);h.height!==this.runtime.draw_height&&(h.height=
this.runtime.draw_height,e=!0);e&&(b.imageSmoothingEnabled=this.runtime.linearSampling)}b.globalAlpha=1;b.globalCompositeOperation="source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&b.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);var a;e=0;for(a=this.layers.length;e<a;e++){var t=this.layers[e];t.visible&&0<t.opacity&&11!==t.blend_mode&&(t.instances.length||!t.transparent)?t.draw(b):t.updateViewport(null)}m&&d.drawImage(h,0,0,this.runtime.width,this.runtime.height)};
f.prototype.drawGL_earlyZPass=function(d){d.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=d.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)d.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=d.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);d.setRenderingToTexture(this.runtime.layout_tex);
this.runtime.fullscreenScalingQuality||d.setSize(this.runtime.draw_width,this.runtime.draw_height);var b;for(b=this.layers.length-1;0<=b;--b){var e=this.layers[b];e.visible&&1===e.opacity&&e.shaders_preserve_opaqueness&&0===e.blend_mode&&(e.instances.length||!e.transparent)?e.drawGL_earlyZPass(d):e.updateViewport(null)}d.setEarlyZPass(!1)};f.prototype.drawGL=function(d){var b=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;
if(b){this.runtime.layout_tex||(this.runtime.layout_tex=d.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)d.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=d.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);d.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||
d.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&(d.setRenderingToTexture(null),d.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&d.clear(0,0,0,0);var e;var m=0;for(e=this.layers.length;m<e;m++){var h=this.layers[m];h.visible&&0<h.opacity&&(h.instances.length||!h.transparent)?h.drawGL(d):h.updateViewport(null)}b&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&
this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(b=this.active_effect_types[0].index,m=this.calculateViewRect(),d.switchProgram(this.active_effect_types[0].shaderindex),d.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,m.left,m.top,m.right,m.bottom,0,0,1,1,this.scale,this.angle,this.runtime.kahanTime.sum,this.effect_params[b]),d.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):d.switchProgram(0),
this.runtime.fullscreenScalingQuality||d.setSize(this.runtime.width,this.runtime.height),d.setRenderingToTexture(null),d.setDepthTestEnabled(!1),d.setOpacity(1),d.setTexture(this.runtime.layout_tex),d.setAlphaBlend(),d.resetModelView(),d.updateModelView(),b=this.runtime.width/2,m=this.runtime.height/2,d.quad(-b,m,b,m,b,-m,-b,-m),d.setTexture(null),d.setDepthTestEnabled(!0)):this.renderEffectChain(d,null,null,null))};f.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||
this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:null};f.prototype.getMinLayerScale=function(){var d=this.layers[0].getScale(),b;var e=1;for(b=this.layers.length;e<b;e++){var m=this.layers[e];(0!==m.parallaxX||0!==m.parallaxY)&&m.getScale()<d&&(d=m.getScale())}return d};f.prototype.scrollToX=function(d){if(!this.unbounded_scrolling){var b=this.runtime.draw_width*(1/this.getMinLayerScale())/2;d>this.width-b&&(d=this.width-
b);d<b&&(d=b)}this.scrollX!==d&&(this.scrollX=d,this.runtime.redraw=!0)};f.prototype.scrollToY=function(d){if(!this.unbounded_scrolling){var b=this.runtime.draw_height*(1/this.getMinLayerScale())/2;d>this.height-b&&(d=this.height-b);d<b&&(d=b)}this.scrollY!==d&&(this.scrollY=d,this.runtime.redraw=!0)};f.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};f.prototype.calculateViewRect=function(){var d=this.scrollX,b=this.scrollY,e=1/(this.scale*this.runtime.aspect_scale);
d-=this.runtime.width*e/2;b-=this.runtime.height*e/2;this.viewRect.set(d,b,d+this.runtime.draw_width*e,b+this.runtime.draw_height*e);return this.viewRect};f.prototype.renderEffectChain=function(d,b,e,m){var h=e?e.active_effect_types:b?b.active_effect_types:this.active_effect_types;if(e){var a=e.layer.getScale();var t=e.layer.getAngle();var f=e.layer.viewLeft;var z=e.layer.viewTop;var p=e.layer.viewRight;var k=e.layer.viewBottom}else b?(a=b.getScale(),t=b.getAngle(),f=b.viewLeft,z=b.viewTop,p=b.viewRight,
k=b.viewBottom):(a=this.scale,t=this.angle,k=this.calculateViewRect(),f=k.left,z=k.top,p=k.right,k=k.bottom);var l=this.runtime.fx_tex,B,q,n=0,u=1,H=this.runtime.draw_width,c=this.runtime.draw_height,g=H/2,r=c/2,v=b?b.rcTexBounce:this.rcTexBounce,K=b?b.rcTexDest:this.rcTexDest,O=b?b.rcTexOrigin:this.rcTexOrigin,w=0,I=0,J=0,E=0,x=H,W=H,M=c,R=c,F=q=0,P=e?e.layer.getAngle():0;if(e){var L=0;for(B=h.length;L<B;L++)q+=d.getProgramBoxExtendHorizontal(h[L].shaderindex),F+=d.getProgramBoxExtendVertical(h[L].shaderindex);
E=e.bbox;w=b.layerToCanvas(E.left,E.top,!0,!0);J=b.layerToCanvas(E.left,E.top,!1,!0);x=b.layerToCanvas(E.right,E.bottom,!0,!0);M=b.layerToCanvas(E.right,E.bottom,!1,!0);if(0!==P){L=b.layerToCanvas(E.right,E.top,!0,!0);B=b.layerToCanvas(E.right,E.top,!1,!0);I=b.layerToCanvas(E.left,E.bottom,!0,!0);E=b.layerToCanvas(E.left,E.bottom,!1,!0);var D=Math.min(w,x,L,I);x=Math.max(w,x,L,I);w=D;D=Math.min(J,M,B,E);M=Math.max(J,M,B,E);J=D}O.left=w/H;O.top=1-J/c;O.right=x/H;O.bottom=1-M/c;w-=q;J-=F;x+=q;M+=F;
K.left=w/H;K.top=1-J/c;K.right=x/H;K.bottom=1-M/c;I=w=cr.floor(w);E=J=cr.floor(J);W=x=cr.ceil(x);R=M=cr.ceil(M);I-=q;E-=F;W+=q;R+=F;0>w&&(w=0);0>J&&(J=0);x>H&&(x=H);M>c&&(M=c);0>I&&(I=0);0>E&&(E=0);W>H&&(W=H);R>c&&(R=c);v.left=w/H;v.top=1-J/c;v.right=x/H;v.bottom=1-M/c}else v.left=K.left=O.left=0,v.top=K.top=O.top=0,v.right=K.right=O.right=1,v.bottom=K.bottom=1;F=e&&(d.programUsesDest(h[0].shaderindex)||0!==q||0!==F||1!==e.opacity||e.type.plugin.must_predraw)||b&&!e&&1!==b.opacity;d.setAlphaBlend();
if(F){l[n]||(l[n]=d.createEmptyTexture(H,c,this.runtime.linearSampling));if(l[n].c2width!==H||l[n].c2height!==c)d.deleteTexture(l[n]),l[n]=d.createEmptyTexture(H,c,this.runtime.linearSampling);d.switchProgram(0);d.setRenderingToTexture(l[n]);var C=R-E;d.clearRect(I,c-E-C,W-I,C);e?e.drawGL(d):(d.setTexture(this.runtime.layer_tex),d.setOpacity(b.opacity),d.resetModelView(),d.translate(-g,-r),d.updateModelView(),d.quadTex(w,M,x,M,x,J,w,J,v));K.left=K.top=0;K.right=K.bottom=1;e&&(D=v.top,v.top=v.bottom,
v.bottom=D);n=1;u=0}d.setOpacity(1);q=h.length-1;P=d.programUsesCrossSampling(h[q].shaderindex)||!b&&!e&&!this.runtime.fullscreenScalingQuality;L=0;for(B=h.length;L<B;L++){l[n]||(l[n]=d.createEmptyTexture(H,c,this.runtime.linearSampling));if(l[n].c2width!==H||l[n].c2height!==c)d.deleteTexture(l[n]),l[n]=d.createEmptyTexture(H,c,this.runtime.linearSampling);d.switchProgram(h[L].shaderindex);D=h[L].index;d.programIsAnimated(h[L].shaderindex)&&(this.runtime.redraw=!0);if(0!=L||F){d.setProgramParameters(m,
1/H,1/c,0,0,1,1,O.left,O.top,O.right,O.bottom,f,z,p,k,K.left,K.top,K.right,K.bottom,a,t,this.runtime.kahanTime.sum,e?e.effect_params[D]:b?b.effect_params[D]:this.effect_params[D]);d.setTexture(null);if(L!==q||P){d.setRenderingToTexture(l[n]);C=R-E;var X=c-E-C;d.clearRect(I,X,W-I,C)}else e?d.setBlend(e.srcBlend,e.destBlend):b&&d.setBlend(b.srcBlend,b.destBlend),d.setRenderingToTexture(m);d.setTexture(l[u]);d.resetModelView();d.translate(-g,-r);d.updateModelView();d.quadTex(w,M,x,M,x,J,w,J,v);L!==q||
P||d.setTexture(null)}else{d.setRenderingToTexture(l[n]);C=R-E;X=c-E-C;d.clearRect(I,X,W-I,C);if(e){X=u=0;var Q=C=1,T=1/e.width,ea=1/e.height;e.curFrame&&e.curFrame.sheetTex&&(u=e.curFrame.sheetTex.left,X=e.curFrame.sheetTex.top,C=e.curFrame.sheetTex.right,Q=e.curFrame.sheetTex.bottom,e.curFrame.texture_img&&(T=1/e.curFrame.texture_img.width,ea=1/e.curFrame.texture_img.height));d.setProgramParameters(m,T,ea,u,X,C,Q,u,X,C,Q,e.bbox.left,e.bbox.top,e.bbox.right,e.bbox.bottom,K.left,K.top,K.right,K.bottom,
a,t,this.runtime.kahanTime.sum,e.effect_params[D]);e.drawGL(d)}else d.setProgramParameters(m,1/H,1/c,0,0,1,1,0,0,1,1,f,z,p,k,0,0,1,1,a,t,this.runtime.kahanTime.sum,b?b.effect_params[D]:this.effect_params[D]),d.setTexture(b?this.runtime.layer_tex:this.runtime.layout_tex),d.resetModelView(),d.translate(-g,-r),d.updateModelView(),d.quadTex(w,M,x,M,x,J,w,J,v);K.left=K.top=0;K.right=K.bottom=1;e&&!P&&(D=M,M=J,J=D)}n=0===n?1:0;u=0===n?1:0}P&&(d.switchProgram(0),e?d.setBlend(e.srcBlend,e.destBlend):b?d.setBlend(b.srcBlend,
b.destBlend):this.runtime.fullscreenScalingQuality||(d.setSize(this.runtime.width,this.runtime.height),g=this.runtime.width/2,r=this.runtime.height/2,J=w=0,x=this.runtime.width,M=this.runtime.height),d.setRenderingToTexture(m),d.setTexture(l[u]),d.resetModelView(),d.translate(-g,-r),d.updateModelView(),e&&1===h.length&&!F?d.quadTex(w,J,x,J,x,M,w,M,v):d.quadTex(w,M,x,M,x,J,w,J,v),d.setTexture(null))};f.prototype.getLayerBySid=function(d){var b;var e=0;for(b=this.layers.length;e<b;e++)if(this.layers[e].sid===
d)return this.layers[e];return null};f.prototype.saveToJSON=function(){var d,b={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var e=0;for(d=this.effect_types.length;e<d;e++){var m=this.effect_types[e];b.fx.push({name:m.name,active:m.active,params:this.effect_params[m.index]})}e=0;for(d=this.layers.length;e<d;e++)m=this.layers[e],b.layers[m.sid.toString()]=m.saveToJSON();return b};f.prototype.loadFromJSON=
function(d){var b,e,m;this.scrollX=d.sx;this.scrollY=d.sy;this.scale=d.s;this.angle=d.a;this.width=d.w;this.height=d.h;this.persist_data=d.persist;"undefined"!==typeof d.fv&&(this.first_visit=d.fv);var h=d.fx;var a=0;for(b=h.length;a<b;a++)if(e=this.getEffectByName(h[a].name))e.active=h[a].active,this.effect_params[e.index]=h[a].params;this.updateActiveEffects();a=d.layers;for(m in a)a.hasOwnProperty(m)&&(d=this.getLayerBySid(parseInt(m,10)))&&d.loadFromJSON(a[m])};cr.layout=f})();
(function(){function f(a,b){var l,d=a.length;switch(d){case 0:return!0;case 1:return a[0]===b[0];case 2:return a[0]===b[0]&&a[1]===b[1];default:for(l=0;l<d;l++)if(a[l]!==b[l])return!1;return!0}}function p(a,b){return a.index-b.index}function q(a){var b;if(2===a.length){if(a[0].index>a[1].index){var l=a[0];a[0]=a[1];a[1]=l}}else 2<a.length&&a.sort(p);a.length>=z.length&&(z.length=a.length+1);z[a.length]||(z[a.length]=[]);var d=z[a.length];l=0;for(b=d.length;l<b;l++){var e=d[l];if(f(a,e))return e}d.push(a);
return a}function n(a,b){this.runtime=a;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=b[0];a=b[1];this.events=[];var l;b=0;for(l=a.length;b<l;b++)this.init_event(a[b],null,this.events)}function u(a){this.type=a;this.instances=[];this.else_instances=[];this.select_all=!0}function m(a,b,d){this.sheet=a;this.parent=b;this.runtime=a.runtime;this.solModifiers=[];this.solModifiersIncludingParents=[];this.has_else_block=
this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;3===d[0]&&(this.group_name=d[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!d[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=d[2];this.sid=d[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var l=d[6];a=0;for(b=l.length;a<b;a++){var e=new cr.condition(this,l[a]);e.index=a;cr.seal(e);this.conditions.push(e);this.addSolModifier(e.type)}l=d[7];a=0;for(b=l.length;a<b;a++)e=new cr.action(this,l[a]),e.index=a,cr.seal(e),this.actions.push(e);if(9===d.length)for(d=d[8],a=0,b=d.length;a<b;a++)this.sheet.init_event(d[a],this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=
null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function d(a,b){var l;if(a&&(-1===b.indexOf(a)&&b.push(a),a.is_contained)){var d=0;for(l=a.container.length;d<l;d++){var e=a.container[d];a!==e&&-1===b.indexOf(e)&&b.push(e)}}}function b(a,b){this.block=a;this.sheet=a.sheet;this.runtime=a.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(b[1]);this.trigger=0<
b[3];this.fasttrigger=2===b[3];this.looping=b[4];this.inverted=b[5];this.isstatic=b[6];this.sid=b[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===b[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[b[0]],this.run=this.isstatic?this.run_static:this.run_object,b[2]?(this.behaviortype=this.type.getBehaviorByName(b[2]),this.beh_index=this.type.getBehaviorIndexByName(b[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&
this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===b.length){var l=b[9];a=0;for(b=l.length;a<b;a++){var d=new cr.parameter(this,l[a]);cr.seal(d);this.parameters.push(d)}this.results.length=l.length}}function e(a,b){this.block=a;this.sheet=a.sheet;this.runtime=a.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(b[1]);-1===b[0]?(this.type=null,this.run=this.run_system,
this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[b[0]],this.run=this.run_object,b[2]?(this.behaviortype=this.type.getBehaviorByName(b[2]),this.beh_index=this.type.getBehaviorIndexByName(b[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=b[3];this.runtime.actsBySid[this.sid.toString()]=this;if(7===b.length){var l=b[6];a=0;for(b=l.length;a<b;a++){var d=new cr.parameter(this,l[a]);cr.seal(d);this.parameters.push(d)}this.results.length=l.length}}function w(){k++;
A.length===k&&A.push(new cr.expvalue);return A[k]}function h(a,b){this.owner=a;this.block=a.block;this.sheet=a.sheet;this.runtime=a.runtime;this.type=b[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var l;switch(this.type){case 0:case 7:this.expression=new cr.expNode(this,b[1]);this.solindex=0;this.get=this.get_exp;
break;case 1:case 14:this.expression=new cr.expNode(this,b[1]);this.solindex=0;this.get=this.get_exp_str;14===this.type&&(this.block.setAllSolModifiers(),this.owner instanceof cr.action&&this.block.setSolWriterAfterCnds());break;case 5:this.expression=new cr.expNode(this,b[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=b[1];this.get=this.get_combosel;break;case 16:this.combosel=b[1]?1:0;this.get=this.get_boolean;break;case 6:this.layout=this.runtime.layouts[b[1]];this.get=
this.get_layout;break;case 9:this.key=b[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[b[1]];this.get=this.get_object;this.block.addSolModifier(this.object);this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=b[1];a.type&&a.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=b[1];this.eventvar=null;
this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=b[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],a=1,l=b.length;a<l;a++){var d=new cr.parameter(this.owner,b[a]);cr.seal(d);this.subparams.push(d);this.variadicret.push(0)}}}function a(a,b,d){this.sheet=a;this.parent=b;this.runtime=a.runtime;this.solModifiers=[];this.name=d[1];this.vartype=d[2];this.initial=d[3];this.is_static=!!d[4];this.is_constant=!!d[5];this.sid=d[6];
this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function t(a,b,d){this.sheet=a;this.parent=b;this.runtime=a.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=d[1];this.active=!0}function y(){this.temp_parents_arr=[];this.reset(null);cr.seal(this)}var z=
[];n.prototype.toString=function(){return this.name};n.prototype.init_event=function(a,b,d){switch(a[0]){case 0:case 3:a=new cr.eventblock(this,b,a);cr.seal(a);if(a.orblock)for(d.push(a),d=0,b=a.conditions.length;d<b;d++)a.conditions[d].trigger&&this.init_trigger(a,d);else a.is_trigger()?this.init_trigger(a,0):d.push(a);break;case 1:a=new cr.eventvariable(this,b,a);cr.seal(a);d.push(a);break;case 2:a=new cr.eventinclude(this,b,a),cr.seal(a),d.push(a)}};n.prototype.postInit=function(){var a;var b=
0;for(a=this.events.length;b<a;b++)this.events[b].postInit(b<a-1&&this.events[b+1].is_else_block)};n.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes);cr.clearArray(this.already_included_sheets);this.addDeepIncludes(this);cr.clearArray(this.already_included_sheets)};n.prototype.addDeepIncludes=function(a){var b,d=a.deep_includes,l=a.already_included_sheets,e=this.includes.valuesRef();var k=0;for(b=e.length;k<b;++k){var c=e[k];var g=c.include_sheet;!c.isActive()||a===g||-1<
l.indexOf(g)||(l.push(g),g.addDeepIncludes(a),d.push(g))}};n.prototype.run=function(a){this.runtime.resuming_breakpoint||(this.hasRun=!0,a||(this.runtime.isRunningEvents=!0));var b;var d=0;for(b=this.events.length;d<b;d++){var l=this.events[d];l.run();this.runtime.clearSol(l.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}a||(this.runtime.isRunningEvents=!1)};n.prototype.init_trigger=function(a,b){a.orblock||this.runtime.triggers_to_postinit.push(a);var d,l,e=a.conditions[b];
var k=e.type?e.type.name:"system";var c=(d=e.fasttrigger)?this.fasttriggers:this.triggers;c[k]||(c[k]=[]);k=c[k];c=e.func;if(d){if(e.parameters.length&&(e=e.parameters[0],1===e.type&&2===e.expression.type)){e=e.expression.value.toLowerCase();d=0;for(l=k.length;d<l;d++)if(k[d].method==c){d=k[d].evs;d[e]?d[e].push([a,b]):d[e]=[[a,b]];return}d={};d[e]=[[a,b]];k.push({method:c,evs:d})}}else{d=0;for(l=k.length;d<l;d++)if(k[d].method==c){k[d].evs.push([a,b]);return}e=cr.plugins_.Sprite&&c===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?
!0:!1;e?k.unshift({method:c,evs:[[a,b]]}):k.push({method:c,evs:[[a,b]]})}};cr.eventsheet=n;u.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};u.prototype.getObjects=function(){return this.select_all?this.type.instances:this.instances};u.prototype.pick_one=function(a){a&&(a.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,a.type.instances),this.select_all=
!1),a=this.else_instances.indexOf(a),-1!==a&&(this.instances.push(this.else_instances[a]),this.else_instances.splice(a,1))):(this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=a))};cr.selection=u;m.prototype.postInit=function(a){var b,d=this.parent;if(this.group)for(this.toplevelgroup=!0;d;){if(!d.group){this.toplevelgroup=!1;break}d=d.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!a;d=this.runtime.types_by_index;
if(this.solModifiers===d)this.solModifiersIncludingParents=d;else{this.solModifiersIncludingParents=this.solModifiers.slice(0);for(d=this.parent;d;){a=0;for(b=d.solModifiers.length;a<b;a++)this.addParentSolModifier(d.solModifiers[a]);d=d.parent}this.solModifiers=q(this.solModifiers);this.solModifiersIncludingParents=q(this.solModifiersIncludingParents)}a=0;for(b=this.conditions.length;a<b;a++)this.conditions[a].postInit();a=0;for(b=this.actions.length;a<b;a++)this.actions[a].postInit();a=0;for(b=
this.subevents.length;a<b;a++)this.subevents[a].postInit(a<b-1&&this.subevents[a+1].is_else_block)};m.prototype.setGroupActive=function(a){if(this.group_active!==!!a){this.group_active=!!a;var b;a=0;for(b=this.contained_includes.length;a<b;++a)this.contained_includes[a].updateActive();0<b&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};m.prototype.addSolModifier=function(a){d(a,this.solModifiers)};m.prototype.addParentSolModifier=function(a){d(a,
this.solModifiersIncludingParents)};m.prototype.setAllSolModifiers=function(){this.solModifiers=this.runtime.types_by_index};m.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};m.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};m.prototype.run=function(){var a,b=!1,d=this.runtime,e=this.runtime.getCurrentEventStack();e.current_event=this;var k=this.conditions;this.is_else_block||(e.else_branch_ran=
!1);if(this.orblock){0===k.length&&(b=!0);e.cndindex=0;for(a=k.length;e.cndindex<a;e.cndindex++){var h=k[e.cndindex];h.trigger||(h=h.run())&&(b=!0)}(e.last_event_true=b)&&this.run_actions_and_subevents()}else{e.cndindex=0;for(a=k.length;e.cndindex<a;e.cndindex++)if(h=k[e.cndindex].run(),!h){e.last_event_true=!1;this.toplevelevent&&d.hasPendingInstances&&d.ClearDeathRow();return}e.last_event_true=!0;this.run_actions_and_subevents()}this.end_run(e)};m.prototype.end_run=function(a){a.last_event_true&&
this.has_else_block&&(a.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};m.prototype.run_orblocktrigger=function(a){this.runtime.getCurrentEventStack().current_event=this;this.conditions[a].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};m.prototype.run_actions_and_subevents=function(){var a=this.runtime.getCurrentEventStack(),b;a.actindex=0;for(b=this.actions.length;a.actindex<b;a.actindex++)if(this.actions[a.actindex].run())return;
this.run_subevents()};m.prototype.resume_actions_and_subevents=function(){var a=this.runtime.getCurrentEventStack(),b;for(b=this.actions.length;a.actindex<b;a.actindex++)if(this.actions[a.actindex].run())return;this.run_subevents()};m.prototype.run_subevents=function(){if(this.subevents.length){var a,b,d=this.subevents.length-1;this.runtime.pushEventStack(this);if(this.solWriterAfterCnds){var e=0;for(a=this.subevents.length;e<a;e++){var k=this.subevents[e];(b=!this.toplevelgroup||!this.group&&e<d)&&
this.runtime.pushCopySol(k.solModifiers);k.run();b?this.runtime.popSol(k.solModifiers):this.runtime.clearSol(k.solModifiers)}}else for(e=0,a=this.subevents.length;e<a;e++)this.subevents[e].run();this.runtime.popEventStack()}};m.prototype.run_pretrigger=function(){var a=this.runtime.getCurrentEventStack();a.current_event=this;var b=!1,d;a.cndindex=0;for(d=this.conditions.length;a.cndindex<d;a.cndindex++)if(this.conditions[a.cndindex].run())b=!0;else if(!this.orblock)return!1;return this.orblock?b:
!0};m.prototype.retrigger=function(){this.runtime.execcount++;var a=this.runtime.getCurrentEventStack().cndindex,b=this.runtime.pushEventStack(this);if(!this.orblock)for(b.cndindex=a+1,a=this.conditions.length;b.cndindex<a;b.cndindex++)if(!this.conditions[b.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};m.prototype.isFirstConditionOfType=function(a){var b=a.index;if(0===b)return!0;for(--b;0<=b;--b)if(this.conditions[b].type===
a.type)return!1;return!0};cr.eventblock=m;b.prototype.postInit=function(){var a;var b=0;for(a=this.parameters.length;b<a;b++){var d=this.parameters[b];d.postInit();d.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};b.prototype.run_true=function(){return!0};b.prototype.run_system=function(){var a;var b=0;for(a=this.parameters.length;b<a;b++)this.results[b]=this.parameters[b].get();return cr.xor(this.func.apply(this.runtime.system,this.results),this.inverted)};b.prototype.run_static=function(){var a;
var b=0;for(a=this.parameters.length;b<a;b++)this.results[b]=this.parameters[b].get();b=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return b};b.prototype.run_object=function(){var a,b,d,e=this.type,k=e.getCurrentSol(),h=this.block.orblock&&!this.trigger,c=e.is_contained,g=e.is_family,r=e.family_index,m=this.beh_index,t=-1<m,f=this.anyParamVariesPerInstance,z=this.parameters,p=this.results,y=this.inverted,q=this.func;if(f){var n=0;for(b=
z.length;n<b;++n){var A=z[n];A.variesPerInstance||(p[n]=A.get(0))}}else for(n=0,b=z.length;n<b;++n)p[n]=z[n].get(0);if(k.select_all){cr.clearArray(k.instances);cr.clearArray(k.else_instances);var u=e.instances;var w=0;for(a=u.length;w<a;++w){var F=u[w];if(f)for(n=0,b=z.length;n<b;++n)A=z[n],A.variesPerInstance&&(p[n]=A.get(w));t?(n=0,g&&(n=F.type.family_beh_map[r]),n=q.apply(F.behavior_insts[m+n],p)):n=q.apply(F,p);(d=cr.xor(n,y))?k.instances.push(F):h&&k.else_instances.push(F)}e.finish&&e.finish(!0);
k.select_all=!1;e.applySolToContainer();return k.hasObjects()}var P=0;u=(d=h&&!this.block.isFirstConditionOfType(this))?k.else_instances:k.instances;var L=!1;w=0;for(a=u.length;w<a;++w){F=u[w];if(f)for(n=0,b=z.length;n<b;++n)A=z[n],A.variesPerInstance&&(p[n]=A.get(w));t?(n=0,g&&(n=F.type.family_beh_map[r]),n=q.apply(F.behavior_insts[m+n],p)):n=q.apply(F,p);if(cr.xor(n,y))if(L=!0,d){if(k.instances.push(F),c)for(n=0,b=F.siblings.length;n<b;n++)A=F.siblings[n],A.type.getCurrentSol().instances.push(A)}else{u[P]=
F;if(c)for(n=0,b=F.siblings.length;n<b;n++)A=F.siblings[n],A.type.getCurrentSol().instances[P]=A;P++}else if(d){u[P]=F;if(c)for(n=0,b=F.siblings.length;n<b;n++)A=F.siblings[n],A.type.getCurrentSol().else_instances[P]=A;P++}else if(h&&(k.else_instances.push(F),c))for(n=0,b=F.siblings.length;n<b;n++)A=F.siblings[n],A.type.getCurrentSol().else_instances.push(A)}cr.truncateArray(u,P);if(c)for(g=e.container,w=0,a=g.length;w<a;w++)F=g[w].getCurrentSol(),d?cr.truncateArray(F.else_instances,P):cr.truncateArray(F.instances,
P);P=L;if(d&&!L)for(w=0,a=k.instances.length;w<a;w++){F=k.instances[w];if(f)for(n=0,b=z.length;n<b;n++)A=z[n],A.variesPerInstance&&(p[n]=A.get(w));n=t?q.apply(F.behavior_insts[m],p):q.apply(F,p);if(cr.xor(n,y)){L=!0;break}}e.finish&&e.finish(P||h);return h?L:k.hasObjects()};cr.condition=b;e.prototype.postInit=function(){var a;var b=0;for(a=this.parameters.length;b<a;b++){var d=this.parameters[b];d.postInit();d.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};e.prototype.run_system=function(){var a=
this.runtime,b,d=this.parameters,e=this.results;var k=0;for(b=d.length;k<b;++k)e[k]=d[k].get();return this.func.apply(a.system,e)};e.prototype.run_object=function(){var a=this.type,b=this.beh_index,d=a.family_index,e=this.anyParamVariesPerInstance,k=this.parameters,h=this.results,c=this.func,g=a.getCurrentSol().getObjects();a=a.is_family;var r=-1<b,m,t;if(e){var f=0;for(t=k.length;f<t;++f){var z=k[f];z.variesPerInstance||(h[f]=z.get(0))}}else for(f=0,t=k.length;f<t;++f)h[f]=k[f].get(0);var p=0;for(m=
g.length;p<m;++p){var y=g[p];if(e)for(f=0,t=k.length;f<t;++f)z=k[f],z.variesPerInstance&&(h[f]=z.get(p));r?(f=0,a&&(f=y.type.family_beh_map[d]),c.apply(y.behavior_insts[b+f],h)):c.apply(y,h)}return!1};cr.action=e;var A=[],k=-1;h.prototype.postInit=function(){var a;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var b=0;for(a=this.subparams.length;b<a;b++)this.subparams[b].postInit()}this.expression&&this.expression.postInit()};
h.prototype.maybeVaryForType=function(a){this.variesPerInstance||!a||a.plugin.singleglobal||(this.variesPerInstance=!0)};h.prototype.setVaries=function(){this.variesPerInstance=!0};h.prototype.get_exp=function(a){this.solindex=a||0;a=w();this.expression.get(a);k--;return a.data};h.prototype.get_exp_str=function(a){this.solindex=a||0;a=w();this.expression.get(a);k--;return cr.is_string(a.data)?a.data:""};h.prototype.get_object=function(){return this.object};h.prototype.get_combosel=function(){return this.combosel};
h.prototype.get_boolean=function(){return!!this.combosel};h.prototype.get_layer=function(a){this.solindex=a||0;a=w();this.expression.get(a);k--;return a.is_number()?this.runtime.getLayerByNumber(a.data):this.runtime.getLayerByName(a.data)};h.prototype.get_layout=function(){return this.layout};h.prototype.get_key=function(){return this.key};h.prototype.get_instvar=function(){return this.index};h.prototype.get_familyvar=function(a){var b=a||0;a=this.owner.type;var d=a.getCurrentSol(),e=d.getObjects();
if(e.length)b=e[b%e.length].type;else if(d.else_instances.length)b=d.else_instances[b%d.else_instances.length].type;else if(a.instances.length)b=a.instances[b%a.instances.length].type;else return 0;return this.index+b.family_var_map[a.family_index]};h.prototype.get_eventvar=function(){return this.eventvar};h.prototype.get_audiofile=function(){return this.fileinfo};h.prototype.get_variadic=function(){var a;var b=0;for(a=this.subparams.length;b<a;b++)this.variadicret[b]=this.subparams[b].get();return this.variadicret};
cr.parameter=h;a.prototype.postInit=function(){this.solModifiers=q(this.solModifiers)};a.prototype.setValue=function(a){var b=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&b?(this.localIndex>=b.length&&(b.length=this.localIndex+1),b[this.localIndex]=a):this.data=a};a.prototype.getValue=function(){var a=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!a||this.is_constant?this.data:this.localIndex>=a.length||"undefined"===typeof a[this.localIndex]?this.initial:
a[this.localIndex]};a.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)};cr.eventvariable=a;t.prototype.toString=function(){return"include:"+this.include_sheet.toString()};t.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=q(this.solModifiers);for(var a=this.parent;a;)a.group&&a.contained_includes.push(this),a=a.parent;this.updateActive()};t.prototype.run=
function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};t.prototype.updateActive=function(){for(var a=this.parent;a;){if(a.group&&!a.group_active){this.active=!1;return}a=a.parent}this.active=!0};t.prototype.isActive=function(){return this.active};cr.eventinclude=t;y.prototype.reset=function(a){this.current_event=a;this.actindex=this.cndindex=0;cr.clearArray(this.temp_parents_arr);
this.any_true_state=this.else_branch_ran=this.last_event_true=!1};y.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr.eventStackFrame=y})();
(function(){function f(d,b){this.owner=d;this.runtime=d.runtime;this.type=b[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var e=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=b[1];break;case 3:this.first=new cr.expNode(d,b[1]);break;case 18:this.first=new cr.expNode(d,b[1]);this.second=new cr.expNode(d,b[2]);this.third=new cr.expNode(d,b[3]);
break;case 19:this.func=this.runtime.GetObjectReference(b[1]);this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===b.length?(e=b[2],this.results.length=e.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[b[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(b[2]);this.return_string=b[3];cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&
this.owner.setVaries();this.instance_expr=b[4]?new cr.expNode(d,b[4]):null;this.results=[];this.parameters=[];6===b.length?(e=b[5],this.results.length=e.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[b[1]];this.return_string=b[2];this.instance_expr=b[3]?new cr.expNode(d,b[3]):null;this.varindex=b[4];break;case 22:this.object_type=this.runtime.types_by_index[b[1]];this.behavior_type=this.object_type.getBehaviorByName(b[2]);this.beh_index=this.object_type.getBehaviorIndexByName(b[2]);
this.func=this.runtime.GetObjectReference(b[3]);this.return_string=b[4];this.instance_expr=b[5]?new cr.expNode(d,b[5]):null;this.results=[];this.parameters=[];7===b.length?(e=b[6],this.results.length=e.length+1):this.results.length=1;break;case 23:this.varname=b[1],this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr.expNode(d,b[1]),this.second=new cr.expNode(d,b[2]));if(e){var m;b=0;for(m=e.length;b<m;b++)this.parameters.push(new cr.expNode(d,
e[b]))}cr.seal(this)}function p(){++m;u.length===m&&u.push(new cr.expvalue);return u[m]}function q(d,b,e){var m;var h=0;for(m=d.length;h<m;++h)d[h].get(e),b[h+1]=e.data}function n(d,b){this.type=d||cr.exptype.Integer;this.data=b||0;this.object_class=null;this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data));cr.seal(this)}f.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();
this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&this.instance_expr.postInit();if(this.parameters){var d;var b=0;for(d=this.parameters.length;b<d;b++)this.parameters[b].postInit()}};var u=[],m=-1;f.prototype.eval_system_exp=function(d){var b=this.parameters,e=this.results;e[0]=d;d=p();q(b,e,d);--m;this.func.apply(this.runtime.system,e)};f.prototype.eval_object_exp=function(d){var b=this.object_type,e=this.results,f=this.parameters,h=this.instance_expr,a=this.func,
t=this.owner.solindex,y=b.getCurrentSol(),z=y.getObjects();if(!z.length)if(y.else_instances.length)z=y.else_instances;else{this.return_string?d.set_string(""):d.set_int(0);return}e[0]=d;d.object_class=b;d=p();q(f,e,d);h&&(h.get(d),d.is_number()&&(t=d.data,z=b.instances));--m;b=z.length;if(t>=b||t<=-b)t%=b;0>t&&(t+=b);a.apply(z[t],e)};f.prototype.eval_behavior_exp=function(d){var b=this.object_type,e=this.results,f=this.parameters,h=this.instance_expr,a=this.beh_index,t=this.func,y=this.owner.solindex,
z=b.getCurrentSol(),n=z.getObjects();if(!n.length)if(z.else_instances.length)n=z.else_instances;else{this.return_string?d.set_string(""):d.set_int(0);return}e[0]=d;d.object_class=b;d=p();q(f,e,d);h&&(h.get(d),d.is_number()&&(y=d.data,n=b.instances));--m;f=n.length;if(y>=f||y<=-f)y%=f;0>y&&(y+=f);y=n[y];n=0;b.is_family&&(n=y.type.family_beh_map[b.family_index]);t.apply(y.behavior_insts[a+n],e)};f.prototype.eval_instvar_exp=function(d){var b=this.instance_expr,e=this.object_type,f=this.varindex,h=this.owner.solindex,
a=e.getCurrentSol(),t=a.getObjects();if(!t.length)if(a.else_instances.length)t=a.else_instances;else{this.return_string?d.set_string(""):d.set_int(0);return}if(b){a=p();b.get(a);if(a.is_number()){h=a.data;t=e.instances;0!==t.length&&(h%=t.length,0>h&&(h+=t.length));h=e.getInstanceByIID(h);e=h.instance_vars[f];cr.is_string(e)?d.set_string(e):d.set_float(e);--m;return}--m}b=t.length;if(h>=b||h<=-b)h%=b;0>h&&(h+=b);h=t[h];t=0;e.is_family&&(t=h.type.family_var_map[e.family_index]);e=h.instance_vars[f+
t];cr.is_string(e)?d.set_string(e):d.set_float(e)};f.prototype.eval_int=function(d){d.type=cr.exptype.Integer;d.data=this.value};f.prototype.eval_float=function(d){d.type=cr.exptype.Float;d.data=this.value};f.prototype.eval_string=function(d){d.type=cr.exptype.String;d.data=this.value};f.prototype.eval_unaryminus=function(d){this.first.get(d);d.is_number()&&(d.data=-d.data)};f.prototype.eval_add=function(d){this.first.get(d);var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data+=b.data,
b.is_float()&&d.make_float());--m};f.prototype.eval_subtract=function(d){this.first.get(d);var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data-=b.data,b.is_float()&&d.make_float());--m};f.prototype.eval_multiply=function(d){this.first.get(d);var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data*=b.data,b.is_float()&&d.make_float());--m};f.prototype.eval_divide=function(d){this.first.get(d);var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data/=b.data,d.make_float());
--m};f.prototype.eval_mod=function(d){this.first.get(d);var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data%=b.data,b.is_float()&&d.make_float());--m};f.prototype.eval_power=function(d){this.first.get(d);var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data=Math.pow(d.data,b.data),b.is_float()&&d.make_float());--m};f.prototype.eval_and=function(d){this.first.get(d);var b=p();this.second.get(b);b.is_string()||d.is_string()?this.eval_and_stringconcat(d,b):this.eval_and_logical(d,
b);--m};f.prototype.eval_and_stringconcat=function(d,b){d.is_string()&&b.is_string()?this.eval_and_stringconcat_str_str(d,b):this.eval_and_stringconcat_num(d,b)};f.prototype.eval_and_stringconcat_str_str=function(d,b){d.data+=b.data};f.prototype.eval_and_stringconcat_num=function(d,b){d.is_string()?d.data+=(Math.round(1E10*b.data)/1E10).toString():d.set_string(d.data.toString()+b.data)};f.prototype.eval_and_logical=function(d,b){d.set_int(d.data&&b.data?1:0)};f.prototype.eval_or=function(d){this.first.get(d);
var b=p();this.second.get(b);d.is_number()&&b.is_number()&&(d.data||b.data?d.set_int(1):d.set_int(0));--m};f.prototype.eval_conditional=function(d){this.first.get(d);d.data?this.second.get(d):this.third.get(d)};f.prototype.eval_equal=function(d){this.first.get(d);var b=p();this.second.get(b);d.set_int(d.data===b.data?1:0);--m};f.prototype.eval_notequal=function(d){this.first.get(d);var b=p();this.second.get(b);d.set_int(d.data!==b.data?1:0);--m};f.prototype.eval_less=function(d){this.first.get(d);
var b=p();this.second.get(b);d.set_int(d.data<b.data?1:0);--m};f.prototype.eval_lessequal=function(d){this.first.get(d);var b=p();this.second.get(b);d.set_int(d.data<=b.data?1:0);--m};f.prototype.eval_greater=function(d){this.first.get(d);var b=p();this.second.get(b);d.set_int(d.data>b.data?1:0);--m};f.prototype.eval_greaterequal=function(d){this.first.get(d);var b=p();this.second.get(b);d.set_int(d.data>=b.data?1:0);--m};f.prototype.eval_eventvar_exp=function(d){var b=this.eventvar.getValue();"number"===
typeof b?d.set_float(b):"boolean"===typeof b?d.set_int(b?1:0):d.set_string(b)};cr.expNode=f;n.prototype.is_int=function(){return this.type===cr.exptype.Integer};n.prototype.is_float=function(){return this.type===cr.exptype.Float};n.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float};n.prototype.is_string=function(){return this.type===cr.exptype.String};n.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&
(this.data=parseInt(this.data,10)),this.type=cr.exptype.Integer)};n.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)};n.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)};n.prototype.set_int=function(d){this.type=cr.exptype.Integer;this.data=Math.floor(d)};n.prototype.set_float=function(d){this.type=cr.exptype.Float;this.data=d};n.prototype.set_string=function(d){this.type=
cr.exptype.String;this.data=d};n.prototype.set_any=function(d){cr.is_number(d)?(this.type=cr.exptype.Float,this.data=d):cr.is_string(d)?(this.type=cr.exptype.String,this.data=d.toString()):(this.type=cr.exptype.Integer,this.data=0)};cr.expvalue=n;cr.exptype={Integer:0,Float:1,String:2}})();cr.system_object=function(f){this.runtime=f;this.waits=[]};
cr.system_object.prototype.saveToJSON=function(){var f={},p,q,n;f.waits=[];var u=f.waits;var m=0;for(p=this.waits.length;m<p;m++){var d=this.waits[m];var b={t:d.time,st:d.signaltag,s:d.signalled,ev:d.ev.sid,sm:[],sols:{}};d.ev.actions[d.actindex]&&(b.act=d.ev.actions[d.actindex].sid);var e=0;for(q=d.solModifiers.length;e<q;e++)b.sm.push(d.solModifiers[e].sid);for(n in d.sols)if(d.sols.hasOwnProperty(n)){var w=this.runtime.types_by_index[parseInt(n,10)];var h={sa:d.sols[n].sa,insts:[]};e=0;for(q=d.sols[n].insts.length;e<
q;e++)h.insts.push(d.sols[n].insts[e].uid);b.sols[w.sid.toString()]=h}u.push(b)}return f};
cr.system_object.prototype.loadFromJSON=function(f){f=f.waits;var p,q,n,u,m;cr.clearArray(this.waits);var d=0;for(p=f.length;d<p;d++){var b=f[d];if(u=this.runtime.blocksBySid[b.ev.toString()]){var e=-1;var w=0;for(q=u.actions.length;w<q;w++)if(u.actions[w].sid===b.act){e=w;break}if(-1!==e){var h={sols:{},solModifiers:[],deleteme:!1};h.time=b.t;h.signaltag=b.st||"";h.signalled=!!b.s;h.ev=u;h.actindex=e;w=0;for(q=b.sm.length;w<q;w++)(u=this.runtime.getObjectTypeBySid(b.sm[w]))&&h.solModifiers.push(u);
for(n in b.sols)if(b.sols.hasOwnProperty(n)&&(u=this.runtime.getObjectTypeBySid(parseInt(n,10)))){e=b.sols[n];var a={sa:e.sa,insts:[]};w=0;for(q=e.insts.length;w<q;w++)(m=this.runtime.getObjectByUID(e.insts[w]))&&a.insts.push(m);h.sols[u.index.toString()]=a}this.waits.push(h)}}}};
(function(){function f(){}function p(c,a){c=c.extra.c2_feo_val;a=a.extra.c2_feo_val;if(cr.is_number(c)&&cr.is_number(a))return c-a;c=""+c;a=""+a;return c<a?-1:c>a?1:0}function q(c,a){y&&c===z&&a===A||(y=new RegExp(c,a),z=c,A=a);y.lastIndex=0;return y}function n(){}function u(){var c=l.length?l.pop():{sols:{},solModifiers:[]};c.deleteme=!1;return c}function m(){var c=B.length?B.pop():{insts:[]};c.sa=!1;return c}function d(c,a){var g=c[0]-a[0];return 0!==g?g:c[1]-a[1]}function b(c,a){return c[1]-a[1]}
function e(){}function w(c,a,b){if(c!==N||a!==U||b!==H){var g=q(a,b);G=c.match(g);N=c;U=a;H=b}}var h=cr.system_object.prototype;f.prototype.EveryTick=function(){return!0};f.prototype.OnLayoutStart=function(){return!0};f.prototype.OnLayoutEnd=function(){return!0};f.prototype.Compare=function(c,a,b){return cr.do_cmp(c,a,b)};f.prototype.CompareTime=function(c,a){var g=this.runtime.kahanTime.sum;return 0===c?(c=this.runtime.getCurrentCondition(),!c.extra.CompareTime_executed&&g>=a?c.extra.CompareTime_executed=
!0:!1):cr.do_cmp(g,c,a)};f.prototype.LayerVisible=function(c){return c?c.visible:!1};f.prototype.LayerEmpty=function(c){return c?!c.instances.length:!1};f.prototype.LayerCmpOpacity=function(c,a,b){return c?cr.do_cmp(100*c.opacity,a,b):!1};f.prototype.Repeat=function(c){var a=this.runtime.getCurrentEventStack(),b=a.current_event,d=a.isModifierAfterCnds();a=this.runtime.pushLoopStack();if(d)for(d=0;d<c&&!a.stopped;d++)this.runtime.pushCopySol(b.solModifiers),a.index=d,b.retrigger(),this.runtime.popSol(b.solModifiers);
else for(d=0;d<c&&!a.stopped;d++)a.index=d,b.retrigger();this.runtime.popLoopStack();return!1};f.prototype.While=function(c){var a=this.runtime.getCurrentEventStack();c=a.current_event;var b=a.isModifierAfterCnds();a=this.runtime.pushLoopStack();if(b)for(b=0;!a.stopped;b++)this.runtime.pushCopySol(c.solModifiers),a.index=b,c.retrigger()||(a.stopped=!0),this.runtime.popSol(c.solModifiers);else for(b=0;!a.stopped;b++)a.index=b,c.retrigger()||(a.stopped=!0);this.runtime.popLoopStack();return!1};f.prototype.For=
function(c,a,b){var g=this.runtime.getCurrentEventStack(),d=g.current_event;g=g.isModifierAfterCnds();c=this.runtime.pushLoopStack(c);if(b<a)if(g)for(;a>=b&&!c.stopped;--a)this.runtime.pushCopySol(d.solModifiers),c.index=a,d.retrigger(),this.runtime.popSol(d.solModifiers);else for(;a>=b&&!c.stopped;--a)c.index=a,d.retrigger();else if(g)for(;a<=b&&!c.stopped;++a)this.runtime.pushCopySol(d.solModifiers),c.index=a,d.retrigger(),this.runtime.popSol(d.solModifiers);else for(;a<=b&&!c.stopped;++a)c.index=
a,d.retrigger();this.runtime.popLoopStack();return!1};var a=[],t=-1;f.prototype.ForEach=function(c){var g=c.getCurrentSol();t++;a.length===t&&a.push([]);var b=a[t];cr.shallowAssignArray(b,g.getObjects());var d=this.runtime.getCurrentEventStack(),e=d.current_event,k=d.isModifierAfterCnds();d=this.runtime.pushLoopStack();var l,h,m=c.is_contained;if(k)for(k=0,l=b.length;k<l&&!d.stopped;k++){this.runtime.pushCopySol(e.solModifiers);var f=b[k];g=c.getCurrentSol();g.select_all=!1;cr.clearArray(g.instances);
g.instances[0]=f;if(m){var z=0;for(h=f.siblings.length;z<h;z++){var p=f.siblings[z];var y=p.type.getCurrentSol();y.select_all=!1;cr.clearArray(y.instances);y.instances[0]=p}}d.index=k;e.retrigger();this.runtime.popSol(e.solModifiers)}else for(g.select_all=!1,cr.clearArray(g.instances),k=0,l=b.length;k<l&&!d.stopped;k++){f=b[k];g.instances[0]=f;if(m)for(z=0,h=f.siblings.length;z<h;z++)p=f.siblings[z],y=p.type.getCurrentSol(),y.select_all=!1,cr.clearArray(y.instances),y.instances[0]=p;d.index=k;e.retrigger()}cr.clearArray(b);
this.runtime.popLoopStack();t--;return!1};f.prototype.ForEachOrdered=function(c,g,b){g=c.getCurrentSol();t++;a.length===t&&a.push([]);var d=a[t];cr.shallowAssignArray(d,g.getObjects());var e=this.runtime.getCurrentEventStack(),k=e.current_event,l=this.runtime.getCurrentCondition(),h=e.isModifierAfterCnds();e=this.runtime.pushLoopStack();var m;var r=0;for(m=d.length;r<m;r++)d[r].extra.c2_feo_val=l.parameters[1].get(r);d.sort(p);1===b&&d.reverse();b=c.is_contained;if(h)for(r=0,m=d.length;r<m&&!e.stopped;r++){this.runtime.pushCopySol(k.solModifiers);
var f=d[r];g=c.getCurrentSol();g.select_all=!1;cr.clearArray(g.instances);g.instances[0]=f;if(b)for(l=0,h=f.siblings.length;l<h;l++){var z=f.siblings[l];var y=z.type.getCurrentSol();y.select_all=!1;cr.clearArray(y.instances);y.instances[0]=z}e.index=r;k.retrigger();this.runtime.popSol(k.solModifiers)}else for(g.select_all=!1,cr.clearArray(g.instances),r=0,m=d.length;r<m&&!e.stopped;r++){f=d[r];g.instances[0]=f;if(b)for(l=0,h=f.siblings.length;l<h;l++)z=f.siblings[l],y=z.type.getCurrentSol(),y.select_all=
!1,cr.clearArray(y.instances),y.instances[0]=z;e.index=r;k.retrigger()}cr.clearArray(d);this.runtime.popLoopStack();t--;return!1};f.prototype.PickByComparison=function(c,g,b,d){var e,k;if(c){t++;a.length===t&&a.push([]);var l=a[t],h=c.getCurrentSol();cr.shallowAssignArray(l,h.getObjects());h.select_all&&cr.clearArray(h.else_instances);var r=this.runtime.getCurrentCondition();var m=e=0;for(k=l.length;e<k;e++){var f=l[e];l[m]=f;g=r.parameters[1].get(e);d=r.parameters[3].get(e);cr.do_cmp(g,b,d)?m++:
h.else_instances.push(f)}cr.truncateArray(l,m);h.select_all=!1;cr.shallowAssignArray(h.instances,l);cr.clearArray(l);t--;c.applySolToContainer();return!!h.instances.length}};f.prototype.PickByEvaluate=function(c,g){var b,d;if(c){t++;a.length===t&&a.push([]);var e=a[t],k=c.getCurrentSol();cr.shallowAssignArray(e,k.getObjects());k.select_all&&cr.clearArray(k.else_instances);var l=this.runtime.getCurrentCondition();var h=b=0;for(d=e.length;b<d;b++){var m=e[b];e[h]=m;(g=l.parameters[1].get(b))?h++:k.else_instances.push(m)}cr.truncateArray(e,
h);k.select_all=!1;cr.shallowAssignArray(k.instances,e);cr.clearArray(e);t--;c.applySolToContainer();return!!k.instances.length}};f.prototype.TriggerOnce=function(){var c=this.runtime.getCurrentCondition().extra;"undefined"===typeof c.TriggerOnce_lastTick&&(c.TriggerOnce_lastTick=-1);var a=c.TriggerOnce_lastTick,b=this.runtime.tickcount;c.TriggerOnce_lastTick=b;return this.runtime.layout_first_tick||a!==b-1};f.prototype.Every=function(c){var a=this.runtime.getCurrentCondition(),b=a.extra.Every_lastTime||
0,d=this.runtime.kahanTime.sum;"undefined"===typeof a.extra.Every_seconds&&(a.extra.Every_seconds=c);var e=a.extra.Every_seconds;if(d>=b+e)return a.extra.Every_lastTime=b+e,d>=a.extra.Every_lastTime+.04&&(a.extra.Every_lastTime=d),a.extra.Every_seconds=c,!0;d<b-.1&&(a.extra.Every_lastTime=d);return!1};f.prototype.PickNth=function(c,a){if(!c)return!1;var b=c.getCurrentSol(),g=b.getObjects();a=cr.floor(a);if(0>a||a>=g.length)return!1;b.pick_one(g[a]);c.applySolToContainer();return!0};f.prototype.PickRandom=
function(c){if(!c)return!1;var a=c.getCurrentSol(),b=a.getObjects(),d=cr.floor(Math.random()*b.length);if(d>=b.length)return!1;a.pick_one(b[d]);c.applySolToContainer();return!0};f.prototype.CompareVar=function(c,a,b){return cr.do_cmp(c.getValue(),a,b)};f.prototype.CompareBoolVar=function(c){return c.getValue()};f.prototype.IsGroupActive=function(c){return(c=this.runtime.groups_by_name[c.toLowerCase()])&&c.group_active};f.prototype.IsPreview=function(){return this.runtime.isPreview};f.prototype.PickAll=
function(c){if(!c||!c.instances.length)return!1;c.getCurrentSol().select_all=!0;c.applySolToContainer();return!0};f.prototype.IsMobile=function(){return this.runtime.isMobile};f.prototype.CompareBetween=function(c,a,b){return c>=a&&c<=b};f.prototype.Else=function(){var c=this.runtime.getCurrentEventStack();return c.else_branch_ran?!1:!c.last_event_true};f.prototype.OnLoadFinished=function(){return!0};f.prototype.OnCanvasSnapshot=function(){return!0};f.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};
f.prototype.OnSaveComplete=function(){return!0};f.prototype.OnSaveFailed=function(){return!0};f.prototype.OnLoadComplete=function(){return!0};f.prototype.OnLoadFailed=function(){return!0};f.prototype.ObjectUIDExists=function(c){return!!this.runtime.getObjectByUID(c)};f.prototype.IsOnPlatform=function(c){var a=this.runtime;switch(c){case 0:return!a.isNodeWebkit&&!a.isCordova&&!a.isWinJS&&!a.isWindowsPhone8&&!a.isBlackberry10&&!a.isAmazonWebApp;case 1:return a.isiOS;case 2:return a.isAndroid;case 3:return a.isWindows8App;
case 4:return a.isWindowsPhone8;case 5:return a.isBlackberry10;case 6:return a.isTizen;case 7:return!1;case 8:return a.isCordova;case 9:return a.isArcade;case 10:return a.isNodeWebkit;case 11:return a.isCrosswalk;case 12:return a.isAmazonWebApp;case 13:return a.isWindows10;default:return!1}};var y=null,z="",A="";f.prototype.RegexTest=function(c,a,b){return q(a,b).test(c)};var k=[];f.prototype.PickOverlappingPoint=function(c,a,b){if(!c)return!1;var g=c.getCurrentSol(),d=g.getObjects(),e=this.runtime.getCurrentEventStack().current_event.orblock,
l=this.runtime.getCurrentCondition(),h;g.select_all?(cr.shallowAssignArray(k,d),cr.clearArray(g.else_instances),g.select_all=!1,cr.clearArray(g.instances)):e?(cr.shallowAssignArray(k,g.else_instances),cr.clearArray(g.else_instances)):(cr.shallowAssignArray(k,d),cr.clearArray(g.instances));d=0;for(e=k.length;d<e;++d){var m=k[d];m.update_bbox();(h=cr.xor(m.contains_pt(a,b),l.inverted))?g.instances.push(m):g.else_instances.push(m)}c.applySolToContainer();return cr.xor(!!g.instances.length,l.inverted)};
f.prototype.PickLastCreated=function(c){if(!c)return!1;var a=this.runtime.createRow,b,d=null,e=c.is_family;for(b=a.length-1;0<=b;--b){var k=a[b];if(e){if(0<=k.type.families.indexOf(c)){d=k;break}}else if(k.type===c){d=k;break}}!d&&c.instances.length&&(d=c.instances[c.instances.length-1]);if(!d)return!1;c.getCurrentSol().pick_one(d);c.applySolToContainer();return!0};f.prototype.IsNaN=function(c){return!!isNaN(c)};f.prototype.AngleWithin=function(c,a,b){return cr.angleDiff(cr.to_radians(c),cr.to_radians(b))<=
cr.to_radians(a)};f.prototype.IsClockwiseFrom=function(c,a){return cr.angleClockwise(cr.to_radians(c),cr.to_radians(a))};f.prototype.IsBetweenAngles=function(c,a,b){c=cr.to_clamped_radians(c);a=cr.to_clamped_radians(a);b=cr.to_clamped_radians(b);return cr.angleClockwise(b,a)?cr.angleClockwise(c,a)&&!cr.angleClockwise(c,b):!(!cr.angleClockwise(c,a)&&cr.angleClockwise(c,b))};f.prototype.IsValueType=function(c,a){return"number"===typeof c?0===a:1===a};h.cnds=new f;n.prototype.GoToLayout=function(c){this.runtime.isloading||
this.runtime.changelayout||(this.runtime.changelayout=c)};n.prototype.NextPrevLayout=function(c){if(!this.runtime.isloading&&!this.runtime.changelayout){var a=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if(!c||0!==a)if(c||a!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=this.runtime.layouts_by_index[a+(c?-1:1)]}};n.prototype.CreateObject=function(c,a,b,d){if(a&&c&&(a=this.runtime.createInstance(c,a,b,d))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(c.plugin).cnds.OnCreated,
a);if(a.is_contained)for(b=0,d=a.siblings.length;b<d;b++){var g=a.siblings[b];this.runtime.trigger(Object.getPrototypeOf(g.type.plugin).cnds.OnCreated,g)}this.runtime.isInOnDestroy--;c=c.getCurrentSol();c.select_all=!1;cr.clearArray(c.instances);c.instances[0]=a;if(a.is_contained)for(b=0,d=a.siblings.length;b<d;b++)g=a.siblings[b],c=g.type.getCurrentSol(),c.select_all=!1,cr.clearArray(c.instances),c.instances[0]=g}};n.prototype.CreateObjectByName=function(c,a,b,d){a&&c&&(c=this.runtime.types_lowercase[c.toLowerCase()])&&
n.prototype.CreateObject.call(this,c,a,b,d)};n.prototype.SetLayerVisible=function(c,a){c&&c.visible!==a&&(c.visible=a,this.runtime.redraw=!0)};n.prototype.SetLayerOpacity=function(c,a){c&&(a=cr.clamp(a/100,0,1),c.opacity!==a&&(c.opacity=a,this.runtime.redraw=!0))};n.prototype.SetLayerScaleRate=function(c,a){c&&c.zoomRate!==a&&(c.zoomRate=a,this.runtime.redraw=!0)};n.prototype.SetLayerForceOwnTexture=function(c,a){c&&(a=!!a,c.forceOwnTexture!==a&&(c.forceOwnTexture=a,this.runtime.redraw=!0))};n.prototype.SetLayoutScale=
function(c){this.runtime.running_layout&&this.runtime.running_layout.scale!==c&&(this.runtime.running_layout.scale=c,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)};n.prototype.ScrollX=function(c){this.runtime.running_layout.scrollToX(c)};n.prototype.ScrollY=function(c){this.runtime.running_layout.scrollToY(c)};n.prototype.Scroll=function(c,a){this.runtime.running_layout.scrollToX(c);this.runtime.running_layout.scrollToY(a)};n.prototype.ScrollToObject=function(c){if(c=c.getFirstPicked())this.runtime.running_layout.scrollToX(c.x),
this.runtime.running_layout.scrollToY(c.y)};n.prototype.SetVar=function(c,a){0===c.vartype?cr.is_number(a)?c.setValue(a):c.setValue(parseFloat(a)):1===c.vartype&&c.setValue(a.toString())};n.prototype.AddVar=function(c,a){0===c.vartype?cr.is_number(a)?c.setValue(c.getValue()+a):c.setValue(c.getValue()+parseFloat(a)):1===c.vartype&&c.setValue(c.getValue()+a.toString())};n.prototype.SubVar=function(c,a){0===c.vartype&&(cr.is_number(a)?c.setValue(c.getValue()-a):c.setValue(c.getValue()-parseFloat(a)))};
n.prototype.SetBoolVar=function(c,a){c.setValue(0!==a)};n.prototype.ToggleBoolVar=function(c){c.setValue(!c.getValue())};n.prototype.SetGroupActive=function(c,a){if(c=this.runtime.groups_by_name[c.toLowerCase()])switch(a){case 0:c.setGroupActive(!1);break;case 1:c.setGroupActive(!0);break;case 2:c.setGroupActive(!c.group_active)}};n.prototype.SetTimescale=function(c){0>c&&(c=0);this.runtime.timescale=c};n.prototype.SetObjectTimescale=function(c,a){0>a&&(a=0);if(c){c=c.getCurrentSol().getObjects();
var b;var g=0;for(b=c.length;g<b;g++)c[g].my_timescale=a}};n.prototype.RestoreObjectTimescale=function(c){if(!c)return!1;c=c.getCurrentSol().getObjects();var a;var b=0;for(a=c.length;b<a;b++)c[b].my_timescale=-1};var l=[],B=[];n.prototype.Wait=function(c){if(!(0>c)){var a,b=this.runtime.getCurrentEventStack(),d=u();d.time=this.runtime.kahanTime.sum+c;d.signaltag="";d.signalled=!1;d.ev=b.current_event;d.actindex=b.actindex+1;c=0;for(a=this.runtime.types_by_index.length;c<a;c++){var e=this.runtime.types_by_index[c];
var k=e.getCurrentSol();k.select_all&&-1===b.current_event.solModifiers.indexOf(e)||(d.solModifiers.push(e),e=m(),e.sa=k.select_all,cr.shallowAssignArray(e.insts,k.instances),d.sols[c.toString()]=e)}this.waits.push(d);return!0}};n.prototype.WaitForSignal=function(c){var a,b=this.runtime.getCurrentEventStack(),d=u();d.time=-1;d.signaltag=c.toLowerCase();d.signalled=!1;d.ev=b.current_event;d.actindex=b.actindex+1;c=0;for(a=this.runtime.types_by_index.length;c<a;c++){var e=this.runtime.types_by_index[c];
var k=e.getCurrentSol();k.select_all&&-1===b.current_event.solModifiers.indexOf(e)||(d.solModifiers.push(e),e=m(),e.sa=k.select_all,cr.shallowAssignArray(e.insts,k.instances),d.sols[c.toString()]=e)}this.waits.push(d);return!0};n.prototype.Signal=function(c){c=c.toLowerCase();var a;var b=0;for(a=this.waits.length;b<a;++b){var d=this.waits[b];-1===d.time&&d.signaltag===c&&(d.signalled=!0)}};n.prototype.SetLayerScale=function(c,a){c&&c.scale!==a&&(c.scale=a,this.runtime.redraw=!0)};n.prototype.ResetGlobals=
function(){var c;var a=0;for(c=this.runtime.all_global_vars.length;a<c;a++){var b=this.runtime.all_global_vars[a];b.data=b.initial}};n.prototype.SetLayoutAngle=function(c){c=cr.to_radians(c);c=cr.clamp_angle(c);this.runtime.running_layout&&this.runtime.running_layout.angle!==c&&(this.runtime.running_layout.angle=c,this.runtime.redraw=!0)};n.prototype.SetLayerAngle=function(c,a){c&&(a=cr.to_radians(a),a=cr.clamp_angle(a),c.angle!==a&&(c.angle=a,this.runtime.redraw=!0))};n.prototype.SetLayerParallax=
function(c,a,b){if(c&&(c.parallaxX!==a/100||c.parallaxY!==b/100)){c.parallaxX=a/100;c.parallaxY=b/100;if(1!==c.parallaxX||1!==c.parallaxY)for(b=c.instances,c=0,a=b.length;c<a;++c)b[c].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};n.prototype.SetLayerBackground=function(c,a){if(c){var b=cr.clamp(Math.floor(255*cr.GetRValue(a)),0,255),g=cr.clamp(Math.floor(255*cr.GetGValue(a)),0,255);a=cr.clamp(Math.floor(255*cr.GetBValue(a)),0,255);if(c.background_color[0]!==b||c.background_color[1]!==g||
c.background_color[2]!==a)c.background_color[0]=b,c.background_color[1]=g,c.background_color[2]=a,this.runtime.redraw=!0}};n.prototype.SetLayerTransparent=function(c,a){c&&!!a!==!!c.transparent&&(c.transparent=!!a,this.runtime.redraw=!0)};n.prototype.SetLayerBlendMode=function(c,a){c&&c.blend_mode!==a&&(c.blend_mode=a,c.compositeOp=cr.effectToCompositeOp(c.blend_mode),this.runtime.gl&&cr.setGLBlend(c,c.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};n.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||
(this.runtime.getCurrentLoop().stopped=!0)};n.prototype.GoToLayoutByName=function(c){if(!this.runtime.isloading&&!this.runtime.changelayout)for(var a in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(a)&&cr.equals_nocase(a,c)){this.runtime.changelayout=this.runtime.layouts[a];break}};n.prototype.RestartLayout=function(c){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var a;c=0;for(a=this.runtime.allGroups.length;c<
a;c++){var b=this.runtime.allGroups[c];b.setGroupActive(b.initially_activated)}}};n.prototype.SnapshotCanvas=function(c,a){this.runtime.doCanvasSnapshot(0===c?"image/png":"image/jpeg",a/100)};n.prototype.SetCanvasSize=function(c,a){if(!(0>=c||0>=a)){var b=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen)&&0<this.runtime.fullscreen_scaling&&(b=this.runtime.fullscreen_scaling);0===b?this.runtime.setSize(c,a,!0):(this.runtime.original_width=
c,this.runtime.original_height=a,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}};n.prototype.SetLayoutEffectEnabled=function(c,a){this.runtime.running_layout&&this.runtime.glwrap&&(a=this.runtime.running_layout.getEffectByName(a))&&(c=1===c,a.active!=c&&(a.active=c,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};n.prototype.SetLayerEffectEnabled=function(c,a,b){c&&this.runtime.glwrap&&(b=c.getEffectByName(b))&&(a=1===a,b.active!=a&&
(b.active=a,c.updateActiveEffects(),this.runtime.redraw=!0))};n.prototype.SetLayoutEffectParam=function(c,a,b){if(this.runtime.running_layout&&this.runtime.glwrap&&(c=this.runtime.running_layout.getEffectByName(c))){var g=this.runtime.running_layout.effect_params[c.index];a=Math.floor(a);if(!(0>a||a>=g.length)){var d=this.runtime.glwrap.getProgramParameterType(c.shaderindex,a);1===d?b/=100:2===d&&(b=[cr.GetRValue(b),cr.GetGValue(b),cr.GetBValue(b)]);g[a]!==b&&(g[a]=b,c.active&&(this.runtime.redraw=
!0))}}};n.prototype.SetLayerEffectParam=function(c,a,b,d){if(c&&this.runtime.glwrap&&(a=c.getEffectByName(a))&&(c=c.effect_params[a.index],b=Math.floor(b),!(0>b||b>=c.length))){var g=this.runtime.glwrap.getProgramParameterType(a.shaderindex,b);1===g?d/=100:2===g&&(d=[cr.GetRValue(d),cr.GetGValue(d),cr.GetBValue(d)]);c[b]!==d&&(c[b]=d,a.active&&(this.runtime.redraw=!0))}};n.prototype.SaveState=function(c){this.runtime.saveToSlot=c};n.prototype.LoadState=function(c){this.runtime.loadFromSlot=c};n.prototype.LoadStateJSON=
function(c){this.runtime.loadFromJson=c};n.prototype.SetHalfFramerateMode=function(c){this.runtime.halfFramerateMode=0!==c};n.prototype.SetFullscreenQuality=function(c){if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==c,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};n.prototype.ResetPersisted=function(){var c;var a=0;for(c=this.runtime.layouts_by_index.length;a<
c;++a)this.runtime.layouts_by_index[a].persist_data={},this.runtime.layouts_by_index[a].first_visit=!0};n.prototype.RecreateInitialObjects=function(c,a,b,d,e){c&&this.runtime.running_layout.recreateInitialObjects(c,a,b,d,e)};n.prototype.SetPixelRounding=function(c){this.runtime.pixel_rounding=0!==c;this.runtime.redraw=!0};n.prototype.SetMinimumFramerate=function(c){1>c&&(c=1);120<c&&(c=120);this.runtime.minimumFramerate=c};n.prototype.SortZOrderByInstVar=function(c,a){if(c){var g;var e=c.getCurrentSol().getObjects();
var k=[],l=[],h=this.runtime.running_layout,m=c.is_family,t=c.family_index,f=!1;c=0;for(g=e.length;c<g;++c){var z=e[c];if(z.layer){var y=m?z.instance_vars[a+z.type.family_var_map[t]]:z.instance_vars[a];k.push([z.layer.index,z.get_zindex()]);l.push([z,y])}}if(k.length){k.sort(d);l.sort(b);c=0;for(g=k.length;c<g;++c)z=l[c][0],a=h.layers[k[c][0]],e=k[c][1],a.instances[e]!==z&&(a.instances[e]=z,z.layer=a,a.setZIndicesStaleFrom(e),f=!0);f&&(this.runtime.redraw=!0)}}};h.acts=new n;e.prototype.int=function(c,
a){cr.is_string(a)?(c.set_int(parseInt(a,10)),isNaN(c.data)&&(c.data=0)):c.set_int(a)};e.prototype.float=function(c,a){cr.is_string(a)?(c.set_float(parseFloat(a)),isNaN(c.data)&&(c.data=0)):c.set_float(a)};e.prototype.str=function(c,a){cr.is_string(a)?c.set_string(a):c.set_string(a.toString())};e.prototype.len=function(c,a){c.set_int(a.length||0)};e.prototype.random=function(c,a,b){void 0===b?c.set_float(Math.random()*a):c.set_float(Math.random()*(b-a)+a)};e.prototype.sqrt=function(c,a){c.set_float(Math.sqrt(a))};
e.prototype.abs=function(c,a){c.set_float(Math.abs(a))};e.prototype.round=function(c,a){c.set_int(Math.round(a))};e.prototype.floor=function(c,a){c.set_int(Math.floor(a))};e.prototype.ceil=function(c,a){c.set_int(Math.ceil(a))};e.prototype.sign=function(c,a){c.set_float(Math.sign(a))};e.prototype.sin=function(c,a){c.set_float(Math.sin(cr.to_radians(a)))};e.prototype.cos=function(c,a){c.set_float(Math.cos(cr.to_radians(a)))};e.prototype.tan=function(c,a){c.set_float(Math.tan(cr.to_radians(a)))};e.prototype.asin=
function(c,a){c.set_float(cr.to_degrees(Math.asin(a)))};e.prototype.acos=function(c,a){c.set_float(cr.to_degrees(Math.acos(a)))};e.prototype.atan=function(c,a){c.set_float(cr.to_degrees(Math.atan(a)))};e.prototype.exp=function(c,a){c.set_float(Math.exp(a))};e.prototype.ln=function(c,a){c.set_float(Math.log(a))};e.prototype.log10=function(c,a){c.set_float(Math.log(a)/Math.LN10)};e.prototype.max=function(c){var a=arguments[1];"number"!==typeof a&&(a=0);var b;var d=2;for(b=arguments.length;d<b;d++){var e=
arguments[d];"number"===typeof e&&a<e&&(a=e)}c.set_float(a)};e.prototype.min=function(c){var a=arguments[1];"number"!==typeof a&&(a=0);var b;var d=2;for(b=arguments.length;d<b;d++){var e=arguments[d];"number"===typeof e&&a>e&&(a=e)}c.set_float(a)};e.prototype.dt=function(c){c.set_float(this.runtime.dt)};e.prototype.timescale=function(c){c.set_float(this.runtime.timescale)};e.prototype.wallclocktime=function(c){c.set_float((Date.now()-this.runtime.start_time)/1E3)};e.prototype.unixtime=function(c){c.set_float(Date.now())};
e.prototype.time=function(c){c.set_float(this.runtime.kahanTime.sum)};e.prototype.tickcount=function(c){c.set_int(this.runtime.tickcount)};e.prototype.objectcount=function(c){c.set_int(this.runtime.objectcount)};e.prototype.fps=function(c){c.set_int(this.runtime.fps)};e.prototype.loopindex=function(c,a){var b;if(this.runtime.loop_stack.length)if(a){for(b=this.runtime.loop_stack_index;0<=b;--b){var g=this.runtime.loop_stack[b];if(g.name===a){c.set_int(g.index);return}}c.set_int(0)}else g=this.runtime.getCurrentLoop(),
c.set_int(g?g.index:-1);else c.set_int(0)};e.prototype.distance=function(c,a,b,d,e){c.set_float(cr.distanceTo(a,b,d,e))};e.prototype.angle=function(c,a,b,d,e){c.set_float(cr.to_degrees(cr.angleTo(a,b,d,e)))};e.prototype.scrollx=function(c){c.set_float(this.runtime.running_layout.scrollX)};e.prototype.scrolly=function(c){c.set_float(this.runtime.running_layout.scrollY)};e.prototype.newline=function(c){c.set_string("\n")};e.prototype.lerp=function(c,a,b,d){c.set_float(cr.lerp(a,b,d))};e.prototype.qarp=
function(c,a,b,d,e){c.set_float(cr.qarp(a,b,d,e))};e.prototype.cubic=function(c,a,b,d,e,k){c.set_float(cr.cubic(a,b,d,e,k))};e.prototype.cosp=function(c,a,b,d){c.set_float(cr.cosp(a,b,d))};e.prototype.windowwidth=function(c){c.set_int(this.runtime.width)};e.prototype.windowheight=function(c){c.set_int(this.runtime.height)};e.prototype.uppercase=function(c,a){c.set_string(cr.is_string(a)?a.toUpperCase():"")};e.prototype.lowercase=function(c,a){c.set_string(cr.is_string(a)?a.toLowerCase():"")};e.prototype.clamp=
function(c,a,b,d){a<b?c.set_float(b):a>d?c.set_float(d):c.set_float(a)};e.prototype.layerscale=function(c,a){(a=this.runtime.getLayer(a))?c.set_float(a.scale):c.set_float(0)};e.prototype.layeropacity=function(c,a){(a=this.runtime.getLayer(a))?c.set_float(100*a.opacity):c.set_float(0)};e.prototype.layerscalerate=function(c,a){(a=this.runtime.getLayer(a))?c.set_float(a.zoomRate):c.set_float(0)};e.prototype.layerparallaxx=function(c,a){(a=this.runtime.getLayer(a))?c.set_float(100*a.parallaxX):c.set_float(0)};
e.prototype.layerparallaxy=function(c,a){(a=this.runtime.getLayer(a))?c.set_float(100*a.parallaxY):c.set_float(0)};e.prototype.layerindex=function(c,a){(a=this.runtime.getLayer(a))?c.set_int(a.index):c.set_int(-1)};e.prototype.layoutscale=function(c){this.runtime.running_layout?c.set_float(this.runtime.running_layout.scale):c.set_float(0)};e.prototype.layoutangle=function(c){c.set_float(cr.to_degrees(this.runtime.running_layout.angle))};e.prototype.layerangle=function(c,a){(a=this.runtime.getLayer(a))?
c.set_float(cr.to_degrees(a.angle)):c.set_float(0)};e.prototype.layoutwidth=function(c){c.set_int(this.runtime.running_layout.width)};e.prototype.layoutheight=function(c){c.set_int(this.runtime.running_layout.height)};e.prototype.find=function(c,a,b){cr.is_string(a)&&cr.is_string(b)?c.set_int(a.search(new RegExp(cr.regexp_escape(b),"i"))):c.set_int(-1)};e.prototype.findcase=function(c,a,b){cr.is_string(a)&&cr.is_string(b)?c.set_int(a.search(new RegExp(cr.regexp_escape(b),""))):c.set_int(-1)};e.prototype.left=
function(c,a,b){c.set_string(cr.is_string(a)?a.substr(0,b):"")};e.prototype.right=function(c,a,b){c.set_string(cr.is_string(a)?a.substr(a.length-b):"")};e.prototype.mid=function(c,a,b,d){c.set_string(cr.is_string(a)?a.substr(b,d):"")};e.prototype.tokenat=function(c,a,b,d){cr.is_string(a)&&cr.is_string(d)?(a=a.split(d),b=cr.floor(b),0>b||b>=a.length?c.set_string(""):c.set_string(a[b])):c.set_string("")};e.prototype.tokencount=function(c,a,b){cr.is_string(a)&&a.length?c.set_int(a.split(b).length):c.set_int(0)};
e.prototype.replace=function(c,a,b,d){cr.is_string(a)&&cr.is_string(b)&&cr.is_string(d)?c.set_string(a.replace(new RegExp(cr.regexp_escape(b),"gi"),d)):c.set_string(cr.is_string(a)?a:"")};e.prototype.trim=function(c,a){c.set_string(cr.is_string(a)?a.trim():"")};e.prototype.pi=function(c){c.set_float(cr.PI)};e.prototype.layoutname=function(c){this.runtime.running_layout?c.set_string(this.runtime.running_layout.name):c.set_string("")};e.prototype.renderer=function(c){c.set_string(this.runtime.gl?"webgl":
"canvas2d")};e.prototype.rendererdetail=function(c){c.set_string(this.runtime.glUnmaskedRenderer)};e.prototype.anglediff=function(c,a,b){c.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(a),cr.to_radians(b))))};e.prototype.choose=function(c){var a=cr.floor(Math.random()*(arguments.length-1));c.set_any(arguments[a+1])};e.prototype.rgb=function(c,a,b,d){c.set_int(cr.RGB(a,b,d))};e.prototype.rgbex=function(c,a,b,d){c.set_float(cr.RGBEx(a/100,b/100,d/100))};e.prototype.projectversion=function(c){c.set_string(this.runtime.versionstr)};
e.prototype.projectname=function(c){c.set_string(this.runtime.name)};e.prototype.anglelerp=function(c,a,b,d){a=cr.to_radians(a);b=cr.to_radians(b);var g=cr.angleDiff(a,b);cr.angleClockwise(b,a)?c.set_float(cr.to_clamped_degrees(a+g*d)):c.set_float(cr.to_clamped_degrees(a-g*d))};e.prototype.anglerotate=function(c,a,b,d){a=cr.to_radians(a);b=cr.to_radians(b);d=cr.to_radians(d);c.set_float(cr.to_clamped_degrees(cr.angleRotate(a,b,d)))};e.prototype.zeropad=function(c,a,b){var d=0>a?"-":"";0>a&&(a=-a);
b-=a.toString().length;for(var g=0;g<b;g++)d+="0";c.set_string(d+a.toString())};e.prototype.cpuutilisation=function(c){c.set_float(this.runtime.cpuutilisation/1E3)};e.prototype.gpuutilisation=function(c){c.set_float(this.runtime.gpuLastUtilisation)};e.prototype.viewportleft=function(c,a){a=this.runtime.getLayer(a);c.set_float(a?a.viewLeft:0)};e.prototype.viewporttop=function(c,a){a=this.runtime.getLayer(a);c.set_float(a?a.viewTop:0)};e.prototype.viewportright=function(c,a){a=this.runtime.getLayer(a);
c.set_float(a?a.viewRight:0)};e.prototype.viewportbottom=function(c,a){a=this.runtime.getLayer(a);c.set_float(a?a.viewBottom:0)};e.prototype.loadingprogress=function(c){c.set_float(this.runtime.loadingprogress)};e.prototype.unlerp=function(c,a,b,d){c.set_float(cr.unlerp(a,b,d))};e.prototype.canvassnapshot=function(c){c.set_string(this.runtime.snapshotData)};e.prototype.urlencode=function(c,a){c.set_string(encodeURIComponent(a))};e.prototype.urldecode=function(c,a){c.set_string(decodeURIComponent(a))};
e.prototype.canvastolayerx=function(c,a,b,d){a=this.runtime.getLayer(a);c.set_float(a?a.canvasToLayer(b,d,!0):0)};e.prototype.canvastolayery=function(c,a,b,d){a=this.runtime.getLayer(a);c.set_float(a?a.canvasToLayer(b,d,!1):0)};e.prototype.layertocanvasx=function(c,a,b,d){a=this.runtime.getLayer(a);c.set_float(a?a.layerToCanvas(b,d,!0):0)};e.prototype.layertocanvasy=function(c,a,b,d){a=this.runtime.getLayer(a);c.set_float(a?a.layerToCanvas(b,d,!1):0)};e.prototype.savestatejson=function(c){c.set_string(this.runtime.lastSaveJson)};
e.prototype.imagememoryusage=function(c){this.runtime.glwrap?c.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):c.set_float(0)};e.prototype.regexsearch=function(c,a,b,d){b=q(b,d);c.set_int(a?a.search(b):-1)};e.prototype.regexreplace=function(c,a,b,d,e){b=q(b,d);c.set_string(a?a.replace(b,e):"")};var G=[],N="",U="",H="";e.prototype.regexmatchcount=function(c,a,b,d){q(b,d);w(a.toString(),b,d);c.set_int(G?G.length:0)};e.prototype.regexmatchat=function(c,a,b,d,e){e=Math.floor(e);
q(b,d);w(a.toString(),b,d);!G||0>e||e>=G.length?c.set_string(""):c.set_string(G[e])};e.prototype.infinity=function(c){c.set_float(Infinity)};e.prototype.setbit=function(c,a,b,d){b|=0;c.set_int((a|0)&~(1<<b)|(0!==d?1:0)<<b)};e.prototype.togglebit=function(c,a,b){c.set_int((a|0)^1<<(b|0))};e.prototype.getbit=function(c,a,b){c.set_int((a|0)&1<<(b|0)?1:0)};e.prototype.originalwindowwidth=function(c){c.set_int(this.runtime.original_width)};e.prototype.originalwindowheight=function(c){c.set_int(this.runtime.original_height)};
e.prototype.originalviewportwidth=function(c){c.set_int(this.runtime.original_width)};e.prototype.originalviewportheight=function(c){c.set_int(this.runtime.original_height)};h.exps=new e;h.runWaits=function(){var c,a=this.runtime.getCurrentEventStack();var b=0;for(c=this.waits.length;b<c;b++){var d=this.waits[b];if(-1===d.time){if(!d.signalled)continue}else if(d.time>this.runtime.kahanTime.sum)continue;a.current_event=d.ev;a.actindex=d.actindex;a.cndindex=0;for(h in d.sols)if(d.sols.hasOwnProperty(h)){var e=
this.runtime.types_by_index[parseInt(h,10)].getCurrentSol();var k=d.sols[h];e.select_all=k.sa;cr.shallowAssignArray(e.instances,k.insts);e=k;cr.clearArray(e.insts);B.push(e)}d.ev.resume_actions_and_subevents();this.runtime.clearSol(d.solModifiers);d.deleteme=!0}var h=b=0;for(c=this.waits.length;b<c;b++)d=this.waits[b],this.waits[h]=d,d.deleteme?(cr.wipe(d.sols),cr.clearArray(d.solModifiers),l.push(d)):h++;cr.truncateArray(this.waits,h)}})();
(function(){cr.add_common_aces=function(f,q){var p=f[1],u=f[3],m=f[4],d=f[5],b=f[6],e=f[7];f=f[8];q.cnds||(q.cnds={});q.acts||(q.acts={});q.exps||(q.exps={});var w=q.cnds,h=q.acts;q=q.exps;u&&(w.CompareX=function(a,b){return cr.do_cmp(this.x,a,b)},w.CompareY=function(a,b){return cr.do_cmp(this.y,a,b)},w.IsOnScreen=function(){var a=this.layer;this.update_bbox();var b=this.bbox;return!(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)},w.IsOutsideLayout=function(){this.update_bbox();
var a=this.bbox,b=this.runtime.running_layout;return 0>a.right||0>a.bottom||a.left>b.width||a.top>b.height},w.PickDistance=function(a,b,d){var e=this.getCurrentSol(),h=e.getObjects();if(!h.length)return!1;var k=h[0],l=k,m=cr.distanceTo(k.x,k.y,b,d),t;var f=1;for(t=h.length;f<t;f++){k=h[f];var y=cr.distanceTo(k.x,k.y,b,d);if(0===a&&y<m||1===a&&y>m)m=y,l=k}e.pick_one(l);return!0},h.SetX=function(a){this.x!==a&&(this.x=a,this.set_bbox_changed())},h.SetY=function(a){this.y!==a&&(this.y=a,this.set_bbox_changed())},
h.SetPos=function(a,b){if(this.x!==a||this.y!==b)this.x=a,this.y=b,this.set_bbox_changed()},h.SetPosToObject=function(a,b){var d=a.getPairedInstance(this);d&&(d.getImagePoint?(a=d.getImagePoint(b,!0),b=d.getImagePoint(b,!1)):(a=d.x,b=d.y),this.x!==a||this.y!==b)&&(this.x=a,this.y=b,this.set_bbox_changed())},h.MoveForward=function(a){0!==a&&(this.x+=Math.cos(this.angle)*a,this.y+=Math.sin(this.angle)*a,this.set_bbox_changed())},h.MoveAtAngle=function(a,b){0!==b&&(this.x+=Math.cos(cr.to_radians(a))*
b,this.y+=Math.sin(cr.to_radians(a))*b,this.set_bbox_changed())},q.X=function(a){a.set_float(this.x)},q.Y=function(a){a.set_float(this.y)},q.dt=function(a){a.set_float(this.runtime.getDt(this))});m&&(w.CompareWidth=function(a,b){return cr.do_cmp(this.width,a,b)},w.CompareHeight=function(a,b){return cr.do_cmp(this.height,a,b)},h.SetWidth=function(a){this.width!==a&&(this.width=a,this.set_bbox_changed())},h.SetHeight=function(a){this.height!==a&&(this.height=a,this.set_bbox_changed())},h.SetSize=function(a,
b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.set_bbox_changed()},q.Width=function(a){a.set_float(this.width)},q.Height=function(a){a.set_float(this.height)},q.BBoxLeft=function(a){this.update_bbox();a.set_float(this.bbox.left)},q.BBoxTop=function(a){this.update_bbox();a.set_float(this.bbox.top)},q.BBoxRight=function(a){this.update_bbox();a.set_float(this.bbox.right)},q.BBoxBottom=function(a){this.update_bbox();a.set_float(this.bbox.bottom)});d&&(w.AngleWithin=function(a,b){return cr.angleDiff(this.angle,
cr.to_radians(b))<=cr.to_radians(a)},w.IsClockwiseFrom=function(a){return cr.angleClockwise(this.angle,cr.to_radians(a))},w.IsBetweenAngles=function(a,b){a=cr.to_clamped_radians(a);b=cr.to_clamped_radians(b);var d=cr.clamp_angle(this.angle);return cr.angleClockwise(b,a)?cr.angleClockwise(d,a)&&!cr.angleClockwise(d,b):!(!cr.angleClockwise(d,a)&&cr.angleClockwise(d,b))},h.SetAngle=function(a){a=cr.to_radians(cr.clamp_angle_degrees(a));isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},
h.RotateClockwise=function(a){0===a||isNaN(a)||(this.angle+=cr.to_radians(a),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},h.RotateCounterclockwise=function(a){0===a||isNaN(a)||(this.angle-=cr.to_radians(a),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},h.RotateTowardAngle=function(a,b){a=cr.angleRotate(this.angle,cr.to_radians(b),cr.to_radians(a));isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},h.RotateTowardPosition=function(a,b,d){a=cr.angleRotate(this.angle,
Math.atan2(d-this.y,b-this.x),cr.to_radians(a));isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},h.SetTowardPosition=function(a,b){a=Math.atan2(b-this.y,a-this.x);isNaN(a)||this.angle===a||(this.angle=a,this.set_bbox_changed())},q.Angle=function(a){a.set_float(cr.to_clamped_degrees(this.angle))});p||(w.CompareInstanceVar=function(a,b,d){return cr.do_cmp(this.instance_vars[a],b,d)},w.IsBoolInstanceVarSet=function(a){return this.instance_vars[a]},w.PickInstVarHiLow=function(a,b){var d=
this.getCurrentSol(),e=d.getObjects();if(!e.length)return!1;var h=e[0],k=h,l=h.instance_vars[b],m;var f=1;for(m=e.length;f<m;f++){h=e[f];var t=h.instance_vars[b];if(0===a&&t<l||1===a&&t>l)l=t,k=h}d.pick_one(k);return!0},w.PickByUID=function(a){var b;if(this.runtime.getCurrentCondition().inverted){var d=this.getCurrentSol();if(d.select_all){d.select_all=!1;cr.clearArray(d.instances);cr.clearArray(d.else_instances);var e=this.instances;var h=0;for(b=e.length;h<b;h++){var k=e[h];k.uid===a?d.else_instances.push(k):
d.instances.push(k)}}else{e=h=0;for(b=d.instances.length;h<b;h++)k=d.instances[h],d.instances[e]=k,k.uid===a?d.else_instances.push(k):e++;cr.truncateArray(d.instances,e)}this.applySolToContainer();return!!d.instances.length}k=this.runtime.getObjectByUID(a);if(!k)return!1;d=this.getCurrentSol();if(!d.select_all&&-1===d.instances.indexOf(k))return!1;if(this.is_family)for(a=k.type.families,h=0,b=a.length;h<b;h++){if(a[h]===this)return d.pick_one(k),this.applySolToContainer(),!0}else if(k.type===this)return d.pick_one(k),
this.applySolToContainer(),!0;return!1},w.OnCreated=function(){return!0},w.OnDestroyed=function(){return!0},h.SetInstanceVar=function(a,b){var d=this.instance_vars;cr.is_number(d[a])?cr.is_number(b)?d[a]=b:d[a]=parseFloat(b):cr.is_string(d[a])&&(cr.is_string(b)?d[a]=b:d[a]=b.toString())},h.AddInstanceVar=function(a,b){var d=this.instance_vars;cr.is_number(d[a])?cr.is_number(b)?d[a]+=b:d[a]+=parseFloat(b):cr.is_string(d[a])&&(cr.is_string(b)?d[a]+=b:d[a]+=b.toString())},h.SubInstanceVar=function(a,
b){var d=this.instance_vars;cr.is_number(d[a])&&(cr.is_number(b)?d[a]-=b:d[a]-=parseFloat(b))},h.SetBoolInstanceVar=function(a,b){this.instance_vars[a]=b?1:0},h.ToggleBoolInstanceVar=function(a){this.instance_vars[a]=1-this.instance_vars[a]},h.Destroy=function(){this.runtime.DestroyInstance(this)},h.LoadFromJsonString||(h.LoadFromJsonString=function(a){try{var b=JSON.parse(a)}catch(z){return}this.runtime.loadInstanceFromJSON(this,b,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(a=
0,b=this.behavior_insts.length;a<b;++a){var d=this.behavior_insts[a];d.afterLoad&&d.afterLoad()}}),q.Count=function(a){var b=a.object_class.instances.length,d;var e=0;for(d=this.runtime.createRow.length;e<d;e++){var h=this.runtime.createRow[e];a.object_class.is_family?0<=h.type.families.indexOf(a.object_class)&&b++:h.type===a.object_class&&b++}a.set_int(b)},q.PickedCount=function(a){a.set_int(a.object_class.getCurrentSol().getObjects().length)},q.UID=function(a){a.set_int(this.uid)},q.IID=function(a){a.set_int(this.get_iid())},
q.AsJSON||(q.AsJSON=function(a){a.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));b&&(w.IsVisible=function(){return this.visible},h.SetVisible=function(a){a=2===a?!this.visible:0!==a;a!==this.visible&&(this.visible=a,this.runtime.redraw=!0)},w.CompareOpacity=function(a,b){return cr.do_cmp(cr.round6dp(100*this.opacity),a,b)},h.SetOpacity=function(a){a/=100;0>a?a=0:1<a&&(a=1);a!==this.opacity&&(this.opacity=a,this.runtime.redraw=!0)},q.Opacity=function(a){a.set_float(cr.round6dp(100*
this.opacity))});e&&(w.IsOnLayer=function(a){return a?this.layer===a:!1},w.PickTopBottom=function(a){var b=this.getCurrentSol(),d=b.getObjects();if(!d.length)return!1;var e=d[0],h=e,k;var l=1;for(k=d.length;l<k;l++)if(e=d[l],0===a){if(e.layer.index>h.layer.index||e.layer.index===h.layer.index&&e.get_zindex()>h.get_zindex())h=e}else if(e.layer.index<h.layer.index||e.layer.index===h.layer.index&&e.get_zindex()<h.get_zindex())h=e;b.pick_one(h);return!0},h.MoveToTop=function(){var a=this.layer,b=a.instances;
b.length&&b[b.length-1]===this||(a.removeFromInstanceList(this,!1),a.appendToInstanceList(this,!1),this.runtime.redraw=!0)},h.MoveToBottom=function(){var a=this.layer,b=a.instances;b.length&&b[0]===this||(a.removeFromInstanceList(this,!1),a.prependToInstanceList(this,!1),this.runtime.redraw=!0)},h.MoveToLayer=function(a){a&&a!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=a,a.appendToInstanceList(this,!0),this.runtime.redraw=!0)},h.ZMoveToObject=function(a,b){a=0===a;b&&(b=b.getFirstPicked(this))&&
b.uid!==this.uid&&(this.layer.index!==b.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=b.layer,b.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,b,a),this.runtime.redraw=!0)},q.LayerNumber=function(a){a.set_int(this.layer.number)},q.LayerName=function(a){a.set_string(this.layer.name)},q.ZIndex=function(a){a.set_int(this.get_zindex())});f&&(h.SetEffectEnabled=function(a,b){this.runtime.glwrap&&(b=this.type.getEffectIndexByName(b),0>b||(a=1===a,this.active_effect_flags[b]!==
a&&(this.active_effect_flags[b]=a,this.updateActiveEffects(),this.runtime.redraw=!0)))},h.SetEffectParam=function(a,b,d){if(this.runtime.glwrap){var e=this.type.getEffectIndexByName(a);if(!(0>e||(a=this.type.effect_types[e],e=this.effect_params[e],b=Math.floor(b),0>b||b>=e.length))){var h=this.runtime.glwrap.getProgramParameterType(a.shaderindex,b);1===h&&(d/=100);if(2===h){h=cr.GetRValue(d);var k=cr.GetGValue(d);d=cr.GetBValue(d);b=e[b];if(b[0]===h&&b[1]===k&&b[2]===d)return;b[0]=h;b[1]=k;b[2]=d}else{if(e[b]===
d)return;e[b]=d}a.active&&(this.runtime.redraw=!0)}}})};cr.set_bbox_changed=function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=!0;this.runtime.redraw=!0;var f,q=this.bbox_changed_callbacks;var n=0;for(f=q.length;n<f;++n)q[n](this);this.layer.useRenderCells&&this.update_bbox()};cr.add_bbox_changed_callback=function(f){f&&this.bbox_changed_callbacks.push(f)};cr.update_bbox=function(){if(this.bbox_changed){var f=this.bbox,q=this.bquad;f.set(this.x,this.y,this.x+this.width,this.y+
this.height);f.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);this.angle?(f.offset(-this.x,-this.y),q.set_from_rotated_rect(f,this.angle),q.offset(this.x,this.y),q.bounding_box(f)):q.set_from_rect(f);f.normalize();this.bbox_changed=!1;this.update_render_cell()}};var f=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var p=this.layer.render_grid,q=this.bbox;f.set(p.XToCell(q.left),p.YToCell(q.top),p.XToCell(q.right),p.YToCell(q.bottom));this.rendercells.equals(f)||
(this.rendercells.right<this.rendercells.left?p.update(this,null,f):p.update(this,this.rendercells,f),this.rendercells.copy(f),this.layer.render_list_stale=!0)}};cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var p=this.type.collision_grid,q=this.bbox;f.set(p.XToCell(q.left),p.YToCell(q.top),p.XToCell(q.right),p.YToCell(q.bottom));this.collcells.equals(f)||(this.collcells.right<this.collcells.left?p.update(this,null,f):p.update(this,this.collcells,
f),this.collcells.copy(f),this.cell_changed=!1)}};cr.inst_contains_pt=function(f,q){return this.bbox.contains_pt(f,q)&&this.bquad.contains_pt(f,q)?this.tilemap_exists?this.testPointOverlapTile(f,q):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(f-this.x,q-this.y)):!0:!1};cr.inst_get_iid=function(){this.type.updateIIDs();return this.iid};cr.inst_get_zindex=function(){this.layer.updateZIndices();
return this.zindex};cr.inst_updateActiveEffects=function(){cr.clearArray(this.active_effect_types);var f,q=!0;var n=0;for(f=this.active_effect_flags.length;n<f;n++)if(this.active_effect_flags[n]){var u=this.type.effect_types[n];this.active_effect_types.push(u);u.preservesOpaqueness||(q=!1)}this.uses_shaders=!!this.active_effect_types.length;this.shaders_preserve_opaqueness=q};cr.inst_toString=function(){return"Inst"+this.puid};cr.type_getFirstPicked=function(f){if(f&&f.is_contained&&f.type!=this){var p;
var n=0;for(p=f.siblings.length;n<p;n++){var u=f.siblings[n];if(u.type==this)return u}}f=this.getCurrentSol().getObjects();return f.length?f[0]:null};cr.type_getPairedInstance=function(f){var p=this.getCurrentSol().getObjects();return p.length?p[f.get_iid()%p.length]:null};cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var f;var q=0;for(f=this.instances.length;q<f;q++)this.instances[q].iid=q;var n=q,u=this.runtime.createRow;q=0;for(f=u.length;q<f;++q)u[q].type===this&&(u[q].iid=
n++);this.stale_iids=!1}};cr.type_getInstanceByIID=function(f){if(f<this.instances.length)return this.instances[f];f-=this.instances.length;var p=this.runtime.createRow,n;var u=0;for(n=p.length;u<n;++u)if(p[u].type===this){if(0===f)return p[u];--f}return null};cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))};
cr.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&this.solstack.push(new cr.selection(this));var f=this.solstack[this.cur_sol],q=this.solstack[this.cur_sol-1];q.select_all?f.select_all=!0:(f.select_all=!1,cr.shallowAssignArray(f.instances,q.instances));cr.clearArray(f.else_instances)};cr.type_popSol=function(){this.cur_sol--};cr.type_getBehaviorByName=function(f){var p,n,u=0;if(!this.is_family){var m=0;for(p=this.families.length;m<p;m++){var d=this.families[m];var b=
0;for(n=d.behaviors.length;b<n;b++){if(f===d.behaviors[b].name)return this.extra.lastBehIndex=u,d.behaviors[b];u++}}}m=0;for(p=this.behaviors.length;m<p;m++){if(f===this.behaviors[m].name)return this.extra.lastBehIndex=u,this.behaviors[m];u++}return null};cr.type_getBehaviorIndexByName=function(f){return this.getBehaviorByName(f)?this.extra.lastBehIndex:-1};cr.type_getEffectIndexByName=function(f){var p;var n=0;for(p=this.effect_types.length;n<p;n++)if(this.effect_types[n].name===f)return n;return-1};
cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var f,q,n;this.updateIIDs();var u=this.getCurrentSol();var m=u.select_all,d=(f=this.runtime.getCurrentEventStack())&&f.current_event&&f.current_event.orblock;f=0;for(q=this.container.length;f<q;f++){var b=this.container[f];if(b!==this){b.updateIIDs();var e=b.getCurrentSol();e.select_all=m;if(!m){cr.clearArray(e.instances);var w=0;for(n=u.instances.length;w<n;++w)e.instances[w]=b.getInstanceByIID(u.instances[w].iid);if(d)for(cr.clearArray(e.else_instances),
w=0,n=u.else_instances.length;w<n;++w)e.else_instances[w]=b.getInstanceByIID(u.else_instances[w].iid)}}}}};cr.type_toString=function(){return"Type"+this.sid};cr.do_cmp=function(f,q,n){if("undefined"===typeof f||"undefined"===typeof n)return!1;switch(q){case 0:return f===n;case 1:return f!==n;case 2:return f<n;case 3:return f<=n;case 4:return f>n;case 5:return f>=n;default:return!1}}})();cr.shaders={};
cr.shaders.warpobject={src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nuniform mediump vec2 srcStart;\nuniform mediump vec2 srcEnd;\nuniform mediump vec2 srcOriginStart;\nuniform mediump vec2 srcOriginEnd;\nuniform mediump float seconds;\nuniform mediump vec2 pixelSize;\nuniform mediump float layerScale;\nuniform mediump float freqX;\nuniform mediump float freqY;\nuniform mediump float ampX;\nuniform mediump float ampY;\nuniform mediump float speedX;\nuniform mediump float speedY;\nvoid main(void)\n{\nmediump float _2pi = 2.0 * 3.14159265359;\nmediump vec2 srcOriginSize = srcOriginEnd - srcOriginStart;\nmediump vec2 n = ((vTex - srcOriginStart) / srcOriginSize);\nmediump vec2 p = vTex;\np.x += cos(n.y * _2pi * freqY + seconds * speedY * _2pi) * ampY * pixelSize.x * layerScale;\np.y += sin(n.x * _2pi * freqX + seconds * speedX * _2pi) * ampX * pixelSize.y * layerScale;\np = clamp(p, min(srcStart, srcEnd), max(srcStart, srcEnd));\ngl_FragColor = texture2D(samplerFront, p);\n}",extendBoxHorizontal:30,
extendBoxVertical:30,crossSampling:!1,mustPreDraw:!1,preservesOpaqueness:!1,animated:!0,parameters:[["freqX",0,0],["freqY",0,0],["ampX",0,0],["ampY",0,0],["speedX",0,0],["speedY",0,0]]};cr.plugins_.Sprite=function(f){this.runtime=f};
(function(){function f(){if(0===this.datauri.length){var a=document.createElement("canvas");a.width=this.width;a.height=this.height;var c=a.getContext("2d");this.spritesheeted?c.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):c.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=a.toDataURL("image/png")}return this.datauri}function p(){}function q(a){a[0]=0;a[1]=0;a[2]=0;z.push(a)}function n(a,c){return a<c?""+a+","+c:""+c+","+a}function u(a,
c,b,d){c=c.uid;b=b.uid;var e=n(c,b);if(a.hasOwnProperty(e))a[e][2]=d;else{var g=z.length?z.pop():[0,0,0];g[0]=c;g[1]=b;g[2]=d;a[e]=g}}function m(a,c,b){c=n(c.uid,b.uid);a.hasOwnProperty(c)&&(q(a[c]),delete a[c])}function d(a,c,b){c=n(c.uid,b.uid);if(a.hasOwnProperty(c))return A=a[c][2],!0;A=-2;return!1}function b(a,c,b){if(!a)return!1;var d=0!==c||0!==b,e=!1,g=this.runtime.getCurrentCondition(),k=g.type;g=g.inverted;var h=a.getCurrentSol();var f=this.runtime.getCurrentEventStack().current_event.orblock;
h.select_all?(this.update_bbox(),U.copy(this.bbox),U.offset(c,b),this.runtime.getCollisionCandidates(this.layer,a,U,N),h=N):h=f?this.runtime.isCurrentConditionFirst()&&!h.else_instances.length&&h.instances.length?h.instances:h.else_instances:h.instances;l=a;G=k!==a&&!g;if(d){var m=this.x;var t=this.y;this.x+=c;this.y+=b;this.set_bbox_changed()}c=0;for(b=h.length;c<b;c++)if(f=h[c],this.runtime.testOverlap(this,f)){e=!0;if(g)break;k!==a&&B.add(f)}d&&(this.x=m,this.y=t,this.set_bbox_changed());cr.clearArray(N);
return e}function e(){}function w(){}var h=cr.plugins_.Sprite.prototype;h.Type=function(a){this.plugin=a;this.runtime=a.runtime};var a=h.Type.prototype;a.onCreate=function(){if(!this.is_family){var a,c;this.all_frames=[];this.has_loaded_textures=!1;var b=0;for(a=this.animations.length;b<a;b++){var d=this.animations[b];var e={};e.name=d[0];e.speed=d[1];e.loop=d[2];e.repeatcount=d[3];e.repeatto=d[4];e.pingpong=d[5];e.sid=d[6];e.frames=[];var k=0;for(c=d[7].length;k<c;k++){var l=d[7][k];var h={};h.texture_file=
l[0];h.texture_filesize=l[1];h.offx=l[2];h.offy=l[3];h.width=l[4];h.height=l[5];h.duration=l[6];h.hotspotX=l[7];h.hotspotY=l[8];h.image_points=l[9];h.poly_pts=l[10];h.pixelformat=l[11];h.spritesheeted=0!==h.width;h.datauri="";h.getDataUri=f;var m={left:0,top:0,right:1,bottom:1};h.sheetTex=m;h.webGL_texture=null;(m=this.runtime.findWaitingTexture(l[0]))?h.texture_img=m:(h.texture_img=new Image,h.texture_img.cr_src=l[0],h.texture_img.cr_filesize=l[1],h.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(h.texture_img,
l[0]));cr.seal(h);e.frames.push(h);this.all_frames.push(h)}cr.seal(e);this.animations[b]=e}}};a.updateAllCurrentTexture=function(){var a;var c=0;for(a=this.instances.length;c<a;c++){var b=this.instances[c];b.curWebGLTexture=b.curFrame.webGL_texture}};a.onLostWebGLContext=function(){if(!this.is_family){var a;var c=0;for(a=this.all_frames.length;c<a;++c){var b=this.all_frames[c];b.texture_img.c2webGL_texture=null;b.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};a.onRestoreWebGLContext=
function(){if(!this.is_family&&this.instances.length){var a;var c=0;for(a=this.all_frames.length;c<a;++c){var b=this.all_frames[c];b.webGL_texture=this.runtime.glwrap.loadTexture(b.texture_img,!1,this.runtime.linearSampling,b.pixelformat)}this.updateAllCurrentTexture()}};a.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var a;var c=0;for(a=this.all_frames.length;c<a;++c){var b=this.all_frames[c];b.webGL_texture=this.runtime.glwrap.loadTexture(b.texture_img,
!1,this.runtime.linearSampling,b.pixelformat)}this.has_loaded_textures=!0}};a.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var a;var c=0;for(a=this.all_frames.length;c<a;++c){var b=this.all_frames[c];this.runtime.glwrap.deleteTexture(b.webGL_texture);b.webGL_texture=null}this.has_loaded_textures=!1}};var t=[];a.preloadCanvas2D=function(a){var c;cr.clearArray(t);var b=0;for(c=this.all_frames.length;b<c;++b){var d=this.all_frames[b].texture_img;-1===
t.indexOf(d)&&(a.drawImage(d,0,0),t.push(d))}};h.Instance=function(a){this.type=a;this.runtime=a.runtime;a=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(a):this.collision_poly=new cr.CollisionPoly(a)};var y=h.Instance.prototype;y.onCreate=function(){this.visible=this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=this.properties[3];this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=
this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var a=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(a.poly_pts);this.hotspotX=a.hotspotX;this.hotspotY=a.hotspotY;this.animForwards=0<=this.cur_animation.speed;this.cur_anim_speed=Math.abs(this.cur_animation.speed);this.cur_anim_repeatto=this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||
0===this.cur_anim_speed||(this.runtime.tickMe(this),this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var c,b;a=0;for(c=this.type.animations.length;a<c;a++){var d=this.type.animations[a];var e=0;for(b=d.frames.length;e<b;e++){var k=d.frames[e];0===k.width&&(k.width=k.texture_img.width,
k.height=k.texture_img.height);if(k.spritesheeted){var l=k.texture_img;var h=k.sheetTex;h.left=k.offx/l.width;h.top=k.offy/l.height;h.right=(k.offx+k.width)/l.width;h.bottom=(k.offy+k.height)/l.height;0===k.offx&&0===k.offy&&k.width===l.width&&k.height===l.height&&(k.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture};y.saveToJSON=function(){var a={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,
ar:this.animRepeats,at:this.animTimer.sum,rt:this.cur_anim_repeatto};this.animPlaying||(a.ap=this.animPlaying);this.animForwards||(a.af=this.animForwards);return a};y.loadFromJSON=function(a){var c=this.getAnimationBySid(a.a);c&&(this.cur_animation=c);this.cur_frame=a.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=a.cas;this.frameStart=a.fs;this.animRepeats=a.ar;this.animTimer.reset();
this.animTimer.sum=a.at;this.animPlaying=a.hasOwnProperty("ap")?a.ap:!0;this.animForwards=a.hasOwnProperty("af")?a.af:!0;a.hasOwnProperty("rt")?this.cur_anim_repeatto=a.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};y.animationFinish=function(a){this.cur_frame=a?
0:this.cur_animation.frames.length-1;this.animPlaying=!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};y.getNowTime=function(){return this.animTimer.sum};y.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&
this.doChangeAnimFrame();var a=this.getNowTime(),c=this.cur_animation,b=c.frames[this.cur_frame],d=b.duration/this.cur_anim_speed;this.animPlaying&&a>=this.frameStart+d&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=d,this.cur_frame>=c.frames.length&&(c.pingpong?(this.animForwards=!1,this.cur_frame=c.frames.length-2):c.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=c.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),
0>this.cur_frame&&(c.pingpong?(this.cur_frame=1,this.animForwards=!0,c.loop||(this.animRepeats++,this.animRepeats>=c.repeatcount&&this.animationFinish(!0))):c.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=c.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=c.frames.length&&(this.cur_frame=c.frames.length-1),a>this.frameStart+c.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=
a),a=c.frames[this.cur_frame],this.OnFrameChanged(b,a),this.runtime.redraw=!0)};y.getAnimationByName=function(a){var c;var b=0;for(c=this.type.animations.length;b<c;b++){var d=this.type.animations[b];if(cr.equals_nocase(d.name,a))return d}return null};y.getAnimationBySid=function(a){var c;var b=0;for(c=this.type.animations.length;b<c;b++){var d=this.type.animations[b];if(d.sid===a)return d}return null};y.doChangeAnim=function(){var a=this.cur_animation.frames[this.cur_frame],c=this.getAnimationByName(this.changeAnimName);
this.changeAnimName="";!c||cr.equals_nocase(c.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=c,this.animForwards=0<=c.speed,this.cur_anim_speed=Math.abs(c.speed),this.cur_anim_repeatto=c.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),
this.runtime.redraw=!0)};y.doChangeAnimFrame=function(){var a=this.cur_animation.frames[this.cur_frame],c=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);c!==this.cur_frame&&(this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};y.OnFrameChanged=function(a,
c){var b=a.width,d=a.height,e=c.width,k=c.height;b!=e&&(this.width*=e/b);d!=k&&(this.height*=k/d);this.hotspotX=c.hotspotX;this.hotspotY=c.hotspotY;this.collision_poly.set_pts(c.poly_pts);this.set_bbox_changed();this.curFrame=c;this.curWebGLTexture=c.webGL_texture;b=0;for(d=this.behavior_insts.length;b<d;b++)if(e=this.behavior_insts[b],e.onSpriteFrameChanged)e.onSpriteFrameChanged(a,c);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};y.draw=function(a){a.globalAlpha=this.opacity;
var c=this.curFrame,b=c.spritesheeted,d=c.texture_img,e=this.x,k=this.y,l=this.width,h=this.height;if(0===this.angle&&0<=l&&0<=h)e-=this.hotspotX*l,k-=this.hotspotY*h,this.runtime.pixel_rounding&&(e=Math.round(e),k=Math.round(k)),b?a.drawImage(d,c.offx,c.offy,c.width,c.height,e,k,l,h):a.drawImage(d,e,k,l,h);else{this.runtime.pixel_rounding&&(e=Math.round(e),k=Math.round(k));a.save();var f=0<l?1:-1,m=0<h?1:-1;a.translate(e,k);1===f&&1===m||a.scale(f,m);a.rotate(this.angle*f*m);e=-(this.hotspotX*cr.abs(l));
k=-(this.hotspotY*cr.abs(h));b?a.drawImage(d,c.offx,c.offy,c.width,c.height,e,k,cr.abs(l),cr.abs(h)):a.drawImage(d,e,k,cr.abs(l),cr.abs(h));a.restore()}};y.drawGL_earlyZPass=function(a){this.drawGL(a)};y.drawGL=function(a){a.setTexture(this.curWebGLTexture);a.setOpacity(this.opacity);var c=this.curFrame,b=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,e=Math.round(this.y)-this.y;c.spritesheeted?a.quadTex(b.tlx+d,b.tly+e,b.trx+d,b.try_+e,b.brx+d,b.bry+e,b.blx+d,b.bly+e,
c.sheetTex):a.quad(b.tlx+d,b.tly+e,b.trx+d,b.try_+e,b.brx+d,b.bry+e,b.blx+d,b.bly+e)}else c.spritesheeted?a.quadTex(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly,c.sheetTex):a.quad(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly)};y.getImagePointIndexByName=function(a){var c=this.curFrame,b;var d=0;for(b=c.image_points.length;d<b;d++)if(cr.equals_nocase(a,c.image_points[d][0]))return d;return-1};y.getImagePoint=function(a,c){var b=this.curFrame,d=b.image_points;var e=cr.is_string(a)?this.getImagePointIndexByName(a):
a-1;e=cr.floor(e);if(0>e||e>=d.length)return c?this.x:this.y;a=(d[e][1]-b.hotspotX)*this.width;d=d[e][2];d=(d-b.hotspotY)*this.height;b=Math.cos(this.angle);e=Math.sin(this.angle);var k=a*b-d*e;d=d*b+a*e;a=k+this.x;d+=this.y;return c?a:d};var z=[],A=-2,k=[];p.prototype.OnCollision=function(a){if(!a)return!1;var c=this.runtime,b=c.getCurrentCondition(),e=b.type,l=null;b.extra.collmemory?l=b.extra.collmemory:(l={},b.extra.collmemory=l);b.extra.spriteCreatedDestroyCallback||(b.extra.spriteCreatedDestroyCallback=
!0,c.addDestroyCallback(function(a){var c=b.extra.collmemory;a=a.uid;var d;for(d in c)if(c.hasOwnProperty(d)){var e=c[d];if(e[0]===a||e[1]===a)q(c[d]),delete c[d]}}));var h=e.getCurrentSol(),f=a.getCurrentSol();h=h.getObjects();var t,z,B=this.runtime.tickcount,n=B-1,p=c.getCurrentEventStack().current_event;for(t=0;t<h.length;t++){var y=h[t];if(f.select_all){y.update_bbox();this.runtime.getCollisionCandidates(y.layer,a,y.bbox,k);var H=k;this.runtime.addRegisteredCollisionCandidates(y,a,H)}else H=f.getObjects();
for(z=0;z<H.length;z++){var w=H[z];if(c.testOverlap(y,w)||c.checkRegisteredCollision(y,w)){var G=d(l,y,w);G=!G||A<n;u(l,y,w,B);if(G){c.pushCopySol(p.solModifiers);G=e.getCurrentSol();var N=a.getCurrentSol();G.select_all=!1;N.select_all=!1;e===a?(G.instances.length=2,G.instances[0]=y,G.instances[1]=w,e.applySolToContainer()):(G.instances.length=1,N.instances.length=1,G.instances[0]=y,N.instances[0]=w,e.applySolToContainer(),a.applySolToContainer());p.retrigger();c.popSol(p.solModifiers)}}else m(l,
y,w)}cr.clearArray(k)}return!1};var l=null,B=new cr.ObjectSet,G=!1,N=[],U=new cr.rect(0,0,0,0);a.finish=function(a){if(G){if(a){var c=this.runtime.getCurrentEventStack().current_event.orblock;a=l.getCurrentSol();var b=B.valuesRef(),d;if(a.select_all){a.select_all=!1;cr.clearArray(a.instances);var e=0;for(d=b.length;e<d;++e)a.instances[e]=b[e];if(c)for(cr.clearArray(a.else_instances),e=0,d=l.instances.length;e<d;++e)b=l.instances[e],B.contains(b)||a.else_instances.push(b)}else if(c)for(c=a.instances.length,
e=0,d=b.length;e<d;++e)a.instances[c+e]=b[e],cr.arrayFindRemove(a.else_instances,b[e]);else cr.shallowAssignArray(a.instances,b);l.applySolToContainer()}B.clear();G=!1}};p.prototype.IsOverlapping=function(a){return b.call(this,a,0,0)};p.prototype.IsOverlappingOffset=function(a,c,d){return b.call(this,a,c,d)};p.prototype.IsAnimPlaying=function(a){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,a):cr.equals_nocase(this.cur_animation.name,a)};p.prototype.CompareFrame=function(a,
c){return cr.do_cmp(this.cur_frame,a,c)};p.prototype.CompareAnimSpeed=function(a,c){return cr.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,a,c)};p.prototype.OnAnimFinished=function(a){return cr.equals_nocase(this.animTriggerName,a)};p.prototype.OnAnyAnimFinished=function(){return!0};p.prototype.OnFrameChanged=function(){return!0};p.prototype.IsMirrored=function(){return 0>this.width};p.prototype.IsFlipped=function(){return 0>this.height};p.prototype.OnURLLoaded=function(){return!0};
p.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled};h.cnds=new p;e.prototype.Spawn=function(a,c,b){if(a&&c&&(c=this.runtime.createInstance(a,c,this.getImagePoint(b,!0),this.getImagePoint(b,!1)))){"undefined"!==typeof c.angle&&(c.angle=this.angle,c.set_bbox_changed());this.runtime.isInOnDestroy++;var d;this.runtime.trigger(Object.getPrototypeOf(a.plugin).cnds.OnCreated,c);if(c.is_contained){var e=0;for(d=c.siblings.length;e<d;e++){var k=c.siblings[e];this.runtime.trigger(Object.getPrototypeOf(k.type.plugin).cnds.OnCreated,
k)}}this.runtime.isInOnDestroy--;e=this.runtime.getCurrentAction();b=!1;if(cr.is_undefined(e.extra.Spawn_LastExec)||e.extra.Spawn_LastExec<this.runtime.execcount)b=!0,e.extra.Spawn_LastExec=this.runtime.execcount;if(a!=this.type&&(a=a.getCurrentSol(),a.select_all=!1,b?(cr.clearArray(a.instances),a.instances[0]=c):a.instances.push(c),c.is_contained))for(e=0,d=c.siblings.length;e<d;e++)k=c.siblings[e],a=k.type.getCurrentSol(),a.select_all=!1,b?(cr.clearArray(a.instances),a.instances[0]=k):a.instances.push(k)}};
e.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};e.prototype.StopAnim=function(){this.animPlaying=!1};e.prototype.StartAnim=function(a){this.animPlaying=!0;this.frameStart=this.getNowTime();1===a&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};e.prototype.SetAnim=function(a,c){this.changeAnimName=
a;this.changeAnimFrom=c;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};e.prototype.SetAnimFrame=function(a){this.changeAnimFrame=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnimFrame()};e.prototype.SetAnimSpeed=function(a){this.cur_anim_speed=cr.abs(a);this.animForwards=0<=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};e.prototype.SetAnimRepeatToFrame=function(a){a=Math.floor(a);
0>a&&(a=0);a>=this.cur_animation.frames.length&&(a=this.cur_animation.frames.length-1);this.cur_anim_repeatto=a};e.prototype.SetMirrored=function(a){a=cr.abs(this.width)*(0===a?-1:1);this.width!==a&&(this.width=a,this.set_bbox_changed())};e.prototype.SetFlipped=function(a){a=cr.abs(this.height)*(0===a?-1:1);this.height!==a&&(this.height=a,this.set_bbox_changed())};e.prototype.SetScale=function(a){var c=this.curFrame,b=c.width*a*(0>this.width?-1:1);a=c.height*a*(0>this.height?-1:1);if(this.width!==
b||this.height!==a)this.width=b,this.height=a,this.set_bbox_changed()};e.prototype.LoadURL=function(a,c,b){var d=new Image,e=this,k=this.curFrame;d.onload=function(){k.texture_img.src===d.src?e.runtime.glwrap&&e.curFrame===k&&(e.curWebGLTexture=k.webGL_texture):(k.texture_img=d,k.offx=0,k.offy=0,k.width=d.width,k.height=d.height,k.spritesheeted=!1,k.datauri="",k.pixelformat=0,e.runtime.glwrap&&(k.webGL_texture&&e.runtime.glwrap.deleteTexture(k.webGL_texture),k.webGL_texture=e.runtime.glwrap.loadTexture(d,
!1,e.runtime.linearSampling),e.curFrame===k&&(e.curWebGLTexture=k.webGL_texture),e.type.updateAllCurrentTexture()));0===c&&(e.width=d.width,e.height=d.height,e.set_bbox_changed());e.runtime.redraw=!0;e.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,e)};"data:"!==a.substr(0,5)&&0===b&&(d.crossOrigin="anonymous");this.runtime.setImageSrc(d,a)};e.prototype.SetCollisions=function(a){this.collisionsEnabled!==(0!==a)&&((this.collisionsEnabled=0!==a)?this.set_bbox_changed():(this.collcells.right>=
this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};h.acts=new e;w.prototype.AnimationFrame=function(a){a.set_int(this.cur_frame)};w.prototype.AnimationFrameCount=function(a){a.set_int(this.cur_animation.frames.length)};w.prototype.AnimationName=function(a){a.set_string(this.cur_animation.name)};w.prototype.AnimationSpeed=function(a){a.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};w.prototype.ImagePointX=function(a,
c){a.set_float(this.getImagePoint(c,!0))};w.prototype.ImagePointY=function(a,c){a.set_float(this.getImagePoint(c,!1))};w.prototype.ImagePointCount=function(a){a.set_int(this.curFrame.image_points.length)};w.prototype.ImageWidth=function(a){a.set_float(this.curFrame.width)};w.prototype.ImageHeight=function(a){a.set_float(this.curFrame.height)};h.exps=new w})();cr.plugins_.Text=function(f){this.runtime=f};
(function(){function f(){return h.length?h.pop():{}}function p(a){var b;var d=0;for(b=a.length;d<b;d++)h.push(a[d]);cr.clearArray(a)}function q(a){return a.length&&" "===a.charAt(a.length-1)?a.substring(0,a.length-1):a}function n(){}function u(){}function m(){}var d=cr.plugins_.Text.prototype;d.onCreate=function(){d.acts.SetWidth=function(a){this.width!==a&&(this.width=a,this.text_changed=!0,this.set_bbox_changed())}};d.Type=function(a){this.plugin=a;this.runtime=a.runtime};var b=d.Type.prototype;
b.onCreate=function(){};b.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;b++){var d=this.instances[b];d.mycanvas=null;d.myctx=null;d.mytex=null}}};d.Instance=function(a){this.type=a;this.runtime=a.runtime;this.recycled?cr.clearArray(this.lines):this.lines=[];this.text_changed=!0};b=d.Instance.prototype;var e={};b.onCreate=function(){this.text=this.properties[0];this.facename=this.properties[2];this.ptSize=this.properties[3];this.line_height_offset=
this.properties[4];this.isBold=this.properties[5];this.isItalic=this.properties[6];var a=this.properties[7];this.color="rgb("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*a[2])+")";this.halign=this.properties[8];this.valign=this.properties[9];this.wrapbyword=0===this.properties[10];this.visible=this.properties[11];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.fontstyle=this.font="";this.textHeight=this.textWidth=this.pxHeight=0;this.updateFont();
this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1);this.runtime.glwrap&&this.runtime.tickMe(this)};b.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};
b.loadFromJSON=function(a){this.text=a.t;this.font=a.f;this.color=a.c;this.halign=a.ha;this.valign=a.va;this.wrapbyword=a.wr;this.line_height_offset=a.lho;this.facename=a.fn;this.fontstyle=a.fs;this.ptSize=a.ps;this.pxHeight=a.pxh;this.textWidth=a.tw;this.textHeight=a.th;this.last_render_tick=a.lrt;this.isBold=0!==this.fontstyle.indexOf("bold");this.isItalic=0!==this.fontstyle.indexOf("italic");this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height};b.tick=function(){if(this.runtime.glwrap&&
this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var a=this.layer;this.update_bbox();var b=this.bbox;if(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};b.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};b.updateFont=function(){this.pxHeight=Math.ceil(this.ptSize/72*96)+
4;var a=[];this.isBold&&a.push("bold");this.isItalic&&a.push("italic");this.fontstyle=a.join(" ");this.font=this.fontstyle+" "+this.ptSize.toString()+"pt '"+this.facename+"'";this.text_changed=!0;this.runtime.redraw=!0};b.draw=function(a,b){a.font=this.font;a.textBaseline="top";a.fillStyle=this.color;a.globalAlpha=b?1:this.opacity;if(b){var d=this.layer.getScale();a.save();a.scale(d,d)}if(this.text_changed||this.width!==this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,a,this.width,
this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();d=b?0:this.bquad.tlx;var e=b?0:this.bquad.tly;this.runtime.pixel_rounding&&(d=d+.5|0,e=e+.5|0);0===this.angle||b||(a.save(),a.translate(d,e),a.rotate(this.angle),e=d=0);var h=e+this.height,k=this.pxHeight;k+=this.line_height_offset;var l;1===this.valign?e+=Math.max(this.height/2-this.lines.length*k/2,0):2===this.valign&&(e+=Math.max(this.height-this.lines.length*k-2,0));for(l=0;l<this.lines.length;l++){var f=d;
1===this.halign?f=d+(this.width-this.lines[l].width)/2:2===this.halign&&(f=d+(this.width-this.lines[l].width));a.fillText(this.lines[l].text,f,e);e+=k;if(e>=h-k)break}(0!==this.angle||b)&&a.restore();this.last_render_tick=this.runtime.tickcount};b.drawGL=function(a){if(!(1>this.width||1>this.height)){var b=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var d=this.layer.getScale(),e=this.layer.getAngle(),h=this.rcTex,k=d*this.width,l=d*this.height,f=Math.ceil(k),m=Math.ceil(l),n=
this.runtime.draw_width/2,p=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=f,this.mycanvas.height=m,this.lastwidth=f,this.lastheight=m,b=!0,this.myctx=this.mycanvas.getContext("2d"));if(f!==this.lastwidth||m!==this.lastheight)this.mycanvas.width=f,this.mycanvas.height=m,this.mytex&&(a.deleteTexture(this.mytex),this.mytex=null),b=!0;b&&(this.myctx.clearRect(0,0,f,m),this.draw(this.myctx,!0),this.mytex||(this.mytex=a.createEmptyTexture(f,m,
this.runtime.linearSampling,this.runtime.isMobile)),a.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile));this.lastwidth=f;this.lastheight=m;a.setTexture(this.mytex);a.setOpacity(this.opacity);a.resetModelView();a.translate(-n,-p);a.updateModelView();var q=this.bquad;b=this.layer.layerToCanvas(q.tlx,q.tly,!0,!0);n=this.layer.layerToCanvas(q.tlx,q.tly,!1,!0);p=this.layer.layerToCanvas(q.trx,q.try_,!0,!0);var c=this.layer.layerToCanvas(q.trx,q.try_,!1,!0),g=this.layer.layerToCanvas(q.brx,
q.bry,!0,!0),r=this.layer.layerToCanvas(q.brx,q.bry,!1,!0),v=this.layer.layerToCanvas(q.blx,q.bly,!0,!0);q=this.layer.layerToCanvas(q.blx,q.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===e){var u=(b+.5|0)-b,w=(n+.5|0)-n;b+=u;n+=w;p+=u;c+=w;g+=u;r+=w;v+=u;q+=w}0===this.angle&&0===e?(p=b+f,c=n,g=p,r=n+m,v=b,q=r,h.right=1,h.bottom=1):(h.right=k/f,h.bottom=l/m);a.quadTex(b,n,p,c,g,r,v,q,h);a.resetModelView();a.scale(d,d);a.rotateZ(-this.layer.getAngle());a.translate((this.layer.viewLeft+
this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);a.updateModelView();this.last_render_tick=this.runtime.tickcount}};var w=[];d.TokeniseWords=function(a){cr.clearArray(w);for(var b="",d,e=0;e<a.length;)if(d=a.charAt(e),"\n"===d)b.length&&(w.push(b),b=""),w.push("\n"),++e;else if(" "===d||"\t"===d||"-"===d){do b+=a.charAt(e),e++;while(e<a.length&&(" "===a.charAt(e)||"\t"===a.charAt(e)));w.push(b);b=""}else e<a.length&&(b+=d,e++);b.length&&w.push(b)};var h=[];d.WordWrap=function(a,
b,d,e,h){if(a&&a.length)if(2>=e)p(b);else{if(100>=a.length&&-1===a.indexOf("\n")){var k=d.measureText(a).width;if(k<=e){p(b);b.push(f());b[0].text=a;b[0].width=k;return}}this.WrapText(a,b,d,e,h)}else p(b)};d.WrapText=function(a,b,d,e,m){m&&(this.TokeniseWords(a),a=w);var k="",l,t=0;for(l=0;l<a.length;l++)if("\n"===a[l]){t>=b.length&&b.push(f());k=q(k);var z=b[t];z.text=k;z.width=d.measureText(k).width;t++;k=""}else{var n=k;k+=a[l];z=d.measureText(q(k)).width;z>=e&&(t>=b.length&&b.push(f()),n=q(n),
z=b[t],z.text=n,z.width=d.measureText(n).width,t++,k=a[l],m||" "!==k||(k=""))}k.length&&(t>=b.length&&b.push(f()),k=q(k),z=b[t],z.text=k,z.width=d.measureText(k).width,t++);for(l=t;l<b.length;l++)h.push(b[l]);b.length=t};n.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};d.cnds=new n;u.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.text!==a&&(this.text=a,this.text_changed=!0,this.runtime.redraw=!0)};u.prototype.AppendText=
function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);if(a=a.toString())this.text+=a,this.text_changed=!0,this.runtime.redraw=!0};u.prototype.SetFontFace=function(a,b){var d=!1,e=!1;switch(b){case 1:d=!0;break;case 2:e=!0;break;case 3:e=d=!0}if(a!==this.facename||this.isBold!==d||this.isItalic!==e)this.facename=a,this.isBold=d,this.isItalic=e,this.updateFont()};u.prototype.SetFontSize=function(a){this.ptSize!==a&&(this.ptSize=a,this.updateFont())};u.prototype.SetFontColor=function(a){var b=cr.clamp(Math.floor(255*
cr.GetRValue(a)),0,255),d=cr.clamp(Math.floor(255*cr.GetGValue(a)),0,255);a=cr.clamp(Math.floor(255*cr.GetBValue(a)),0,255);b="rgb("+b+","+d+","+a+")";b!==this.color&&(this.color=b,this.need_text_redraw=!0,this.runtime.redraw=!0)};u.prototype.SetWebFont=function(a,b){var d=this,h=function(){d.runtime.redraw=!0;d.text_changed=!0};if(e.hasOwnProperty(b)){if(a="'"+a+"'",this.facename!==a)for(this.facename=a,this.updateFont(),a=1;10>a;a++)setTimeout(h,100*a),setTimeout(h,1E3*a)}else{var f=document.createElement("link");
f.href=b;f.rel="stylesheet";f.type="text/css";f.onload=h;document.getElementsByTagName("head")[0].appendChild(f);e[b]=!0;this.facename="'"+a+"'";this.updateFont();for(a=1;10>a;a++)setTimeout(h,100*a),setTimeout(h,1E3*a)}};u.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};d.acts=new u;m.prototype.Text=function(a){a.set_string(this.text)};m.prototype.FaceName=function(a){a.set_string(this.facename)};
m.prototype.FaceSize=function(a){a.set_int(this.ptSize)};m.prototype.TextWidth=function(a){var b=0,d;var e=0;for(d=this.lines.length;e<d;e++){var h=this.lines[e].width;b<h&&(b=h)}a.set_int(b)};m.prototype.TextHeight=function(a){a.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};d.exps=new m})();cr.plugins_.Audio=function(f){this.runtime=f};
(function(){function f(a){-1===ja.indexOf(a)&&ja.push(a)}function p(a){var c=a.instanceObject;try{var b=c.play()}catch(za){f(a);return}b?b.catch(function(c){f(a)}):qa&&!R.isInUserInputEvent&&f(a)}function q(){var a,c;ra||la||!C||(n(),"running"===C.state&&(ra=!0));var b=ja.slice(0);cr.clearArray(ja);if(!Y){var d=0;for(a=b.length;d<a;++d){var e=b[d];e.stopped||e.is_paused||(c=e.instanceObject.play())&&c.catch(function(a){f(e)})}}}function n(){"suspended"===C.state&&C.resume&&C.resume();if(C.createBuffer){var a=
C.createBuffer(1,220,22050),c=C.createBufferSource();c.buffer=a;c.connect(C.destination);w(c)}}function u(a){a=Math.pow(10,a/20);isFinite(a)||(a=0);0>a&&(a=0);1<a&&(a=1);return a}function m(a){0>a&&(a=0);1<a&&(a=1);return Math.log(a)/Math.log(10)*20}function d(a){a=a.toLowerCase();return V.hasOwnProperty(a)&&V[a].length?V[a][0].getInputNode():C.destination}function b(){return C.createGain?C.createGain():C.createGainNode()}function e(a){return C.createDelay?C.createDelay(a):C.createDelayNode(a)}function w(a,
c){a.start?a.start(c||0):a.noteOn(c||0)}function h(a,c,b,d){a.start?a.start(d||0,c):a.noteGrainOn(d||0,c,b-c)}function a(a){try{a.stop?a.stop(0):a.noteOff(0)}catch(pa){}}function t(a,c,b,d){if(a)if(a.cancelScheduledValues(0),0===d)a.value=c;else{var e=C.currentTime;d+=e;switch(b){case 0:a.setValueAtTime(c,d);break;case 1:a.setValueAtTime(a.value,e);a.linearRampToValueAtTime(c,d);break;case 2:a.setValueAtTime(a.value,e),a.exponentialRampToValueAtTime(c,d)}}}function y(a,c,d,e,k,g){this.type="filter";
this.params=[a,c,d,e,k,g];this.inputNode=b();this.wetNode=b();this.wetNode.gain.value=g;this.dryNode=b();this.dryNode.gain.value=1-g;this.filterNode=C.createBiquadFilter();this.filterNode.type="number"===typeof this.filterNode.type?a:ta[a];this.filterNode.frequency.value=c;this.filterNode.detune&&(this.filterNode.detune.value=d);this.filterNode.Q.value=e;this.filterNode.gain.value=k;this.inputNode.connect(this.filterNode);this.inputNode.connect(this.dryNode);this.filterNode.connect(this.wetNode)}
function z(a,c,d){this.type="delay";this.params=[a,c,d];this.inputNode=b();this.wetNode=b();this.wetNode.gain.value=d;this.dryNode=b();this.dryNode.gain.value=1-d;this.mainNode=b();this.delayNode=e(a);this.delayNode.delayTime.value=a;this.delayGainNode=b();this.delayGainNode.gain.value=c;this.inputNode.connect(this.mainNode);this.inputNode.connect(this.dryNode);this.mainNode.connect(this.wetNode);this.mainNode.connect(this.delayNode);this.delayNode.connect(this.delayGainNode);this.delayGainNode.connect(this.mainNode)}
function A(a,c,d,e){this.type="convolve";this.params=[c,d,e];this.inputNode=b();this.wetNode=b();this.wetNode.gain.value=d;this.dryNode=b();this.dryNode.gain.value=1-d;this.convolveNode=C.createConvolver();a&&(this.convolveNode.normalize=c,this.convolveNode.buffer=a);this.inputNode.connect(this.convolveNode);this.inputNode.connect(this.dryNode);this.convolveNode.connect(this.wetNode)}function k(a,c,d,k,g){this.type="flanger";this.params=[a,c,d,k,g];this.inputNode=b();this.dryNode=b();this.dryNode.gain.value=
1-g/2;this.wetNode=b();this.wetNode.gain.value=g/2;this.feedbackNode=b();this.feedbackNode.gain.value=k;this.delayNode=e(a+c);this.delayNode.delayTime.value=a;this.oscNode=C.createOscillator();this.oscNode.frequency.value=d;this.oscGainNode=b();this.oscGainNode.gain.value=c;this.inputNode.connect(this.delayNode);this.inputNode.connect(this.dryNode);this.delayNode.connect(this.wetNode);this.delayNode.connect(this.feedbackNode);this.feedbackNode.connect(this.delayNode);this.oscNode.connect(this.oscGainNode);
this.oscGainNode.connect(this.delayNode.delayTime);w(this.oscNode)}function l(a,c,d,e,k,g){this.type="phaser";this.params=[a,c,d,e,k,g];this.inputNode=b();this.dryNode=b();this.dryNode.gain.value=1-g/2;this.wetNode=b();this.wetNode.gain.value=g/2;this.filterNode=C.createBiquadFilter();this.filterNode.type="number"===typeof this.filterNode.type?7:"allpass";this.filterNode.frequency.value=a;this.filterNode.detune&&(this.filterNode.detune.value=c);this.filterNode.Q.value=d;this.oscNode=C.createOscillator();
this.oscNode.frequency.value=k;this.oscGainNode=b();this.oscGainNode.gain.value=e;this.inputNode.connect(this.filterNode);this.inputNode.connect(this.dryNode);this.filterNode.connect(this.wetNode);this.oscNode.connect(this.oscGainNode);this.oscGainNode.connect(this.filterNode.frequency);w(this.oscNode)}function B(a){this.type="gain";this.params=[a];this.node=b();this.node.gain.value=a}function G(a,c){this.type="tremolo";this.params=[a,c];this.node=b();this.node.gain.value=1-c/2;this.oscNode=C.createOscillator();
this.oscNode.frequency.value=a;this.oscGainNode=b();this.oscGainNode.gain.value=c/2;this.oscNode.connect(this.oscGainNode);this.oscGainNode.connect(this.node.gain);w(this.oscNode)}function N(a,c){this.type="ringmod";this.params=[a,c];this.inputNode=b();this.wetNode=b();this.wetNode.gain.value=c;this.dryNode=b();this.dryNode.gain.value=1-c;this.ringNode=b();this.ringNode.gain.value=0;this.oscNode=C.createOscillator();this.oscNode.frequency.value=a;this.oscNode.connect(this.ringNode.gain);w(this.oscNode);
this.inputNode.connect(this.ringNode);this.inputNode.connect(this.dryNode);this.ringNode.connect(this.wetNode)}function U(a,c,d,e,k){this.type="distortion";this.params=[a,c,d,e,k];this.inputNode=b();this.preGain=b();this.postGain=b();this.setDrive(d,Math.pow(10,e/20));this.wetNode=b();this.wetNode.gain.value=k;this.dryNode=b();this.dryNode.gain.value=1-k;this.waveShaper=C.createWaveShaper();this.curve=new Float32Array(65536);this.generateColortouchCurve(a,c);this.waveShaper.curve=this.curve;this.inputNode.connect(this.preGain);
this.inputNode.connect(this.dryNode);this.preGain.connect(this.waveShaper);this.waveShaper.connect(this.postGain);this.postGain.connect(this.wetNode)}function H(a,c,b,d,e){this.type="compressor";this.params=[a,c,b,d,e];this.node=C.createDynamicsCompressor();try{this.node.threshold.value=a,this.node.knee.value=c,this.node.ratio.value=b,this.node.attack.value=d,this.node.release.value=e}catch(sa){}}function c(a,c){this.type="analyser";this.params=[a,c];this.node=C.createAnalyser();this.node.fftSize=
a;this.node.smoothingTimeConstant=c;this.freqBins=new Float32Array(this.node.frequencyBinCount);this.signal=new Uint8Array(a);this.rms=this.peak=0}function g(){this.obj=null;this.loadUid=0}function r(a,c,d){this.src=a;this.type=c;this.myapi=D;this.is_music=d;this.added_end_listener=!1;var e=this;this.mediaSourceNode=this.outNode=null;this.panWhenReady=[];this.seekWhenReady=0;this.failedToLoad=this.supportWebAudioAPI=this.pauseWhenReady=!1;this.needsSoftwareDecode="audio/webm; codecs=opus"===this.type&&
!ya;this.wasEverReady=!1;this.is_music&&this.needsSoftwareDecode&&(ua=!0);1!==D||!d||ka||this.needsSoftwareDecode||(this.myapi=0,this.outNode=b());this.audioData=this.bufferObject=null;switch(this.myapi){case 0:this.bufferObject=new Audio;this.bufferObject.crossOrigin="anonymous";this.bufferObject.addEventListener("canplaythrough",function(){e.wasEverReady=!0});1===D&&C.createMediaElementSource&&!/wiiu/i.test(navigator.userAgent)&&(this.supportWebAudioAPI=!0,this.bufferObject.addEventListener("canplay",
function(){!e.mediaSourceNode&&e.bufferObject&&(e.mediaSourceNode=C.createMediaElementSource(e.bufferObject),e.mediaSourceNode.connect(e.outNode))}));this.bufferObject.autoplay=!1;this.bufferObject.preload="auto";this.bufferObject.src=a;break;case 1:if(R.isWKWebView)R.fetchLocalFileViaCordovaAsArrayBuffer(a,function(a){e.audioData=a;e.decodeAudioBuffer()},function(a){e.failedToLoad=!0});else{var k=new XMLHttpRequest;k.open("GET",a,!0);k.responseType="arraybuffer";k.onload=function(){e.audioData=k.response;
e.decodeAudioBuffer()};k.onerror=function(){e.failedToLoad=!0};k.send()}break;case 2:this.bufferObject=!0}}function v(a,c){var e=this;this.tag=c;this.stopped=this.fresh=!0;this.src=a.src;this.buffer=a;this.myapi=D;this.is_music=a.is_music;this.playbackRate=1;this.hasPlaybackEnded=!0;this.is_paused=this.resume_me=!1;this.resume_position=0;this.is_silent=this.is_muted=this.looping=!1;this.volume=1;this.onended_handler=function(a){if(!e.is_paused&&!e.resume_me){var c=this;c||(c=a.target);c===e.active_buffer&&
(e.hasPlaybackEnded=!0,e.stopped=!0,P=e.tag,R.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,F))}};this.active_buffer=null;this.isTimescaled=1===ea&&!this.is_music||2===ea;this.mutevol=1;this.startTime=this.isTimescaled?R.kahanTime.sum:R.wallTime.sum;this.pannerNode=this.gainNode=null;this.pannerEnabled=!1;this.objectTracker=null;this.panConeOuterGain=this.panConeOuter=this.panConeInner=this.panAngle=this.panY=this.panX=0;this.instanceObject=null;var k=!1;1!==this.myapi||0!==this.buffer.myapi||
this.buffer.supportWebAudioAPI||(this.myapi=0);switch(this.myapi){case 0:this.is_music?(this.instanceObject=a.bufferObject,k=!a.added_end_listener,a.added_end_listener=!0):(this.instanceObject=new Audio,this.instanceObject.crossOrigin="anonymous",this.instanceObject.autoplay=!1,this.instanceObject.src=a.bufferObject.src,k=!0);k&&this.instanceObject.addEventListener("ended",function(){P=e.tag;e.stopped=!0;R.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,F)});break;case 1:this.gainNode=b();this.gainNode.connect(d(c));
1===this.buffer.myapi?a.bufferObject&&(this.instanceObject=C.createBufferSource(),this.instanceObject.buffer=a.bufferObject,this.instanceObject.connect(this.gainNode)):(this.instanceObject=this.buffer.bufferObject,this.buffer.outNode.connect(this.gainNode),this.buffer.added_end_listener||(this.buffer.added_end_listener=!0,this.buffer.bufferObject.addEventListener("ended",function(){P=e.tag;e.stopped=!0;R.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,F)})));break;case 2:this.instanceObject=new window.Media(L+
this.src,null,null,function(a){a===window.Media.MEDIA_STOPPED&&(e.hasPlaybackEnded=!0,e.stopped=!0,P=e.tag,R.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,F))})}}function K(a,c){a=a.isPlaying()?1:0;c=c.isPlaying()?1:0;return a===c?0:a<c?1:-1}function O(a,c){cr.clearArray(S);if(a.length){var b;var d=0;for(b=Q.length;d<b;d++){var e=Q[d];cr.equals_nocase(a,e.tag)&&S.push(e)}c&&S.sort(K)}else T&&!T.hasEnded()&&(cr.clearArray(S),S[0]=T)}function Z(a){var c,b=C.destination;if(V.hasOwnProperty(a)){var d=
V[a];if(d.length){b=d[0].getInputNode();var e=0;for(c=d.length;e<c;e++){var k=d[e];e+1===c?k.connectTo(C.destination):k.connectTo(d[e+1].getInputNode())}}}O(a);e=0;for(c=S.length;e<c;e++)S[e].reconnect(b);fa&&ma===a&&(fa.disconnect(),fa.connect(b))}function I(a,c){V.hasOwnProperty(a)?V[a].push(c):V[a]=[c];Z(a)}function J(){}function E(){}function x(){}function W(a,c){var b=null;V.hasOwnProperty(a)&&(b=V[a]);return b&&0<=c&&c<b.length&&b[c].freqBins?b[c]:null}var M=cr.plugins_.Audio.prototype;M.Type=
function(a){this.plugin=a;this.runtime=a.runtime};M.Type.prototype.onCreate=function(){};var R=null,F=null,P="",L="",D=0,C=null,X=[],Q=[],T=null,ea=0,Y=!1,aa=1,ca=0,da=0,la=!1,ya=!!(new Audio).canPlayType("audio/webm; codecs=opus"),na=1,oa=1,va=10,wa=1E4,xa=1,fa=null,ma="",qa=!1,ja=[],ka=!1,ua=!1,ra=!1;document.addEventListener("pointerup",q,!0);document.addEventListener("touchend",q,!0);document.addEventListener("click",q,!0);document.addEventListener("keydown",q,!0);document.addEventListener("gamepadconnected",
q,!0);var V={},ta="lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ");y.prototype.connectTo=function(a){this.wetNode.disconnect();this.wetNode.connect(a);this.dryNode.disconnect();this.dryNode.connect(a)};y.prototype.remove=function(){this.inputNode.disconnect();this.filterNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};y.prototype.getInputNode=function(){return this.inputNode};y.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100;0>c&&(c=
0);1<c&&(c=1);this.params[5]=c;t(this.wetNode.gain,c,b,d);t(this.dryNode.gain,1-c,b,d);break;case 1:this.params[1]=c;t(this.filterNode.frequency,c,b,d);break;case 2:this.params[2]=c;t(this.filterNode.detune,c,b,d);break;case 3:this.params[3]=c;t(this.filterNode.Q,c,b,d);break;case 4:this.params[4]=c,t(this.filterNode.gain,c,b,d)}};z.prototype.connectTo=function(a){this.wetNode.disconnect();this.wetNode.connect(a);this.dryNode.disconnect();this.dryNode.connect(a)};z.prototype.remove=function(){this.inputNode.disconnect();
this.mainNode.disconnect();this.delayNode.disconnect();this.delayGainNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};z.prototype.getInputNode=function(){return this.inputNode};z.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100;0>c&&(c=0);1<c&&(c=1);this.params[2]=c;t(this.wetNode.gain,c,b,d);t(this.dryNode.gain,1-c,b,d);break;case 4:this.params[1]=u(c);t(this.delayGainNode.gain,u(c),b,d);break;case 5:this.params[0]=c,t(this.delayNode.delayTime,c,b,d)}};A.prototype.connectTo=
function(a){this.wetNode.disconnect();this.wetNode.connect(a);this.dryNode.disconnect();this.dryNode.connect(a)};A.prototype.remove=function(){this.inputNode.disconnect();this.convolveNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};A.prototype.getInputNode=function(){return this.inputNode};A.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100,0>c&&(c=0),1<c&&(c=1),this.params[1]=c,t(this.wetNode.gain,c,b,d),t(this.dryNode.gain,1-c,b,d)}};k.prototype.connectTo=function(a){this.dryNode.disconnect();
this.dryNode.connect(a);this.wetNode.disconnect();this.wetNode.connect(a)};k.prototype.remove=function(){this.inputNode.disconnect();this.delayNode.disconnect();this.oscNode.disconnect();this.oscGainNode.disconnect();this.dryNode.disconnect();this.wetNode.disconnect();this.feedbackNode.disconnect()};k.prototype.getInputNode=function(){return this.inputNode};k.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100;0>c&&(c=0);1<c&&(c=1);this.params[4]=c;t(this.wetNode.gain,c/2,b,d);t(this.dryNode.gain,
1-c/2,b,d);break;case 6:this.params[1]=c/1E3;t(this.oscGainNode.gain,c/1E3,b,d);break;case 7:this.params[2]=c;t(this.oscNode.frequency,c,b,d);break;case 8:this.params[3]=c/100,t(this.feedbackNode.gain,c/100,b,d)}};l.prototype.connectTo=function(a){this.dryNode.disconnect();this.dryNode.connect(a);this.wetNode.disconnect();this.wetNode.connect(a)};l.prototype.remove=function(){this.inputNode.disconnect();this.filterNode.disconnect();this.oscNode.disconnect();this.oscGainNode.disconnect();this.dryNode.disconnect();
this.wetNode.disconnect()};l.prototype.getInputNode=function(){return this.inputNode};l.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100;0>c&&(c=0);1<c&&(c=1);this.params[5]=c;t(this.wetNode.gain,c/2,b,d);t(this.dryNode.gain,1-c/2,b,d);break;case 1:this.params[0]=c;t(this.filterNode.frequency,c,b,d);break;case 2:this.params[1]=c;t(this.filterNode.detune,c,b,d);break;case 3:this.params[2]=c;t(this.filterNode.Q,c,b,d);break;case 6:this.params[3]=c;t(this.oscGainNode.gain,c,b,d);break;case 7:this.params[4]=
c,t(this.oscNode.frequency,c,b,d)}};B.prototype.connectTo=function(a){this.node.disconnect();this.node.connect(a)};B.prototype.remove=function(){this.node.disconnect()};B.prototype.getInputNode=function(){return this.node};B.prototype.setParam=function(a,c,b,d){switch(a){case 4:this.params[0]=u(c),t(this.node.gain,u(c),b,d)}};G.prototype.connectTo=function(a){this.node.disconnect();this.node.connect(a)};G.prototype.remove=function(){this.oscNode.disconnect();this.oscGainNode.disconnect();this.node.disconnect()};
G.prototype.getInputNode=function(){return this.node};G.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100;0>c&&(c=0);1<c&&(c=1);this.params[1]=c;t(this.node.gain.value,1-c/2,b,d);t(this.oscGainNode.gain.value,c/2,b,d);break;case 7:this.params[0]=c,t(this.oscNode.frequency,c,b,d)}};N.prototype.connectTo=function(a){this.wetNode.disconnect();this.wetNode.connect(a);this.dryNode.disconnect();this.dryNode.connect(a)};N.prototype.remove=function(){this.oscNode.disconnect();this.ringNode.disconnect();
this.inputNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};N.prototype.getInputNode=function(){return this.inputNode};N.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100;0>c&&(c=0);1<c&&(c=1);this.params[1]=c;t(this.wetNode.gain,c,b,d);t(this.dryNode.gain,1-c,b,d);break;case 7:this.params[0]=c,t(this.oscNode.frequency,c,b,d)}};U.prototype.setDrive=function(a,c){.01>a&&(a=.01);this.preGain.gain.value=a;this.postGain.gain.value=Math.pow(1/a,.6)*c};U.prototype.shape=
function(a,c,b){b=1.05*b*c-c;var d=0>a?-a:a;return(d<c?d:c+b*(1-Math.exp(-(1/b)*(d-c))))*(0>a?-1:1)};U.prototype.generateColortouchCurve=function(a,c){a=Math.pow(10,a/20);c=Math.pow(10,c/20);for(var b,d=0;32768>d;++d)b=d/32768,b=this.shape(b,a,c),this.curve[32768+d]=b,this.curve[32768-d-1]=-b};U.prototype.connectTo=function(a){this.wetNode.disconnect();this.wetNode.connect(a);this.dryNode.disconnect();this.dryNode.connect(a)};U.prototype.remove=function(){this.inputNode.disconnect();this.preGain.disconnect();
this.waveShaper.disconnect();this.postGain.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};U.prototype.getInputNode=function(){return this.inputNode};U.prototype.setParam=function(a,c,b,d){switch(a){case 0:c/=100,0>c&&(c=0),1<c&&(c=1),this.params[4]=c,t(this.wetNode.gain,c,b,d),t(this.dryNode.gain,1-c,b,d)}};H.prototype.connectTo=function(a){this.node.disconnect();this.node.connect(a)};H.prototype.remove=function(){this.node.disconnect()};H.prototype.getInputNode=function(){return this.node};
H.prototype.setParam=function(a,c,b,d){};c.prototype.tick=function(){this.node.getFloatFrequencyData(this.freqBins);this.node.getByteTimeDomainData(this.signal);for(var a=this.node.fftSize,c=0,b=this.peak=0,d;c<a;c++)d=(this.signal[c]-128)/128,0>d&&(d=-d),this.peak<d&&(this.peak=d),b+=d*d;this.peak=m(this.peak);this.rms=m(Math.sqrt(b/a))};c.prototype.connectTo=function(a){this.node.disconnect();this.node.connect(a)};c.prototype.remove=function(){this.node.disconnect()};c.prototype.getInputNode=function(){return this.node};
c.prototype.setParam=function(a,c,b,d){};g.prototype.setObject=function(a){this.obj=a};g.prototype.hasObject=function(){return!!this.obj};g.prototype.tick=function(a){};r.prototype.release=function(){var a,c;var b=a=0;for(c=Q.length;a<c;++a){var d=Q[a];Q[b]=d;d.buffer===this?d.stop():++b}Q.length=b;this.mediaSourceNode&&(this.mediaSourceNode.disconnect(),this.mediaSourceNode=null);this.outNode&&(this.outNode.disconnect(),this.outNode=null);this.audioData=this.bufferObject=null};r.prototype.decodeAudioBuffer=
function(){if(!this.bufferObject&&this.audioData){var a=this;if(this.needsSoftwareDecode){var c=this.audioData;this.audioData=null;window.OpusDecoder(c,function(c,b){if(c)a.onDecodeError(c);else c=C.createBuffer(1,b.length,48E3),c.getChannelData(0).set(b),a.onDecodeComplete(c)})}else C.decodeAudioData(this.audioData,function(c){a.onDecodeComplete(c)},function(c){a.onDecodeError(c)})}};r.prototype.onDecodeComplete=function(a){this.bufferObject=a;this.audioData=null;var c;if(cr.is_undefined(this.playTagWhenReady)||
Y)cr.is_undefined(this.convolveWhenReady)||(b=this.convolveWhenReady.convolveNode,b.normalize=this.normalizeWhenReady,b.buffer=a);else if(this.panWhenReady.length){var b=0;for(c=this.panWhenReady.length;b<c;b++){a=this.panWhenReady[b];var d=new v(this,a.thistag);d.setPannerEnabled(!0);if("undefined"!==typeof a.objUid&&(a.obj=R.getObjectByUID(a.objUid),!a.obj))continue;if(a.obj){var e=cr.rotatePtAround(a.obj.x,a.obj.y,-a.obj.layer.getAngle(),ca,da,!0),k=cr.rotatePtAround(a.obj.x,a.obj.y,-a.obj.layer.getAngle(),
ca,da,!1);d.setPan(e,k,cr.to_degrees(a.obj.angle-a.obj.layer.getAngle()),a.ia,a.oa,a.og);d.setObject(a.obj)}else d.setPan(a.x,a.y,a.a,a.ia,a.oa,a.og);d.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady);this.pauseWhenReady&&d.pause();Q.push(d)}cr.clearArray(this.panWhenReady)}else d=new v(this,this.playTagWhenReady||""),d.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady&&d.pause(),Q.push(d)};r.prototype.onDecodeError=function(a){self.failedToLoad=
!0;console.error("Failed to decode audio '"+this.src+"': "+a)};r.prototype.isLoaded=function(){switch(this.myapi){case 0:var a=4<=this.bufferObject.readyState;a&&(this.wasEverReady=!0);return a||this.wasEverReady;case 1:return!!this.audioData||!!this.bufferObject;case 2:return!0}return!1};r.prototype.isLoadedAndDecoded=function(){switch(this.myapi){case 0:return this.isLoaded();case 1:return!!this.bufferObject;case 2:return!0}return!1};r.prototype.hasFailedToLoad=function(){switch(this.myapi){case 0:return!!this.bufferObject.error;
case 1:return this.failedToLoad}return!1};v.prototype.hasEnded=function(){switch(this.myapi){case 0:return this.instanceObject.ended;case 1:return 1===this.buffer.myapi?!this.fresh&&!this.stopped&&this.instanceObject.loop||this.is_paused?!1:this.hasPlaybackEnded:this.instanceObject.ended;case 2:return this.hasPlaybackEnded}return!0};v.prototype.canBeRecycled=function(){return this.fresh||this.stopped?!0:this.hasEnded()};v.prototype.setPannerEnabled=function(a){1===D&&(!this.pannerEnabled&&a?this.gainNode&&
(this.pannerNode||(this.pannerNode=C.createPanner(),this.pannerNode.panningModel="number"===typeof this.pannerNode.panningModel?na:["equalpower","HRTF","soundfield"][na],this.pannerNode.distanceModel="number"===typeof this.pannerNode.distanceModel?oa:["linear","inverse","exponential"][oa],this.pannerNode.refDistance=va,this.pannerNode.maxDistance=wa,this.pannerNode.rolloffFactor=xa),this.gainNode.disconnect(),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(d(this.tag)),this.pannerEnabled=
!0):this.pannerEnabled&&!a&&this.gainNode&&(this.pannerNode.disconnect(),this.gainNode.disconnect(),this.gainNode.connect(d(this.tag)),this.pannerEnabled=!1))};v.prototype.setPan=function(a,c,b,d,e,k){this.pannerEnabled&&1===D&&(this.pannerNode.setPosition(a,c,0),this.pannerNode.setOrientation(Math.cos(cr.to_radians(b)),Math.sin(cr.to_radians(b)),0),this.pannerNode.coneInnerAngle=d,this.pannerNode.coneOuterAngle=e,this.pannerNode.coneOuterGain=k,this.panX=a,this.panY=c,this.panAngle=b,this.panConeInner=
d,this.panConeOuter=e,this.panConeOuterGain=k)};v.prototype.setObject=function(a){this.pannerEnabled&&1===D&&(this.objectTracker||(this.objectTracker=new g),this.objectTracker.setObject(a))};v.prototype.tick=function(a){if(this.pannerEnabled&&1===D&&this.objectTracker&&this.objectTracker.hasObject()&&this.isPlaying()){this.objectTracker.tick(a);a=this.objectTracker.obj;var c=cr.rotatePtAround(a.x,a.y,-a.layer.getAngle(),ca,da,!0),b=cr.rotatePtAround(a.x,a.y,-a.layer.getAngle(),ca,da,!1);this.pannerNode.setPosition(c,
b,0);"undefined"!==typeof this.objectTracker.obj.angle&&(a=a.angle-a.layer.getAngle(),this.pannerNode.setOrientation(Math.cos(a),Math.sin(a),0))}};v.prototype.play=function(a,c,b,d){var e=this.instanceObject;this.looping=a;this.volume=c;b=b||0;d=d||0;switch(this.myapi){case 0:1!==e.playbackRate&&(e.playbackRate=1);e.volume!==c*aa&&(e.volume=c*aa);e.loop!==a&&(e.loop=a);e.muted&&(e.muted=!1);if(e.currentTime!==b)try{e.currentTime=b}catch(sa){}p(this);break;case 1:this.muted=!1;this.mutevol=1;if(1===
this.buffer.myapi)this.gainNode.gain.value=c*aa,this.fresh||(this.instanceObject=C.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode)),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=a,this.hasPlaybackEnded=!1,0===b?w(this.instanceObject,d):h(this.instanceObject,b,this.getDuration(),d);else{1!==e.playbackRate&&(e.playbackRate=1);e.loop!==a&&(e.loop=a);e.volume=c*aa;if(e.currentTime!==
b)try{e.currentTime=b}catch(sa){}p(this)}break;case 2:(!this.fresh&&this.stopped||0!==b)&&e.seekTo(b),e.play(),this.hasPlaybackEnded=!1}this.playbackRate=1;this.startTime=(this.isTimescaled?R.kahanTime.sum:R.wallTime.sum)-b;this.is_paused=this.stopped=this.fresh=!1};v.prototype.stop=function(){switch(this.myapi){case 0:this.instanceObject.paused||this.instanceObject.pause();break;case 1:1===this.buffer.myapi?a(this.instanceObject):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.stop()}this.stopped=
!0;this.is_paused=!1};v.prototype.pause=function(){if(!(this.fresh||this.stopped||this.hasEnded()||this.is_paused)){switch(this.myapi){case 0:this.instanceObject.paused||this.instanceObject.pause();break;case 1:1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position%=this.getDuration()),this.is_paused=!0,a(this.instanceObject)):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.pause()}this.is_paused=!0}};v.prototype.resume=
function(){if(!(this.fresh||this.stopped||this.hasEnded())&&this.is_paused){switch(this.myapi){case 0:p(this);break;case 1:1===this.buffer.myapi?(this.instanceObject=C.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=aa*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=
(this.isTimescaled?R.kahanTime.sum:R.wallTime.sum)-this.resume_position/(this.playbackRate||.001),h(this.instanceObject,this.resume_position,this.getDuration())):p(this);break;case 2:this.instanceObject.play()}this.is_paused=!1}};v.prototype.seek=function(a){if(!(this.fresh||this.stopped||this.hasEnded()))switch(this.myapi){case 0:try{this.instanceObject.currentTime=a}catch(pa){}break;case 1:if(1===this.buffer.myapi)this.is_paused?this.resume_position=a:(this.pause(),this.resume_position=a,this.resume());
else try{this.instanceObject.currentTime=a}catch(pa){}}};v.prototype.reconnect=function(a){1===this.myapi&&(this.pannerEnabled?(this.pannerNode.disconnect(),this.pannerNode.connect(a)):(this.gainNode.disconnect(),this.gainNode.connect(a)))};v.prototype.getDuration=function(a){var c=0;switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.duration&&(c=this.instanceObject.duration);break;case 1:c=this.buffer.bufferObject.duration;break;case 2:c=this.instanceObject.getDuration()}a&&(c/=this.playbackRate||
.001);return c};v.prototype.getPlaybackTime=function(a){var c=this.getDuration(),b=0;switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.currentTime&&(b=this.instanceObject.currentTime);break;case 1:if(1===this.buffer.myapi){if(this.is_paused)return this.resume_position;b=(this.isTimescaled?R.kahanTime.sum:R.wallTime.sum)-this.startTime}else"undefined"!==typeof this.instanceObject.currentTime&&(b=this.instanceObject.currentTime)}a&&(b*=this.playbackRate);!this.looping&&b>c&&(b=c);return b};
v.prototype.isPlaying=function(){return!this.is_paused&&!this.fresh&&!this.stopped&&!this.hasEnded()};v.prototype.shouldSave=function(){return!this.fresh&&!this.stopped&&!this.hasEnded()};v.prototype.setVolume=function(a){this.volume=a;this.updateVolume()};v.prototype.updateVolume=function(){var a=this.volume*aa;isFinite(a)||(a=0);switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.volume&&this.instanceObject.volume!==a&&(this.instanceObject.volume=a);break;case 1:1===this.buffer.myapi?
this.gainNode.gain.value=a*this.mutevol:"undefined"!==typeof this.instanceObject.volume&&this.instanceObject.volume!==a&&(this.instanceObject.volume=a)}};v.prototype.getVolume=function(){return this.volume};v.prototype.doSetMuted=function(a){switch(this.myapi){case 0:this.instanceObject.muted!==!!a&&(this.instanceObject.muted=!!a);break;case 1:1===this.buffer.myapi?(this.mutevol=a?0:1,this.gainNode.gain.value=aa*this.volume*this.mutevol):this.instanceObject.muted!==!!a&&(this.instanceObject.muted=
!!a)}};v.prototype.setMuted=function(a){this.is_muted=!!a;this.doSetMuted(this.is_muted||this.is_silent)};v.prototype.setSilent=function(a){this.is_silent=!!a;this.doSetMuted(this.is_muted||this.is_silent)};v.prototype.setLooping=function(a){this.looping=a;switch(this.myapi){case 0:this.instanceObject.loop!==!!a&&(this.instanceObject.loop=!!a);break;case 1:this.instanceObject.loop!==!!a&&(this.instanceObject.loop=!!a)}};v.prototype.setPlaybackRate=function(a){this.playbackRate=a;this.updatePlaybackRate()};
v.prototype.getPlaybackRate=function(a){return this.playbackRate};v.prototype.updatePlaybackRate=function(){var a=this.playbackRate;this.isTimescaled&&(a*=R.timescale);switch(this.myapi){case 0:this.instanceObject.playbackRate!==a&&(this.instanceObject.playbackRate=a);break;case 1:1===this.buffer.myapi?this.instanceObject.playbackRate.value!==a&&(this.instanceObject.playbackRate.value=a):this.instanceObject.playbackRate!==a&&(this.instanceObject.playbackRate=a)}};v.prototype.setSuspended=function(c){switch(this.myapi){case 0:c?
this.isPlaying()?(this.resume_me=!0,this.instanceObject.pause()):this.resume_me=!1:this.resume_me&&(this.instanceObject.play(),this.resume_me=!1);break;case 1:c?this.isPlaying()?(this.resume_me=!0,1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position%=this.getDuration()),a(this.instanceObject)):this.instanceObject.pause()):this.resume_me=!1:this.resume_me&&(1===this.buffer.myapi?(this.instanceObject=C.createBufferSource(),this.instanceObject.buffer=
this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=aa*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?R.kahanTime.sum:R.wallTime.sum)-this.resume_position/(this.playbackRate||.001),h(this.instanceObject,this.resume_position,this.getDuration())):this.instanceObject.play(),this.resume_me=!1);break;
case 2:c?this.isPlaying()?(this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&(this.resume_me=!1,this.instanceObject.play())}};M.Instance=function(a){this.type=a;R=this.runtime=a.runtime;F=this;this.listenerTracker=null;this.listenerZ=-600;this.runtime.isWKWebView&&(ka=!0);!(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))||this.runtime.isCrosswalk||this.runtime.isAmazonWebApp||ka||(qa=!0);C=null;"undefined"!==typeof AudioContext?
(D=1,C=new AudioContext):"undefined"!==typeof webkitAudioContext&&(D=1,C=new webkitAudioContext);this.runtime.isiOS&&C&&(C.close&&C.close(),"undefined"!==typeof AudioContext?C=new AudioContext:"undefined"!==typeof webkitAudioContext&&(C=new webkitAudioContext));1!==D&&this.runtime.isCordova&&"undefined"!==typeof window.Media&&(D=2);2===D&&(L=location.href,a=L.lastIndexOf("/"),-1<a&&(L=L.substr(0,a+1)),L=L.replace("file://",""));this.runtime.tickMe(this)};var ba=M.Instance.prototype;ba.onCreate=function(){this.runtime.audioInstance=
this;ea=this.properties[0];this.saveload=this.properties[1];this.playinbackground=this.properties[2];this.nextPlayTime=0;na=this.properties[4];oa=this.properties[5];this.listenerZ=-this.properties[6];va=this.properties[7];wa=this.properties[8];xa=this.properties[9];this.listenerTracker=new g;var a=this.runtime.draw_width||this.runtime.width,c=this.runtime.draw_height||this.runtime.height;1===D&&(C.listener.setPosition(a/2,c/2,this.listenerZ),C.listener.setOrientation(0,0,1,0,-1,0),window.c2OnAudioMicStream=
function(a,c){fa&&fa.disconnect();ma=c.toLowerCase();fa=C.createMediaStreamSource(a);fa.connect(d(ma))});this.runtime.addSuspendCallback(function(a){F.onSuspend(a)});var b=this;this.runtime.addDestroyCallback(function(a){b.onInstanceDestroyed(a)})};ba.onInstanceDestroyed=function(a){var c;var b=0;for(c=Q.length;b<c;b++){var d=Q[b];d.objectTracker&&d.objectTracker.obj===a&&(d.objectTracker.obj=null,d.pannerEnabled&&d.isPlaying()&&d.looping&&d.stop())}this.listenerTracker.obj===a&&(this.listenerTracker.obj=
null)};ba.saveToJSON=function(){var a={silent:Y,masterVolume:aa,listenerZ:this.listenerZ,listenerUid:this.listenerTracker.hasObject()?this.listenerTracker.obj.uid:-1,playing:[],effects:{}},c=a.playing,b,d;var e=0;for(b=Q.length;e<b;e++){var k=Q[e];if(k.shouldSave()&&3!==this.saveload&&(!k.is_music||1!==this.saveload)&&(k.is_music||2!==this.saveload)){var g=k.getPlaybackTime();k.looping&&(g%=k.getDuration());g={tag:k.tag,buffersrc:k.buffer.src,buffertype:k.buffer.type,is_music:k.is_music,playbackTime:g,
volume:k.volume,looping:k.looping,muted:k.is_muted,playbackRate:k.playbackRate,paused:k.is_paused,resume_position:k.resume_position};if(k.pannerEnabled){g.pan={};var l=g.pan;k.objectTracker&&k.objectTracker.hasObject()?l.objUid=k.objectTracker.obj.uid:(l.x=k.panX,l.y=k.panY,l.a=k.panAngle);l.ia=k.panConeInner;l.oa=k.panConeOuter;l.og=k.panConeOuterGain}c.push(g)}}c=a.effects;for(d in V)if(V.hasOwnProperty(d)){k=[];e=0;for(b=V[d].length;e<b;e++)k.push({type:V[d][e].type,params:V[d][e].params});c[d]=
k}return a};var ha=[];ba.loadFromJSON=function(a){var b=a.silent;aa=a.masterVolume;this.listenerZ=a.listenerZ;this.listenerTracker.setObject(null);var d=a.listenerUid;-1!==d&&(this.listenerTracker.loadUid=d,ha.push(this.listenerTracker));d=a.playing;var e;if(3!==this.saveload){var h=0;for(e=Q.length;h<e;h++){var f=Q[h];f.is_music&&1===this.saveload||(f.is_music||2!==this.saveload)&&f.stop()}}for(p in V)if(V.hasOwnProperty(p))for(h=0,e=V[p].length;h<e;h++)V[p][h].remove();cr.wipe(V);for(p in a.effects)if(a.effects.hasOwnProperty(p)){var m=
a.effects[p];h=0;for(e=m.length;h<e;h++){var t=m[h].type;var r=m[h].params;switch(t){case "filter":I(p,new y(r[0],r[1],r[2],r[3],r[4],r[5]));break;case "delay":I(p,new z(r[0],r[1],r[2]));break;case "convolve":t=r[2];f=this.getAudioBuffer(t,!1);f.bufferObject?t=new A(f.bufferObject,r[0],r[1],t):(t=new A(null,r[0],r[1],t),f.normalizeWhenReady=r[0],f.convolveWhenReady=t);I(p,t);break;case "flanger":I(p,new k(r[0],r[1],r[2],r[3],r[4]));break;case "phaser":I(p,new l(r[0],r[1],r[2],r[3],r[4],r[5]));break;
case "gain":I(p,new B(r[0]));break;case "tremolo":I(p,new G(r[0],r[1]));break;case "ringmod":I(p,new N(r[0],r[1]));break;case "distortion":I(p,new U(r[0],r[1],r[2],r[3],r[4]));break;case "compressor":I(p,new H(r[0],r[1],r[2],r[3],r[4]));break;case "analyser":I(p,new c(r[0],r[1]))}}}h=0;for(e=d.length;h<e;h++)if(3!==this.saveload){a=d[h];t=a.buffersrc;f=a.buffertype||"";var n=a.is_music;var p=a.tag;m=a.playbackTime;var q=a.looping;var v=a.volume;var u=(r=a.pan)&&r.hasOwnProperty("objUid")?r.objUid:
-1;if(!n||1!==this.saveload)if(n||2!==this.saveload)(f=this.getAudioInstance({url:t,type:f},p,n,q,v))?(f.resume_position=a.resume_position,f.setPannerEnabled(!!r),f.play(q,v,m),f.updatePlaybackRate(),f.updateVolume(),f.doSetMuted(f.is_muted||f.is_silent),a.paused&&f.pause(),a.muted&&f.setMuted(!0),f.doSetMuted(f.is_muted||f.is_silent),r&&(-1!==u?(f.objectTracker=f.objectTracker||new g,f.objectTracker.loadUid=u,ha.push(f.objectTracker)):f.setPan(r.x,r.y,r.a,r.ia,r.oa,r.og))):(f=this.getAudioBuffer({url:t,
type:""},n),f.seekWhenReady=m,f.pauseWhenReady=a.paused,r&&(-1!==u?f.panWhenReady.push({objUid:u,ia:r.ia,oa:r.oa,og:r.og,thistag:p}):f.panWhenReady.push({x:r.x,y:r.y,a:r.a,ia:r.ia,oa:r.oa,og:r.og,thistag:p})))}if(b&&!Y){h=0;for(e=Q.length;h<e;h++)Q[h].setSilent(!0);Y=!0}else if(!b&&Y){h=0;for(e=Q.length;h<e;h++)Q[h].setSilent(!1);Y=!1}};ba.afterLoad=function(){var a;var c=0;for(a=ha.length;c<a;c++){var b=ha[c];var d=this.runtime.getObjectByUID(b.loadUid);b.setObject(d);b.loadUid=-1;d&&(ca=d.x,da=
d.y)}cr.clearArray(ha)};ba.onSuspend=function(a){if(!this.playinbackground){!a&&C&&C.resume&&(C.resume(),la=!1);var c;var b=0;for(c=Q.length;b<c;b++)Q[b].setSuspended(a);a&&C&&C.suspend&&(C.suspend(),la=!0)}};ba.tick=function(){var a=this.runtime.dt,c;var b=0;for(c=Q.length;b<c;b++){var d=Q[b];d.tick(a);0!==ea&&d.updatePlaybackRate()}var e;for(e in V)if(V.hasOwnProperty(e))for(d=V[e],b=0,c=d.length;b<c;b++){var k=d[b];k.tick&&k.tick()}1===D&&this.listenerTracker.hasObject()&&(this.listenerTracker.tick(a),
ca=this.listenerTracker.obj.x,da=this.listenerTracker.obj.y,C.listener.setPosition(this.listenerTracker.obj.x,this.listenerTracker.obj.y,this.listenerZ))};var ia=[];ba.setPreloadList=function(a){var c,b=0;var d=0;for(c=a.length;d<c;++d){var e=a[d];var k=2*e.size;ia.push({filename:e.filename,size:k,type:e.type,obj:null});b+=k}return b};ba.startPreloads=function(){var a;var c=0;for(a=ia.length;c<a;++c){var b=ia[c];var d=this.runtime.getProjectFileUrl(b.filename);b.obj=this.getAudioBuffer({url:d,type:b.type},
!1)}};ba.getPreloadedSize=function(){var a=0,c;var b=0;for(c=ia.length;b<c;++b){var d=ia[b];d.obj.isLoadedAndDecoded()||d.obj.hasFailedToLoad()||this.runtime.isAndroidStockBrowser?a+=d.size:d.obj.isLoaded()&&(a+=Math.floor(d.size/2))}return a};ba.releaseAllMusicBuffers=function(){var a,c;var b=a=0;for(c=X.length;a<c;++a){var d=X[a];X[b]=d;d.is_music?d.release():++b}X.length=b};ba.getAudioBuffer=function(a,c,b){var d,e=null,k=a.url;var g=0;for(d=X.length;g<d;g++){var l=X[g];if(l.src===k){e=l;break}}e||
b||((ka||ua)&&c&&this.releaseAllMusicBuffers(),e=new r(k,a.type,c),X.push(e));return e};ba.getAudioInstance=function(a,c,b,d,e){var k,g=a.url;var l=0;for(k=Q.length;l<k;l++){var h=Q[l];if(h.src===g&&(h.canBeRecycled()||b))return h.tag=c,h}a=this.getAudioBuffer(a,b);if(!a.bufferObject)return"<preload>"!==c&&(a.playTagWhenReady=c,a.loopWhenReady=d,a.volumeWhenReady=e),null;h=new v(a,c);Q.push(h);return h};var S=[];J.prototype.OnEnded=function(a){return cr.equals_nocase(P,a)};J.prototype.PreloadsComplete=
function(){var a;var c=0;for(a=X.length;c<a;c++)if(!X[c].isLoadedAndDecoded()&&!X[c].hasFailedToLoad())return!1;return!0};J.prototype.AdvancedAudioSupported=function(){return 1===D};J.prototype.IsSilent=function(){return Y};J.prototype.IsAnyPlaying=function(){var a;var c=0;for(a=Q.length;c<a;c++)if(Q[c].isPlaying())return!0;return!1};J.prototype.IsTagPlaying=function(a){O(a);var c;a=0;for(c=S.length;a<c;a++)if(S[a].isPlaying())return!0;return!1};M.cnds=new J;E.prototype.Play=function(a,c,b,d){if(!Y){b=
u(b);var e=a[1];if(a=this.runtime.getProjectAudioFileUrl(a[0]))if(T=this.getAudioInstance(a,d,e,0!==c,b))T.setPannerEnabled(!1),T.play(0!==c,b,0,this.nextPlayTime),this.nextPlayTime=0}};E.prototype.PlayAtPosition=function(a,c,b,d,e,k,g,l,h,f){if(!Y){b=u(b);var m=a[1];if(a=this.runtime.getProjectAudioFileUrl(a[0]))(T=this.getAudioInstance(a,f,m,0!==c,b))?(T.setPannerEnabled(!0),T.setPan(d,e,k,g,l,u(h)),T.play(0!==c,b,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(a,m).panWhenReady.push({x:d,
y:e,a:k,ia:g,oa:l,og:u(h),thistag:f})}};E.prototype.PlayAtObject=function(a,c,b,d,e,k,g,l){if(!Y&&d&&(d=d.getFirstPicked())){b=u(b);var h=a[1];if(a=this.runtime.getProjectAudioFileUrl(a[0]))(T=this.getAudioInstance(a,l,h,0!==c,b))?(T.setPannerEnabled(!0),l=cr.rotatePtAround(d.x,d.y,-d.layer.getAngle(),ca,da,!0),a=cr.rotatePtAround(d.x,d.y,-d.layer.getAngle(),ca,da,!1),T.setPan(l,a,cr.to_degrees(d.angle-d.layer.getAngle()),e,k,u(g)),T.setObject(d),T.play(0!==c,b,0,this.nextPlayTime),this.nextPlayTime=
0):this.getAudioBuffer(a,h).panWhenReady.push({obj:d,ia:e,oa:k,og:u(g),thistag:l})}};E.prototype.PlayByName=function(a,c,b,d,e){!Y&&(d=u(d),a=1===a,c=this.runtime.getProjectAudioFileUrl(c))&&(T=this.getAudioInstance(c,e,a,0!==b,d))&&(T.setPannerEnabled(!1),T.play(0!==b,d,0,this.nextPlayTime),this.nextPlayTime=0)};E.prototype.PlayAtPositionByName=function(a,c,b,d,e,k,g,l,h,f,m){!Y&&(d=u(d),a=1===a,c=this.runtime.getProjectAudioFileUrl(c))&&((T=this.getAudioInstance(c,m,a,0!==b,d))?(T.setPannerEnabled(!0),
T.setPan(e,k,g,l,h,u(f)),T.play(0!==b,d,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(c,a).panWhenReady.push({x:e,y:k,a:g,ia:l,oa:h,og:u(f),thistag:m}))};E.prototype.PlayAtObjectByName=function(a,c,b,d,e,k,g,l,h){!Y&&e&&(e=e.getFirstPicked())&&(d=u(d),a=1===a,c=this.runtime.getProjectAudioFileUrl(c))&&((T=this.getAudioInstance(c,h,a,0!==b,d))?(T.setPannerEnabled(!0),h=cr.rotatePtAround(e.x,e.y,-e.layer.getAngle(),ca,da,!0),c=cr.rotatePtAround(e.x,e.y,-e.layer.getAngle(),ca,da,!1),
T.setPan(h,c,cr.to_degrees(e.angle-e.layer.getAngle()),k,g,u(l)),T.setObject(e),T.play(0!==b,d,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(c,a).panWhenReady.push({obj:e,ia:k,oa:g,og:u(l),thistag:h}))};E.prototype.SetLooping=function(a,c){O(a);var b;a=0;for(b=S.length;a<b;a++)S[a].setLooping(0===c)};E.prototype.SetMuted=function(a,c){O(a);var b;a=0;for(b=S.length;a<b;a++)S[a].setMuted(0===c)};E.prototype.SetVolume=function(a,c){O(a);a=u(c);var b;c=0;for(b=S.length;c<b;c++)S[c].setVolume(a)};
E.prototype.Preload=function(a){if(!Y){var c=a[1];(a=this.runtime.getProjectAudioFileUrl(a[0]))&&2!==D&&this.getAudioInstance(a,"<preload>",c,!1)}};E.prototype.PreloadByName=function(a,c){Y||(a=1===a,(c=this.runtime.getProjectAudioFileUrl(c))&&2!==D&&this.getAudioInstance(c,"<preload>",a,!1))};E.prototype.SetPlaybackRate=function(a,c){O(a);0>c&&(c=0);var b;a=0;for(b=S.length;a<b;a++)S[a].setPlaybackRate(c)};E.prototype.Stop=function(a){O(a);var c;a=0;for(c=S.length;a<c;a++)S[a].stop()};E.prototype.StopAll=
function(){var a;var c=0;for(a=Q.length;c<a;c++)Q[c].stop()};E.prototype.SetPaused=function(a,c){O(a);var b;a=0;for(b=S.length;a<b;a++)0===c?S[a].pause():S[a].resume()};E.prototype.Seek=function(a,c){O(a);var b;a=0;for(b=S.length;a<b;a++)S[a].seek(c)};E.prototype.SetSilent=function(a){var c;2===a&&(a=Y?1:0);if(0===a&&!Y){a=0;for(c=Q.length;a<c;a++)Q[a].setSilent(!0);Y=!0}else if(1===a&&Y){a=0;for(c=Q.length;a<c;a++)Q[a].setSilent(!1);Y=!1}};E.prototype.SetMasterVolume=function(a){aa=u(a);var c;a=
0;for(c=Q.length;a<c;a++)Q[a].updateVolume()};E.prototype.AddFilterEffect=function(a,c,b,d,e,k,g){1!==D||0>c||c>=ta.length||!C.createBiquadFilter||(a=a.toLowerCase(),g/=100,0>g&&(g=0),1<g&&(g=1),I(a,new y(c,b,d,e,k,g)))};E.prototype.AddDelayEffect=function(a,c,b,d){1===D&&(a=a.toLowerCase(),d/=100,0>d&&(d=0),1<d&&(d=1),I(a,new z(c,u(b),d)))};E.prototype.AddFlangerEffect=function(a,c,b,d,e,g){1===D&&C.createOscillator&&(a=a.toLowerCase(),g/=100,0>g&&(g=0),1<g&&(g=1),I(a,new k(c/1E3,b/1E3,d,e/100,g)))};
E.prototype.AddPhaserEffect=function(a,c,b,d,e,k,g){1===D&&C.createOscillator&&(a=a.toLowerCase(),g/=100,0>g&&(g=0),1<g&&(g=1),I(a,new l(c,b,d,e,k,g)))};E.prototype.AddConvolutionEffect=function(a,c,b,d){if(1===D&&C.createConvolver){b=0===b;var e=this.runtime.getProjectAudioFileUrl(c[0]);e&&(c=this.getAudioBuffer(e,!1),a=a.toLowerCase(),d/=100,0>d&&(d=0),1<d&&(d=1),c.bufferObject?d=new A(c.bufferObject,b,d,e.url):(d=new A(null,b,d,e.url),c.normalizeWhenReady=b,c.convolveWhenReady=d),I(a,d))}};E.prototype.AddGainEffect=
function(a,c){1===D&&(a=a.toLowerCase(),I(a,new B(u(c))))};E.prototype.AddMuteEffect=function(a){1===D&&(a=a.toLowerCase(),I(a,new B(0)))};E.prototype.AddTremoloEffect=function(a,c,b){1===D&&C.createOscillator&&(a=a.toLowerCase(),b/=100,0>b&&(b=0),1<b&&(b=1),I(a,new G(c,b)))};E.prototype.AddRingModEffect=function(a,c,b){1===D&&C.createOscillator&&(a=a.toLowerCase(),b/=100,0>b&&(b=0),1<b&&(b=1),I(a,new N(c,b)))};E.prototype.AddDistortionEffect=function(a,c,b,d,e,k){1===D&&C.createWaveShaper&&(a=a.toLowerCase(),
k/=100,0>k&&(k=0),1<k&&(k=1),I(a,new U(c,b,d,e,k)))};E.prototype.AddCompressorEffect=function(a,c,b,d,e,k){1===D&&C.createDynamicsCompressor&&(a=a.toLowerCase(),I(a,new H(c,b,d,e/1E3,k/1E3)))};E.prototype.AddAnalyserEffect=function(a,b,d){1===D&&(a=a.toLowerCase(),I(a,new c(b,d)))};E.prototype.RemoveEffects=function(a){if(1===D){a=a.toLowerCase();var c;if(V.hasOwnProperty(a)){var b=V[a];if(b.length){var d=0;for(c=b.length;d<c;d++)b[d].remove();cr.clearArray(b);Z(a)}}}};E.prototype.SetEffectParameter=
function(a,c,b,d,e,k){1===D&&(a=a.toLowerCase(),c=Math.floor(c),V.hasOwnProperty(a)&&(a=V[a],0>c||c>=a.length||a[c].setParam(b,d,e,k)))};E.prototype.SetListenerObject=function(a){a&&1===D&&(a=a.getFirstPicked())&&(this.listenerTracker.setObject(a),ca=a.x,da=a.y)};E.prototype.SetListenerZ=function(a){this.listenerZ=a};E.prototype.ScheduleNextPlay=function(a){C&&(this.nextPlayTime=a)};E.prototype.UnloadAudio=function(a){var c=a[1];if(a=this.runtime.getProjectAudioFileUrl(a[0]))if(c=this.getAudioBuffer(a,
c,!0))c.release(),cr.arrayFindRemove(X,c)};E.prototype.UnloadAudioByName=function(a,c){a=1===a;if(c=this.runtime.getProjectAudioFileUrl(c))if(c=this.getAudioBuffer(c,a,!0))c.release(),cr.arrayFindRemove(X,c)};E.prototype.UnloadAll=function(){var a;var c=0;for(a=X.length;c<a;++c)X[c].release();cr.clearArray(X)};M.acts=new E;x.prototype.Duration=function(a,c){O(c,!0);S.length?a.set_float(S[0].getDuration()):a.set_float(0)};x.prototype.PlaybackTime=function(a,c){O(c,!0);S.length?a.set_float(S[0].getPlaybackTime(!0)):
a.set_float(0)};x.prototype.PlaybackRate=function(a,c){O(c,!0);S.length?a.set_float(S[0].getPlaybackRate()):a.set_float(0)};x.prototype.Volume=function(a,c){O(c,!0);S.length?(c=S[0].getVolume(),a.set_float(m(c))):a.set_float(0)};x.prototype.MasterVolume=function(a){a.set_float(m(aa))};x.prototype.EffectCount=function(a,c){c=c.toLowerCase();var b=null;V.hasOwnProperty(c)&&(b=V[c]);a.set_int(b?b.length:0)};x.prototype.AnalyserFreqBinCount=function(a,c,b){c=c.toLowerCase();b=Math.floor(b);c=W(c,b);a.set_int(c?
c.node.frequencyBinCount:0)};x.prototype.AnalyserFreqBinAt=function(a,c,b,d){c=c.toLowerCase();b=Math.floor(b);d=Math.floor(d);(c=W(c,b))?0>d||d>=c.node.frequencyBinCount?a.set_float(0):a.set_float(c.freqBins[d]):a.set_float(0)};x.prototype.AnalyserPeakLevel=function(a,c,b){c=c.toLowerCase();b=Math.floor(b);(c=W(c,b))?a.set_float(c.peak):a.set_float(0)};x.prototype.AnalyserRMSLevel=function(a,c,b){c=c.toLowerCase();b=Math.floor(b);(c=W(c,b))?a.set_float(c.rms):a.set_float(0)};x.prototype.SampleRate=
function(a){a.set_int(C?C.sampleRate:0)};x.prototype.CurrentTime=function(a){a.set_float(C?C.currentTime:cr.performance_now())};M.exps=new x})();cr.plugins_.InstantGames=function(f){this.runtime=f};
(function(){function f(){return m?FBInstant.context.getID():null}function p(){}function q(){}function n(){}var u=cr.plugins_.InstantGames.prototype,m=!1,d=null,b=null,e=null,w=null,h=[],a=0,t=0,y=[],z=null,A=null,k=null,l=null,B=null,G=0,N="",U="",H=[];u.Type=function(a){this.plugin=a;this.runtime=a.runtime};var c=u.Type.prototype;c.onCreate=function(){};c.onBeforeAppBegin=function(){if(m=this.runtime.useFbInstant){H=FBInstant.getSupportedAPIs();z=FBInstant.getLocale();A=FBInstant.getPlatform();k=
FBInstant.getSDKVersion();b=FBInstant.player.getName();e=FBInstant.player.getPhoto();w=FBInstant.player.getID();var a=FBInstant.getEntryPointData();a&&a.hasOwnProperty("data")&&(N=a.data);FBInstant.onPause(function(){d.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnPause,d)})}};u.Instance=function(a){this.type=a;this.runtime=a.runtime;d=this};c=u.Instance.prototype;c.onCreate=function(){};c.saveToJSON=function(){return{}};c.loadFromJSON=function(a){};c.onError=function(){this.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnError,
this)};p.prototype.IsAvailable=function(){return m};p.prototype.OnPause=function(){return!0};p.prototype.OnLoadedPlayerData=function(){return!0};p.prototype.OnError=function(){return!0};p.prototype.OnContextChanged=function(){return!0};p.prototype.OnContextChangeCancelled=function(){return!0};p.prototype.OnConnectedPlayersLoaded=function(){return!0};p.prototype.OnScoreSubmitted=function(){return!0};p.prototype.OnPlayerScoreLoaded=function(){return!0};p.prototype.OnLeaderboardLoaded=function(){return!0};
p.prototype.OnShortcutCreated=function(){return!0};p.prototype.OnShortcutFailed=function(){return!0};p.prototype.OnLoadAdSuccess=function(a){return G===a};p.prototype.OnLoadAdError=function(a){return G===a};p.prototype.OnShowAdSuccess=function(a){return G===a};p.prototype.OnShowAdError=function(a){return G===a};p.prototype.SupportsFeature=function(a){return 0===a?0<=H.indexOf("switchGameAsync"):!1};u.cnds=new p;q.prototype.Quit=function(){m&&FBInstant.quit()};q.prototype.SetPlayerData=function(a){if(m){var c=
this;FBInstant.player.setDataAsync({data:a.toString()}).catch(function(a){console.error("[Instant Games] Failed to set player data: ",a);c.onError()})}};q.prototype.LoadPlayerData=function(){if(m){var a=this;FBInstant.player.getDataAsync(["data"]).then(function(c){c&&c.hasOwnProperty("data")&&(U=c.data);a.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnLoadedPlayerData,a);U=""}).catch(function(c){console.error("[Instant Games] Failed to load player data: ",c);a.onError()})}};q.prototype.Share=
function(a,c,b,d){if(m){var e=this,k=null;if(c){c=c.getFirstPicked();if(!c||!c.curFrame)return;k=c.curFrame.getDataUri()}FBInstant.shareAsync({intent:["INVITE","REQUEST","CHALLENGE","SHARE"][a],image:k,text:b,data:{data:d}}).catch(function(a){console.error("[Instant Games] Failed to share: ",a);e.onError()})}};q.prototype.CustomUpdate=function(a,c,b,d,e,k,l){if(m){var g=null;if(b){b=b.getFirstPicked();if(!b||!b.curFrame)return;g=b.curFrame.getDataUri()}a={action:"CUSTOM",template:a,image:g,text:d,
data:{data:e},strategy:["IMMEDIATE","IMMEDIATE_CLEAR","LAST"][k],notification:["NO_PUSH","PUSH"][l]};c&&(a.cta=c);FBInstant.updateAsync(a).catch(function(a){console.error("[Instant Games] Error posting custom update: ",a)})}};q.prototype.SwitchGame=function(a,c){m&&FBInstant.switchGameAsync(a,{data:c}).catch(function(a){console.error("[Instant Games] Failed to switch game: ",a);self.onError()})};q.prototype.ChangeContext=function(a,c,b){if(m){var d={};1===a?d.filters=["NEW_CONTEXT_ONLY"]:2===a?d.filters=
["INCLUDE_EXISTING_CHALLENGES"]:3===a&&(d.filters=["NEW_PLAYERS_ONLY"]);0<=c&&(d.minSize=c);0<=b&&(d.maxSize=b);var e=this;FBInstant.context.chooseAsync(d).then(function(){e.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnContextChanged,e)}).catch(function(a){"USER_INPUT"===a.code?e.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnContextChangeCancelled,e):console.warn("[Instant Games] Failed to change context: ",a)})}};q.prototype.LogEvent=function(a,c){m&&FBInstant.logEvent(a,
c)};q.prototype.LoadConnectedPlayers=function(){if(m){var a=this;FBInstant.player.getConnectedPlayersAsync().then(function(c){h=c;a.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnConnectedPlayersLoaded,a)}).catch(function(c){console.error("[Instant Games] Failed to load connected players: ",c);a.onError()})}};q.prototype.SetScore=function(a,c,b){if(m){var d=this;a+=0!==c?"."+f():"";FBInstant.getLeaderboardAsync(a).then(function(a){return a.setScoreAsync(b)}).then(function(){d.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnScoreSubmitted,
d)}).catch(function(a){console.error("[Instant Games] Failed to set score: ",a);d.onError()})}};q.prototype.LoadPlayerScore=function(c,b){if(m){var d=this;c+=0!==b?"."+f():"";FBInstant.getLeaderboardAsync(c).then(function(a){return a.getPlayerEntryAsync()}).then(function(c){a=c.getScore();t=c.getRank();d.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnPlayerScoreLoaded,d)}).catch(function(a){console.error("[Instant Games] Failed to load player score: ",a);d.onError()})}};q.prototype.ShareLeaderboardUpdate=
function(a,c){m&&(a+=0!==c?"."+f():"",FBInstant.updateAsync({action:"LEADERBOARD",name:a}))};q.prototype.LoadLeaderboard=function(a,c,b,d,e){if(m){var k=this;a+=0!==c?"."+f():"";FBInstant.getLeaderboardAsync(a).then(function(a){return 0===b?a.getEntriesAsync(d,e):a.getConnectedPlayerEntriesAsync(d,e)}).then(function(a){y=a;k.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnLeaderboardLoaded,k)}).catch(function(a){console.error("[Instant Games] Failed to load leaderboard: ",a);k.onError()})}};
q.prototype.CreateShortcut=function(){if(m){var a=this;FBInstant.canCreateShortcutAsync().then(function(c){c?FBInstant.createShortcutAsync().then(function(){a.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnShortcutCreated,a)}).catch(function(){a.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnShortcutFailed,a)}):a.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnShortcutFailed,a)})}};q.prototype.SubscribeBot=function(){m&&FBInstant.player.canSubscribeBotAsync().then(function(a){a?
FBInstant.player.subscribeBotAsync().then(function(){console.log("[Instant Games] Successfully subscribed to bot")}).catch(function(a){console.error("[Instant Games] Failed to subscribe bot: ",a)}):console.error("[Instant Games] Failed to subscribe bot: not allowed by canSubscribeBotAsync()")})};q.prototype.LoadAd=function(a,c){if(m){var b=this,d=null,e=null;d=0===a?FBInstant.getInterstitialAdAsync(c):FBInstant.getRewardedVideoAsync(c);d.then(function(a){e=a;return a.loadAsync()}).then(function(){0===
a?l=e:B=e;G=a;b.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnLoadAdSuccess,b)}).catch(function(c){console.error("[Instant Games] Failed to load ad: ",c);G=a;b.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnLoadAdError,b)})}};q.prototype.ShowAd=function(a){if(m){var c=0===a?l:B;if(c){var b=this;c.showAsync().then(function(){G=a;b.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnShowAdSuccess,b)}).catch(function(c){console.error("[Instant Games] Failed to show ad: ",
c);G=a;b.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnShowAdError,b)})}else G=a,this.runtime.trigger(cr.plugins_.InstantGames.prototype.cnds.OnShowAdError,b)}};u.acts=new q;n.prototype.Locale=function(a){a.set_string(z||"")};n.prototype.Platform=function(a){a.set_string(A||"")};n.prototype.SDKVersion=function(a){a.set_string(k||"")};n.prototype.ContextID=function(a){a.set_string(f()||"")};n.prototype.ContextType=function(a){a.set_string((m?FBInstant.context.getType():null)||"SOLO")};
n.prototype.PlayerName=function(a){a.set_string(b||"")};n.prototype.PlayerPhotoURL=function(a){a.set_string(e||"")};n.prototype.PlayerID=function(a){a.set_string(w||"")};n.prototype.PlayerData=function(a){a.set_string(U)};n.prototype.EntryPointData=function(a){a.set_string(N)};n.prototype.ConnectedPlayerCount=function(a){a.set_int(h.length)};n.prototype.ConnectedPlayerIDAt=function(a,c){c=Math.floor(c);0>c||c>=h.length?a.set_string(""):a.set_string(h[c].getID())};n.prototype.ConnectedPlayerNameAt=
function(a,c){c=Math.floor(c);0>c||c>=h.length?a.set_string(""):a.set_string(h[c].getName())};n.prototype.ConnectedPlayerPhotoURLAt=function(a,c){c=Math.floor(c);0>c||c>=h.length?a.set_string(""):a.set_string(h[c].getPhoto())};n.prototype.PlayerScore=function(c){c.set_float(a)};n.prototype.PlayerRank=function(a){a.set_float(t)};n.prototype.LeaderboardResultCount=function(a){a.set_float(y.length)};n.prototype.LeaderboardScoreAt=function(a,c){c=Math.floor(c);0>c||c>=y.length?a.set_float(0):a.set_float(y[c].getScore())};
n.prototype.LeaderboardRankAt=function(a,c){c=Math.floor(c);0>c||c>=y.length?a.set_float(0):a.set_float(y[c].getRank())};n.prototype.LeaderboardPlayerNameAt=function(a,c){c=Math.floor(c);0>c||c>=y.length?a.set_string(""):a.set_string(y[c].getPlayer().getName())};n.prototype.LeaderboardPlayerPhotoURLAt=function(a,c){c=Math.floor(c);0>c||c>=y.length?a.set_string(""):a.set_string(y[c].getPlayer().getPhoto())};u.exps=new n})();
if(void 0===window)var window="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window;var __CONSTRUCT2_RUNTIME2__=!1,__CONSTRUCT3_RUNTIME2__=!0,__CONSTRUCT3_RUNTIME3__=!1,__DEBUG__=!1;cr.plugins_.ValerypopoffJSPlugin=function(f){this.runtime=f};
(function(){function f(){}function p(){}function q(){}var n=cr.plugins_.ValerypopoffJSPlugin.prototype;n.Type=function(b){this.plugin=b;this.runtime=b.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(b){this.type=b;this.runtime=b.runtime};var u=n.Instance.prototype;u.onCreate=function(){function b(a,b){if(void 0===document)a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"'document' is not defined. You're probably launching the game in a Worker. Workers are not supported yet. Export project with 'Use worker' option unchecked in the 'Advanced' section of the 'Project properties' panel."});
else{var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",b);d.onreadystatechange=function(){"complete"==this.readyState&&a.sciptsToLoad--};d.onload=function(){a.sciptsToLoad--};d.onerror=function(){a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"Probably file not found"})};document.getElementsByTagName("head")[0].appendChild(d)}}this.returnValue=void 0;this.sciptsToLoad=
0;this.Aliases={};this.construct_compare_function_prefix="ConstructCompare_";this.AliasDotpartsCache={count:0,max_count:4096,Dotparts:{},AliasNames:{},AliasTrailers:{},IsAlias:{}};this.NonAliasDotpartsCache={count:0,max_count:2048,Dotparts:{}};if(""!=this.properties[0]){var a=[];a=__CONSTRUCT2_RUNTIME2__?this.properties[0].split(";"):this.properties[0].split(/[;\n\r]/);for(var d=0;d<a.length;d++)if(a[d]=a[d].trim(),0!=a[d].length&&(this.sciptsToLoad++,__CONSTRUCT2_RUNTIME2__&&b(this,a[d]),__CONSTRUCT3_RUNTIME2__&&
b(this,this.runtime.getLocalFileUrl(a[d])),__CONSTRUCT3_RUNTIME3__)){var e=this;void 0!==e._runtime.GetAssetManager().LoadProjectFileUrl?e._runtime.GetAssetManager().LoadProjectFileUrl(a[d]).then(function(a){b(e,a)},function(b){e.ShowError({debug_caller:"Including '"+a[d]+"' script to the page",caller_name:"Including '"+a[d]+"' script to the page",error_message:b.message})}).catch(function(b){e.ShowError({debug_caller:"Including '"+a[d]+"' script to the page",caller_name:"Including '"+a[d]+"' script to the page",
error_message:b.message})}):b(e,e._runtime.GetAssetManager().GetLocalFileUrl(a[d]))}}};u.saveToJSON=function(){return{}};u.loadFromJSON=function(b){};var m=function(b){for(var a=[],d=0,e=0,h=0,f=b.length;h<f;h++)"["==b[h]?d++:"]"==b[h]?e++:"."==b[h]&&d==e&&a.push(h);var k=[],l=a.length-1;a.forEach(function(d,e,h){h=b.substring(a[e-1]+1,d);""!=h&&k.push(h);e==l&&(h=b.substring(d+1),""!=h&&k.push(h))});0==k.length&&k.push(b);k.forEach(function(a,b,d){"["==a[0]&&(d[b]=m(a.substring(1,a.length-1)))});
return k},d=function(b,a){return b=b.replace(/#[0-9]+/g,function(b){b=a[b.substr(1)];return"string"===typeof b?"'"+b+"'":b})},b=function(b,a){b+="(";if(a)for(var d=0,e=a.length;d<e;++d)b="string"===typeof a[d]?b+"'"+a[d]+"'":b+a[d],d!=a.length-1&&(b+=",");return b+")"},e={Value:function(b,a){var d=a[0];a.splice(0,1);var e=this.ParseJS(d,!0,b);if(e.error)ret.set_any(void 0);else{var h=void 0;try{h=e.end}catch(A){this.ShowError({debug_caller:"Value",caller_name:b,"show-alias-expression":e.alias_found,
alias_expression:e.trimmed_code,error_message:A.message});ret.set_any(void 0);return}"function"==typeof e.end&&(h=this.CallJSfunction(d,a,!1,b,e));return h}},CallJSfunction:function(d,a,e,f,m){void 0===e&&(e=!0);void 0===f&&(f="'Call function' action");m=void 0===m?this.ParseJS(d,!0,f):m;if(!m.error)if(0<=d.indexOf("(")||0<=d.indexOf(")"))d={debug_caller:"CallJSfunction",caller_name:f,error_message:"'"+m.trimmed_code+"' must be a function name, not a function call. Remove parentheses."},m.alias_found&&
(d["show-alias-expression"]=!0,d.alias_expression=m.trimmed_code),this.ShowError(d);else{var h=void 0;try{h=m.end.apply(m.context,a)}catch(k){k instanceof TypeError&&0<=k.message.indexOf("apply")&&0<=k.message.indexOf("undefined")&&(k.message=d+" is undefined");d={debug_caller:"CallJSfunction",caller_name:f,error_message:k.message};m.alias_found?(d["show-alias-expression"]=!0,d.alias_expression=b(m.trimmed_code,a),d["show-code"]=!0,d.code=b(this.Aliases[m.alias_name].js+m.alias_trailer,a)):(d["show-code"]=
!0,d.code=b(m.trimmed_code,a));this.ShowError(d);return}e&&(this.returnValue=h);return h}},CallAlias:function(b,a,d,e){void 0===d&&(d=!0);void 0===e&&(e="'Call alias' action");b=this.ParseJS(b,!0,e);if(!b.error)return this.CallJSfunction(this.Aliases[b.alias_name].js+b.alias_trailer,a,d,e,b)},ShowError:function(b){var a="ValerypopoffJS plugin: Error in "+b.caller_name+"\n";a+="--------------------- \n";__DEBUG__&&(a+="DEBUG CALLER: "+b.debug_caller+"\n",a+="--------------------- \n");b["show-alias-expression"]&&
(a+="Alias expression: "+b.alias_expression+"\n",a+="--------------------- \n");b["show-code"]&&(a+="JS code: "+b.code+"\n",a+="--------------------- \n");a+=b.error_message;console.error(a)},Resolve:function(b,a,d,e,f){for(var h=window,k=h,l="",m=0,t=b.length;m<t;m++){l=b[m];if("object"==typeof l){l=this.Resolve(l,a,d,e,f);if(l.error)return{error:!0};l=l.end;try{k=k[l]}catch(N){return b={debug_caller:"Resolve",caller_name:a,error_message:N.message,"show-code":!0,code:d},e&&(b["show-alias-expression"]=
!0,b.code=this.Aliases[e].js+f,b.alias_expression=d),this.ShowError(b),{error:!0}}}else try{h==window?/^[$A-Z_][0-9A-Z_$]*$/i.test(l)?k=k[l]:("'"==l[0]&&(l=l.substring(1,l.length-1)),k=l):k=k[l]}catch(N){return b={debug_caller:"Resolve",caller_name:a,error_message:N.message,"show-code":!0,code:d},e&&(b["show-alias-expression"]=!0,b.code=this.Aliases[e].js+f,b.alias_expression=d),this.ShowError(b),{error:!0}}m<t-1&&(h=k)}return{error:!1,context:h,end:k,endname:l}},ParseJS:function(b,a,d){a=!1;var e=
void 0,h=void 0;b=b.trim().replace(/\s*([\.\[\]])\s*/g,"$1");var f=this.AliasDotpartsCache;if(f.Dotparts[b]){var k=f.Dotparts[b];f.IsAlias[b]&&(a=!0,e=f.AliasNames[b],h=f.AliasTrailers[b])}else{e=b.split(/[\.\[]/)[0];h=b.substring(e.length);this.Aliases[e]?(a=!0,k=h?m(this.Aliases[e].dotstring+h.split("[").join(".[")):m(this.Aliases[e].dotstring)):(h=e=void 0,k=m(b.split("[").join(".[")));if(f.count>=f.max_count)for(var l in f.Dotparts)if(delete f.Dotparts[l],f.IsAlias[l]&&(delete f.AliasNames[l],
delete f.AliasTrailers[l],delete f.IsAlias[l]),f.count--,f.count<=f.max_count)break;f.Dotparts[b]=k;a&&(f.AliasNames[b]=e,f.AliasTrailers[b]=h,f.IsAlias[b]=!0);f.count++}d=this.Resolve(k,d,b,e,h);return{error:d.error,end:d.end,endname:d.endname,context:d.context,trimmed_code:b,alias_found:a,alias_name:e,alias_trailer:h}}},w;for(w in e)u[w]=e[w];e={C2CompareFunctionReturnValue:function(b,a,d,e){switch(a){case 2:a=4;break;case 3:a=5;break;case 4:a=2;break;case 5:a=3}return this.CNDS.CompareFunctionReturnValue.call(this,
d,e,a,b)},C2CompareAliasCallReturnValue:function(b,a,d,e){switch(a){case 2:a=4;break;case 3:a=5;break;case 4:a=2;break;case 5:a=3}return this.CNDS.CompareAliasCallReturnValue.call(this,d,e,a,b)},C2CompareExecReturnWithParams:function(b,a,d,e){switch(a){case 2:a=4;break;case 3:a=5;break;case 4:a=2;break;case 5:a=3}return this.CNDS.CompareExecReturnWithParams.call(this,d,e,a,b)},C2CompareValue:function(b,a,d,e){switch(a){case 2:a=4;break;case 3:a=5;break;case 4:a=2;break;case 5:a=3}return this.CNDS.CompareValue.call(this,
d,e,a,b)},CompareExecReturnWithParams:function(b,a,e,f){var h=void 0;a.length&&(b=d(b,a));try{h=eval(b)}catch(A){this.ShowError({debug_caller:"CompareExecReturnWithParams",caller_name:"'Compare JS code Completion value' condition",error_message:A.message,"show-code":!0,code:b});return}"boolean"===typeof h&&(h=h?1:0);return cr.do_cmp(h,e,f)},CompareExecReturnWithParamsNonvar:function(b,a,e,f,m,p,k,l){var h=void 0;a=[a,e,f,m,p];a.length&&(b=d(b,a));try{h=eval(b)}catch(G){this.ShowError({debug_caller:"CompareExecReturnWithParams",
caller_name:"'Compare JS code Completion value' condition",error_message:G.message,"show-code":!0,code:b});return}"boolean"===typeof h&&(h=h?1:0);return cr.do_cmp(h,k,l)},CompareFunctionReturnValue:function(b,a,d,e){b=this.CallJSfunction(b,a,!1,"'Compare Function return value' condition");"boolean"===typeof b&&(b=b?1:0);return cr.do_cmp(b,d,e)},CompareStoredReturnValue:function(b,a){var d=this.returnValue;"boolean"===typeof d&&(d=d?1:0);return cr.do_cmp(d,b,a)},AllScriptsLoaded:function(){return 0>=
this.sciptsToLoad?!0:!1},CompareValue:function(b,a,d,e){b=this.Value("'Compare Value' condition",[].concat(b,a));"boolean"===typeof b&&(b=b?1:0);return cr.do_cmp(b,d,e)},CompareValueNonvar:function(b,a,d,e,f,m,k,l){b=this.Value("'Compare Value' condition",[].concat(b,[a,d,e,f,m]));"boolean"===typeof b&&(b=b?1:0);return cr.do_cmp(b,k,l)},CompareAliasValue:function(b,a,d){var e=this.ParseJS(b,!0,"'Set alias' action");if(!e.alias_found)a={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition",
error_message:"No such alias '"+b+"'"},this.ShowError(a);else if(!e.error)if((b=e.context[this.construct_compare_function_prefix+e.endname])&&"object"==typeof e.context)try{return b.call(e.context,a,d)}catch(z){a={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition","show-alias-expression":!0,alias_expression:e.trimmed_code,error_message:"Error in user defined '"+this.construct_compare_function_prefix+e.endname+"' function: "+z.message},this.ShowError(a)}else return e=e.end,"boolean"===
typeof e&&(e=e?1:0),cr.do_cmp(e,a,d)},CompareAliasCallReturnValue:function(b,a,d,e){b=this.CallAlias(b,a,!1,"'Compare Alias Call return value' condition");"boolean"===typeof b&&(b=b?1:0);return cr.do_cmp(b,d,e)}};for(w in e)f.prototype[w]=e[w];n.cnds=new f;e={ExecuteJSWithParams:function(b,a){this.returnValue=void 0;b=b.replace(/#[0-9]+/g,function(b){b=a[b.substr(1)];return"string"===typeof b?"'"+b+"'":b});try{this.returnValue=eval(b)}catch(t){this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:"'Execute JS code' action",
"show-code":!0,code:b,error_message:t.message})}},ExecuteJSWithParamsNonvar:function(b,a,d,e,f,m){this.returnValue=void 0;var k=[a,d,e,f,m];b=b.replace(/#[0-9]+/g,function(a){a=k[a.substr(1)];return"string"===typeof a?"'"+a+"'":a});try{this.returnValue=eval(b)}catch(l){this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:"'Execute JS code' action","show-code":!0,code:b,error_message:l.message})}},CallJSfunction:function(b,a,d,e,f){this.CallJSfunction(b,a,d,e,f)},SetValue:function(b,a){var d=
this.ParseJS(b,!0,"'Set value' action");if(!d.error)try{d.context[d.endname]=a}catch(y){b+="=",this.ShowError({debug_caller:"SetValue",caller_name:"'Set value' action","show-alias-expression":d.alias_found,alias_expression:d.trimmed_code,"show-code":!0,code:"string"==typeof a?b+"'"+a+"'":b+a,error_message:y.message})}},Call:function(b,a,d,e){this.CallJSfunction(b,a,!0,"'Call' action")},CallNonvar:function(b,a,d,e,f,m,k,l){this.CallJSfunction(b,[a,d,e,f,m],!0,"'Call' action")},InitAlias:function(b,
a){b=b.trim();a=a.trim();if(0==a.length)b={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Javascript string of alias '"+b+"' must not be empty."},this.ShowError(b);else if(0<=b.indexOf(".")||0<=b.indexOf("[")||0<=b.indexOf("]"))b={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Alias name must not contain '.', '[' or ']' signs: '"+b+"'"},this.ShowError(b);else if(void 0!=this.Aliases[b])b={debug_caller:"InitAlias",caller_name:"'Init alias' action",
error_message:"Alias '"+b+"' already exists"},this.ShowError(b);else{var d={};d.js=a;d.dotstring=a.split("[").join(".[");this.Aliases[b]=d}},SetAlias:function(b,a){var d=this.ParseJS(b,!0,"'Set alias' action");if(!d.alias_found)a={debug_caller:"SetAlias",caller_name:"'Set alias' action",error_message:"No such alias '"+d.trimmed_code+"'"},this.ShowError(a);else if(!d.error)try{d.context[d.endname]=a}catch(y){b+="=",a={debug_caller:"SetAlias",caller_name:"'Set alias' action","show-alias-expression":!0,
alias_expression:d.trimmed_code,"show-code":!0,code:"string"==typeof a?b+"'"+a+"'":b+a,error_message:y.message},this.ShowError(a)}},CallAlias:function(b,a,d,e){this.CallAlias(b,a,d,e)}};for(w in e)p.prototype[w]=e[w];n.acts=new p;e={JSCodeValue:function(){var b=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var a={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{a=b[0];for(var e=0;e<b.length-1;e++)b[e]=b[e+1];b.pop()}e=b[0];b.splice(0,
1);b.length&&(e=d(e,b));b=void 0;try{b=eval(e)}catch(y){this.ShowError({debug_caller:"JSCodeValue",caller_name:"'JSCodeValue' expression","show-code":!0,code:e,error_message:y.message});a.set_any(void 0);return}if("boolean"==typeof b){if(a.set_any(b?1:0),__CONSTRUCT3_RUNTIME3__)return b?1:0}else if(a.set_any(b),__CONSTRUCT3_RUNTIME3__)return b},StoredReturnValue:function(){var b=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var a={set_int:function(){},set_float:function(){},set_string:function(){},
set_any:function(){}};else{a=b[0];for(var d=0;d<b.length-1;d++)b[d]=b[d+1];b.pop()}if("boolean"===typeof this.returnValue){if(a.set_any(this.returnValue?1:0),__CONSTRUCT3_RUNTIME3__)return this.returnValue?1:0}else if(a.set_any(this.returnValue),__CONSTRUCT3_RUNTIME3__)return this.returnValue},FunctionReturnValue:function(){var b=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var a={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{a=
b[0];for(var d=0;d<b.length-1;d++)b[d]=b[d+1];b.pop()}d=b[0];var e=this.ParseJS(d,!1,"'FunctionReturnValue' expression");b.splice(0,1);if(e.error)a.set_any(void 0);else{var f=void 0;f=this.CallJSfunction(d,b,!1,"'FunctionReturnValue' expression",e);if("boolean"===typeof f){if(a.set_any(f?1:0),__CONSTRUCT3_RUNTIME3__)return f?1:0}else if(a.set_any(f),__CONSTRUCT3_RUNTIME3__)return f}},Value:function(){var b=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var a={set_int:function(){},
set_float:function(){},set_string:function(){},set_any:function(){}};else{a=b[0];for(var d=0;d<b.length-1;d++)b[d]=b[d+1];b.pop()}b=this.Value("'Value' expression",b);if("boolean"===typeof b){if(a.set_any(b?1:0),__CONSTRUCT3_RUNTIME3__)return b?1:0}else if(a.set_any(b),__CONSTRUCT3_RUNTIME3__)return b},AliasValue:function(){var b=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var a={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{a=
b[0];for(var d=0;d<b.length-1;d++)b[d]=b[d+1];b.pop()}b=this.ParseJS(b[0],!0,"'AliasValue' expression");if(b.alias_found)if(b.error)a.set_any(void 0);else{d=void 0;try{d=b.end}catch(y){b={debug_caller:"AliasValue",caller_name:"'AliasValue' expression","show-alias-expression":!0,alias_expression:b.trimmed_code,error_message:y.message};this.ShowError(b);a.set_any(void 0);return}if("boolean"===typeof d){if(a.set_any(d?1:0),__CONSTRUCT3_RUNTIME3__)return d?1:0}else if(a.set_any(d),__CONSTRUCT3_RUNTIME3__)return d}else b=
{debug_caller:"AliasValue",caller_name:"'AliasValue' expression",error_message:"No such alias '"+b.trimmed_code+"'"},this.ShowError(b),a.set_any(void 0)},AliasCallReturnValue:function(){var b=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var a={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{a=b[0];for(var d=0;d<b.length-1;d++)b[d]=b[d+1];b.pop()}d=b[0];var e=this.ParseJS(d,!0,"'AliasCallValue' expression");b.splice(0,1);if(e.alias_found)if(e.error)a.set_any(void 0);
else{var f=void 0;f=this.CallJSfunction(d,b,!1,"'AliasCallValue' expression",e);if("boolean"===typeof f){if(a.set_any(f?1:0),__CONSTRUCT3_RUNTIME3__)return f?1:0}else if(a.set_any(f),__CONSTRUCT3_RUNTIME3__)return f}else this.ShowError({debug_caller:"AliasCallValue",caller_name:"'AliasCallValue' expression",error_message:"No such alias '"+e.trimmed_code+"'"}),a.set_any(void 0)}};for(w in e)q.prototype[w]=e[w];n.exps=new q;u.EXPS=n.exps;u.CNDS=n.cnds;u.ACTS=n.acts})();
cr.plugins_.Touch=function(f){this.runtime=f};
(function(){function f(a){e=a.x;w=a.y;h=a.z}function p(b,d,e,f){var k=a.length?a.pop():new q;k.init(b,d,e,f);return k}function q(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function n(a){return a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||a.originalEvent&&a.originalEvent.sourceCapabilities&&a.originalEvent.sourceCapabilities.firesTouchEvents}function u(){}function m(){}
var d=cr.plugins_.Touch.prototype;d.Type=function(a){this.plugin=a;this.runtime=a.runtime};d.Type.prototype.onCreate=function(){};d.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.mouseDown=!1};var b=d.Instance.prototype;b.findTouch=function(a){var b;var d=0;for(b=this.touches.length;d<b;d++)if(this.touches[d].id===a)return d;return-1};var e=0,w=0,h=0,a=[];q.prototype.init=function(a,b,d,e){var k=cr.performance_now();this.starttime=this.lasttime=this.time=k;this.startx=
a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=d;this.startindex=e;this.tooFarForHold=this.triggeredHold=!1};q.prototype.update=function(a,b,d,e,f,h){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=d;this.width=e;this.height=f;this.pressure=h;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};q.prototype.maybeTriggerHold=function(a,b){!this.triggeredHold&&
500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,a),a.getTouchIndex=0)};var t=-1E3,y=-1E3,z=-1E4;q.prototype.maybeTriggerTap=function(a,b){if(!this.triggeredHold){var d=
cr.performance_now();333>=d-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=d-z&&25>cr.distanceTo(t,y,this.x,this.y)?(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,a),y=t=-1E3,z=-1E4):(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,
a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,a),t=this.x,y=this.y,z=d),a.getTouchIndex=0)}};b.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=this.properties[0];
var a=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,b=document,d=this;"undefined"!==typeof PointerEvent?(a.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),a.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),b.addEventListener("pointerup",function(a){d.onPointerEnd(a,!1)},!1),b.addEventListener("pointercancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},
!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(a.addEventListener("MSPointerDown",function(a){d.onPointerStart(a)},!1),a.addEventListener("MSPointerMove",function(a){d.onPointerMove(a)},!1),b.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),b.addEventListener("MSPointerCancel",
function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(a.addEventListener("touchstart",function(a){d.onTouchStart(a)},!1),a.addEventListener("touchmove",function(a){d.onTouchMove(a)},!1),b.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),b.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=
function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},h=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},m=Windows.Devices.Sensors.Accelerometer.getDefault();m&&(m.reportInterval=Math.max(m.minimumReportInterval,16),m.addEventListener("readingchanged",e));var p=Windows.Devices.Sensors.Inclinometer.getDefault();p&&(p.reportInterval=Math.max(p.minimumReportInterval,16),p.addEventListener("readingchanged",
h));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(m&&m.removeEventListener("readingchanged",e),p&&p.removeEventListener("readingchanged",h)):(m&&m.addEventListener("readingchanged",e),p&&p.addEventListener("readingchanged",h))},!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&
(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&(document.addEventListener("mousemove",function(a){d.onMouseMove(a)}),document.addEventListener("mousedown",function(a){d.onMouseDown(a)}),document.addEventListener("mouseup",function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&
navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(f,null,{frequency:40});this.runtime.tick2Me(this)};b.onPointerMove=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),d=cr.performance_now();0<=b&&(b=this.touches[b],2>d-b.time||b.update(d,a.pageX-this.runtime.canvas.offsetLeft,a.pageY-this.runtime.canvas.offsetTop,a.width||0,a.height||0,a.pressure||
0))}};b.onPointerStart=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&-1===this.findTouch(a.pointerId)){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=a.pageX-this.runtime.canvas.offsetLeft,d=a.pageY-this.runtime.canvas.offsetTop;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(p(b,d,a.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,
this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=b;this.curTouchY=d;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};b.onPointerEnd=function(b,d){b.pointerType!==b.MSPOINTER_TYPE_MOUSE&&"mouse"!==b.pointerType&&(b.preventDefault&&cr.isCanvasInputEvent(b)&&b.preventDefault(),b=this.findTouch(b.pointerId),this.trigger_index=0<=b?this.touches[b].startindex:-1,this.trigger_id=0<=b?this.touches[b].id:
-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=b&&(d||this.touches[b].maybeTriggerTap(this,b),100>a.length&&a.push(this.touches[b]),this.touches.splice(b,1)),this.runtime.isInUserInputEvent=!1)};b.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),d;var e=0;for(d=a.changedTouches.length;e<d;e++){var k=a.changedTouches[e];var f=
this.findTouch(k.identifier);if(0<=f){var h=this.runtime.canvas.offsetLeft,c=this.runtime.canvas.offsetTop;f=this.touches[f];2>b-f.time||f.update(b,k.pageX-h,k.pageY-c,2*(k.radiusX||k.webkitRadiusX||k.mozRadiusX||k.msRadiusX||0),2*(k.radiusY||k.webkitRadiusY||k.mozRadiusY||k.msRadiusY||0),k.force||k.webkitForce||k.mozForce||k.msForce||0)}}};b.onTouchStart=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.runtime.canvas.offsetLeft,d=this.runtime.canvas.offsetTop;
cr.performance_now();this.runtime.isInUserInputEvent=!0;var e;var k=0;for(e=a.changedTouches.length;k<e;k++){var f=a.changedTouches[k];var h=this.findTouch(f.identifier);if(-1===h){h=f.pageX-b;var c=f.pageY-d;this.trigger_index=this.touches.length;this.trigger_id=f.identifier;this.touches.push(p(h,c,f.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=h;
this.curTouchY=c;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};b.onTouchEnd=function(b,d){b.preventDefault&&cr.isCanvasInputEvent(b)&&b.preventDefault();this.runtime.isInUserInputEvent=!0;var e;var k=0;for(e=b.changedTouches.length;k<e;k++){var l=b.changedTouches[k];l=this.findTouch(l.identifier);0<=l&&(this.trigger_index=this.touches[l].startindex,this.trigger_id=this.touches[l].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,
this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),d||this.touches[l].maybeTriggerTap(this,l),100>a.length&&a.push(this.touches[l]),this.touches.splice(l,1))}this.runtime.isInUserInputEvent=!1};b.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==h?90*h:this.orient_alpha};b.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==w?90*w:this.orient_beta};b.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&
0!==e?90*e:this.orient_gamma};b.onMouseDown=function(a){n(a)||(this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!0)};b.onMouseMove=function(a){if(this.mouseDown&&!n(a))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};b.onMouseUp=function(a){a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();this.runtime.had_a_click=!0;n(a)||(this.onTouchEnd({changedTouches:[{pageX:a.pageX,pageY:a.pageY,
identifier:0}]}),this.mouseDown=!1)};b.isClientPosOverCanvas=function(a,b){return 0<=a&&0<=b&&a<this.runtime.width&&b<this.runtime.height};b.tick2=function(){var a,b=cr.performance_now();var d=0;for(a=this.touches.length;d<a;++d){var e=this.touches[d];e.time<=b-50&&(e.lasttime=b);e.maybeTriggerHold(this,d)}};u.prototype.OnTouchStart=function(){return!0};u.prototype.OnTouchEnd=function(){return!0};u.prototype.IsInTouch=function(){return this.touches.length};u.prototype.OnTouchObject=function(a){return a&&
this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};var A=[];u.prototype.IsTouchingObject=function(a){if(!a)return!1;var b=a.getCurrentSol(),d=b.getObjects(),e,k;var f=0;for(e=d.length;f<e;f++){var h=d[f];h.update_bbox();var c=0;for(k=this.touches.length;c<k;c++){var g=this.touches[c];if(this.isClientPosOverCanvas(g.x,g.y)){var m=h.layer.canvasToLayer(g.x,g.y,!0);g=h.layer.canvasToLayer(g.x,g.y,!1);if(h.contains_pt(m,
g)){A.push(h);break}}}}return A.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,A),a.applySolToContainer(),cr.clearArray(A),!0):!1};u.prototype.CompareTouchSpeed=function(a,b,d){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var e=this.touches[a];a=cr.distanceTo(e.x,e.y,e.lastx,e.lasty);e=(e.time-e.lasttime)/1E3;var k=0;0<e&&(k=a/e);return cr.do_cmp(k,b,d)};u.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};u.prototype.MotionSupported=
function(){return"undefined"!==typeof window.DeviceMotionEvent};u.prototype.CompareOrientation=function(a,b,d){a=0===a?this.getAlpha():1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,d)};u.prototype.CompareAcceleration=function(a,b,d){var e=0;0===a?e=this.acc_g_x:1===a?e=this.acc_g_y:2===a?e=this.acc_g_z:3===a?e=this.acc_x:4===a?e=this.acc_y:5===a&&(e=this.acc_z);return cr.do_cmp(e,b,d)};u.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};u.prototype.OnNthTouchEnd=
function(a){a=Math.floor(a);return a===this.trigger_index};u.prototype.HasNthTouch=function(a){a=Math.floor(a);return this.touches.length>=a+1};u.prototype.OnHoldGesture=function(){return!0};u.prototype.OnTapGesture=function(){return!0};u.prototype.OnDoubleTapGesture=function(){return!0};u.prototype.OnHoldGestureObject=function(a){return a&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};u.prototype.OnTapGestureObject=
function(a){return a&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};u.prototype.OnDoubleTapGestureObject=function(a){return a&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};d.cnds=new u;m.prototype.TouchCount=function(a){a.set_int(this.touches.length)};m.prototype.X=function(a,b){var d=this.getTouchIndex;if(0>
d||d>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var e=b.scale;var k=b.zoomRate;var l=b.parallaxX;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[d].x,this.touches[d].y,!0));b.scale=e;b.zoomRate=k;b.parallaxX=l;b.angle=f}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[d].x,this.touches[d].y,!0)):a.set_float(0)};
m.prototype.XAt=function(a,b,d){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(d)){d=this.runtime.getLayerByNumber(0);var e=d.scale;var k=d.zoomRate;var l=d.parallaxX;var f=d.angle;d.scale=1;d.zoomRate=1;d.parallaxX=1;d.angle=0;a.set_float(d.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));d.scale=e;d.zoomRate=k;d.parallaxX=l;d.angle=f}else(d=cr.is_number(d)?this.runtime.getLayerByNumber(d):this.runtime.getLayerByName(d))?a.set_float(d.canvasToLayer(this.touches[b].x,
this.touches[b].y,!0)):a.set_float(0)};m.prototype.XForID=function(a,b,d){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(d)){d=this.runtime.getLayerByNumber(0);var e=d.scale;var k=d.zoomRate;var l=d.parallaxX;var f=d.angle;d.scale=1;d.zoomRate=1;d.parallaxX=1;d.angle=0;a.set_float(d.canvasToLayer(b.x,b.y,!0));d.scale=e;d.zoomRate=k;d.parallaxX=l;d.angle=f}else(d=cr.is_number(d)?this.runtime.getLayerByNumber(d):this.runtime.getLayerByName(d))?a.set_float(d.canvasToLayer(b.x,
b.y,!0)):a.set_float(0)};m.prototype.Y=function(a,b){var d=this.getTouchIndex;if(0>d||d>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var e=b.scale;var k=b.zoomRate;var l=b.parallaxY;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[d].x,this.touches[d].y,!1));b.scale=e;b.zoomRate=k;b.parallaxY=l;b.angle=f}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?
a.set_float(b.canvasToLayer(this.touches[d].x,this.touches[d].y,!1)):a.set_float(0)};m.prototype.YAt=function(a,b,d){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(d)){d=this.runtime.getLayerByNumber(0);var e=d.scale;var k=d.zoomRate;var l=d.parallaxY;var f=d.angle;d.scale=1;d.zoomRate=1;d.parallaxY=1;d.angle=0;a.set_float(d.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));d.scale=e;d.zoomRate=k;d.parallaxY=l;d.angle=f}else(d=cr.is_number(d)?this.runtime.getLayerByNumber(d):
this.runtime.getLayerByName(d))?a.set_float(d.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};m.prototype.YForID=function(a,b,d){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(d)){d=this.runtime.getLayerByNumber(0);var e=d.scale;var k=d.zoomRate;var l=d.parallaxY;var f=d.angle;d.scale=1;d.zoomRate=1;d.parallaxY=1;d.angle=0;a.set_float(d.canvasToLayer(b.x,b.y,!1));d.scale=e;d.zoomRate=k;d.parallaxY=l;d.angle=f}else(d=cr.is_number(d)?this.runtime.getLayerByNumber(d):
this.runtime.getLayerByName(d))?a.set_float(d.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};m.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};m.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};m.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};m.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):
a.set_float(0)};m.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};m.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};m.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var d=this.touches[b];b=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;0>=d?a.set_float(0):a.set_float(b/d)}};m.prototype.SpeedForID=
function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var d=this.touches[b];b=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;0>=d?a.set_float(0):a.set_float(b/d)}};m.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};m.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,
b.lasty,b.x,b.y))))};m.prototype.Alpha=function(a){a.set_float(this.getAlpha())};m.prototype.Beta=function(a){a.set_float(this.getBeta())};m.prototype.Gamma=function(a){a.set_float(this.getGamma())};m.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};m.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};m.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};m.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};m.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};
m.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};m.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};m.prototype.TouchID=function(a){a.set_float(this.trigger_id)};m.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};m.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};m.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};
d.exps=new m})();cr.plugins_.Browser=function(f){this.runtime=f};
(function(){function f(){e&&w&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(a){h.onSWMessage(a)})}function p(){if(!t&&navigator.getBattery){var b=navigator.getBattery();t=!0;b&&b.then(function(b){a=b})}}function q(){}function n(){}function u(a){console&&console.warn&&console.warn("Fullscreen request failed: ",a);z.setSize(window.innerWidth,window.innerHeight)}function m(){}var d=cr.plugins_.Browser.prototype;d.Type=function(a){this.plugin=a;this.runtime=a.runtime};
var b=d.Type.prototype;b.onCreate=function(){};var e=!1,w=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C3_RegisterSW&&navigator.serviceWorker){var a=document.createElement("script");a.onload=function(){e=!0;f()};a.src="offlineclient.js";document.head.appendChild(a)}});var h=null;b.onAppBegin=function(){w=!0;f()};d.Instance=function(a){this.type=a;this.runtime=a.runtime};b=d.Instance.prototype;b.onCreate=function(){var a=this;window.addEventListener("resize",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,
a)});h=this;"undefined"!==typeof navigator.onLine&&(window.addEventListener("online",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,a)}),window.addEventListener("offline",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,a)}));document.addEventListener("backbutton",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a)});document.addEventListener("menubutton",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,
a)});document.addEventListener("searchbutton",function(){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,a)});document.addEventListener("tizenhwkey",function(b){switch(b.keyName){case "back":var d=a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a);!d&&window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case "menu":(d=a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,a))||b.preventDefault()}});this.runtime.isWindows10&&"undefined"!==
typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(b){a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a)&&(b.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(b){return!!a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,a)});this.runtime.addSuspendCallback(function(b){b?a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,a):a.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,
a)});this.is_arcade="undefined"!==typeof window.is_scirra_arcade};b.onSWMessage=function(a){a=a.data.type;"downloading-update"===a?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===a||"update-pending"===a?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,this):"offline-ready"===a&&this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var a=null,t=!1;q.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:
!1};q.prototype.IsOnline=function(){return navigator?navigator.onLine:!1};q.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1};q.prototype.OnOnline=function(){return!0};q.prototype.OnOffline=function(){return!0};q.prototype.IsDownloadingUpdate=function(){return!1};q.prototype.PageVisible=function(){return!this.runtime.isSuspended};q.prototype.OnPageVisible=function(){return!0};q.prototype.OnPageHidden=function(){return!0};q.prototype.OnResize=function(){return!0};q.prototype.IsFullscreen=
function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen)};q.prototype.OnBackButton=function(){return!0};q.prototype.OnMenuButton=function(){return!0};q.prototype.OnSearchButton=function(){return!0};q.prototype.IsMetered=function(){var a=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return a?!!a.metered:!1};q.prototype.IsCharging=function(){var b=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(b)return!!b.charging;
p();return a?!!a.charging:!0};q.prototype.IsPortraitLandscape=function(a){return(window.innerWidth<=window.innerHeight?0:1)===a};q.prototype.SupportsFullscreen=function(){if(this.runtime.isNWjs)return!0;var a=this.runtime.canvas;return!!(a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullScreen)};q.prototype.OnUpdateFound=function(){return!0};q.prototype.OnUpdateReady=function(){return!0};q.prototype.OnOfflineReady=function(){return!0};d.cnds=new q;n.prototype.Alert=
function(a){alert(a.toString())};n.prototype.Close=function(){window.tizen?window.tizen.application.getCurrentApplication().exit():navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||window.close()};n.prototype.Focus=function(){this.runtime.isNWjs?nw.Window.get().focus():this.is_arcade||window.focus()};n.prototype.Blur=function(){this.runtime.isNWjs?nw.Window.get().blur():this.is_arcade||window.blur()};
n.prototype.GoBack=function(){navigator.app&&navigator.app.backHistory?navigator.app.backHistory():!this.is_arcade&&window.back&&window.back()};n.prototype.GoForward=function(){!this.is_arcade&&window.forward&&window.forward()};n.prototype.GoHome=function(){!this.is_arcade&&window.home&&window.home()};n.prototype.GoToURL=function(a,b){this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(a,{openExternal:!0}):
this.runtime.isCordova?window.open(a,"_system"):this.runtime.isPreview?window.open(a,"_blank"):this.is_arcade||(2!==b||this.is_arcade?1!==b||this.is_arcade?window.location=a:window.parent.location=a:window.top.location=a)};n.prototype.GoToURLWindow=function(a,b){this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(a,{openExternal:!0}):this.runtime.isCordova?window.open(a,"_system"):this.is_arcade||window.open(a,
b)};n.prototype.Reload=function(){this.is_arcade||window.location.reload()};var y=!0,z=null;n.prototype.RequestFullScreen=function(a,b){2<=a&&(a+=1);6===a&&(a=2);document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement||(this.runtime.fullscreen_scaling=2<=a?a:0,a={navigationUI:"auto"},1===b?a.navigationUI="hide":2===b&&(a.navigationUI="show"),b=document.documentElement,y&&(y=!1,z=this.runtime,b.addEventListener("mozfullscreenerror",
u),b.addEventListener("webkitfullscreenerror",u),b.addEventListener("MSFullscreenError",u),b.addEventListener("fullscreenerror",u)),b.requestFullscreen?b.requestFullscreen(a):b.mozRequestFullScreen?b.mozRequestFullScreen(a):b.msRequestFullscreen?b.msRequestFullscreen(a):b.webkitRequestFullScreen&&("undefined"!==typeof Element&&"undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?b.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):b.webkitRequestFullScreen()))};n.prototype.CancelFullScreen=function(){document.exitFullscreen?
document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()};n.prototype.Vibrate=function(a){try{var b=a.split(","),d;var e=0;for(d=b.length;e<d;e++)b[e]=parseInt(b[e],10);navigator.vibrate?navigator.vibrate(b):navigator.mozVibrate?navigator.mozVibrate(b):navigator.webkitVibrate?navigator.webkitVibrate(b):navigator.msVibrate&&navigator.msVibrate(b)}catch(N){}};
n.prototype.InvokeDownload=function(a,b){if(b){var d=document.createElement("a");if("undefined"===typeof d.download)window.open(a);else{var e=document.getElementsByTagName("body")[0];d.textContent=b;d.href=a;d.download=b;e.appendChild(d);a=new MouseEvent("click");d.dispatchEvent(a);e.removeChild(d)}}};n.prototype.InvokeDownloadString=function(a,b,d){if(d){var e="data:"+b+","+encodeURIComponent(a);a=document.createElement("a");"undefined"===typeof a.download?window.open(e):(b=document.getElementsByTagName("body")[0],
a.textContent=d,a.href=e,a.download=d,b.appendChild(a),d=new MouseEvent("click"),a.dispatchEvent(d),b.removeChild(a))}};n.prototype.ConsoleLog=function(a,b){"undefined"!==typeof console&&(0===a&&console.log&&console.log(b.toString()),1===a&&console.warn&&console.warn(b.toString()),2===a&&console.error&&console.error(b.toString()))};n.prototype.ConsoleGroup=function(a){console&&console.group&&console.group(a)};n.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()};n.prototype.ExecJs=
function(a){try{eval&&eval(a)}catch(l){console&&console.error&&console.error("Error executing Javascript: ",l)}};var A="portrait landscape portrait-primary portrait-secondary landscape-primary landscape-secondary".split(" ");n.prototype.LockOrientation=function(a){a=Math.floor(a);0>a||a>=A.length||(this.runtime.autoLockOrientation=!1,a=A[a],screen.orientation&&screen.orientation.lock?screen.orientation.lock(a):screen.lockOrientation?screen.lockOrientation(a):screen.webkitLockOrientation?screen.webkitLockOrientation(a):
screen.mozLockOrientation?screen.mozLockOrientation(a):screen.msLockOrientation&&screen.msLockOrientation(a))};n.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1;screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()};d.acts=
new n;m.prototype.URL=function(a){a.set_string(window.location.toString())};m.prototype.Protocol=function(a){a.set_string(window.location.protocol)};m.prototype.Domain=function(a){a.set_string(window.location.hostname)};m.prototype.PathName=function(a){a.set_string(window.location.pathname)};m.prototype.Hash=function(a){a.set_string(window.location.hash)};m.prototype.Referrer=function(a){a.set_string(document.referrer)};m.prototype.Title=function(a){a.set_string(document.title)};m.prototype.Name=
function(a){a.set_string(navigator.appName)};m.prototype.Version=function(a){a.set_string(navigator.appVersion)};m.prototype.Language=function(a){navigator&&navigator.language?a.set_string(navigator.language):a.set_string("")};m.prototype.Platform=function(a){a.set_string(navigator.platform)};m.prototype.Product=function(a){navigator&&navigator.product?a.set_string(navigator.product):a.set_string("")};m.prototype.Vendor=function(a){navigator&&navigator.vendor?a.set_string(navigator.vendor):a.set_string("")};
m.prototype.UserAgent=function(a){a.set_string(navigator.userAgent)};m.prototype.QueryString=function(a){a.set_string(window.location.search)};m.prototype.QueryParam=function(a,b){(b=RegExp("[?&]"+b+"=([^&]*)").exec(window.location.search))?a.set_string(decodeURIComponent(b[1].replace(/\+/g," "))):a.set_string("")};m.prototype.Bandwidth=function(a){var b=navigator.connection||navigator.mozConnection||navigator.webkitConnection;b?"undefined"!==typeof b.bandwidth?a.set_float(b.bandwidth):"undefined"!==
typeof b.downlinkMax?a.set_float(b.downlinkMax):a.set_float(Number.POSITIVE_INFINITY):a.set_float(Number.POSITIVE_INFINITY)};m.prototype.ConnectionType=function(a){var b=navigator.connection||navigator.mozConnection||navigator.webkitConnection;b?a.set_string(b.type||"unknown"):a.set_string("unknown")};m.prototype.BatteryLevel=function(b){var d=navigator.battery||navigator.mozBattery||navigator.webkitBattery;d?b.set_float(d.level):(p(),a?b.set_float(a.level):b.set_float(1))};m.prototype.BatteryTimeLeft=
function(b){var d=navigator.battery||navigator.mozBattery||navigator.webkitBattery;d?b.set_float(d.dischargingTime):(p(),a?b.set_float(a.dischargingTime):b.set_float(Number.POSITIVE_INFINITY))};m.prototype.ExecJS=function(a,b){if(eval){var d=0;try{d=eval(b)}catch(G){console&&console.error&&console.error("Error executing Javascript: ",G)}"number"===typeof d?a.set_any(d):"string"===typeof d?a.set_any(d):"boolean"===typeof d?a.set_any(d?1:0):a.set_any(0)}else a.set_any(0)};m.prototype.ScreenWidth=function(a){a.set_int(screen.width)};
m.prototype.ScreenHeight=function(a){a.set_int(screen.height)};m.prototype.DevicePixelRatio=function(a){a.set_float(this.runtime.devicePixelRatio)};m.prototype.WindowInnerWidth=function(a){a.set_int(window.innerWidth)};m.prototype.WindowInnerHeight=function(a){a.set_int(window.innerHeight)};m.prototype.WindowOuterWidth=function(a){a.set_int(window.outerWidth)};m.prototype.WindowOuterHeight=function(a){a.set_int(window.outerHeight)};d.exps=new m})();
cr.plugins_.Spritefont2=function(f){this.runtime=f};
(function(){function f(a,b){return a.length?a.pop():new b}function p(a,b,d){if(d){var f;d=0;for(f=b.length;d<f;d++)a.length<e&&a.push(b[d]);cr.clearArray(b)}else for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(a.length<e&&a.push(b[f]),delete b[f])}function q(a,b,d){var e=a.lines;d=d.replace(/\s\s*$/,"");b>=e.length&&e.push(f(w,Object));b=e[b];b.text=d;b.width=a.measureWidth(d);a.textWidth=cr.max(a.textWidth,b.width)}function n(){}function u(){}function m(){}var d=cr.plugins_.Spritefont2.prototype;
d.onCreate=function(){};d.Type=function(a){this.plugin=a;this.runtime=a.runtime};var b=d.Type.prototype;b.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,this.texture_file)),this.spriteX=this.texture_data[3],this.spriteY=
this.texture_data[4],this.spriteWidth=this.texture_data[5],this.spriteHeight=this.texture_data[6],this.webGL_texture=null)};b.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};b.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!1,this.runtime.linearSampling,this.texture_pixelformat));var a;var b=0;for(a=this.instances.length;b<a;b++)this.instances[b].webGL_texture=
this.webGL_texture}};b.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};b.preloadCanvas2D=function(a){a.drawImage(this.texture_img,0,0)};d.Instance=function(a){this.type=a;this.runtime=a.runtime};b=d.Instance.prototype;b.onDestroy=function(){p(w,this.lines,!0);p(h,this.clipList,!1);p(a,this.clipUV,!1);cr.wipe(this.characterWidthList)};b.onCreate=function(){this.texture_img=this.type.texture_img;
this.text=this.properties[0];this.characterWidth=this.properties[2];this.characterHeight=this.properties[3];this.characterSet=this.properties[4];var a=this.properties[5];this.characterScale=this.properties[6];this.characterSpacing=this.properties[7];this.lineHeight=this.properties[8];this.halign=this.properties[9]/2;this.valign=this.properties[10]/2;this.wrapbyword=0===this.properties[11];this.visible=this.properties[12];this.textHeight=this.textWidth=0;this.recycled?(cr.clearArray(this.lines),cr.wipe(this.clipList),
cr.wipe(this.clipUV),cr.wipe(this.characterWidthList)):(this.lines=[],this.clipList={},this.clipUV={},this.characterWidthList={});this.text_changed=!0;this.lastwrapwidth=this.width;this.runtime.glwrap&&(this.type.webGL_texture||(this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat)),this.webGL_texture=this.type.webGL_texture);this.LoadCharacterSpacingData(a);this.SplitSheet()};b.saveToJSON=function(){var a={t:this.text,
csc:this.characterScale,csp:this.characterSpacing,lh:this.lineHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick,ha:this.halign,va:this.valign,cw:{}},b;for(b in this.characterWidthList)a.cw[b]=this.characterWidthList[b];return a};b.loadFromJSON=function(a){this.text=a.t;this.characterScale=a.csc;this.characterSpacing=a.csp;this.lineHeight=a.lh;this.textWidth=a.tw;this.textHeight=a.th;this.last_render_tick=a.lrt;a.hasOwnProperty("ha")&&(this.halign=a.ha);a.hasOwnProperty("va")&&
(this.valign=a.va);for(var b in a.cw)this.characterWidthList[b]=a.cw[b];this.text_changed=!0;this.lastwrapwidth=this.width};var e=1E3,w=[],h=[],a=[];b.SplitSheet=function(){var b=this.texture_img.width,d=this.texture_img.height,e=this.type.spriteX,l=this.type.spriteY,m=this.characterWidth,p=this.characterHeight,n=e/b,t=l/d;b=m/b;d=p/d;for(var q=this.characterSet,c=Math.floor(this.type.spriteWidth/m),g=Math.floor(this.type.spriteHeight/p),r=0;r<q.length&&!(r>=c*g);r++){var u=r%c,w=Math.floor(r/c),
y=q.charAt(r);if(this.runtime.glwrap){var Z=this.clipUV,I=u*b+n,J=w*d+t;u=(u+1)*b+n;w=(w+1)*d+t;void 0===Z[y]&&(Z[y]=f(a,cr.rect));Z[y].left=I;Z[y].top=J;Z[y].right=u;Z[y].bottom=w}else Z=this.clipList,u=u*m+e,w=w*p+l,I=m,J=p,void 0===Z[y]&&(Z[y]=f(h,Object)),Z[y].x=u,Z[y].y=w,Z[y].w=I,Z[y].h=J}};var t=[];d.TokeniseWords=function(a){cr.clearArray(t);for(var b="",d,e=0;e<a.length;)if(d=a.charAt(e),"\n"===d)b.length&&(t.push(b),b=""),t.push("\n"),++e;else if(" "===d||"\t"===d||"-"===d){do b+=a.charAt(e),
e++;while(e<a.length&&(" "===a.charAt(e)||"\t"===a.charAt(e)));t.push(b);b=""}else e<a.length&&(b+=d,e++);b.length&&t.push(b)};d.WordWrap=function(a){var b=a.text,d=a.lines;if(b&&b.length){var e=a.width;if(2>=e)p(w,d,!0);else{var h=a.characterScale,m=a.characterSpacing;if(b.length*(a.characterWidth*h+m)-m<=e&&-1===b.indexOf("\n")&&(m=a.measureWidth(b),m<=e)){p(w,d,!0);d.push(f(w,Object));d[0].text=b;d[0].width=m;a.textWidth=m;a.textHeight=a.characterHeight*h+a.lineHeight;return}this.WrapText(a);a.textHeight=
d.length*(a.characterHeight*h+a.lineHeight)}}else p(w,d,!0)};d.WrapText=function(a){var b=a.wrapbyword,d=a.text,f=a.lines,h=a.width;b&&(this.TokeniseWords(d),d=t);var m="",p,n=0,u=!1;for(p=0;p<d.length;p++)if("\n"===d[p])!0===u?u=!1:(q(a,n,m),n++),m="";else{u=!1;var c=m;m+=d[p];var g=a.measureWidth(m.replace(/\s\s*$/,""));g>h&&(""===c?(q(a,n,m),m="",u=!0):(q(a,n,c),m=d[p]),n++,b||" "!==m||(m=""))}m.replace(/\s\s*$/,"").length&&(q(a,n,m),n++);for(p=n;p<f.length;p++)w.length<e&&w.push(f[p]);f.length=
n};b.measureWidth=function(a){for(var b=this.characterSpacing,d=a.length,e=0,f=0;f<d;f++)e+=this.getCharacterWidth(a.charAt(f))*this.characterScale+b;return e-(0<e?b:0)};b.getCharacterWidth=function(a){var b=this.characterWidthList;return void 0!==b[a]?b[a]:this.characterWidth};b.rebuildText=function(){if(this.text_changed||this.width!==this.lastwrapwidth)this.textHeight=this.textWidth=0,this.type.plugin.WordWrap(this),this.text_changed=!1,this.lastwrapwidth=this.width};b.draw=function(a,b){b=this.texture_img;
if(""!==this.text&&null!=b&&(this.rebuildText(),!(this.height<this.characterHeight*this.characterScale+this.lineHeight))){a.globalAlpha=this.opacity;b=this.x;var d=this.y;this.runtime.pixel_rounding&&(b=Math.round(b),d=Math.round(d));var e=this.layer.viewLeft,f=this.layer.viewTop,h=this.layer.viewRight,m=this.layer.viewBottom;a.save();a.translate(b,d);a.rotate(this.angle);var p=this.angle,n=this.halign,c=this.characterScale,g=this.characterHeight*c,r=this.lineHeight,t=this.characterSpacing,q=this.lines,
u=this.valign*cr.max(0,this.height-this.textHeight),z=-(this.hotspotX*this.width);u=-(this.hotspotY*this.height)+u;for(var w,y,A=0;A<q.length;A++){var x=q[A].text;var W=n*cr.max(0,this.width-q[A].width);var M=z+W;u+=r;if(0===p&&d+u+g<f)u+=g;else{for(var R=0;R<x.length;R++){w=x.charAt(R);W=this.getCharacterWidth(w);var F=this.clipList[w];if(0===p&&b+M+W*c+t<e)M+=W*c+t;else{if(M+W*c>this.width+1E-5)break;void 0!==F&&(w=M,y=u,0===p&&1===c&&(w=Math.round(w),y=Math.round(y)),a.drawImage(this.texture_img,
F.x,F.y,F.w,F.h,w,y,F.w*c,F.h*c));M+=W*c+t;if(0===p&&b+M>h)break}}u+=g;if(0===p&&(u+g+r>this.height||d+u>m))break}}a.restore()}};var y=new cr.quad;b.drawGL=function(a){a.setTexture(this.webGL_texture);a.setOpacity(this.opacity);if(this.text&&(this.rebuildText(),!(this.height<this.characterHeight*this.characterScale+this.lineHeight))){this.update_bbox();var b=this.bquad,d=0,e=0;this.runtime.pixel_rounding&&(d=Math.round(this.x)-this.x,e=Math.round(this.y)-this.y);var f=this.layer.viewLeft,h=this.layer.viewTop,
m=this.layer.viewRight,p=this.layer.viewBottom,n=this.angle,c=this.halign,g=this.valign,t=this.characterScale,q=this.characterHeight*t,u=this.lineHeight,w=this.characterSpacing,z=this.lines,I=this.textHeight,J;if(0!==n){var E=Math.cos(n);var x=Math.sin(n)}g*=cr.max(0,this.height-I);d=b.tlx+d;b=b.tly+e;e=g;for(g=0;g<z.length;g++){I=z[g].text;var W=J=c*cr.max(0,this.width-z[g].width);e+=u;if(0===n&&b+e+q<h)e+=q;else{for(var M=0;M<I.length;M++){var R=I.charAt(M);J=this.getCharacterWidth(R);R=this.clipUV[R];
if(0===n&&d+W+J*t+w<f)W+=J*t+w;else{if(W+J*t>this.width+1E-5)break;if(void 0!==R){var F=this.characterWidth*t,P=this.characterHeight*t;var L=W;var D=e;0===n&&1===t&&(L=Math.round(L),D=Math.round(D));y.tlx=L;y.tly=D;y.trx=L+F;y.try_=D;y.blx=L;y.bly=D+P;y.brx=L+F;y.bry=D+P;0!==n&&(D=y,F=E,P=x,L=D.tlx*F-D.tly*P,D.tly=D.tly*F+D.tlx*P,D.tlx=L,L=D.trx*F-D.try_*P,D.try_=D.try_*F+D.trx*P,D.trx=L,L=D.blx*F-D.bly*P,D.bly=D.bly*F+D.blx*P,D.blx=L,L=D.brx*F-D.bry*P,D.bry=D.bry*F+D.brx*P,D.brx=L);y.offset(d,b);
a.quadTex(y.tlx,y.tly,y.trx,y.try_,y.brx,y.bry,y.blx,y.bly,R)}W+=J*t+w;if(0===n&&d+W>m)break}}e+=q;if(0===n&&(e+q+u>this.height||b+e>p))break}}}};n.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};d.cnds=new n;u.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.text!==a&&(this.text=a,this.text_changed=!0,this.runtime.redraw=!0)};u.prototype.AppendText=function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);
if(a=a.toString())this.text+=a,this.text_changed=!0,this.runtime.redraw=!0};u.prototype.SetScale=function(a){a!==this.characterScale&&(this.characterScale=a,this.text_changed=!0,this.runtime.redraw=!0)};u.prototype.SetCharacterSpacing=function(a){a!==this.CharacterSpacing&&(this.characterSpacing=a,this.text_changed=!0,this.runtime.redraw=!0)};u.prototype.SetLineHeight=function(a){a!==this.lineHeight&&(this.lineHeight=a,this.text_changed=!0,this.runtime.redraw=!0)};b.SetCharWidth=function(a,b){b=parseInt(b,
10);this.characterWidthList[a]!==b&&(this.characterWidthList[a]=b,this.text_changed=!0,this.runtime.redraw=!0)};b.LoadCharacterSpacingData=function(a){var b,d;if(a){try{var e=JSON.parse(a)}catch(U){return}if(Array.isArray(e))for(a=0,b=e.length;a<b;++a){var f=e[a];if(Array.isArray(f)&&2===f.length&&"number"===typeof f[0]&&"string"===typeof f[1]){var h=f[0];f=f[1];var m=0;for(d=f.length;m<d;++m)this.SetCharWidth(f.charAt(m),h)}}}};u.prototype.SetCharacterWidth=function(a,b){if(""!==a)for(var d=0;d<
a.length;d++)this.SetCharWidth(a.charAt(d),b)};u.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};u.prototype.SetHAlign=function(a){this.halign=a/2;this.text_changed=!0;this.runtime.redraw=!0};u.prototype.SetVAlign=function(a){this.valign=a/2;this.text_changed=!0;this.runtime.redraw=!0};d.acts=new u;m.prototype.CharacterWidth=function(a,b){a.set_int(this.getCharacterWidth(b))};m.prototype.CharacterHeight=
function(a){a.set_int(this.characterHeight)};m.prototype.CharacterScale=function(a){a.set_float(this.characterScale)};m.prototype.CharacterSpacing=function(a){a.set_int(this.characterSpacing)};m.prototype.LineHeight=function(a){a.set_int(this.lineHeight)};m.prototype.Text=function(a){a.set_string(this.text)};m.prototype.TextWidth=function(a){this.rebuildText();a.set_float(this.textWidth)};m.prototype.TextHeight=function(a){this.rebuildText();a.set_float(this.textHeight)};d.exps=new m})();
cr.behaviors.solid=function(f){this.runtime=f};
(function(){function f(){}function p(){}var q=cr.behaviors.solid.prototype;q.Type=function(f,m){this.behavior=f;this.objtype=m;this.runtime=f.runtime};q.Type.prototype.onCreate=function(){};q.Instance=function(f,m){this.type=f;this.behavior=f.behavior;this.inst=m;this.runtime=f.runtime};var n=q.Instance.prototype;n.onCreate=function(){this.inst.extra.solidEnabled=this.properties[0]};n.tick=function(){};f.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled};q.cnds=new f;p.prototype.SetEnabled=
function(f){this.inst.extra.solidEnabled=!!f};q.acts=new p})();cr.behaviors.Platform=function(f){this.runtime=f};
(function(){function f(){}function p(){}function q(){}var n=cr.behaviors.Platform.prototype;n.Type=function(f,d){this.behavior=f;this.objtype=d;this.runtime=f.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(f,d){this.type=f;this.behavior=f.behavior;this.inst=d;this.runtime=f.runtime;this.simjump=this.simright=this.simleft=this.ignoreInput=this.canDoubleJump=this.doubleJumped=this.jumped=this.jumpkey=this.rightkey=this.leftkey=!1;this.lastFloorObject=null;this.loadFloorObject=-1;
this.lastFloorY=this.lastFloorX=0;this.floorIsJumpthru=!1;this.fallthrough=this.animMode=this.ceilingCollisionMode=0;this.firstTick=!0;this.dy=this.dx=0};var u=n.Instance.prototype;u.updateGravity=function(){this.downx=Math.cos(this.ga);this.downy=Math.sin(this.ga);this.rightx=Math.cos(this.ga-Math.PI/2);this.righty=Math.sin(this.ga-Math.PI/2);this.downx=cr.round6dp(this.downx);this.downy=cr.round6dp(this.downy);this.rightx=cr.round6dp(this.rightx);this.righty=cr.round6dp(this.righty);this.g1=this.g;
0>this.g&&(this.downx*=-1,this.downy*=-1,this.g=Math.abs(this.g))};u.onCreate=function(){this.maxspeed=this.properties[0];this.acc=this.properties[1];this.dec=this.properties[2];this.jumpStrength=this.properties[3];this.g1=this.g=this.properties[4];this.maxFall=this.properties[5];this.enableDoubleJump=this.properties[6];this.jumpSustain=this.properties[7]/1E3;this.defaultControls=this.properties[8];this.enabled=this.properties[9];this.wasOnFloor=!1;this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst);
this.loadOverJumpthru=-1;this.sustainTime=0;this.ga=cr.to_radians(90);this.updateGravity();var f=this;this.defaultControls&&(document.addEventListener("keydown",function(d){f.onKeyDown(d)}),document.addEventListener("keyup",function(d){f.onKeyUp(d)}));this.recycled||(this.myDestroyCallback=function(d){f.onInstanceDestroyed(d)});this.runtime.addDestroyCallback(this.myDestroyCallback);this.inst.extra.isPlatformBehavior=!0};u.saveToJSON=function(){return{ii:this.ignoreInput,lfx:this.lastFloorX,lfy:this.lastFloorY,
lfo:this.lastFloorObject?this.lastFloorObject.uid:-1,am:this.animMode,en:this.enabled,fall:this.fallthrough,ft:this.firstTick,dx:this.dx,dy:this.dy,ms:this.maxspeed,acc:this.acc,dec:this.dec,js:this.jumpStrength,g:this.g,g1:this.g1,mf:this.maxFall,wof:this.wasOnFloor,woj:this.wasOverJumpthru?this.wasOverJumpthru.uid:-1,ga:this.ga,edj:this.enableDoubleJump,cdj:this.canDoubleJump,dj:this.doubleJumped,sus:this.jumpSustain,cc:this.ceilingCollisionMode}};u.loadFromJSON=function(f){this.ignoreInput=f.ii;
this.lastFloorX=f.lfx;this.lastFloorY=f.lfy;this.loadFloorObject=f.lfo;this.animMode=f.am;this.enabled=f.en;this.fallthrough=f.fall;this.firstTick=f.ft;this.dx=f.dx;this.dy=f.dy;this.maxspeed=f.ms;this.acc=f.acc;this.dec=f.dec;this.jumpStrength=f.js;this.g=f.g;this.g1=f.g1;this.maxFall=f.mf;this.wasOnFloor=f.wof;this.loadOverJumpthru=f.woj;this.ga=f.ga;this.enableDoubleJump=f.edj;this.canDoubleJump=f.cdj;this.doubleJumped=f.dj;this.jumpSustain=f.sus;this.ceilingCollisionMode=f.cc||0;this.simjump=
this.simright=this.simleft=this.jumped=this.jumpkey=this.rightkey=this.leftkey=!1;this.sustainTime=0;this.updateGravity()};u.afterLoad=function(){this.lastFloorObject=-1===this.loadFloorObject?null:this.runtime.getObjectByUID(this.loadFloorObject);this.wasOverJumpthru=-1===this.loadOverJumpthru?null:this.runtime.getObjectByUID(this.loadOverJumpthru)};u.onInstanceDestroyed=function(f){this.lastFloorObject==f&&(this.lastFloorObject=null)};u.onDestroy=function(){this.lastFloorObject=null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};
u.onKeyDown=function(f){switch(f.which){case 38:f.preventDefault();this.jumpkey=!0;break;case 37:f.preventDefault();this.leftkey=!0;break;case 39:f.preventDefault(),this.rightkey=!0}};u.onKeyUp=function(f){switch(f.which){case 38:f.preventDefault();this.jumped=this.jumpkey=!1;break;case 37:f.preventDefault();this.leftkey=!1;break;case 39:f.preventDefault(),this.rightkey=!1}};u.onWindowBlur=function(){this.jumpkey=this.rightkey=this.leftkey=!1};u.getGDir=function(){return 0>this.g?-1:1};u.isOnFloor=
function(){var f,d=null;var b=this.inst.x;var e=this.inst.y;this.inst.x+=this.downx;this.inst.y+=this.downy;this.inst.set_bbox_changed();if(this.lastFloorObject&&this.runtime.testOverlap(this.inst,this.lastFloorObject)&&(!this.runtime.typeHasBehavior(this.lastFloorObject.type,cr.behaviors.solid)||this.lastFloorObject.extra.solidEnabled))return this.inst.x=b,this.inst.y=e,this.inst.set_bbox_changed(),this.lastFloorObject;(f=this.runtime.testOverlapSolid(this.inst))||0!==this.fallthrough||(d=this.runtime.testOverlapJumpThru(this.inst,
!0));this.inst.x=b;this.inst.y=e;this.inst.set_bbox_changed();if(f){if(this.runtime.testOverlap(this.inst,f))return null;this.floorIsJumpthru=!1;return f}if(d&&d.length){e=f=0;for(b=d.length;f<b;f++)d[e]=d[f],this.runtime.testOverlap(this.inst,d[f])||e++;if(1<=e)return this.floorIsJumpthru=!0,d[0]}return null};u.tick=function(){};u.posttick=function(){var f=this.runtime.getDt(this.inst),d,b;this.jumpkey||this.simjump||(this.jumped=!1);var e=this.leftkey||this.simleft;var p=this.rightkey||this.simright;
var h=(d=this.jumpkey||this.simjump)&&!this.jumped;this.simjump=this.simright=this.simleft=!1;if(this.enabled){this.ignoreInput&&(h=d=p=e=!1);d||(this.sustainTime=0);var a=this.lastFloorObject;var n=!1;this.firstTick&&((this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst))&&this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,4,!0),this.firstTick=!1);if(a&&0===this.dy&&(a.y!==this.lastFloorY||a.x!==this.lastFloorX)){var q=a.x-this.lastFloorX;var u=a.y-this.lastFloorY;
this.inst.x+=q;this.inst.y+=u;this.inst.set_bbox_changed();this.lastFloorX=a.x;this.lastFloorY=a.y;n=!0;this.runtime.testOverlapSolid(this.inst)&&this.runtime.pushOutSolid(this.inst,-q,-u,2.5*Math.sqrt(q*q+u*u))}var A=this.isOnFloor();if(u=this.runtime.testOverlapSolid(this.inst))if(this.inst.extra.inputPredicted)this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,10,!1);else if(this.runtime.pushOutSolidAxis(this.inst,-this.downx,-this.downy,this.inst.height/8))this.runtime.registerCollision(this.inst,
u);else if(this.runtime.pushOutSolidAxis(this.inst,this.rightx,this.righty,this.inst.width/2))this.runtime.registerCollision(this.inst,u);else if(this.runtime.pushOutSolidAxis(this.inst,this.downx,this.downy,this.inst.height/2))this.runtime.registerCollision(this.inst,u);else if(this.runtime.pushOutSolidNearest(this.inst,Math.max(this.inst.width,this.inst.height)/2))this.runtime.registerCollision(this.inst,u);else return;A?(this.canDoubleJump=this.doubleJumped=!1,0<this.dy&&(this.wasOnFloor||(this.runtime.pushInFractional(this.inst,
-this.downx,-this.downy,A,16),this.wasOnFloor=!0),this.dy=0),a!=A)?(this.lastFloorObject=A,this.lastFloorX=A.x,this.lastFloorY=A.y,this.runtime.registerCollision(this.inst,A)):n&&(u=this.runtime.testOverlapSolid(this.inst))&&(this.runtime.registerCollision(this.inst,u),0!==q&&(0<q?this.runtime.pushOutSolid(this.inst,-this.rightx,-this.righty):this.runtime.pushOutSolid(this.inst,this.rightx,this.righty)),this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy)):d||(this.canDoubleJump=!0);if(A&&
h||!A&&this.enableDoubleJump&&d&&this.canDoubleJump&&!this.doubleJumped)a=this.inst.x,n=this.inst.y,this.inst.x-=this.downx,this.inst.y-=this.downy,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)?h=!1:(this.sustainTime=this.jumpSustain,this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnJump,this.inst),this.animMode=2,this.dy=-this.jumpStrength,h=!0,A?this.jumped=!0:this.doubleJumped=!0),this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed();A||(d&&0<this.sustainTime?
(this.dy=-this.jumpStrength,this.sustainTime-=f):(this.lastFloorObject=null,this.dy+=this.g*f,this.dy>this.maxFall&&(this.dy=this.maxFall)),h&&(this.jumped=!0));this.wasOnFloor=!!A;e==p&&(0>this.dx?(this.dx+=this.dec*f,0<this.dx&&(this.dx=0)):0<this.dx&&(this.dx-=this.dec*f,0>this.dx&&(this.dx=0)));u=0;e&&!p&&(u=0<this.dx?-(this.acc+this.dec):-this.acc);p&&!e&&(u=0>this.dx?this.acc+this.dec:this.acc);this.dx+=u*f;this.dx>this.maxspeed?this.dx=this.maxspeed:this.dx<-this.maxspeed&&(this.dx=-this.maxspeed);
e=!1;if(0!==this.dx){a=this.inst.x;n=this.inst.y;q=this.runtime.accelerate(this.dx,-this.maxspeed,this.maxspeed,u,f)*this.rightx;u=this.runtime.accelerate(this.dx,-this.maxspeed,this.maxspeed,u,f)*this.righty;this.inst.x+=this.rightx*(1<this.dx?1:-1)-this.downx;this.inst.y+=this.righty*(1<this.dx?1:-1)-this.downy;this.inst.set_bbox_changed();d=!1;var k=this.runtime.testOverlapSolid(this.inst);this.inst.x=a+q;this.inst.y=n+u;this.inst.set_bbox_changed();p=this.runtime.testOverlapSolid(this.inst);!p&&
A&&(p=this.runtime.testOverlapJumpThru(this.inst))&&(this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed(),this.runtime.testOverlap(this.inst,p)?(p=null,d=!1):d=!0,this.inst.x=a+q,this.inst.y=n+u,this.inst.set_bbox_changed());p?(q=Math.abs(this.dx*f)+2,k||!this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,q,d,p))?(this.runtime.registerCollision(this.inst,p),q=Math.max(Math.abs(this.dx*f*2.5),30),this.runtime.pushOutSolid(this.inst,this.rightx*(0>this.dx?1:-1),this.righty*(0>this.dx?1:
-1),q,!1)?!A||d||this.floorIsJumpthru||(a=this.inst.x,n=this.inst.y,this.inst.x+=this.downx,this.inst.y+=this.downy,this.runtime.testOverlapSolid(this.inst)?this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,3,!1)||(this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed()):(this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed())):(this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed()),d||(this.dx=0)):!k&&!h&&Math.abs(this.dy)<Math.abs(this.jumpStrength/4)&&(this.dy=0,A||(e=!0)):(a=this.isOnFloor(),
A&&!a?(u=Math.ceil(Math.abs(this.dx*f))+2,a=this.inst.x,n=this.inst.y,this.inst.x+=this.downx*u,this.inst.y+=this.downy*u,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst)?this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,u+2,!0):(this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed())):a&&(!A&&this.floorIsJumpthru&&(this.lastFloorObject=a,this.lastFloorX=a.x,this.lastFloorY=a.y,this.dy=0,e=!0),0===this.dy&&this.runtime.pushInFractional(this.inst,
-this.downx,-this.downy,a,16)))}if(0!==this.dy){a=this.inst.x;n=this.inst.y;this.inst.x+=this.runtime.accelerate(this.dy,-Infinity,this.maxFall,this.g,f)*this.downx;this.inst.y+=this.runtime.accelerate(this.dy,-Infinity,this.maxFall,this.g,f)*this.downy;q=this.inst.x;p=this.inst.y;this.inst.set_bbox_changed();u=this.runtime.testOverlapSolid(this.inst);d=!1;if(!u&&0<this.dy&&!A){if((d=0<this.fallthrough?null:this.runtime.testOverlapJumpThru(this.inst,!0))&&d.length){if(this.wasOverJumpthru){this.inst.x=
a;this.inst.y=n;this.inst.set_bbox_changed();var l=k=0;for(b=d.length;k<b;k++)d[l]=d[k],this.runtime.testOverlap(this.inst,d[k])||l++;d.length=l;this.inst.x=q;this.inst.y=p;this.inst.set_bbox_changed()}1<=d.length&&(u=d[0])}d=!!u}if(u)if(this.runtime.registerCollision(this.inst,u),this.sustainTime=0,q=d?Math.abs(this.dy*f*2.5+10):Math.max(Math.abs(this.dy*f*2.5+10),30),this.runtime.pushOutSolid(this.inst,this.downx*(0>this.dy?1:-1),this.downy*(0>this.dy?1:-1),q,d,u)){this.lastFloorObject=u;this.lastFloorX=
u.x;this.lastFloorY=u.y;(this.floorIsJumpthru=d)&&(e=!0);if(0<this.dy||0===this.ceilingCollisionMode)this.dy=0;0>this.dy&&1===this.ceilingCollisionMode&&this.runtime.pushInFractional(this.inst,this.downx,this.downy,u,32)}else this.inst.x=a,this.inst.y=n,this.inst.set_bbox_changed(),this.wasOnFloor=!0,d||(this.dy=0)}3!==this.animMode&&0<this.dy&&!A&&(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnFall,this.inst),this.animMode=3);(A||e)&&0<=this.dy&&(3===this.animMode||e||h&&0===this.dy?
(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnLand,this.inst),this.animMode=0===this.dx&&0===this.dy?0:1):(0!==this.animMode&&0===this.dx&&0===this.dy&&(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnStop,this.inst),this.animMode=0),1===this.animMode||0===this.dx&&0===this.dy||h||(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnMove,this.inst),this.animMode=1)));0<this.fallthrough&&this.fallthrough--;this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst)}};
f.prototype.IsMoving=function(){return 0!==this.dx||0!==this.dy};f.prototype.CompareSpeed=function(f,d){return cr.do_cmp(Math.sqrt(this.dx*this.dx+this.dy*this.dy),f,d)};f.prototype.IsOnFloor=function(){if(0!==this.dy)return!1;var f,d=null;var b=this.inst.x;var e=this.inst.y;this.inst.x+=this.downx;this.inst.y+=this.downy;this.inst.set_bbox_changed();(f=this.runtime.testOverlapSolid(this.inst))||0!==this.fallthrough||(d=this.runtime.testOverlapJumpThru(this.inst,!0));this.inst.x=b;this.inst.y=e;this.inst.set_bbox_changed();
if(f)return!this.runtime.testOverlap(this.inst,f);if(d&&d.length){e=f=0;for(b=d.length;f<b;f++)d[e]=d[f],this.runtime.testOverlap(this.inst,d[f])||e++;if(1<=e)return!0}return!1};f.prototype.IsByWall=function(f){var d=this.inst.x,b=this.inst.y;0===f?(this.inst.x-=2*this.rightx,this.inst.y-=2*this.righty):(this.inst.x+=2*this.rightx,this.inst.y+=2*this.righty);this.inst.set_bbox_changed();if(!this.runtime.testOverlapSolid(this.inst))return this.inst.x=d,this.inst.y=b,this.inst.set_bbox_changed(),!1;
this.inst.x-=3*this.downx;this.inst.y-=3*this.downy;this.inst.set_bbox_changed();f=this.runtime.testOverlapSolid(this.inst);this.inst.x=d;this.inst.y=b;this.inst.set_bbox_changed();return f};f.prototype.IsJumping=function(){return 0>this.dy};f.prototype.IsFalling=function(){return 0<this.dy};f.prototype.OnJump=function(){return!0};f.prototype.OnFall=function(){return!0};f.prototype.OnStop=function(){return!0};f.prototype.OnMove=function(){return!0};f.prototype.OnLand=function(){return!0};f.prototype.IsDoubleJumpEnabled=
function(){return this.enableDoubleJump};f.prototype.IsEnabled=function(){return this.enabled};n.cnds=new f;p.prototype.SetIgnoreInput=function(f){this.ignoreInput=f};p.prototype.SetMaxSpeed=function(f){this.maxspeed=f;0>this.maxspeed&&(this.maxspeed=0)};p.prototype.SetAcceleration=function(f){this.acc=f;0>this.acc&&(this.acc=0)};p.prototype.SetDeceleration=function(f){this.dec=f;0>this.dec&&(this.dec=0)};p.prototype.SetJumpStrength=function(f){this.jumpStrength=f;0>this.jumpStrength&&(this.jumpStrength=
0)};p.prototype.SetGravity=function(f){this.g1!==f&&(this.g=f,this.updateGravity(),this.runtime.testOverlapSolid(this.inst)&&(this.runtime.pushOutSolid(this.inst,this.downx,this.downy,10),this.inst.x+=2*this.downx,this.inst.y+=2*this.downy,this.inst.set_bbox_changed()),this.lastFloorObject=null)};p.prototype.SetMaxFallSpeed=function(f){this.maxFall=f;0>this.maxFall&&(this.maxFall=0)};p.prototype.SimulateControl=function(f){switch(f){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simjump=
!0}};p.prototype.SetVectorX=function(f){this.dx=f};p.prototype.SetVectorY=function(f){this.dy=f};p.prototype.SetGravityAngle=function(f){f=cr.to_radians(f);f=cr.clamp_angle(f);this.ga!==f&&(this.ga=f,this.updateGravity(),this.lastFloorObject=null)};p.prototype.SetEnabled=function(f){this.enabled!==(1===f)&&(this.enabled=1===f,this.enabled||(this.lastFloorObject=null))};p.prototype.FallThrough=function(){var f=this.inst.x,d=this.inst.y;this.inst.x+=this.downx;this.inst.y+=this.downy;this.inst.set_bbox_changed();
var b=this.runtime.testOverlapJumpThru(this.inst,!1);this.inst.x=f;this.inst.y=d;this.inst.set_bbox_changed();b&&(this.fallthrough=3,this.lastFloorObject=null)};p.prototype.SetDoubleJumpEnabled=function(f){this.enableDoubleJump=0!==f};p.prototype.SetJumpSustain=function(f){this.jumpSustain=f/1E3};p.prototype.SetCeilingCollision=function(f){this.ceilingCollisionMode=f};n.acts=new p;q.prototype.Speed=function(f){f.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))};q.prototype.MaxSpeed=function(f){f.set_float(this.maxspeed)};
q.prototype.Acceleration=function(f){f.set_float(this.acc)};q.prototype.Deceleration=function(f){f.set_float(this.dec)};q.prototype.JumpStrength=function(f){f.set_float(this.jumpStrength)};q.prototype.Gravity=function(f){f.set_float(this.g)};q.prototype.GravityAngle=function(f){f.set_float(cr.to_degrees(this.ga))};q.prototype.MaxFallSpeed=function(f){f.set_float(this.maxFall)};q.prototype.MovingAngle=function(f){f.set_float(cr.to_degrees(Math.atan2(this.dy,this.dx)))};q.prototype.VectorX=function(f){f.set_float(this.dx)};
q.prototype.VectorY=function(f){f.set_float(this.dy)};q.prototype.JumpSustain=function(f){f.set_float(1E3*this.jumpSustain)};n.exps=new q})();cr.behaviors.Bullet=function(f){this.runtime=f};
(function(){function f(){}function p(){}function q(){}var n=cr.behaviors.Bullet.prototype;n.Type=function(f,d){this.behavior=f;this.objtype=d;this.runtime=f.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(f,d){this.type=f;this.behavior=f.behavior;this.inst=d;this.runtime=f.runtime};var u=n.Instance.prototype;u.onCreate=function(){var f=this.properties[0];this.acc=this.properties[1];this.g=this.properties[2];this.bounceOffSolid=this.properties[3];this.setAngle=this.properties[4];
this.step=this.properties[5];this.stepSize=Math.abs(Math.min(this.inst.width,this.inst.height)/2);this.stopStepping=!1;this.dx=Math.cos(this.inst.angle)*f;this.dy=Math.sin(this.inst.angle)*f;this.lastx=this.inst.x;this.lasty=this.inst.y;this.lastKnownAngle=this.inst.angle;this.travelled=0;this.enabled=this.properties[6]};u.saveToJSON=function(){return{acc:this.acc,g:this.g,dx:this.dx,dy:this.dy,lx:this.lastx,ly:this.lasty,lka:this.lastKnownAngle,t:this.travelled,st:this.step,e:this.enabled}};u.loadFromJSON=
function(f){this.acc=f.acc;this.g=f.g;this.dx=f.dx;this.dy=f.dy;this.lastx=f.lx;this.lasty=f.ly;this.lastKnownAngle=f.lka;this.travelled=f.t;this.step=!!f.st;this.enabled=f.e};u.tick=function(){if(this.enabled){var f=this.runtime.getDt(this.inst);if(this.inst.angle!==this.lastKnownAngle){if(this.setAngle){var d=cr.distanceTo(0,0,this.dx,this.dy);this.dx=Math.cos(this.inst.angle)*d;this.dy=Math.sin(this.inst.angle)*d}this.lastKnownAngle=this.inst.angle}var b=0;var e=0;if(0!==this.acc){d=cr.distanceTo(0,
0,this.dx,this.dy);var p=0===this.dx&&0===this.dy?this.inst.angle:cr.angleTo(0,0,this.dx,this.dy);d+=this.acc*f;b=Math.cos(p)*this.acc;e=Math.sin(p)*this.acc;0>d&&(e=b=d=0);this.dx=Math.cos(p)*d;this.dy=Math.sin(p)*d}0!==this.g&&(this.dy+=this.g*f,e+=this.g);this.lastx=this.inst.x;this.lasty=this.inst.y;if(0!==this.dx||0!==this.dy)if(d=this.runtime.accelerate(this.dx,-Infinity,Infinity,b,f),e=this.runtime.accelerate(this.dy,-Infinity,Infinity,e,f),this.moveBy(d,e),this.travelled+=cr.distanceTo(this.lastx,
this.lasty,this.inst.x,this.inst.y),!this.setAngle||0===d&&0===e||(this.inst.angle=cr.angleTo(0,0,d,e),this.inst.set_bbox_changed(),this.lastKnownAngle=this.inst.angle),this.bounceOffSolid&&(d=this.runtime.testOverlapSolid(this.inst)))this.runtime.registerCollision(this.inst,d),d=cr.distanceTo(0,0,this.dx,this.dy),e=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty),this.dx=Math.cos(e)*d,this.dy=Math.sin(e)*d,this.inst.x+=this.dx*f,this.inst.y+=this.dy*f,this.inst.set_bbox_changed(),
this.setAngle&&(this.lastKnownAngle=this.inst.angle=e,this.inst.set_bbox_changed()),this.runtime.pushOutSolid(this.inst,this.dx/d,this.dy/d,Math.max(2.5*d*f,30))||this.runtime.pushOutSolidNearest(this.inst,100)}};u.moveBy=function(f,d){var b=cr.distanceTo(0,0,f,d);if(!this.step||b<=this.stepSize)this.inst.x+=f,this.inst.y+=d,this.inst.set_bbox_changed(),this.step&&this.runtime.trigger(cr.behaviors.Bullet.prototype.cnds.OnStep,this.inst);else{this.stopStepping=!1;var e=this.inst.x,m=this.inst.y,h=
e+f,a=m+d;d=cr.angleTo(0,0,f,d);f=Math.cos(d)*this.stepSize;d=Math.sin(d)*this.stepSize;b=Math.floor(b/this.stepSize);for(var p=1;p<=b;++p)if(this.inst.x=e+f*p,this.inst.y=m+d*p,this.inst.set_bbox_changed(),this.runtime.trigger(cr.behaviors.Bullet.prototype.cnds.OnStep,this.inst),this.inst.isDestroyed||this.stopStepping)return;this.inst.x=h;this.inst.y=a;this.inst.set_bbox_changed();this.runtime.trigger(cr.behaviors.Bullet.prototype.cnds.OnStep,this.inst)}};f.prototype.CompareSpeed=function(f,d){return cr.do_cmp(cr.distanceTo(0,
0,this.dx,this.dy),f,d)};f.prototype.CompareTravelled=function(f,d){return cr.do_cmp(this.travelled,f,d)};f.prototype.OnStep=function(){return!0};f.prototype.IsEnabled=function(){return this.enabled};n.cnds=new f;p.prototype.SetSpeed=function(f){var d=cr.angleTo(0,0,this.dx,this.dy);this.dx=Math.cos(d)*f;this.dy=Math.sin(d)*f};p.prototype.SetAcceleration=function(f){this.acc=f};p.prototype.SetGravity=function(f){this.g=f};p.prototype.SetAngleOfMotion=function(f){f=cr.to_radians(f);var d=cr.distanceTo(0,
0,this.dx,this.dy);this.dx=Math.cos(f)*d;this.dy=Math.sin(f)*d};p.prototype.Bounce=function(f){if(f&&(f=f.getFirstPicked(this.inst))){var d=this.runtime.getDt(this.inst),b=cr.distanceTo(0,0,this.dx,this.dy),e=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty,f);this.dx=Math.cos(e)*b;this.dy=Math.sin(e)*b;this.inst.x+=this.dx*d;this.inst.y+=this.dy*d;this.inst.set_bbox_changed();this.setAngle&&(this.lastKnownAngle=this.inst.angle=e,this.inst.set_bbox_changed());0!==b&&(this.bounceOffSolid?
this.runtime.pushOutSolid(this.inst,this.dx/b,this.dy/b,Math.max(2.5*b*d,30))||this.runtime.pushOutSolidNearest(this.inst,100):this.runtime.pushOut(this.inst,this.dx/b,this.dy/b,Math.max(2.5*b*d,30),f))}};p.prototype.SetBounceOffSolids=function(f){this.bounceOffSolid=f};p.prototype.SetDistanceTravelled=function(f){this.travelled=f};p.prototype.SetEnabled=function(f){this.enabled=1===f};p.prototype.StopStepping=function(){this.stopStepping=!0};n.acts=new p;q.prototype.Speed=function(f){var d=cr.distanceTo(0,
0,this.dx,this.dy);d=cr.round6dp(d);f.set_float(d)};q.prototype.Acceleration=function(f){f.set_float(this.acc)};q.prototype.AngleOfMotion=function(f){f.set_float(cr.to_degrees(cr.angleTo(0,0,this.dx,this.dy)))};q.prototype.DistanceTravelled=function(f){f.set_float(this.travelled)};q.prototype.Gravity=function(f){f.set_float(this.g)};n.exps=new q})();cr.behaviors.wrap=function(f){this.runtime=f};
(function(){var f=cr.behaviors.wrap.prototype;f.Type=function(f,q){this.behavior=f;this.objtype=q;this.runtime=f.runtime};f.Type.prototype.onCreate=function(){};f.Instance=function(f,q){this.type=f;this.behavior=f.behavior;this.inst=q;this.runtime=f.runtime};f=f.Instance.prototype;f.onCreate=function(){this.mode=this.properties[0]};f.tick=function(){var f=this.inst;f.update_bbox();var q=f.bbox,n=f.layer,u=n.layout,m=0,d=0;if(0===this.mode){var b=u.width;n=u.height}else m=n.viewLeft,b=n.viewRight,
d=n.viewTop,n=n.viewBottom;q.right<m?(f.x=b-1+(f.x-q.left),f.set_bbox_changed()):q.left>b?(f.x=m+1-(q.right-f.x),f.set_bbox_changed()):q.bottom<d?(f.y=n-1+(f.y-q.top),f.set_bbox_changed()):q.top>n&&(f.y=d+1-(q.bottom-f.y),f.set_bbox_changed())}})();cr.behaviors.Fade=function(f){this.runtime=f};
(function(){function f(){}function p(){}function q(){}var n=cr.behaviors.Fade.prototype;n.Type=function(f,d){this.behavior=f;this.objtype=d;this.runtime=f.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(f,d){this.type=f;this.behavior=f.behavior;this.inst=d;this.runtime=f.runtime};var u=n.Instance.prototype;u.onCreate=function(){this.fadeInTime=this.properties[0];this.waitTime=this.properties[1];this.fadeOutTime=this.properties[2];this.destroy=this.properties[3];this.activeAtStart=
this.properties[4];this.setMaxOpacity=!1;this.stage=this.activeAtStart?0:3;this.recycled?this.stageTime.reset():this.stageTime=new cr.KahanAdder;this.maxOpacity=this.inst.opacity?this.inst.opacity:1;this.activeAtStart&&(0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0))};u.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}};u.loadFromJSON=function(f){this.fadeInTime=
f.fit;this.waitTime=f.wt;this.fadeOutTime=f.fot;this.stage=f.s;this.stageTime.reset();this.stageTime.sum=f.st;this.maxOpacity=f.mo};u.tick=function(){this.stageTime.add(this.runtime.getDt(this.inst));0===this.stage&&(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity&&(this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeInEnd,this.inst)));1===this.stage&&
this.stageTime.sum>=this.waitTime&&(this.stage=2,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnWaitEnd,this.inst));2===this.stage&&0!==this.fadeOutTime&&(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,0>this.inst.opacity&&(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),this.destroy&&this.runtime.DestroyInstance(this.inst)))};
u.doStart=function(){this.stage=0;this.stageTime.reset();0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0)};f.prototype.OnFadeOutEnd=function(){return!0};f.prototype.OnFadeInEnd=function(){return!0};f.prototype.OnWaitEnd=function(){return!0};n.cnds=new f;p.prototype.StartFade=function(){this.activeAtStart||this.setMaxOpacity||(this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.setMaxOpacity=!0);3===this.stage&&this.doStart()};
p.prototype.RestartFade=function(){this.doStart()};p.prototype.SetFadeInTime=function(f){0>f&&(f=0);this.fadeInTime=f};p.prototype.SetWaitTime=function(f){0>f&&(f=0);this.waitTime=f};p.prototype.SetFadeOutTime=function(f){0>f&&(f=0);this.fadeOutTime=f};n.acts=new p;q.prototype.FadeInTime=function(f){f.set_float(this.fadeInTime)};q.prototype.WaitTime=function(f){f.set_float(this.waitTime)};q.prototype.FadeOutTime=function(f){f.set_float(this.fadeOutTime)};n.exps=new q})();
cr.getObjectRefTable=function(){return[cr.plugins_.Sprite,cr.plugins_.Text,cr.plugins_.Audio,cr.plugins_.InstantGames,cr.plugins_.ValerypopoffJSPlugin,cr.plugins_.Touch,cr.plugins_.Browser,cr.plugins_.Spritefont2,cr.behaviors.solid,cr.behaviors.Platform,cr.behaviors.Bullet,cr.behaviors.wrap,cr.behaviors.Fade,cr.system_object.prototype.cnds.OnLayoutStart,cr.plugins_.Sprite.prototype.acts.SetSize,cr.plugins_.Sprite.prototype.acts.SetPos,cr.system_object.prototype.acts.AddVar,cr.system_object.prototype.cnds.For,
cr.system_object.prototype.acts.CreateObject,cr.system_object.prototype.exps.loopindex,cr.plugins_.ValerypopoffJSPlugin.prototype.cnds.AllScriptsLoaded,cr.plugins_.InstantGames.prototype.cnds.IsAvailable,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.plugins_.ValerypopoffJSPlugin.prototype.cnds.CompareAliasValue,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.SetAlias,cr.system_object.prototype.cnds.PickNth,cr.plugins_.Sprite.prototype.acts.SetAnimFrame,cr.plugins_.Sprite.prototype.acts.LoadURL,
cr.plugins_.ValerypopoffJSPlugin.prototype.exps.AliasValue,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.CallAlias,cr.plugins_.Sprite.prototype.exps.IID,cr.system_object.prototype.cnds.TriggerOnce,cr.plugins_.Touch.prototype.cnds.OnTouchEnd,cr.plugins_.Sprite.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.Sprite.prototype.acts.SetBoolInstanceVar,cr.plugins_.Sprite.prototype.acts.SetScale,cr.system_object.prototype.acts.SetVar,
cr.plugins_.InstantGames.prototype.acts.Share,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.FunctionReturnValue,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.plugins_.Audio.prototype.acts.Play,cr.plugins_.Text.prototype.acts.SetText,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.JSCodeValue,cr.system_object.prototype.cnds.Compare,cr.system_object.prototype.acts.SetBoolVar,cr.plugins_.ValerypopoffJSPlugin.prototype.cnds.CompareAliasCallReturnValue,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.AliasCallReturnValue,
cr.plugins_.ValerypopoffJSPlugin.prototype.cnds.CompareExecReturnWithParams,cr.plugins_.Text.prototype.acts.SetVisible,cr.system_object.prototype.cnds.Else,cr.plugins_.Browser.prototype.acts.ConsoleLog,cr.system_object.prototype.acts.SetGroupActive,cr.plugins_.Audio.prototype.acts.SetPaused,cr.system_object.prototype.cnds.CompareBoolVar,cr.system_object.prototype.cnds.CompareVar,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.CallJSfunction,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.InitAlias,
cr.behaviors.Platform.prototype.acts.SetEnabled,cr.plugins_.Spritefont2.prototype.acts.SetVisible,cr.system_object.prototype.cnds.Every,cr.system_object.prototype.acts.Wait,cr.system_object.prototype.acts.SetLayerVisible,cr.system_object.prototype.cnds.EveryTick,cr.plugins_.Spritefont2.prototype.acts.SetText,cr.plugins_.Sprite.prototype.acts.SetCollisions,cr.plugins_.Sprite.prototype.acts.SetAngle,cr.behaviors.solid.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.acts.SetX,cr.plugins_.Sprite.prototype.acts.SetY,
cr.plugins_.Sprite.prototype.acts.Destroy,cr.plugins_.Sprite.prototype.acts.SetAnim,cr.plugins_.Touch.prototype.cnds.OnTouchStart,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,cr.behaviors.Platform.prototype.acts.SimulateControl,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,cr.plugins_.Sprite.prototype.acts.SetInstanceVar,cr.plugins_.Sprite.prototype.acts.MoveToTop,cr.plugins_.Sprite.prototype.exps.Y,cr.plugins_.Sprite.prototype.exps.Height,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Spritefont2.prototype.acts.MoveToTop,
cr.plugins_.Sprite.prototype.cnds.IsOverlappingOffset,cr.plugins_.Sprite.prototype.cnds.IsOverlapping,cr.behaviors.Fade.prototype.acts.RestartFade,cr.plugins_.Sprite.prototype.cnds.CompareY,cr.system_object.prototype.exps.layoutheight,cr.system_object.prototype.cnds.CompareTime,cr.system_object.prototype.exps.time,cr.plugins_.Sprite.prototype.cnds.CompareX,cr.plugins_.Sprite.prototype.exps.Width,cr.system_object.prototype.exps.layoutwidth,cr.plugins_.Sprite.prototype.exps.AnimationName,cr.system_object.prototype.exps.str,
cr.behaviors.solid.prototype.cnds.IsEnabled,cr.plugins_.Sprite.prototype.cnds.OnCollision,cr.behaviors.Platform.prototype.cnds.IsJumping,cr.system_object.prototype.cnds.Repeat,cr.system_object.prototype.exps.random,cr.plugins_.Sprite.prototype.acts.SetOpacity,cr.behaviors.Bullet.prototype.acts.SetSpeed,cr.behaviors.Bullet.prototype.exps.Speed,cr.plugins_.Sprite.prototype.acts.ZMoveToObject,cr.system_object.prototype.cnds.PickByComparison,cr.system_object.prototype.exps.abs,cr.behaviors.Platform.prototype.cnds.OnJump,
cr.behaviors.Platform.prototype.cnds.OnLand,cr.behaviors.Platform.prototype.cnds.OnFall]};
