// Generated by Construct 3, the game and app creator :: https://www.construct.net
"use strict";
window.cr = {}, cr.plugins_ = {}, cr.behaviors = {}, "function" != typeof Object.getPrototypeOf && (Object.getPrototypeOf = function(e) {
        return e.__proto__
    }),
    function() {
        function e(e, t) {
            this.x = e, this.y = t, cr.seal(this)
        }

        function t(e, t, r, n) {
            this.set(e, t, r, n), cr.seal(this)
        }

        function r() {
            this.tlx = 0, this.tly = 0, this.trx = 0, this.try_ = 0, this.brx = 0, this.bry = 0, this.blx = 0, this.bly = 0, cr.seal(this)
        }

        function n(e, t, r, n) {
            e < t ? r < n ? (O = e < r ? e : r, E = t > n ? t : n) : (O = e < n ? e : n, E = t > r ? t : r) : r < n ? (O = t < r ? t : r, E = e > n ? e : n) : (O = t < n ? t : n, E = e > r ? e : r)
        }

        function a(e) {
            return 0 === e && 0 > 1 / e
        }

        function o() {
            this.s = null, this.items = null, this.item_count = 0, I && (this.s = new Set), this.values_cache = [], this.cache_valid = !0, cr.seal(this)
        }

        function i(e) {
            R[k++] = e
        }

        function s() {
            this.c = 0, this.y = 0, this.t = 0, this.sum = 0, cr.seal(this)
        }

        function l(e, t) {
            e || (e = [0, 0, 1, 0, 1, 1, 0, 1]), this.pts_cache = [], this.bboxLeft = 0, this.bboxTop = 0, this.bboxRight = 0, this.bboxBottom = 0, this.convexpolys = null, this.enabled = !("undefined" != typeof t) || t, this.set_pts(e), cr.seal(this)
        }

        function p(e, t) {
            this.cellwidth = e, this.cellheight = t, this.cells = {}
        }

        function d(e, t) {
            this.cellwidth = e, this.cellheight = t, this.cells = {}
        }

        function c(e, t, r) {
            var n;
            return p.prototype.totalCellCount++, F.length ? (n = F.pop(), n.grid = e, n.x = t, n.y = r, n) : new cr.GridCell(e, t, r)
        }

        function u(e) {
            p.prototype.totalCellCount--, e.objects.clear(), 1e3 > F.length && F.push(e)
        }

        function g(e, t, r) {
            this.grid = e, this.x = t, this.y = r, this.objects = new cr.ObjectSet
        }

        function y(e, t, r) {
            var n;
            return d.prototype.totalCellCount++, N.length ? (n = N.pop(), n.grid = e, n.x = t, n.y = r, n) : new cr.RenderCell(e, t, r)
        }

        function m(e) {
            d.prototype.totalCellCount--, e.reset(), 1e3 > N.length && N.push(e)
        }

        function _(e, t, r) {
            this.grid = e, this.x = t, this.y = r, this.objects = [], this.is_sorted = !0, this.pending_removal = new cr.ObjectSet, this.any_pending_removal = !1
        }

        function h(e, t) {
            return e.zindex - t.zindex
        }
        var f = Math.acos,
            b = Math.floor,
            x = Math.max,
            v = Math.min,
            S = Math.cos,
            T = Math.sin,
            w = Math.PI;
        cr.logexport = function(e) {
            window.console && window.console.log && window.console.log(e)
        }, cr.logerror = function(e) {
            window.console && window.console.error && window.console.error(e)
        }, cr.seal = function(e) {
            return e
        }, cr.freeze = function(e) {
            return e
        }, cr.is_undefined = function(e) {
            return "undefined" == typeof e
        }, cr.is_number = function(e) {
            return "number" == typeof e
        }, cr.is_string = function(e) {
            return "string" == typeof e
        }, cr.isPOT = function(e) {
            return 0 < e && 0 == (e - 1 & e)
        }, cr.nextHighestPowerOfTwo = function(e) {
            --e;
            for (var t = 1; 32 > t; t <<= 1) e |= e >> t;
            return e + 1
        }, cr.abs = function(e) {
            return 0 > e ? -e : e
        }, cr.max = function(e, t) {
            return e > t ? e : t
        }, cr.min = function(e, t) {
            return e < t ? e : t
        }, cr.PI = w, cr.round = function(e) {
            return 0 | e + .5
        }, cr.floor = function(e) {
            return 0 <= e ? 0 | e : (0 | e) - 1
        }, cr.ceil = function(e) {
            var t = 0 | e;
            return t === e ? t : t + 1
        };
        e.prototype.offset = function(e, t) {
            return this.x += e, this.y += t, this
        }, e.prototype.mul = function(e, t) {
            return this.x *= e, this.y *= t, this
        }, cr.vector2 = e, cr.segments_intersect = function(e, t, r, n, a, o, i, s) {
            var l, p, c, u, g, y, m, _;
            if (e < r ? (p = e, l = r) : (p = r, l = e), a < i ? (y = a, g = i) : (y = i, g = a), l < y || p > g) return !1;
            if (t < n ? (u = t, c = n) : (u = n, c = t), o < s ? (_ = o, m = s) : (_ = s, m = o), c < _ || u > m) return !1;
            var h = a - e + i - r,
                f = o - t + s - n,
                b = r - e,
                x = n - t,
                v = i - a,
                w = s - o,
                S = cr.abs(x * v - w * b);
            if (cr.abs(v * f - w * h) > S) return !1;
            return cr.abs(b * f - x * h) <= S
        };
        t.prototype.set = function(e, t, r, n) {
            this.left = e, this.top = t, this.right = r, this.bottom = n
        }, t.prototype.copy = function(e) {
            this.left = e.left, this.top = e.top, this.right = e.right, this.bottom = e.bottom
        }, t.prototype.width = function() {
            return this.right - this.left
        }, t.prototype.height = function() {
            return this.bottom - this.top
        }, t.prototype.offset = function(e, t) {
            return this.left += e, this.top += t, this.right += e, this.bottom += t, this
        }, t.prototype.normalize = function() {
            var e = 0;
            this.left > this.right && (e = this.left, this.left = this.right, this.right = e), this.top > this.bottom && (e = this.top, this.top = this.bottom, this.bottom = e)
        }, t.prototype.intersects_rect = function(e) {
            return !(e.right < this.left || e.bottom < this.top || e.left > this.right || e.top > this.bottom)
        }, t.prototype.intersects_rect_off = function(e, t, r) {
            return !(e.right + t < this.left || e.bottom + r < this.top || e.left + t > this.right || e.top + r > this.bottom)
        }, t.prototype.contains_pt = function(e, t) {
            return e >= this.left && e <= this.right && t >= this.top && t <= this.bottom
        }, t.prototype.equals = function(e) {
            return this.left === e.left && this.top === e.top && this.right === e.right && this.bottom === e.bottom
        }, cr.rect = t;
        r.prototype.set_from_rect = function(e) {
            this.tlx = e.left, this.tly = e.top, this.trx = e.right, this.try_ = e.top, this.brx = e.right, this.bry = e.bottom, this.blx = e.left, this.bly = e.bottom
        }, r.prototype.set_from_rotated_rect = function(e, t) {
            if (0 === t) this.set_from_rect(e);
            else {
                var r = T(t),
                    n = S(t),
                    a = e.left * r,
                    o = e.top * r,
                    i = e.right * r,
                    s = e.bottom * r,
                    l = e.left * n,
                    p = e.top * n,
                    d = e.right * n,
                    c = e.bottom * n;
                this.tlx = l - o, this.tly = p + a, this.trx = d - o, this.try_ = p + i, this.brx = d - s, this.bry = c + i, this.blx = l - s, this.bly = c + a
            }
        }, r.prototype.offset = function(e, t) {
            return this.tlx += e, this.tly += t, this.trx += e, this.try_ += t, this.brx += e, this.bry += t, this.blx += e, this.bly += t, this
        };
        var O = 0,
            E = 0;
        r.prototype.bounding_box = function(e) {
            n(this.tlx, this.trx, this.brx, this.blx), e.left = O, e.right = E, n(this.tly, this.try_, this.bry, this.bly), e.top = O, e.bottom = E
        }, r.prototype.contains_pt = function(e, t) {
            var r = this.tlx,
                n = this.tly,
                a = this.trx - r,
                o = this.try_ - n,
                i = this.brx - r,
                s = this.bry - n,
                l = e - r,
                p = t - n,
                d = a * a + o * o,
                c = a * i + o * s,
                g = a * l + o * p,
                y = i * i + s * s,
                m = i * l + s * p,
                _ = 1 / (d * y - c * c),
                h = (y * g - c * m) * _,
                f = (d * m - c * g) * _;
            if (0 <= h && 0 < f && 1 > h + f) return !0;
            a = this.blx - r, o = this.bly - n;
            var d = a * a + o * o,
                c = a * i + o * s,
                g = a * l + o * p;
            return _ = 1 / (d * y - c * c), h = (y * g - c * m) * _, f = (d * m - c * g) * _, 0 <= h && 0 < f && 1 > h + f
        }, r.prototype.at = function(e, t) {
            return t ? 0 === e ? this.tlx : 1 === e ? this.trx : 2 === e ? this.brx : 3 === e ? this.blx : 4 === e ? this.tlx : this.tlx : 0 === e ? this.tly : 1 === e ? this.try_ : 2 === e ? this.bry : 3 === e ? this.bly : 4 === e ? this.tly : this.tly
        }, r.prototype.midX = function() {
            return (this.tlx + this.trx + this.brx + this.blx) / 4
        }, r.prototype.midY = function() {
            return (this.tly + this.try_ + this.bry + this.bly) / 4
        }, r.prototype.intersects_segment = function(e, t, r, n) {
            if (this.contains_pt(e, t) || this.contains_pt(r, n)) return !0;
            var a, o, s, l, p;
            for (p = 0; 4 > p; p++)
                if (a = this.at(p, !0), o = this.at(p, !1), s = this.at(p + 1, !0), l = this.at(p + 1, !1), cr.segments_intersect(e, t, r, n, a, o, s, l)) return !0;
            return !1
        }, r.prototype.intersects_quad = function(e) {
            var t = e.midX(),
                r = e.midY();
            if (this.contains_pt(t, r)) return !0;
            if (t = this.midX(), r = this.midY(), e.contains_pt(t, r)) return !0;
            var n, a, o, s, l, p, d, c, u, g;
            for (u = 0; 4 > u; u++)
                for (g = 0; 4 > g; g++)
                    if (n = this.at(u, !0), a = this.at(u, !1), o = this.at(u + 1, !0), s = this.at(u + 1, !1), l = e.at(g, !0), p = e.at(g, !1), d = e.at(g + 1, !0), c = e.at(g + 1, !1), cr.segments_intersect(n, a, o, s, l, p, d, c)) return !0;
            return !1
        }, cr.quad = r, cr.RGB = function(e, t, r) {
            return x(v(e, 255), 0) | x(v(t, 255), 0) << 8 | x(v(r, 255), 0) << 16
        };
        cr.RGBAEx = function(e, t, r, n) {
            return e = cr.clamp(b(1024 * e), -8192, 8191), t = cr.clamp(b(1024 * t), -8192, 8191), r = cr.clamp(b(1024 * r), -8192, 8191), n = cr.clamp(b(1024 * n), 0, 1024), 0 > e && (e += 16384), 0 > t && (t += 16384), 0 > r && (r += 16384), -(1024 * (16384 * (16384 * e)) + 1024 * (16384 * t) + 1024 * r + n)
        }, cr.RGBEx = function(e, t, r) {
            return cr.RGBAEx(e, t, r, 1)
        }, cr.GetRValue = function(e) {
            if (0 <= e) return (255 & e) / 255;
            var t = b(-e / 274877906944);
            return 8191 < t && (t -= 16384), t / 1024
        }, cr.GetGValue = function(e) {
            if (0 <= e) return ((65280 & e) >> 8) / 255;
            var t = b(-e % 274877906944 / 16777216);
            return 8191 < t && (t -= 16384), t / 1024
        }, cr.GetBValue = function(e) {
            if (0 <= e) return ((16711680 & e) >> 16) / 255;
            var t = b(-e % 16777216 / 1024);
            return 8191 < t && (t -= 16384), t / 1024
        }, cr.GetAValue = function(e) {
            if (a(e)) return 0;
            if (0 <= e) return 1;
            var t = b(-e % 1024);
            return t / 1024
        }, cr.shallowCopy = function(e, t) {
            for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r]);
            return e
        }, cr.arrayRemove = function(e, t) {
            var r, n;
            if (t = cr.floor(t), !(0 > t || t >= e.length)) {
                for (r = t, n = e.length - 1; r < n; r++) e[r] = e[r + 1];
                cr.truncateArray(e, n)
            }
        }, cr.truncateArray = function(e, t) {
            e.length = t
        }, cr.clearArray = function(e) {
            cr.truncateArray(e, 0)
        }, cr.shallowAssignArray = function(e, t) {
            cr.clearArray(e);
            var r, n;
            for (r = 0, n = t.length; r < n; ++r) e[r] = t[r]
        }, cr.appendArray = function(e, t) {
            e.push.apply(e, t)
        }, cr.fastIndexOf = function(e, t) {
            var r, n;
            for (r = 0, n = e.length; r < n; ++r)
                if (e[r] === t) return r;
            return -1
        }, cr.arrayFindRemove = function(e, t) {
            var r = cr.fastIndexOf(e, t); - 1 !== r && cr.arrayRemove(e, r)
        }, cr.clamp = function(e, t, r) {
            return e < t ? t : e > r ? r : e
        }, cr.to_radians = function(e) {
            return e / (180 / cr.PI)
        }, cr.to_degrees = function(e) {
            return e * (180 / cr.PI)
        }, cr.clamp_angle_degrees = function(e) {
            return e %= 360, 0 > e && (e += 360), e
        }, cr.clamp_angle = function(e) {
            return e %= 2 * cr.PI, 0 > e && (e += 2 * cr.PI), e
        }, cr.to_clamped_degrees = function(e) {
            return cr.clamp_angle_degrees(cr.to_degrees(e))
        }, cr.to_clamped_radians = function(e) {
            return cr.clamp_angle(cr.to_radians(e))
        }, cr.angleTo = function(e, t, r, n) {
            return Math.atan2(n - t, r - e)
        }, cr.angleDiff = function(e, t) {
            if (e === t) return 0;
            var r = T(e),
                a = S(e),
                o = T(t),
                i = S(t),
                s = r * o + a * i;
            return 1 <= s ? 0 : -1 >= s ? cr.PI : f(s)
        }, cr.angleRotate = function(e, t, r) {
            var n = T(e),
                a = S(e),
                o = T(t),
                i = S(t);
            return f(n * o + a * i) > r ? 0 < a * o - n * i ? cr.clamp_angle(e + r) : cr.clamp_angle(e - r) : cr.clamp_angle(t)
        }, cr.angleClockwise = function(e, t) {
            var r = T(e),
                n = S(e),
                a = T(t),
                o = S(t);
            return 0 >= n * a - r * o
        }, cr.rotatePtAround = function(e, t, r, n, a, o) {
            if (0 === r) return o ? e : t;
            var i = T(r),
                s = S(r);
            e -= n, t -= a;
            var l = e * i,
                p = t * i,
                d = e * s,
                c = t * s;
            return e = d - p, t = c + l, e += n, t += a, o ? e : t
        }, cr.distanceTo = function(e, t, r, n) {
            var a = r - e,
                o = n - t;
            return Math.sqrt(a * a + o * o)
        }, cr.xor = function(e, t) {
            return !e != !t
        }, cr.lerp = function(e, t, r) {
            return e + (t - e) * r
        }, cr.unlerp = function(e, t, r) {
            return e === t ? 0 : (r - e) / (t - e)
        }, cr.anglelerp = function(e, t, r) {
            var n = cr.angleDiff(e, t);
            return cr.angleClockwise(t, e) ? e + n * r : e - n * r
        }, cr.qarp = function(e, t, r, n) {
            return cr.lerp(cr.lerp(e, t, n), cr.lerp(t, r, n), n)
        }, cr.cubic = function(e, t, r, n, a) {
            return cr.lerp(cr.qarp(e, t, r, a), cr.qarp(t, r, n, a), a)
        }, cr.cosp = function(e, t, r) {
            return (e + t + (e - t) * S(r * w)) / 2
        }, cr.hasAnyOwnProperty = function(e) {
            for (var t in e)
                if (e.hasOwnProperty(t)) return !0;
            return !1
        }, cr.wipe = function(e) {
            for (var t in e) e.hasOwnProperty(t) && delete e[t]
        };
        var C = +new Date;
        cr.performance_now = function() {
            if ("undefined" != typeof window.performance) {
                var e = window.performance;
                if ("undefined" != typeof e.now) return e.now();
                if ("undefined" != typeof e.webkitNow) return e.webkitNow();
                if ("undefined" != typeof e.mozNow) return e.mozNow();
                if ("undefined" != typeof e.msNow) return e.msNow()
            }
            return Date.now() - C
        };
        var A = !1,
            P = !1,
            L = !1;
        "undefined" != typeof window && (A = /chrome/i.test(navigator.userAgent) || /chromium/i.test(navigator.userAgent), P = !A && /safari/i.test(navigator.userAgent), L = /(iphone|ipod|ipad)/i.test(navigator.userAgent));
        var I = "undefined" != typeof Set && "undefined" != typeof Set.prototype.forEach;
        o.prototype.contains = function(e) {
            return !this.isEmpty() && (I ? this.s.has(e) : this.items && this.items.hasOwnProperty(e))
        }, o.prototype.add = function(e) {
            if (I) this.s.has(e) || (this.s.add(e), this.cache_valid = !1);
            else {
                var t = e.toString(),
                    r = this.items;
                r ? !r.hasOwnProperty(t) && (r[t] = e, this.item_count++, this.cache_valid = !1) : (this.items = {}, this.items[t] = e, this.item_count = 1, this.cache_valid = !1)
            }
        }, o.prototype.remove = function(e) {
            if (!this.isEmpty())
                if (I) this.s.has(e) && (this.s["delete"](e), this.cache_valid = !1);
                else if (this.items) {
                var t = e.toString(),
                    r = this.items;
                r.hasOwnProperty(t) && (delete r[t], this.item_count--, this.cache_valid = !1)
            }
        }, o.prototype.clear = function() {
            this.isEmpty() || (I ? this.s.clear() : (this.items = null, this.item_count = 0), cr.clearArray(this.values_cache), this.cache_valid = !0)
        }, o.prototype.isEmpty = function() {
            return 0 === this.count()
        }, o.prototype.count = function() {
            return I ? this.s.size : this.item_count
        };
        var R = null,
            k = 0;
        o.prototype.update_cache = function() {
            if (!this.cache_valid) {
                if (I) cr.clearArray(this.values_cache), R = this.values_cache, k = 0, this.s.forEach(i), R = null, k = 0;
                else {
                    var e = this.values_cache;
                    cr.clearArray(e);
                    var t = 0,
                        r = this.items,
                        a;
                    if (r)
                        for (a in r) r.hasOwnProperty(a) && (e[t++] = r[a])
                }
                this.cache_valid = !0
            }
        }, o.prototype.valuesRef = function() {
            return this.update_cache(), this.values_cache
        }, cr.ObjectSet = o;
        var B = new cr.ObjectSet;
        cr.removeArrayDuplicates = function(e) {
            var t, r;
            for (t = 0, r = e.length; t < r; ++t) B.add(e[t]);
            cr.shallowAssignArray(e, B.valuesRef()), B.clear()
        }, cr.arrayRemoveAllFromObjectSet = function(e, t) {
            I ? cr.arrayRemoveAll_set(e, t.s) : cr.arrayRemoveAll_arr(e, t.valuesRef())
        }, cr.arrayRemoveAll_set = function(e, t) {
            var r, n, a, o;
            for (r = 0, n = 0, a = e.length; r < a; ++r) o = e[r], t.has(o) || (e[n++] = o);
            cr.truncateArray(e, n)
        }, cr.arrayRemoveAll_arr = function(e, t) {
            var r, n, a, o;
            for (r = 0, n = 0, a = e.length; r < a; ++r) o = e[r], -1 === cr.fastIndexOf(t, o) && (e[n++] = o);
            cr.truncateArray(e, n)
        };
        s.prototype.add = function(e) {
            this.y = e - this.c, this.t = this.sum + this.y, this.c = this.t - this.sum - this.y, this.sum = this.t
        }, s.prototype.reset = function() {
            this.c = 0, this.y = 0, this.t = 0, this.sum = 0
        }, cr.KahanAdder = s, cr.regexp_escape = function(e) {
            return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
        };
        l.prototype.set_pts = function(e) {
            this.pts_array = e, this.pts_count = e.length / 2, this.pts_cache.length = e.length, this.cache_width = -1, this.cache_height = -1, this.cache_angle = 0
        }, l.prototype.is_empty = function() {
            return !this.pts_array.length
        }, l.prototype.update_bbox = function() {
            for (var e = this.pts_cache, t = e[0], r = t, n = e[1], a = n, o = 1, s = this.pts_count, l, p, d; o < s; ++o) d = 2 * o, l = e[d], p = e[d + 1], l < t && (t = l), l > r && (r = l), p < n && (n = p), p > a && (a = p);
            this.bboxLeft = t, this.bboxRight = r, this.bboxTop = n, this.bboxBottom = a
        }, l.prototype.set_from_rect = function(e, t, r) {
            this.pts_cache.length = 8, this.pts_count = 4;
            var n = this.pts_cache;
            n[0] = e.left - t, n[1] = e.top - r, n[2] = e.right - t, n[3] = e.top - r, n[4] = e.right - t, n[5] = e.bottom - r, n[6] = e.left - t, n[7] = e.bottom - r, this.cache_width = e.right - e.left, this.cache_height = e.bottom - e.top, this.update_bbox()
        }, l.prototype.set_from_quad = function(e, t, r, n, a) {
            this.pts_cache.length = 8, this.pts_count = 4;
            var o = this.pts_cache;
            o[0] = e.tlx - t, o[1] = e.tly - r, o[2] = e.trx - t, o[3] = e.try_ - r, o[4] = e.brx - t, o[5] = e.bry - r, o[6] = e.blx - t, o[7] = e.bly - r, this.cache_width = n, this.cache_height = a, this.update_bbox()
        }, l.prototype.set_from_poly = function(e) {
            this.pts_count = e.pts_count, cr.shallowAssignArray(this.pts_cache, e.pts_cache), this.bboxLeft = e.bboxLeft, this.bboxTop - e.bboxTop, this.bboxRight = e.bboxRight, this.bboxBottom = e.bboxBottom
        }, l.prototype.cache_poly = function(e, t, r) {
            if (this.cache_width !== e || this.cache_height !== t || this.cache_angle !== r) {
                this.cache_width = e, this.cache_height = t, this.cache_angle = r;
                var n = 0,
                    a = 1,
                    o = this.pts_array,
                    s = this.pts_cache,
                    l, p, d, c, u, g;
                for (0 !== r && (n = T(r), a = S(r)), l = 0, c = this.pts_count; l < c; l++) p = 2 * l, d = p + 1, u = o[p] * e, g = o[d] * t, s[p] = u * a - g * n, s[d] = g * a + u * n;
                this.update_bbox()
            }
        }, l.prototype.contains_pt = function(e, t) {
            var r = this.pts_cache;
            if (e === r[0] && t === r[1]) return !0;
            var n = this.pts_count,
                a = this.bboxLeft - 110,
                o = this.bboxTop - 101,
                s = this.bboxRight + 131,
                l = this.bboxBottom + 120,
                p = 0,
                d = 0,
                c, u, g, y, m, _, h;
            for (c = 0; c < n; c++) u = 2 * c, g = 2 * ((c + 1) % n), y = r[u], m = r[u + 1], _ = r[g], h = r[g + 1], cr.segments_intersect(a, o, e, t, y, m, _, h) && p++, cr.segments_intersect(s, l, e, t, y, m, _, h) && d++;
            return 1 == p % 2 || 1 == d % 2
        }, l.prototype.intersects_poly = function(e, t, r) {
            var n = e.pts_cache,
                a = this.pts_cache;
            if (this.contains_pt(n[0] + t, n[1] + r)) return !0;
            if (e.contains_pt(a[0] - t, a[1] - r)) return !0;
            var o, s, l, p, d, c, u, g, y, m, _, h, f, b, x, v;
            for (o = 0, p = this.pts_count; o < p; o++)
                for (s = 2 * o, l = 2 * ((o + 1) % p), y = a[s], m = a[s + 1], _ = a[l], h = a[l + 1], (d = 0, g = e.pts_count); d < g; d++)
                    if (c = 2 * d, u = 2 * ((d + 1) % g), f = n[c] + t, b = n[c + 1] + r, x = n[u] + t, v = n[u + 1] + r, cr.segments_intersect(y, m, _, h, f, b, x, v)) return !0;
            return !1
        }, l.prototype.intersects_segment = function(e, t, r, n, a, o) {
            var s = this.pts_cache;
            if (this.contains_pt(r - e, n - t)) return !0;
            var l, p, d, c, u, g, y, m;
            for (l = 0, p = this.pts_count; l < p; l++)
                if (d = 2 * l, c = 2 * ((l + 1) % p), u = s[d] + e, g = s[d + 1] + t, y = s[c] + e, m = s[c + 1] + t, cr.segments_intersect(r, n, a, o, u, g, y, m)) return !0;
            return !1
        }, l.prototype.mirror = function(e) {
            var t, r, n;
            for (t = 0, r = this.pts_count; t < r; ++t) n = 2 * t, this.pts_cache[n] = 2 * e - this.pts_cache[n]
        }, l.prototype.flip = function(e) {
            var t, r, n;
            for (t = 0, r = this.pts_count; t < r; ++t) n = 2 * t + 1, this.pts_cache[n] = 2 * e - this.pts_cache[n]
        }, l.prototype.diag = function() {
            var e, t, r, n, a;
            for (e = 0, t = this.pts_count; e < t; ++e) r = 2 * e, n = r + 1, a = this.pts_cache[r], this.pts_cache[r] = this.pts_cache[n], this.pts_cache[n] = a
        }, l.prototype.is_enabled = function() {
            return this.enabled
        }, cr.CollisionPoly = l;
        p.prototype.totalCellCount = 0, p.prototype.getCell = function(e, t, r) {
            var n = this.cells[e],
                a;
            return n ? (a = n[t], a ? a : r ? (a = c(this, e, t), this.cells[e][t] = a, a) : null) : r ? (a = c(this, e, t), this.cells[e] = {}, this.cells[e][t] = a, a) : null
        }, p.prototype.XToCell = function(e) {
            return cr.floor(e / this.cellwidth)
        }, p.prototype.YToCell = function(e) {
            return cr.floor(e / this.cellheight)
        }, p.prototype.update = function(e, t, r) {
            var n, a, o, i, s;
            if (t)
                for (n = t.left, a = t.right; n <= a; ++n)
                    for (o = t.top, i = t.bottom; o <= i; ++o) r && r.contains_pt(n, o) || (s = this.getCell(n, o, !1), s && (s.remove(e), s.isEmpty() && (u(s), this.cells[n][o] = null)));
            if (r)
                for (n = r.left, a = r.right; n <= a; ++n)
                    for (o = r.top, i = r.bottom; o <= i; ++o) t && t.contains_pt(n, o) || this.getCell(n, o, !0).insert(e)
        }, p.prototype.queryRange = function(e, t) {
            var r, n, a, o, i, s;
            for (r = this.XToCell(e.left), a = this.YToCell(e.top), n = this.XToCell(e.right), i = this.YToCell(e.bottom); r <= n; ++r)
                for (o = a; o <= i; ++o) s = this.getCell(r, o, !1), s && s.dump(t)
        }, cr.SparseGrid = p;
        d.prototype.totalCellCount = 0, d.prototype.getCell = function(e, t, r) {
            var n = this.cells[e],
                a;
            return n ? (a = n[t], a ? a : r ? (a = y(this, e, t), this.cells[e][t] = a, a) : null) : r ? (a = y(this, e, t), this.cells[e] = {}, this.cells[e][t] = a, a) : null
        }, d.prototype.XToCell = function(e) {
            return cr.floor(e / this.cellwidth)
        }, d.prototype.YToCell = function(e) {
            return cr.floor(e / this.cellheight)
        }, d.prototype.update = function(e, t, r) {
            var n, a, o, i, s;
            if (t)
                for (n = t.left, a = t.right; n <= a; ++n)
                    for (o = t.top, i = t.bottom; o <= i; ++o) r && r.contains_pt(n, o) || (s = this.getCell(n, o, !1), s && (s.remove(e), s.isEmpty() && (m(s), this.cells[n][o] = null)));
            if (r)
                for (n = r.left, a = r.right; n <= a; ++n)
                    for (o = r.top, i = r.bottom; o <= i; ++o) t && t.contains_pt(n, o) || this.getCell(n, o, !0).insert(e)
        }, d.prototype.queryRange = function(e, t, r, n, a) {
            var o, i, s, l, p, d;
            for (o = this.XToCell(e), s = this.YToCell(t), i = this.XToCell(r), p = this.YToCell(n); o <= i; ++o)
                for (l = s; l <= p; ++l) d = this.getCell(o, l, !1), d && d.dump(a)
        }, d.prototype.markRangeChanged = function(e) {
            var t, r, n, a, o, i;
            for (t = e.left, n = e.top, r = e.right, o = e.bottom; t <= r; ++t)
                for (a = n; a <= o; ++a) i = this.getCell(t, a, !1), i && (i.is_sorted = !1)
        }, cr.RenderGrid = d;
        var F = [];
        g.prototype.isEmpty = function() {
            return this.objects.isEmpty()
        }, g.prototype.insert = function(e) {
            this.objects.add(e)
        }, g.prototype.remove = function(e) {
            this.objects.remove(e)
        }, g.prototype.dump = function(e) {
            cr.appendArray(e, this.objects.valuesRef())
        }, cr.GridCell = g;
        var N = [];
        _.prototype.isEmpty = function() {
            return !this.objects.length || !(this.objects.length > this.pending_removal.count()) && (this.flush_pending(), !0)
        }, _.prototype.insert = function(e) {
            if (this.pending_removal.contains(e)) return this.pending_removal.remove(e), void(this.pending_removal.isEmpty() && (this.any_pending_removal = !1));
            if (this.objects.length) {
                var t = this.objects[this.objects.length - 1];
                t.get_zindex() > e.get_zindex() && (this.is_sorted = !1), this.objects.push(e)
            } else this.objects.push(e), this.is_sorted = !0
        }, _.prototype.remove = function(e) {
            this.pending_removal.add(e), this.any_pending_removal = !0, 30 <= this.pending_removal.count() && this.flush_pending()
        }, _.prototype.flush_pending = function() {
            return this.any_pending_removal ? this.pending_removal.count() === this.objects.length ? void this.reset() : void(cr.arrayRemoveAllFromObjectSet(this.objects, this.pending_removal), this.pending_removal.clear(), this.any_pending_removal = !1) : void 0
        };
        _.prototype.ensure_sorted = function() {
            this.is_sorted || (this.objects.sort(h), this.is_sorted = !0)
        }, _.prototype.reset = function() {
            cr.clearArray(this.objects), this.is_sorted = !0, this.pending_removal.clear(), this.any_pending_removal = !1
        }, _.prototype.dump = function(e) {
            this.flush_pending(), this.ensure_sorted(), this.objects.length && e.push(this.objects)
        }, cr.RenderCell = _;
        var j = ["lighter", "xor", "copy", "destination-over", "source-in", "destination-in", "source-out", "destination-out", "source-atop", "destination-atop"];
        cr.effectToCompositeOp = function(e) {
            return 0 >= e || 11 <= e ? "source-over" : j[e - 1]
        }, cr.setGLBlend = function(e, t, r) {
            if (r) switch (e.srcBlend = r.ONE, e.destBlend = r.ONE_MINUS_SRC_ALPHA, t) {
                case 1:
                    e.srcBlend = r.ONE, e.destBlend = r.ONE;
                    break;
                case 2:
                    break;
                case 3:
                    e.srcBlend = r.ONE, e.destBlend = r.ZERO;
                    break;
                case 4:
                    e.srcBlend = r.ONE_MINUS_DST_ALPHA, e.destBlend = r.ONE;
                    break;
                case 5:
                    e.srcBlend = r.DST_ALPHA, e.destBlend = r.ZERO;
                    break;
                case 6:
                    e.srcBlend = r.ZERO, e.destBlend = r.SRC_ALPHA;
                    break;
                case 7:
                    e.srcBlend = r.ONE_MINUS_DST_ALPHA, e.destBlend = r.ZERO;
                    break;
                case 8:
                    e.srcBlend = r.ZERO, e.destBlend = r.ONE_MINUS_SRC_ALPHA;
                    break;
                case 9:
                    e.srcBlend = r.DST_ALPHA, e.destBlend = r.ONE_MINUS_SRC_ALPHA;
                    break;
                case 10:
                    e.srcBlend = r.ONE_MINUS_DST_ALPHA, e.destBlend = r.SRC_ALPHA;
            }
        }, cr.round6dp = function(e) {
            return Math.round(1e6 * e) / 1e6
        }, cr.equals_nocase = function(e, t) {
            return "string" == typeof e && "string" == typeof t && !(e.length !== t.length) && (!(e !== t) || e.toLowerCase() === t.toLowerCase())
        }, cr.cssToCamelCase = function(e) {
            var t = "",
                r = !1,
                n, a, o;
            for (n = 0, a = e.length; n < a; ++n) o = e.charAt(n), "-" === o ? r = !0 : r ? (t += o.toUpperCase(), r = !1) : t += o;
            return t
        }, cr.isCanvasInputEvent = function(t) {
            var e = t.target;
            return !e || !(e !== document && e !== window) || !!(document && document.body && e === document.body) || !!cr.equals_nocase(e.tagName, "canvas")
        }
    }();
var MatrixArray = "undefined" == typeof Float32Array ? Array : Float32Array,
    glMatrixArrayType = MatrixArray,
    vec3 = {},
    mat3 = {},
    mat4 = {},
    quat4 = {};
vec3.create = function(e) {
        var t = new MatrixArray(3);
        return e && (t[0] = e[0], t[1] = e[1], t[2] = e[2]), t
    }, vec3.set = function(e, t) {
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t
    }, vec3.add = function(e, t, r) {
        return r && e !== r ? (r[0] = e[0] + t[0], r[1] = e[1] + t[1], r[2] = e[2] + t[2], r) : (e[0] += t[0], e[1] += t[1], e[2] += t[2], e)
    }, vec3.subtract = function(e, t, r) {
        return r && e !== r ? (r[0] = e[0] - t[0], r[1] = e[1] - t[1], r[2] = e[2] - t[2], r) : (e[0] -= t[0], e[1] -= t[1], e[2] -= t[2], e)
    }, vec3.negate = function(e, t) {
        return t || (t = e), t[0] = -e[0], t[1] = -e[1], t[2] = -e[2], t
    }, vec3.scale = function(e, t, r) {
        return r && e !== r ? (r[0] = e[0] * t, r[1] = e[1] * t, r[2] = e[2] * t, r) : (e[0] *= t, e[1] *= t, e[2] *= t, e)
    }, vec3.normalize = function(t, r) {
        r || (r = t);
        var n = t[0],
            a = t[1],
            o = t[2],
            e = Math.sqrt(n * n + a * a + o * o);
        if (!e) return r[0] = 0, r[1] = 0, r[2] = 0, r;
        return 1 === e ? (r[0] = n, r[1] = a, r[2] = o, r) : (e = 1 / e, r[0] = n * e, r[1] = a * e, r[2] = o * e, r)
    }, vec3.cross = function(t, r, n) {
        n || (n = t);
        var o = t[0],
            i = t[1],
            t = t[2],
            e = r[0],
            s = r[1],
            r = r[2];
        return n[0] = i * r - t * s, n[1] = t * e - o * r, n[2] = o * s - i * e, n
    }, vec3.length = function(e) {
        var t = e[0],
            r = e[1],
            e = e[2];
        return Math.sqrt(t * t + r * r + e * e)
    }, vec3.dot = function(e, t) {
        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2]
    }, vec3.direction = function(t, r, n) {
        n || (n = t);
        var o = t[0] - r[0],
            i = t[1] - r[1],
            t = t[2] - r[2],
            r = Math.sqrt(o * o + i * i + t * t);
        return r ? (r = 1 / r, n[0] = o * r, n[1] = i * r, n[2] = t * r, n) : (n[0] = 0, n[1] = 0, n[2] = 0, n)
    }, vec3.lerp = function(e, t, r, n) {
        return n || (n = e), n[0] = e[0] + r * (t[0] - e[0]), n[1] = e[1] + r * (t[1] - e[1]), n[2] = e[2] + r * (t[2] - e[2]), n
    }, vec3.str = function(e) {
        return "[" + e[0] + ", " + e[1] + ", " + e[2] + "]"
    }, mat3.create = function(e) {
        var t = new MatrixArray(9);
        return e && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8]), t
    }, mat3.set = function(e, t) {
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8], t
    }, mat3.identity = function(e) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = 0, e[7] = 0, e[8] = 1, e
    }, mat3.transpose = function(t, r) {
        if (!r || t === r) {
            var n = t[1],
                a = t[2],
                o = t[5];
            return t[1] = t[3], t[2] = t[6], t[3] = n, t[5] = t[7], t[6] = a, t[7] = o, t
        }
        return r[0] = t[0], r[1] = t[3], r[2] = t[6], r[3] = t[1], r[4] = t[4], r[5] = t[7], r[6] = t[2], r[7] = t[5], r[8] = t[8], r
    }, mat3.toMat4 = function(e, t) {
        return t || (t = mat4.create()), t[15] = 1, t[14] = 0, t[13] = 0, t[12] = 0, t[11] = 0, t[10] = e[8], t[9] = e[7], t[8] = e[6], t[7] = 0, t[6] = e[5], t[5] = e[4], t[4] = e[3], t[3] = 0, t[2] = e[2], t[1] = e[1], t[0] = e[0], t
    }, mat3.str = function(e) {
        return "[" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ", " + e[4] + ", " + e[5] + ", " + e[6] + ", " + e[7] + ", " + e[8] + "]"
    }, mat4.create = function(e) {
        var t = new MatrixArray(16);
        return e && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t
    }, mat4.set = function(e, t) {
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t
    }, mat4.identity = function(e) {
        return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, e
    }, mat4.transpose = function(t, r) {
        if (!r || t === r) {
            var n = t[1],
                a = t[2],
                o = t[3],
                e = t[6],
                i = t[7],
                s = t[11];
            return t[1] = t[4], t[2] = t[8], t[3] = t[12], t[4] = n, t[6] = t[9], t[7] = t[13], t[8] = a, t[9] = e, t[11] = t[14], t[12] = o, t[13] = i, t[14] = s, t
        }
        return r[0] = t[0], r[1] = t[4], r[2] = t[8], r[3] = t[12], r[4] = t[1], r[5] = t[5], r[6] = t[9], r[7] = t[13], r[8] = t[2], r[9] = t[6], r[10] = t[10], r[11] = t[14], r[12] = t[3], r[13] = t[7], r[14] = t[11], r[15] = t[15], r
    }, mat4.determinant = function(t) {
        var r = t[0],
            s = t[1],
            c = t[2],
            d = t[3],
            e = t[4],
            u = t[5],
            g = t[6],
            y = t[7],
            i = t[8],
            _ = t[9],
            h = t[10],
            l = t[11],
            n = t[12],
            o = t[13],
            m = t[14],
            t = t[15];
        return n * _ * g * d - i * o * g * d - n * u * h * d + e * o * h * d + i * u * m * d - e * _ * m * d - n * _ * c * y + i * o * c * y + n * s * h * y - r * o * h * y - i * s * m * y + r * _ * m * y + n * u * c * l - e * o * c * l - n * s * g * l + r * o * g * l + e * s * m * l - r * u * m * l - i * u * c * t + e * _ * c * t + i * s * g * t - r * _ * g * t - e * s * h * t + r * u * h * t
    }, mat4.inverse = function(_, a) {
        a || (a = _);
        var S = _[0],
            c = _[1],
            d = _[2],
            e = _[3],
            g = _[4],
            f = _[5],
            h = _[6],
            i = _[7],
            T = _[8],
            O = _[9],
            l = _[10],
            n = _[11],
            o = _[12],
            m = _[13],
            p = _[14],
            r = _[15],
            s = S * f - c * g,
            A = S * h - d * g,
            P = S * i - e * g,
            t = c * h - d * f,
            u = c * i - e * f,
            v = d * i - e * h,
            w = T * m - O * o,
            x = T * p - l * o,
            y = T * r - n * o,
            L = O * p - l * m,
            C = O * r - n * m,
            I = l * r - n * p,
            E = 1 / (s * I - A * C + P * L + t * y - u * x + v * w);
        return a[0] = (f * I - h * C + i * L) * E, a[1] = (-c * I + d * C - e * L) * E, a[2] = (m * v - p * u + r * t) * E, a[3] = (-O * v + l * u - n * t) * E, a[4] = (-g * I + h * y - i * x) * E, a[5] = (S * I - d * y + e * x) * E, a[6] = (-o * v + p * P - r * A) * E, a[7] = (T * v - l * P + n * A) * E, a[8] = (g * C - f * y + i * w) * E, a[9] = (-S * C + c * y - e * w) * E, a[10] = (o * u - m * P + r * s) * E, a[11] = (-T * u + O * P - n * s) * E, a[12] = (-g * L + f * x - h * w) * E, a[13] = (S * L - c * x + d * w) * E, a[14] = (-o * t + m * A - p * s) * E, a[15] = (T * t - O * A + l * s) * E, a
    }, mat4.toRotationMat = function(e, t) {
        return t || (t = mat4.create()), t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t
    }, mat4.toMat3 = function(e, t) {
        return t || (t = mat3.create()), t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[4], t[4] = e[5], t[5] = e[6], t[6] = e[8], t[7] = e[9], t[8] = e[10], t
    }, mat4.toInverseMat3 = function(t, r) {
        var a = t[0],
            s = t[1],
            p = t[2],
            e = t[4],
            d = t[5],
            c = t[6],
            u = t[8],
            i = t[9],
            g = t[10],
            y = g * d - c * i,
            l = -g * e + c * u,
            n = i * e - d * u,
            o = a * y + s * l + p * n;
        return o ? (o = 1 / o, r || (r = mat3.create()), r[0] = y * o, r[1] = (-g * s + p * i) * o, r[2] = (c * s - p * d) * o, r[3] = l * o, r[4] = (g * a - p * u) * o, r[5] = (-c * a + p * e) * o, r[6] = n * o, r[7] = (-i * a + s * u) * o, r[8] = (d * a - s * e) * o, r) : null
    }, mat4.multiply = function(_, S, T) {
        T || (T = _);
        var O = _[0],
            d = _[1],
            e = _[2],
            g = _[3],
            f = _[4],
            h = _[5],
            i = _[6],
            P = _[7],
            L = _[8],
            l = _[9],
            n = _[10],
            o = _[11],
            m = _[12],
            p = _[13],
            r = _[14],
            _ = _[15],
            s = S[0],
            A = S[1],
            I = S[2],
            t = S[3],
            u = S[4],
            v = S[5],
            w = S[6],
            x = S[7],
            y = S[8],
            R = S[9],
            C = S[10],
            k = S[11],
            E = S[12],
            B = S[13],
            F = S[14],
            S = S[15];
        return T[0] = s * O + A * f + I * L + t * m, T[1] = s * d + A * h + I * l + t * p, T[2] = s * e + A * i + I * n + t * r, T[3] = s * g + A * P + I * o + t * _, T[4] = u * O + v * f + w * L + x * m, T[5] = u * d + v * h + w * l + x * p, T[6] = u * e + v * i + w * n + x * r, T[7] = u * g + v * P + w * o + x * _, T[8] = y * O + R * f + C * L + k * m, T[9] = y * d + R * h + C * l + k * p, T[10] = y * e + R * i + C * n + k * r, T[11] = y * g + R * P + C * o + k * _, T[12] = E * O + B * f + F * L + S * m, T[13] = E * d + B * h + F * l + S * p, T[14] = E * e + B * i + F * n + S * r, T[15] = E * g + B * P + F * o + S * _, T
    }, mat4.multiplyVec3 = function(t, r, n) {
        n || (n = r);
        var a = r[0],
            o = r[1],
            r = r[2];
        return n[0] = t[0] * a + t[4] * o + t[8] * r + t[12], n[1] = t[1] * a + t[5] * o + t[9] * r + t[13], n[2] = t[2] * a + t[6] * o + t[10] * r + t[14], n
    }, mat4.multiplyVec4 = function(t, r, n) {
        n || (n = r);
        var a = r[0],
            o = r[1],
            e = r[2],
            r = r[3];
        return n[0] = t[0] * a + t[4] * o + t[8] * e + t[12] * r, n[1] = t[1] * a + t[5] * o + t[9] * e + t[13] * r, n[2] = t[2] * a + t[6] * o + t[10] * e + t[14] * r, n[3] = t[3] * a + t[7] * o + t[11] * e + t[15] * r, n
    }, mat4.translate = function(t, a, s) {
        var c = a[0],
            d = a[1],
            a = a[2],
            e, u, y, _, x, v, w, S, T, O, E, C;
        return s && t !== s ? (e = t[0], u = t[1], y = t[2], _ = t[3], x = t[4], v = t[5], w = t[6], S = t[7], T = t[8], O = t[9], E = t[10], C = t[11], s[0] = e, s[1] = u, s[2] = y, s[3] = _, s[4] = x, s[5] = v, s[6] = w, s[7] = S, s[8] = T, s[9] = O, s[10] = E, s[11] = C, s[12] = e * c + x * d + T * a + t[12], s[13] = u * c + v * d + O * a + t[13], s[14] = y * c + w * d + E * a + t[14], s[15] = _ * c + S * d + C * a + t[15], s) : (t[12] = t[0] * c + t[4] * d + t[8] * a + t[12], t[13] = t[1] * c + t[5] * d + t[9] * a + t[13], t[14] = t[2] * c + t[6] * d + t[10] * a + t[14], t[15] = t[3] * c + t[7] * d + t[11] * a + t[15], t)
    }, mat4.scale = function(t, r, n) {
        var a = r[0],
            o = r[1],
            r = r[2];
        return n && t !== n ? (n[0] = t[0] * a, n[1] = t[1] * a, n[2] = t[2] * a, n[3] = t[3] * a, n[4] = t[4] * o, n[5] = t[5] * o, n[6] = t[6] * o, n[7] = t[7] * o, n[8] = t[8] * r, n[9] = t[9] * r, n[10] = t[10] * r, n[11] = t[11] * r, n[12] = t[12], n[13] = t[13], n[14] = t[14], n[15] = t[15], n) : (t[0] *= a, t[1] *= a, t[2] *= a, t[3] *= a, t[4] *= o, t[5] *= o, t[6] *= o, t[7] *= o, t[8] *= r, t[9] *= r, t[10] *= r, t[11] *= r, t)
    }, mat4.rotate = function(_, a, S, T) {
        var O = S[0],
            E = S[1],
            S = S[2],
            C = Math.sqrt(O * O + E * E + S * S),
            P, L, I, R, F, N, D, M, G, W, U, V, X, q, Y, H, J, Z, Q, K;
        return C ? (1 !== C && (C = 1 / C, O *= C, E *= C, S *= C), P = Math.sin(a), L = Math.cos(a), I = 1 - L, a = _[0], C = _[1], R = _[2], F = _[3], N = _[4], D = _[5], M = _[6], G = _[7], W = _[8], U = _[9], V = _[10], X = _[11], q = O * O * I + L, Y = E * O * I + S * P, H = S * O * I - E * P, J = O * E * I - S * P, Z = E * E * I + L, Q = S * E * I + O * P, K = O * S * I + E * P, O = E * S * I - O * P, E = S * S * I + L, T ? _ !== T && (T[12] = _[12], T[13] = _[13], T[14] = _[14], T[15] = _[15]) : T = _, T[0] = a * q + N * Y + W * H, T[1] = C * q + D * Y + U * H, T[2] = R * q + M * Y + V * H, T[3] = F * q + G * Y + X * H, T[4] = a * J + N * Z + W * Q, T[5] = C * J + D * Z + U * Q, T[6] = R * J + M * Z + V * Q, T[7] = F * J + G * Z + X * Q, T[8] = a * K + N * O + W * E, T[9] = C * K + D * O + U * E, T[10] = R * K + M * O + V * E, T[11] = F * K + G * O + X * E, T) : null
    }, mat4.rotateX = function(t, r, n) {
        var a = Math.sin(r),
            r = Math.cos(r),
            o = t[4],
            e = t[5],
            s = t[6],
            p = t[7],
            d = t[8],
            i = t[9],
            u = t[10],
            g = t[11];
        return n ? t !== n && (n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n[12] = t[12], n[13] = t[13], n[14] = t[14], n[15] = t[15]) : n = t, n[4] = o * r + d * a, n[5] = e * r + i * a, n[6] = s * r + u * a, n[7] = p * r + g * a, n[8] = o * -a + d * r, n[9] = e * -a + i * r, n[10] = s * -a + u * r, n[11] = p * -a + g * r, n
    }, mat4.rotateY = function(t, r, n) {
        var a = Math.sin(r),
            r = Math.cos(r),
            o = t[0],
            e = t[1],
            s = t[2],
            p = t[3],
            d = t[8],
            i = t[9],
            u = t[10],
            g = t[11];
        return n ? t !== n && (n[4] = t[4], n[5] = t[5], n[6] = t[6], n[7] = t[7], n[12] = t[12], n[13] = t[13], n[14] = t[14], n[15] = t[15]) : n = t, n[0] = o * r + d * -a, n[1] = e * r + i * -a, n[2] = s * r + u * -a, n[3] = p * r + g * -a, n[8] = o * a + d * r, n[9] = e * a + i * r, n[10] = s * a + u * r, n[11] = p * a + g * r, n
    }, mat4.rotateZ = function(t, r, n) {
        var a = Math.sin(r),
            r = Math.cos(r),
            o = t[0],
            e = t[1],
            s = t[2],
            p = t[3],
            d = t[4],
            i = t[5],
            u = t[6],
            g = t[7];
        return n ? t !== n && (n[8] = t[8], n[9] = t[9], n[10] = t[10], n[11] = t[11], n[12] = t[12], n[13] = t[13], n[14] = t[14], n[15] = t[15]) : n = t, n[0] = o * r + d * a, n[1] = e * r + i * a, n[2] = s * r + u * a, n[3] = p * r + g * a, n[4] = o * -a + d * r, n[5] = e * -a + i * r, n[6] = s * -a + u * r, n[7] = p * -a + g * r, n
    }, mat4.frustum = function(t, r, n, a, o, e, s) {
        s || (s = mat4.create());
        var l = r - t,
            p = a - n,
            i = e - o;
        return s[0] = 2 * o / l, s[1] = 0, s[2] = 0, s[3] = 0, s[4] = 0, s[5] = 2 * o / p, s[6] = 0, s[7] = 0, s[8] = (r + t) / l, s[9] = (a + n) / p, s[10] = -(e + o) / i, s[11] = -1, s[12] = 0, s[13] = 0, s[14] = -(2 * (e * o)) / i, s[15] = 0, s
    }, mat4.perspective = function(t, r, n, o, i) {
        return t = n * Math.tan(t * Math.PI / 360), r *= t, mat4.frustum(-r, r, -t, t, n, o, i)
    }, mat4.ortho = function(t, r, n, a, o, e, s) {
        s || (s = mat4.create());
        var l = r - t,
            p = a - n,
            i = e - o;
        return s[0] = 2 / l, s[1] = 0, s[2] = 0, s[3] = 0, s[4] = 0, s[5] = 2 / p, s[6] = 0, s[7] = 0, s[8] = 0, s[9] = 0, s[10] = -2 / i, s[11] = 0, s[12] = -(t + r) / l, s[13] = -(a + n) / p, s[14] = -(e + o) / i, s[15] = 1, s
    }, mat4.lookAt = function(t, r, s, p) {
        var u = Math.sqrt;
        p || (p = mat4.create());
        var y = t[0],
            n = t[1],
            t = t[2],
            o, m, _, x, v, w, S, T;
        return (m = s[0], _ = s[1], o = s[2], s = r[1], w = r[2], y === r[0] && n === s && t === w) ? mat4.identity(p) : (s = y - r[0], w = n - r[1], S = t - r[2], T = 1 / u(s * s + w * w + S * S), s *= T, w *= T, S *= T, r = _ * S - o * w, o = o * s - m * S, m = m * w - _ * s, (T = u(r * r + o * o + m * m)) ? (T = 1 / T, r *= T, o *= T, m *= T) : m = o = r = 0, _ = w * m - S * o, x = S * r - s * m, v = s * o - w * r, (T = u(_ * _ + x * x + v * v)) ? (T = 1 / T, _ *= T, x *= T, v *= T) : v = x = _ = 0, p[0] = r, p[1] = _, p[2] = s, p[3] = 0, p[4] = o, p[5] = x, p[6] = w, p[7] = 0, p[8] = m, p[9] = v, p[10] = S, p[11] = 0, p[12] = -(r * y + o * n + m * t), p[13] = -(_ * y + x * n + v * t), p[14] = -(s * y + w * n + S * t), p[15] = 1, p)
    }, mat4.fromRotationTranslation = function(t, r, n) {
        n || (n = mat4.create());
        var o = t[0],
            s = t[1],
            p = t[2],
            u = t[3],
            y = o + o,
            m = s + s,
            _ = p + p,
            t = o * y,
            b = o * m;
        o *= _;
        var x = s * m;
        return s *= _, p *= _, y *= u, m *= u, u *= _, n[0] = 1 - (x + p), n[1] = b + u, n[2] = o - m, n[3] = 0, n[4] = b - u, n[5] = 1 - (t + p), n[6] = s + y, n[7] = 0, n[8] = o + m, n[9] = s - y, n[10] = 1 - (t + x), n[11] = 0, n[12] = r[0], n[13] = r[1], n[14] = r[2], n[15] = 1, n
    }, mat4.str = function(e) {
        return "[" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + ", " + e[4] + ", " + e[5] + ", " + e[6] + ", " + e[7] + ", " + e[8] + ", " + e[9] + ", " + e[10] + ", " + e[11] + ", " + e[12] + ", " + e[13] + ", " + e[14] + ", " + e[15] + "]"
    }, quat4.create = function(e) {
        var t = new MatrixArray(4);
        return e && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3]), t
    }, quat4.set = function(e, t) {
        return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t
    }, quat4.calculateW = function(t, r) {
        var n = Math.abs,
            a = Math.sqrt,
            o = t[0],
            i = t[1],
            s = t[2];
        return r && t !== r ? (r[0] = o, r[1] = i, r[2] = s, r[3] = -a(n(1 - o * o - i * i - s * s)), r) : (t[3] = -a(n(1 - o * o - i * i - s * s)), t)
    }, quat4.inverse = function(e, t) {
        return t && e !== t ? (t[0] = -e[0], t[1] = -e[1], t[2] = -e[2], t[3] = e[3], t) : (e[0] *= -1, e[1] *= -1, e[2] *= -1, e)
    }, quat4.length = function(e) {
        var t = e[0],
            r = e[1],
            n = e[2],
            e = e[3];
        return Math.sqrt(t * t + r * r + n * n + e * e)
    }, quat4.normalize = function(t, r) {
        r || (r = t);
        var n = t[0],
            a = t[1],
            o = t[2],
            e = t[3],
            i = Math.sqrt(n * n + a * a + o * o + e * e);
        return 0 === i ? (r[0] = 0, r[1] = 0, r[2] = 0, r[3] = 0, r) : (i = 1 / i, r[0] = n * i, r[1] = a * i, r[2] = o * i, r[3] = e * i, r)
    }, quat4.multiply = function(t, r, n) {
        n || (n = t);
        var o = t[0],
            s = t[1],
            e = t[2],
            t = t[3],
            l = r[0],
            p = r[1],
            d = r[2],
            r = r[3];
        return n[0] = o * r + t * l + s * d - e * p, n[1] = s * r + t * p + e * l - o * d, n[2] = e * r + t * d + o * p - s * l, n[3] = t * r - o * l - s * p - e * d, n
    }, quat4.multiplyVec3 = function(t, r, n) {
        n || (n = r);
        var o = r[0],
            s = r[1],
            e = r[2],
            r = t[0],
            l = t[1],
            p = t[2],
            t = t[3],
            u = t * o + l * e - p * s,
            i = t * s + p * o - r * e,
            g = t * e + r * s - l * o,
            o = -r * o - l * s - p * e;
        return n[0] = u * t + o * -r + i * -p - g * -l, n[1] = i * t + o * -l + g * -r - u * -p, n[2] = g * t + o * -p + u * -l - i * -r, n
    }, quat4.toMat3 = function(t, r) {
        r || (r = mat3.create());
        var n = t[0],
            a = t[1],
            o = t[2],
            s = t[3],
            p = n + n,
            u = a + a,
            y = o + o,
            i = n * p,
            m = n * u;
        n *= y;
        var _ = a * u;
        return a *= y, o *= y, p *= s, u *= s, s *= y, r[0] = 1 - (_ + o), r[1] = m + s, r[2] = n - u, r[3] = m - s, r[4] = 1 - (i + o), r[5] = a + p, r[6] = n + u, r[7] = a - p, r[8] = 1 - (i + _), r
    }, quat4.toMat4 = function(t, r) {
        r || (r = mat4.create());
        var n = t[0],
            a = t[1],
            o = t[2],
            s = t[3],
            p = n + n,
            u = a + a,
            y = o + o,
            i = n * p,
            m = n * u;
        n *= y;
        var _ = a * u;
        return a *= y, o *= y, p *= s, u *= s, s *= y, r[0] = 1 - (_ + o), r[1] = m + s, r[2] = n - u, r[3] = 0, r[4] = m - s, r[5] = 1 - (i + o), r[6] = a + p, r[7] = 0, r[8] = n + u, r[9] = a - p, r[10] = 1 - (i + _), r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r
    }, quat4.slerp = function(t, r, n, a) {
        var o = Math.abs,
            i = Math.sin;
        a || (a = t);
        var s = t[0] * r[0] + t[1] * r[1] + t[2] * r[2] + t[3] * r[3],
            l, p;
        return 1 <= o(s) ? (a !== t && (a[0] = t[0], a[1] = t[1], a[2] = t[2], a[3] = t[3]), a) : (l = Math.acos(s), p = Math.sqrt(1 - s * s), .001 > o(p)) ? (a[0] = .5 * t[0] + .5 * r[0], a[1] = .5 * t[1] + .5 * r[1], a[2] = .5 * t[2] + .5 * r[2], a[3] = .5 * t[3] + .5 * r[3], a) : (s = i((1 - n) * l) / p, n = i(n * l) / p, a[0] = t[0] * s + r[0] * n, a[1] = t[1] * s + r[1] * n, a[2] = t[2] * s + r[2] * n, a[3] = t[3] * s + r[3] * n, a)
    }, quat4.str = function(e) {
        return "[" + e[0] + ", " + e[1] + ", " + e[2] + ", " + e[3] + "]"
    },
    function() {
        function e(e, t, r) {
            this.isIE = /msie/i.test(navigator.userAgent) || /trident/i.test(navigator.userAgent), this.width = 0, this.height = 0, this.enableFrontToBack = !!r, this.isEarlyZPass = !1, this.isBatchInEarlyZPass = !1, this.currentZ = 0, this.zNear = 1, this.zFar = 1e3, this.zIncrement = (this.zFar - this.zNear) / 32768, this.zA = this.zFar / (this.zFar - this.zNear), this.zB = this.zFar * this.zNear / (this.zNear - this.zFar), this.kzA = 65536 * this.zA, this.kzB = 65536 * this.zB, this.cam = vec3.create([0, 0, 100]), this.look = vec3.create([0, 0, 0]), this.up = vec3.create([0, 1, 0]), this.worldScale = vec3.create([1, 1, 1]), this.enable_mipmaps = !0, this.matP = mat4.create(), this.matMV = mat4.create(), this.lastMV = mat4.create(), this.currentMV = mat4.create(), this.gl = e, this.version = 0 === this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2") ? 2 : 1, this.timerExt = null, this.isTiming = !1, this.timerExt = 2 === this.version ? this.gl.getExtension("EXT_disjoint_timer_query_webgl2") || this.gl.getExtension("EXT_disjoint_timer_query") : this.gl.getExtension("EXT_disjoint_timer_query"), this.frameNumber = 0, this.timerResults = [], this.initState()
        }

        function t(e, t, r) {
            this.gl = e, this.shaderProgram = t, this.name = r, this.locAPos = e.getAttribLocation(t, "aPos"), this.locATex = e.getAttribLocation(t, "aTex"), this.locMatP = e.getUniformLocation(t, "matP"), this.locMatMV = e.getUniformLocation(t, "matMV"), this.locOpacity = e.getUniformLocation(t, "opacity"), this.locColorFill = e.getUniformLocation(t, "colorFill"), this.locSamplerFront = e.getUniformLocation(t, "samplerFront"), this.locSamplerBack = e.getUniformLocation(t, "samplerBack"), this.locSrcStart = e.getUniformLocation(t, "srcStart"), this.locSrcEnd = e.getUniformLocation(t, "srcEnd"), this.locSrcOriginStart = e.getUniformLocation(t, "srcOriginStart"), this.locSrcOriginEnd = e.getUniformLocation(t, "srcOriginEnd"), this.locLayoutStart = e.getUniformLocation(t, "layoutStart"), this.locLayoutEnd = e.getUniformLocation(t, "layoutEnd"), this.locDestStart = e.getUniformLocation(t, "destStart"), this.locDestEnd = e.getUniformLocation(t, "destEnd"), this.locSeconds = e.getUniformLocation(t, "seconds"), this.locPixelSize = e.getUniformLocation(t, "pixelSize"), this.locLayerScale = e.getUniformLocation(t, "layerScale"), this.locLayerAngle = e.getUniformLocation(t, "layerAngle"), this.hasAnyOptionalUniforms = !!(this.locPixelSize || this.locSeconds || this.locSamplerBack || this.locSrcStart || this.locSrcEnd || this.locSrcOriginStart || this.locSrcOriginEnd || this.locLayoutStart || this.locLayoutEnd || this.locDestStart || this.locDestEnd || this.locLayerScale || this.locLayerAngle), this.lpPixelWidth = -999, this.lpPixelHeight = -999, this.lpOpacity = 1, this.lpSrcStartX = 0, this.lpSrcStartY = 0, this.lpSrcEndX = 0, this.lpSrcEndY = 0, this.lpSrcOriginStartX = 0, this.lpSrcOriginStartY = 0, this.lpSrcOriginEndX = 0, this.lpSrcOriginEndY = 0, this.lpLayoutStartX = 0, this.lpLayoutStartY = 0, this.lpLayoutEndX = 0, this.lpLayoutEndY = 0, this.lpDestStartX = 0, this.lpDestStartY = 0, this.lpDestEndX = 1, this.lpDestEndY = 1, this.lpLayerScale = 1, this.lpLayerAngle = 0, this.lpSeconds = 0, this.lastCustomParams = [], this.lpMatMV = mat4.create(), this.locOpacity && e.uniform1f(this.locOpacity, 1), this.locColorFill && e.uniform4f(this.locColorFill, 1, 1, 1, 1), this.locSamplerFront && e.uniform1i(this.locSamplerFront, 0), this.locSamplerBack && e.uniform1i(this.locSamplerBack, 1), this.locSrcStart && e.uniform2f(this.locSrcStart, 0, 0), this.locSrcEnd && e.uniform2f(this.locSrcEnd, 1, 1), this.locSrcOriginStart && e.uniform2f(this.locSrcOriginStart, 0, 0), this.locSrcOriginEnd && e.uniform2f(this.locSrcOriginEnd, 0, 0), this.locLayoutStart && e.uniform2f(this.locLayoutStart, 0, 0), this.locLayoutEnd && e.uniform2f(this.locLayoutEnd, 0, 0), this.locDestStart && e.uniform2f(this.locDestStart, 0, 0), this.locDestEnd && e.uniform2f(this.locDestEnd, 1, 1), this.locLayerScale && e.uniform1f(this.locLayerScale, 1), this.locLayerAngle && e.uniform1f(this.locLayerAngle, 0), this.locSeconds && e.uniform1f(this.locSeconds, 0), this.hasCurrentMatMV = !1
        }

        function r(e, t) {
            return e[0] === t[0] && e[1] === t[1] && e[2] === t[2] && e[3] === t[3] && e[4] === t[4] && e[5] === t[5] && e[6] === t[6] && e[7] === t[7] && e[8] === t[8] && e[9] === t[9] && e[10] === t[10] && e[11] === t[11] && e[12] === t[12] && e[13] === t[13] && e[14] === t[14] && e[15] === t[15]
        }

        function n(e, t) {
            this.type = e, this.glwrap = t, this.gl = t.gl, this.opacityParam = 0, this.startIndex = 0, this.indexCount = 0, this.texParam = null, this.mat4param = null, this.layoutRect = quat4.create(), this.srcOriginRect = quat4.create(), this.shaderParams = [], cr.seal(this)
        }
        var a = mat4.create();
        e.prototype.initState = function() {
            var e = this.gl,
                t, r;
            for (this.lastOpacity = 1, this.lastTexture0 = null, this.lastTexture1 = null, this.currentOpacity = 1, e.clearColor(0, 0, 0, 0), e.clear(e.COLOR_BUFFER_BIT), e.enable(e.BLEND), e.blendFunc(e.ONE, e.ONE_MINUS_SRC_ALPHA), e.disable(e.CULL_FACE), e.disable(e.STENCIL_TEST), e.disable(e.DITHER), this.enableFrontToBack ? (e.enable(e.DEPTH_TEST), e.depthFunc(e.LEQUAL)) : e.disable(e.DEPTH_TEST), this.maxTextureSize = e.getParameter(e.MAX_TEXTURE_SIZE), this.lastSrcBlend = e.ONE, this.lastDestBlend = e.ONE_MINUS_SRC_ALPHA, this.vertexData = new Float32Array(8000 * (this.enableFrontToBack ? 3 : 2)), this.texcoordData = new Float32Array(16000), this.pointData = new Float32Array(32000), this.pointBuffer = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, this.pointBuffer), e.bufferData(e.ARRAY_BUFFER, this.pointData.byteLength, e.DYNAMIC_DRAW), this.vertexBuffers = [, , , , ], this.texcoordBuffers = [, , , , ], t = 0; 4 > t; t++) this.vertexBuffers[t] = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, this.vertexBuffers[t]), e.bufferData(e.ARRAY_BUFFER, this.vertexData.byteLength, e.DYNAMIC_DRAW), this.texcoordBuffers[t] = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, this.texcoordBuffers[t]), e.bufferData(e.ARRAY_BUFFER, this.texcoordData.byteLength, e.DYNAMIC_DRAW);
            this.curBuffer = 0, this.indexBuffer = e.createBuffer(), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
            var n = new Uint16Array(12000);
            t = 0, r = 12000;
            for (var a = 0; t < r;) n[t++] = a, n[t++] = a + 1, n[t++] = a + 2, n[t++] = a, n[t++] = a + 2, n[t++] = a + 3, a += 4;
            e.bufferData(e.ELEMENT_ARRAY_BUFFER, n, e.STATIC_DRAW), this.vertexPtr = 0, this.texPtr = 0, this.pointPtr = 0;
            var o, s;
            this.shaderPrograms = [], o = "varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}", s = this.enableFrontToBack ? "attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}" : "attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";
            var l = this.createShaderProgram({
                src: o
            }, s, "<default>");
            this.shaderPrograms.push(l), o = "uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}";
            l = this.createShaderProgram({
                src: o
            }, "attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}", "<point>"), this.shaderPrograms.push(l), o = "varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}";
            var l = this.createShaderProgram({
                src: o
            }, s, "<earlyz>");
            this.shaderPrograms.push(l), o = "uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}";
            var l = this.createShaderProgram({
                src: o
            }, s, "<fill>");
            for (var p in this.shaderPrograms.push(l), cr.shaders) cr.shaders.hasOwnProperty(p) && this.shaderPrograms.push(this.createShaderProgram(cr.shaders[p], s, p));
            e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_2D, null), this.batch = [], this.batchPtr = 0, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1, this.lastProgram = -1, this.currentProgram = -1, this.currentShader = null, this.fbo = e.createFramebuffer(), this.renderToTex = null, this.depthBuffer = null, this.attachedDepthBuffer = !1, this.enableFrontToBack && (this.depthBuffer = e.createRenderbuffer()), this.tmpVec3 = vec3.create([0, 0, 0]);
            var d = e.getParameter(e.ALIASED_POINT_SIZE_RANGE);
            this.minPointSize = d[0], this.maxPointSize = d[1], 2048 < this.maxPointSize && (this.maxPointSize = 2048), this.switchProgram(0), cr.seal(this)
        };
        t.prototype.updateMatMV = function(e) {
            r(this.lpMatMV, e) || (mat4.set(e, this.lpMatMV), this.gl.uniformMatrix4fv(this.locMatMV, !1, e))
        }, e.prototype.createShaderProgram = function(e, r, n) {
            var a = this.gl,
                o = a.createShader(a.FRAGMENT_SHADER);
            if (a.shaderSource(o, e.src), a.compileShader(o), !a.getShaderParameter(o, a.COMPILE_STATUS)) {
                var s = a.getShaderInfoLog(o);
                throw a.deleteShader(o), new Error("error compiling fragment shader: " + s)
            }
            var l = a.createShader(a.VERTEX_SHADER);
            if (a.shaderSource(l, r), a.compileShader(l), !a.getShaderParameter(l, a.COMPILE_STATUS)) {
                var s = a.getShaderInfoLog(l);
                throw a.deleteShader(o), a.deleteShader(l), new Error("error compiling vertex shader: " + s)
            }
            var p = a.createProgram();
            if (a.attachShader(p, o), a.attachShader(p, l), a.linkProgram(p), !a.getProgramParameter(p, a.LINK_STATUS)) {
                var s = a.getProgramInfoLog(p);
                throw a.deleteShader(o), a.deleteShader(l), a.deleteProgram(p), new Error("error linking shader program: " + s)
            }
            a.useProgram(p), a.deleteShader(o), a.deleteShader(l);
            var d = new t(a, p, n);
            d.extendBoxHorizontal = e.extendBoxHorizontal || 0, d.extendBoxVertical = e.extendBoxVertical || 0, d.crossSampling = !!e.crossSampling, d.preservesOpaqueness = !!e.preservesOpaqueness, d.animated = !!e.animated, d.parameters = e.parameters || [];
            var c, u;
            for (c = 0, u = d.parameters.length; c < u; c++) d.parameters[c][1] = a.getUniformLocation(p, d.parameters[c][0]), d.lastCustomParams.push(0);
            return cr.seal(d), d
        }, e.prototype.getShaderIndex = function(e) {
            var t, r;
            for (t = 0, r = this.shaderPrograms.length; t < r; t++)
                if (this.shaderPrograms[t].name === e) return t;
            return -1
        }, e.prototype.project = function(e, t, r) {
            var n = this.matMV,
                a = this.matP,
                o = [0, 0, 0, 0, 0, 0, 0, 0];
            o[0] = n[0] * e + n[4] * t + n[12], o[1] = n[1] * e + n[5] * t + n[13], o[2] = n[2] * e + n[6] * t + n[14], o[3] = n[3] * e + n[7] * t + n[15], o[4] = a[0] * o[0] + a[4] * o[1] + a[8] * o[2] + a[12] * o[3], o[5] = a[1] * o[0] + a[5] * o[1] + a[9] * o[2] + a[13] * o[3], o[6] = a[2] * o[0] + a[6] * o[1] + a[10] * o[2] + a[14] * o[3], o[7] = -o[2];
            0 === o[7] || (o[7] = 1 / o[7], o[4] *= o[7], o[5] *= o[7], o[6] *= o[7], r[0] = (.5 * o[4] + .5) * this.width, r[1] = (.5 * o[5] + .5) * this.height)
        }, e.prototype.setSize = function(e, t, r) {
            if (this.width !== e || this.height !== t || r) {
                this.endBatch();
                var n = this.gl;
                if (this.width = e, this.height = t, n.viewport(0, 0, e, t), mat4.lookAt(this.cam, this.look, this.up, this.matMV), this.enableFrontToBack) mat4.ortho(-e / 2, e / 2, t / 2, -t / 2, this.zNear, this.zFar, this.matP), this.worldScale[0] = 1, this.worldScale[1] = 1;
                else {
                    mat4.perspective(45, e / t, this.zNear, this.zFar, this.matP);
                    var a = [0, 0],
                        o = [0, 0];
                    this.project(0, 0, a), this.project(1, 1, o), this.worldScale[0] = 1 / (o[0] - a[0]), this.worldScale[1] = -1 / (o[1] - a[1])
                }
                var l, p, d;
                for (l = 0, p = this.shaderPrograms.length; l < p; l++) d = this.shaderPrograms[l], d.hasCurrentMatMV = !1, d.locMatP && (n.useProgram(d.shaderProgram), n.uniformMatrix4fv(d.locMatP, !1, this.matP));
                n.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram), n.bindTexture(n.TEXTURE_2D, null), n.activeTexture(n.TEXTURE1), n.bindTexture(n.TEXTURE_2D, null), n.activeTexture(n.TEXTURE0), this.lastTexture0 = null, this.lastTexture1 = null, this.depthBuffer && (n.bindFramebuffer(n.FRAMEBUFFER, this.fbo), n.bindRenderbuffer(n.RENDERBUFFER, this.depthBuffer), n.renderbufferStorage(n.RENDERBUFFER, n.DEPTH_COMPONENT16, this.width, this.height), !this.attachedDepthBuffer && (n.framebufferRenderbuffer(n.FRAMEBUFFER, n.DEPTH_ATTACHMENT, n.RENDERBUFFER, this.depthBuffer), this.attachedDepthBuffer = !0), n.bindRenderbuffer(n.RENDERBUFFER, null), n.bindFramebuffer(n.FRAMEBUFFER, null), this.renderToTex = null)
            }
        }, e.prototype.resetModelView = function() {
            mat4.lookAt(this.cam, this.look, this.up, this.matMV), mat4.scale(this.matMV, this.worldScale)
        }, e.prototype.translate = function(e, t) {
            0 === e && 0 === t || (this.tmpVec3[0] = e, this.tmpVec3[1] = t, this.tmpVec3[2] = 0, mat4.translate(this.matMV, this.tmpVec3))
        }, e.prototype.scale = function(e, t) {
            1 === e && 1 === t || (this.tmpVec3[0] = e, this.tmpVec3[1] = t, this.tmpVec3[2] = 1, mat4.scale(this.matMV, this.tmpVec3))
        }, e.prototype.rotateZ = function(e) {
            0 === e || mat4.rotateZ(this.matMV, e)
        }, e.prototype.updateModelView = function() {
            if (!r(this.lastMV, this.matMV)) {
                var e = this.pushBatch();
                e.type = 5, e.mat4param ? mat4.set(this.matMV, e.mat4param) : e.mat4param = mat4.create(this.matMV), mat4.set(this.matMV, this.lastMV), this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.setEarlyZIndex = function(e) {
            this.enableFrontToBack && (32760 < e && (e = 32760), this.currentZ = this.cam[2] - this.zNear - e * this.zIncrement)
        };
        n.prototype.doSetEarlyZPass = function() {
            var e = this.gl,
                t = this.glwrap;
            0 === this.startIndex ? (e.depthMask(!1), e.colorMask(!0, !0, !0, !0), e.enable(e.BLEND), t.isBatchInEarlyZPass = !1) : (e.depthMask(!0), e.colorMask(!1, !1, !1, !1), e.disable(e.BLEND), e.bindFramebuffer(e.FRAMEBUFFER, t.fbo), e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, null, 0), e.clear(e.DEPTH_BUFFER_BIT), e.bindFramebuffer(e.FRAMEBUFFER, null), t.isBatchInEarlyZPass = !0)
        }, n.prototype.doSetTexture = function() {
            this.gl.bindTexture(this.gl.TEXTURE_2D, this.texParam)
        }, n.prototype.doSetTexture1 = function() {
            var e = this.gl;
            e.activeTexture(e.TEXTURE1), e.bindTexture(e.TEXTURE_2D, this.texParam), e.activeTexture(e.TEXTURE0)
        }, n.prototype.doSetOpacity = function() {
            var e = this.opacityParam,
                t = this.glwrap;
            t.currentOpacity = e;
            var r = t.currentShader;
            r.locOpacity && r.lpOpacity !== e && (r.lpOpacity = e, this.gl.uniform1f(r.locOpacity, e))
        }, n.prototype.doQuad = function() {
            this.gl.drawElements(this.gl.TRIANGLES, this.indexCount, this.gl.UNSIGNED_SHORT, this.startIndex)
        }, n.prototype.doSetBlend = function() {
            this.gl.blendFunc(this.startIndex, this.indexCount)
        }, n.prototype.doUpdateModelView = function() {
            var e = this.glwrap.shaderPrograms,
                t = this.glwrap.currentProgram,
                r, n, a;
            for (r = 0, n = e.length; r < n; r++) a = e[r], r === t && a.locMatMV ? (a.updateMatMV(this.mat4param), a.hasCurrentMatMV = !0) : a.hasCurrentMatMV = !1;
            mat4.set(this.mat4param, this.glwrap.currentMV)
        }, n.prototype.doRenderToTexture = function() {
            var e = this.gl,
                t = this.glwrap;
            this.texParam ? (t.lastTexture1 === this.texParam && (e.activeTexture(e.TEXTURE1), e.bindTexture(e.TEXTURE_2D, null), t.lastTexture1 = null, e.activeTexture(e.TEXTURE0)), e.bindFramebuffer(e.FRAMEBUFFER, t.fbo), !t.isBatchInEarlyZPass && e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, this.texParam, 0)) : (!t.enableFrontToBack && e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, null, 0), e.bindFramebuffer(e.FRAMEBUFFER, null))
        }, n.prototype.doClear = function() {
            var e = this.gl,
                t = this.startIndex;
            0 === t ? (e.clearColor(this.mat4param[0], this.mat4param[1], this.mat4param[2], this.mat4param[3]), e.clear(e.COLOR_BUFFER_BIT)) : 1 === t ? (e.enable(e.SCISSOR_TEST), e.scissor(this.mat4param[0], this.mat4param[1], this.mat4param[2], this.mat4param[3]), e.clearColor(0, 0, 0, 0), e.clear(e.COLOR_BUFFER_BIT), e.disable(e.SCISSOR_TEST)) : e.clear(e.DEPTH_BUFFER_BIT)
        }, n.prototype.doSetDepthTestEnabled = function() {
            var e = this.gl,
                t = this.startIndex;
            0 === t ? e.disable(e.DEPTH_TEST) : e.enable(e.DEPTH_TEST)
        }, n.prototype.doPoints = function() {
            var e = this.gl,
                t = this.glwrap;
            t.enableFrontToBack && e.disable(e.DEPTH_TEST);
            var r = t.shaderPrograms[1];
            e.useProgram(r.shaderProgram), !r.hasCurrentMatMV && r.locMatMV && (r.updateMatMV(t.currentMV), r.hasCurrentMatMV = !0), e.enableVertexAttribArray(r.locAPos), e.bindBuffer(e.ARRAY_BUFFER, t.pointBuffer), e.vertexAttribPointer(r.locAPos, 4, e.FLOAT, !1, 0, 0), e.drawArrays(e.POINTS, this.startIndex / 4, this.indexCount), r = t.currentShader, e.useProgram(r.shaderProgram), 0 <= r.locAPos && (e.enableVertexAttribArray(r.locAPos), e.bindBuffer(e.ARRAY_BUFFER, t.vertexBuffers[t.curBuffer]), e.vertexAttribPointer(r.locAPos, t.enableFrontToBack ? 3 : 2, e.FLOAT, !1, 0, 0)), 0 <= r.locATex && (e.enableVertexAttribArray(r.locATex), e.bindBuffer(e.ARRAY_BUFFER, t.texcoordBuffers[t.curBuffer]), e.vertexAttribPointer(r.locATex, 2, e.FLOAT, !1, 0, 0)), t.enableFrontToBack && e.enable(e.DEPTH_TEST)
        }, n.prototype.doSetProgram = function() {
            var e = this.gl,
                t = this.glwrap,
                r = t.shaderPrograms[this.startIndex];
            t.currentProgram = this.startIndex, t.currentShader = r, e.useProgram(r.shaderProgram), !r.hasCurrentMatMV && r.locMatMV && (r.updateMatMV(t.currentMV), r.hasCurrentMatMV = !0), r.locOpacity && r.lpOpacity !== t.currentOpacity && (r.lpOpacity = t.currentOpacity, e.uniform1f(r.locOpacity, t.currentOpacity)), 0 <= r.locAPos && (e.enableVertexAttribArray(r.locAPos), e.bindBuffer(e.ARRAY_BUFFER, t.vertexBuffers[t.curBuffer]), e.vertexAttribPointer(r.locAPos, t.enableFrontToBack ? 3 : 2, e.FLOAT, !1, 0, 0)), 0 <= r.locATex && (e.enableVertexAttribArray(r.locATex), e.bindBuffer(e.ARRAY_BUFFER, t.texcoordBuffers[t.curBuffer]), e.vertexAttribPointer(r.locATex, 2, e.FLOAT, !1, 0, 0))
        }, n.prototype.doSetColor = function() {
            var e = this.glwrap.currentShader,
                t = this.mat4param;
            this.gl.uniform4f(e.locColorFill, t[0], t[1], t[2], t[3])
        }, n.prototype.doSetProgramParameters = function() {
            var e = this.glwrap.currentShader,
                t = this.gl,
                r = this.mat4param,
                n = this.layoutRect,
                a = this.srcOriginRect,
                o, s;
            e.locSamplerBack && this.glwrap.lastTexture1 !== this.texParam && (t.activeTexture(t.TEXTURE1), t.bindTexture(t.TEXTURE_2D, this.texParam), this.glwrap.lastTexture1 = this.texParam, t.activeTexture(t.TEXTURE0));
            var l = r[0],
                p = r[1];
            if (e.locPixelSize && (l !== e.lpPixelWidth || p !== e.lpPixelHeight) && (e.lpPixelWidth = l, e.lpPixelHeight = p, t.uniform2f(e.locPixelSize, l, p)), l = r[2], p = r[3], e.locDestStart && (l !== e.lpDestStartX || p !== e.lpDestStartY) && (e.lpDestStartX = l, e.lpDestStartY = p, t.uniform2f(e.locDestStart, l, p)), l = r[4], p = r[5], e.locDestEnd && (l !== e.lpDestEndX || p !== e.lpDestEndY) && (e.lpDestEndX = l, e.lpDestEndY = p, t.uniform2f(e.locDestEnd, l, p)), l = r[6], e.locLayerScale && l !== e.lpLayerScale && (e.lpLayerScale = l, t.uniform1f(e.locLayerScale, l)), l = r[7], e.locLayerAngle && l !== e.lpLayerAngle && (e.lpLayerAngle = l, t.uniform1f(e.locLayerAngle, l)), l = r[12], p = r[13], e.locSrcStart && (l !== e.lpSrcStartX || p !== e.lpSrcStartY) && (e.lpSrcStartX = l, e.lpSrcStartY = p, t.uniform2f(e.locSrcStart, l, p)), l = r[14], p = r[15], e.locSrcEnd && (l !== e.lpSrcEndX || p !== e.lpSrcEndY) && (e.lpSrcEndX = l, e.lpSrcEndY = p, t.uniform2f(e.locSrcEnd, l, p)), l = a[0], p = a[1], e.locSrcOriginStart && (l !== e.lpSrcOriginStartX || p !== e.lpSrcOriginStartY) && (e.lpSrcOriginStartX = l, e.lpSrcOriginStartY = p, t.uniform2f(e.locSrcOriginStart, l, p)), l = a[2], p = a[3], e.locSrcOriginEnd && (l !== e.lpSrcOriginEndX || p !== e.lpSrcOriginEndY) && (e.lpSrcOriginEndX = l, e.lpSrcOriginEndY = p, t.uniform2f(e.locSrcOriginEnd, l, p)), l = n[0], p = n[1], e.locLayoutStart && (l !== e.lpLayoutStartX || p !== e.lpLayoutStartY) && (e.lpLayoutStartX = l, e.lpLayoutStartY = p, t.uniform2f(e.locLayoutStart, l, p)), l = n[2], p = n[3], e.locLayoutEnd && (l !== e.lpLayoutEndX || p !== e.lpLayoutEndY) && (e.lpLayoutEndX = l, e.lpLayoutEndY = p, t.uniform2f(e.locLayoutEnd, l, p)), l = this.startIndex, e.locSeconds && l !== e.lpSeconds && (e.lpSeconds = l, t.uniform1f(e.locSeconds, l)), e.parameters.length)
                for (o = 0, s = e.parameters.length; o < s; o++) l = this.shaderParams[o], Array.isArray(l) ? t.uniform3fv(e.parameters[o][1], l) : l !== e.lastCustomParams[o] && (e.lastCustomParams[o] = l, t.uniform1f(e.parameters[o][1], l))
        }, e.prototype.pushBatch = function() {
            return this.batchPtr === this.batch.length && this.batch.push(new n(0, this)), this.batch[this.batchPtr++]
        }, e.prototype.endBatch = function() {
            if (0 !== this.batchPtr && !this.gl.isContextLost()) {
                this.maybeStartTiming();
                var e = this.gl;
                if (0 < this.pointPtr && (e.bindBuffer(e.ARRAY_BUFFER, this.pointBuffer), e.bufferSubData(e.ARRAY_BUFFER, 0, this.pointData.subarray(0, this.pointPtr)), t && 0 <= t.locAPos && "<point>" === t.name && e.vertexAttribPointer(t.locAPos, 4, e.FLOAT, !1, 0, 0)), 0 < this.vertexPtr) {
                    var t = this.currentShader;
                    e.bindBuffer(e.ARRAY_BUFFER, this.vertexBuffers[this.curBuffer]), e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertexData.subarray(0, this.vertexPtr)), t && 0 <= t.locAPos && "<point>" !== t.name && e.vertexAttribPointer(t.locAPos, this.enableFrontToBack ? 3 : 2, e.FLOAT, !1, 0, 0), e.bindBuffer(e.ARRAY_BUFFER, this.texcoordBuffers[this.curBuffer]), e.bufferSubData(e.ARRAY_BUFFER, 0, this.texcoordData.subarray(0, this.texPtr)), t && 0 <= t.locATex && "<point>" !== t.name && e.vertexAttribPointer(t.locATex, 2, e.FLOAT, !1, 0, 0)
                }
                var r, n, a;
                for (r = 0, n = this.batchPtr; r < n; r++) switch (a = this.batch[r], a.type) {
                    case 1:
                        a.doQuad();
                        break;
                    case 2:
                        a.doSetTexture();
                        break;
                    case 3:
                        a.doSetOpacity();
                        break;
                    case 4:
                        a.doSetBlend();
                        break;
                    case 5:
                        a.doUpdateModelView();
                        break;
                    case 6:
                        a.doRenderToTexture();
                        break;
                    case 7:
                        a.doClear();
                        break;
                    case 8:
                        a.doPoints();
                        break;
                    case 9:
                        a.doSetProgram();
                        break;
                    case 10:
                        a.doSetProgramParameters();
                        break;
                    case 11:
                        a.doSetTexture1();
                        break;
                    case 12:
                        a.doSetColor();
                        break;
                    case 13:
                        a.doSetDepthTestEnabled();
                        break;
                    case 14:
                        a.doSetEarlyZPass();
                }
                this.batchPtr = 0, this.vertexPtr = 0, this.texPtr = 0, this.pointPtr = 0, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1, this.isBatchInEarlyZPass = !1, this.curBuffer++, 4 <= this.curBuffer && (this.curBuffer = 0)
            }
        }, e.prototype.maybeStartTiming = function() {
            if (!this.isTiming && this.timerExt) {
                this.isTiming = !0;
                var e = {
                    frameNumber: this.frameNumber,
                    query: null,
                    result: 0
                };
                if (2 === this.version ? (e.query = this.gl.createQuery(), this.gl.beginQuery(this.timerExt.TIME_ELAPSED_EXT, e.query)) : (e.query = this.timerExt.createQueryEXT(), this.timerExt.beginQueryEXT(this.timerExt.TIME_ELAPSED_EXT, e.query)), this.timerResults.push(e), 1e3 < this.timerResults.length) {
                    var t = this.timerResults.shift();
                    t.query && (2 === this.version ? this.gl.deleteQuery(t.query) : this.timerExt.deleteQueryEXT(t.query))
                }
            }
        }, e.prototype.maybeFinishTiming = function() {
            if (this.isTiming && this.timerResults.length) {
                this.timerResults[this.timerResults.length - 1];
                2 === this.version ? this.gl.endQuery(this.timerExt.TIME_ELAPSED_EXT) : this.timerExt.endQueryEXT(this.timerExt.TIME_ELAPSED_EXT), this.isTiming = !1
            }
        }, e.prototype.checkForTimerResults = function(e) {
            var t, r, n, a, s;
            for (t = 0, r = this.timerResults.length; t < r; ++t) {
                if (n = this.timerResults[t], n.frameNumber >= e) return;
                n.query && (a = 2 === this.version ? this.gl.getQueryParameter(n.query, this.gl.QUERY_RESULT_AVAILABLE) : this.timerExt.getQueryObjectEXT(n.query, this.timerExt.QUERY_RESULT_AVAILABLE_EXT), s = this.gl.getParameter(this.timerExt.GPU_DISJOINT_EXT), a && !s && (n.result = 2 === this.version ? this.gl.getQueryParameter(n.query, this.gl.QUERY_RESULT) : this.timerExt.getQueryObjectEXT(n.query, this.timerExt.QUERY_RESULT_EXT), n.result /= 1e9), (a || s) && (2 === this.version ? this.gl.deleteQuery(n.query) : this.timerExt.deleteQueryEXT(n.query), n.query = null))
            }
        }, e.prototype.getFrameRangeTimerResults = function(e, t) {
            if (t <= e) return -1;
            var r = 0,
                n = 0,
                a, s, l;
            for (a = 0, s = this.timerResults.length; a < s && (l = this.timerResults[a], !(l.frameNumber >= t)); ++a)
                if (l.frameNumber >= e) {
                    if (l.query) return -1;
                    r += l.result, n++
                }
            return n < t - e ? -1 : r
        }, e.prototype.deleteTimerResultsToFrame = function(e) {
            var t, r, n;
            for (t = 0, r = this.timerResults.length; t < r; ++t)
                if (n = this.timerResults[t], n.frameNumber >= e) return void(0 < t && this.timerResults.splice(0, t))
        }, e.prototype.setOpacity = function(e) {
            if (e !== this.lastOpacity && !this.isEarlyZPass) {
                var t = this.pushBatch();
                t.type = 3, t.opacityParam = e, this.lastOpacity = e, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.setTexture = function(e) {
            if (e !== this.lastTexture0) {
                var t = this.pushBatch();
                t.type = 2, t.texParam = e, this.lastTexture0 = e, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.setBlend = function(e, t) {
            if ((e !== this.lastSrcBlend || t !== this.lastDestBlend) && !this.isEarlyZPass) {
                var r = this.pushBatch();
                r.type = 4, r.startIndex = e, r.indexCount = t, this.lastSrcBlend = e, this.lastDestBlend = t, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.isPremultipliedAlphaBlend = function() {
            return this.lastSrcBlend === this.gl.ONE && this.lastDestBlend === this.gl.ONE_MINUS_SRC_ALPHA
        }, e.prototype.setAlphaBlend = function() {
            this.setBlend(this.gl.ONE, this.gl.ONE_MINUS_SRC_ALPHA)
        }, e.prototype.setNoPremultiplyAlphaBlend = function() {
            this.setBlend(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA)
        };
        e.prototype.quad = function(e, r, n, a, o, i, s, l) {
            this.vertexPtr >= 15992 && this.endBatch();
            var p = this.vertexPtr,
                d = this.texPtr,
                c = this.vertexData,
                u = this.texcoordData,
                g = this.currentZ;
            if (this.hasQuadBatchTop) this.batch[this.batchPtr - 1].indexCount += 6;
            else {
                var y = this.pushBatch();
                y.type = 1, y.startIndex = this.enableFrontToBack ? p : 3 * (p / 2), y.indexCount = 6, this.hasQuadBatchTop = !0, this.hasPointBatchTop = !1
            }
            this.enableFrontToBack ? (c[p++] = e, c[p++] = r, c[p++] = g, c[p++] = n, c[p++] = a, c[p++] = g, c[p++] = o, c[p++] = i, c[p++] = g, c[p++] = s, c[p++] = l, c[p++] = g) : (c[p++] = e, c[p++] = r, c[p++] = n, c[p++] = a, c[p++] = o, c[p++] = i, c[p++] = s, c[p++] = l), u[d++] = 0, u[d++] = 0, u[d++] = 1, u[d++] = 0, u[d++] = 1, u[d++] = 1, u[d++] = 0, u[d++] = 1, this.vertexPtr = p, this.texPtr = d
        }, e.prototype.quadTex = function(e, r, n, a, o, i, s, l, p) {
            this.vertexPtr >= 15992 && this.endBatch();
            var d = this.vertexPtr,
                c = this.texPtr,
                u = this.vertexData,
                g = this.texcoordData,
                y = this.currentZ;
            if (this.hasQuadBatchTop) this.batch[this.batchPtr - 1].indexCount += 6;
            else {
                var m = this.pushBatch();
                m.type = 1, m.startIndex = this.enableFrontToBack ? d : 3 * (d / 2), m.indexCount = 6, this.hasQuadBatchTop = !0, this.hasPointBatchTop = !1
            }
            var _ = p.left,
                h = p.top,
                f = p.right,
                b = p.bottom;
            this.enableFrontToBack ? (u[d++] = e, u[d++] = r, u[d++] = y, u[d++] = n, u[d++] = a, u[d++] = y, u[d++] = o, u[d++] = i, u[d++] = y, u[d++] = s, u[d++] = l, u[d++] = y) : (u[d++] = e, u[d++] = r, u[d++] = n, u[d++] = a, u[d++] = o, u[d++] = i, u[d++] = s, u[d++] = l), g[c++] = _, g[c++] = h, g[c++] = f, g[c++] = h, g[c++] = f, g[c++] = b, g[c++] = _, g[c++] = b, this.vertexPtr = d, this.texPtr = c
        }, e.prototype.quadTexUV = function(e, r, n, a, o, i, s, l, p, d, c, u, g, y, m, _) {
            this.vertexPtr >= 15992 && this.endBatch();
            var h = this.vertexPtr,
                f = this.texPtr,
                x = this.vertexData,
                w = this.texcoordData,
                S = this.currentZ;
            if (this.hasQuadBatchTop) this.batch[this.batchPtr - 1].indexCount += 6;
            else {
                var T = this.pushBatch();
                T.type = 1, T.startIndex = this.enableFrontToBack ? h : 3 * (h / 2), T.indexCount = 6, this.hasQuadBatchTop = !0, this.hasPointBatchTop = !1
            }
            this.enableFrontToBack ? (x[h++] = e, x[h++] = r, x[h++] = S, x[h++] = n, x[h++] = a, x[h++] = S, x[h++] = o, x[h++] = i, x[h++] = S, x[h++] = s, x[h++] = l, x[h++] = S) : (x[h++] = e, x[h++] = r, x[h++] = n, x[h++] = a, x[h++] = o, x[h++] = i, x[h++] = s, x[h++] = l), w[f++] = p, w[f++] = d, w[f++] = c, w[f++] = u, w[f++] = g, w[f++] = y, w[f++] = m, w[f++] = _, this.vertexPtr = h, this.texPtr = f
        }, e.prototype.convexPoly = function(e) {
            var t = e.length / 2;
            var r = t - 2,
                n = e[0],
                a = e[1],
                o, s, l, p, d, c, u, g;
            for (o = 0; o < r; o += 2) s = 2 * o, l = e[s + 2], p = e[s + 3], d = e[s + 4], c = e[s + 5], o === r - 1 ? this.quad(n, a, l, p, d, c, d, c) : (u = e[s + 6], g = e[s + 7], this.quad(n, a, l, p, d, c, u, g))
        };
        e.prototype.point = function(e, t, r, n) {
            this.pointPtr >= 7996 && this.endBatch();
            var a = this.pointPtr,
                o = this.pointData;
            if (this.hasPointBatchTop) this.batch[this.batchPtr - 1].indexCount++;
            else {
                var i = this.pushBatch();
                i.type = 8, i.startIndex = a, i.indexCount = 1, this.hasPointBatchTop = !0, this.hasQuadBatchTop = !1
            }
            o[a++] = e, o[a++] = t, o[a++] = r, o[a++] = n, this.pointPtr = a
        }, e.prototype.switchProgram = function(e) {
            if (this.lastProgram !== e) {
                var t = this.shaderPrograms[e];
                if (!t) {
                    if (0 === this.lastProgram) return;
                    e = 0, t = this.shaderPrograms[0]
                }
                var r = this.pushBatch();
                r.type = 9, r.startIndex = e, this.lastProgram = e, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.programUsesDest = function(e) {
            var t = this.shaderPrograms[e];
            return !!(t.locDestStart || t.locDestEnd)
        }, e.prototype.programUsesCrossSampling = function(e) {
            var t = this.shaderPrograms[e];
            return !!(t.locDestStart || t.locDestEnd || t.crossSampling)
        }, e.prototype.programPreservesOpaqueness = function(e) {
            return this.shaderPrograms[e].preservesOpaqueness
        }, e.prototype.programExtendsBox = function(e) {
            var t = this.shaderPrograms[e];
            return 0 !== t.extendBoxHorizontal || 0 !== t.extendBoxVertical
        }, e.prototype.getProgramBoxExtendHorizontal = function(e) {
            return this.shaderPrograms[e].extendBoxHorizontal
        }, e.prototype.getProgramBoxExtendVertical = function(e) {
            return this.shaderPrograms[e].extendBoxVertical
        }, e.prototype.getProgramParameterType = function(e, t) {
            return this.shaderPrograms[e].parameters[t][2]
        }, e.prototype.programIsAnimated = function(e) {
            return this.shaderPrograms[e].animated
        }, e.prototype.setProgramParameters = function(e, t, r, n, a, o, l, p, d, c, u, g, y, m, _, h, f, x, v, w, S, T, O) {
            var E = this.shaderPrograms[this.lastProgram],
                s, C, A, P, L, I, R;
            if (E.hasAnyOptionalUniforms || O.length) {
                if (A = this.pushBatch(), A.type = 10, A.mat4param ? mat4.set(this.matMV, A.mat4param) : A.mat4param = mat4.create(), P = A.mat4param, P[0] = t, P[1] = r, P[2] = h, P[3] = f, P[4] = x, P[5] = v, P[6] = w, P[7] = S, P[12] = n, P[13] = a, P[14] = o, P[15] = l, I = A.srcOriginRect, I[0] = p, I[1] = d, I[2] = c, I[3] = u, R = A.layoutRect, R[0] = g, R[1] = _, R[2] = m, R[3] = y, A.startIndex = T, (A.texParam = E.locSamplerBack ? e : null, O.length))
                    for (L = A.shaderParams, L.length = O.length, (s = 0, C = O.length); s < C; s++) L[s] = O[s];
                this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.clear = function(e, t, r, n) {
            var a = this.pushBatch();
            a.type = 7, a.startIndex = 0, a.mat4param || (a.mat4param = mat4.create()), a.mat4param[0] = e, a.mat4param[1] = t, a.mat4param[2] = r, a.mat4param[3] = n, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
        }, e.prototype.clearRect = function(e, t, r, n) {
            if (!(0 > r || 0 > n)) {
                var a = this.pushBatch();
                a.type = 7, a.startIndex = 1, a.mat4param || (a.mat4param = mat4.create()), a.mat4param[0] = e, a.mat4param[1] = t, a.mat4param[2] = r, a.mat4param[3] = n, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.clearDepth = function() {
            var e = this.pushBatch();
            e.type = 7, e.startIndex = 2, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
        }, e.prototype.setEarlyZPass = function(t) {
            if (this.enableFrontToBack && (t = !!t, this.isEarlyZPass !== t)) {
                var r = this.pushBatch();
                r.type = 14, r.startIndex = t ? 1 : 0, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1, this.isEarlyZPass = t, this.renderToTex = null, this.isEarlyZPass ? this.switchProgram(2) : this.switchProgram(0)
            }
        }, e.prototype.setDepthTestEnabled = function(t) {
            if (this.enableFrontToBack) {
                var e = this.pushBatch();
                e.type = 13, e.startIndex = t ? 1 : 0, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, e.prototype.fullscreenQuad = function() {
            mat4.set(this.lastMV, a), this.resetModelView(), this.updateModelView();
            var e = this.width / 2,
                t = this.height / 2;
            this.quad(-e, t, e, t, e, -t, -e, -t), mat4.set(a, this.matMV), this.updateModelView()
        }, e.prototype.setColorFillMode = function(e, t, r, n) {
            this.switchProgram(3);
            var a = this.pushBatch();
            a.type = 12, a.mat4param || (a.mat4param = mat4.create()), a.mat4param[0] = e, a.mat4param[1] = t, a.mat4param[2] = r, a.mat4param[3] = n, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
        }, e.prototype.setTextureFillMode = function() {
            this.switchProgram(0)
        }, e.prototype.restoreEarlyZMode = function() {
            this.switchProgram(2)
        }, e.prototype.getFrameNumber = function() {
            return this.frameNumber
        }, e.prototype.present = function() {
            this.endBatch(), this.maybeFinishTiming(), this.gl.flush(), this.checkForTimerResults(this.frameNumber), this.frameNumber++
        }, e.prototype.supportsGpuProfiling = function() {
            return !!this.timerExt
        };
        var o = [],
            i = {};
        e.prototype.contextLost = function() {
            cr.clearArray(o), i = {}
        };
        e.prototype.loadTexture = function(e, t, r, n, a, s) {
            t = !!t, r = !!r;
            var l = e.src + "," + t + "," + r + (t ? "," + a : ""),
                p = null;
            if ("undefined" != typeof e.src && i.hasOwnProperty(l)) return p = i[l], p.c2refcount++, p;
            this.endBatch();
            var d = this.gl,
                c = cr.isPOT(e.width) && cr.isPOT(e.height);
            p = d.createTexture(), d.bindTexture(d.TEXTURE_2D, p), d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !0);
            var u = d.RGBA,
                g = d.RGBA,
                y = d.UNSIGNED_BYTE;
            if (n && !this.isIE && (1 === n ? (u = d.RGB, g = d.RGB) : 2 === n ? y = d.UNSIGNED_SHORT_4_4_4_4 : 3 === n ? y = d.UNSIGNED_SHORT_5_5_5_1 : 4 === n ? (u = d.RGB, g = d.RGB, y = d.UNSIGNED_SHORT_5_6_5) : void 0), 1 === this.version && !c && t) {
                var m = document.createElement("canvas");
                m.width = cr.nextHighestPowerOfTwo(e.width), m.height = cr.nextHighestPowerOfTwo(e.height);
                var _ = m.getContext("2d");
                _.imageSmoothingEnabled = r, _.drawImage(e, 0, 0, e.width, e.height, 0, 0, m.width, m.height), d.texImage2D(d.TEXTURE_2D, 0, u, g, y, m)
            } else d.texImage2D(d.TEXTURE_2D, 0, u, g, y, e);
            return t ? "repeat-x" === a ? (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_S, d.REPEAT), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_T, d.CLAMP_TO_EDGE)) : "repeat-y" === a ? (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_S, d.CLAMP_TO_EDGE), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_T, d.REPEAT)) : (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_S, d.REPEAT), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_T, d.REPEAT)) : (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_S, d.CLAMP_TO_EDGE), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_T, d.CLAMP_TO_EDGE)), r ? (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MAG_FILTER, d.LINEAR), (c || 2 <= this.version) && this.enable_mipmaps && !s ? (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MIN_FILTER, d.LINEAR_MIPMAP_LINEAR), d.generateMipmap(d.TEXTURE_2D)) : d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MIN_FILTER, d.LINEAR)) : (d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MAG_FILTER, d.NEAREST), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MIN_FILTER, d.NEAREST)), d.bindTexture(d.TEXTURE_2D, null), this.lastTexture0 = null, p.c2width = e.width, p.c2height = e.height, p.c2refcount = 1, p.c2texkey = l, o.push(p), i[l] = p, p
        }, e.prototype.createEmptyTexture = function(e, t, r, n, a) {
            this.endBatch();
            var i = this.gl;
            this.isIE && (n = !1);
            var s = i.createTexture();
            return i.bindTexture(i.TEXTURE_2D, s), i.texImage2D(i.TEXTURE_2D, 0, i.RGBA, e, t, 0, i.RGBA, n ? i.UNSIGNED_SHORT_4_4_4_4 : i.UNSIGNED_BYTE, null), a ? (i.texParameteri(i.TEXTURE_2D, i.TEXTURE_WRAP_S, i.REPEAT), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_WRAP_T, i.REPEAT)) : (i.texParameteri(i.TEXTURE_2D, i.TEXTURE_WRAP_S, i.CLAMP_TO_EDGE), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_WRAP_T, i.CLAMP_TO_EDGE)), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_MAG_FILTER, r ? i.LINEAR : i.NEAREST), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_MIN_FILTER, r ? i.LINEAR : i.NEAREST), i.bindTexture(i.TEXTURE_2D, null), this.lastTexture0 = null, s.c2width = e, s.c2height = t, o.push(s), s
        }, e.prototype.videoToTexture = function(e, t, r) {
            this.endBatch();
            var n = this.gl;
            this.isIE && (r = !1), n.bindTexture(n.TEXTURE_2D, t), n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !0);
            try {
                n.texImage2D(n.TEXTURE_2D, 0, n.RGBA, n.RGBA, r ? n.UNSIGNED_SHORT_4_4_4_4 : n.UNSIGNED_BYTE, e)
            } catch (t) {
                console && console.error && console.error("Error updating WebGL texture: ", t)
            }
            n.bindTexture(n.TEXTURE_2D, null), this.lastTexture0 = null
        }, e.prototype.deleteTexture = function(e) {
            return e ? "undefined" != typeof e.c2refcount && 1 < e.c2refcount ? void e.c2refcount-- : void(this.endBatch(), e === this.lastTexture0 && (this.gl.bindTexture(this.gl.TEXTURE_2D, null), this.lastTexture0 = null), e === this.lastTexture1 && (this.gl.activeTexture(this.gl.TEXTURE1), this.gl.bindTexture(this.gl.TEXTURE_2D, null), this.gl.activeTexture(this.gl.TEXTURE0), this.lastTexture1 = null), cr.arrayFindRemove(o, e), "undefined" != typeof e.c2texkey && delete i[e.c2texkey], this.gl.deleteTexture(e)) : void 0
        }, e.prototype.estimateVRAM = function() {
            var e = 2 * (4 * (this.width * this.height)),
                r, n, a;
            for (r = 0, n = o.length; r < n; r++) a = o[r], e += 4 * (a.c2width * a.c2height);
            return e
        }, e.prototype.textureCount = function() {
            return o.length
        }, e.prototype.setRenderingToTexture = function(e) {
            if (e !== this.renderToTex) {
                var t = this.pushBatch();
                t.type = 6, t.texParam = e, this.renderToTex = e, this.hasQuadBatchTop = !1, this.hasPointBatchTop = !1
            }
        }, cr.GLWrap = e
    }();
(function() {
    function e(e) {
        var t = e.canvas,
            r = e.projectDataUrl;
        if (t || (t = document.createElement("canvas"), document.body.appendChild(t)), t && t.getContext) {
            window.c3runtime = this, window.c3canvas = t;
            var n = this;
            if (this.exportType = e.exportType, this.isPreview = "preview" === this.exportType, this.isRemotePreview = !!e.isRemotePreview, this.isCrosswalk = /crosswalk/i.test(navigator.userAgent) || /xwalk/i.test(navigator.userAgent) || !!("undefined" != typeof window.c2isCrosswalk && window.c2isCrosswalk), this.isCordova = "cordova" === this.exportType, this.isPhoneGap = this.isCordova, this.isMicrosoftEdge = /edge\//i.test(navigator.userAgent), this.isIE = (/msie/i.test(navigator.userAgent) || /trident/i.test(navigator.userAgent) || /iemobile/i.test(navigator.userAgent)) && !this.isMicrosoftEdge, this.isTizen = /tizen/i.test(navigator.userAgent), this.isAndroid = /android/i.test(navigator.userAgent) && !this.isTizen && !this.isIE && !this.isMicrosoftEdge, this.isiPhone = (/iphone/i.test(navigator.userAgent) || /ipod/i.test(navigator.userAgent)) && !this.isIE && !this.isMicrosoftEdge, this.isiPad = /ipad/i.test(navigator.userAgent), this.isiOS = this.isiPhone || this.isiPad, this.isChrome = (/chrome/i.test(navigator.userAgent) || /chromium/i.test(navigator.userAgent)) && !this.isIE && !this.isMicrosoftEdge, this.isAmazonWebApp = /amazonwebappplatform/i.test(navigator.userAgent), this.isFirefox = /firefox/i.test(navigator.userAgent), this.isSafari = /safari/i.test(navigator.userAgent) && !this.isChrome && !this.isIE && !this.isMicrosoftEdge, this.isWindows = /windows/i.test(navigator.userAgent), this.isNWjs = "nwjs" === this.exportType || /nodewebkit/i.test(navigator.userAgent) || /nwjs/i.test(navigator.userAgent), this.isNodeWebkit = this.isNWjs, this.isArcade = "scirra-arcade" === this.exportType, this.isWindows8App = !!("undefined" != typeof window.c2isWindows8 && window.c2isWindows8), this.isWindowsPhone8 = !!("undefined" != typeof window.c2isWindowsPhone8 && window.c2isWindowsPhone8), this.isWindowsPhone81 = !!("undefined" != typeof window.c2isWindowsPhone81 && window.c2isWindowsPhone81), this.isWindows10 = "windows-uwp" === this.exportType, this.isWinJS = this.isWindows8App || this.isWindowsPhone81 || this.isWindows10, this.isBlackberry10 = !!("undefined" != typeof window.c2isBlackberry10 && window.c2isBlackberry10), this.isAndroidStockBrowser = this.isAndroid && !this.isChrome && !this.isCrosswalk && !this.isFirefox && !this.isAmazonWebApp, this.devicePixelRatio = 1, this.isMobile = this.isCordova || this.isCrosswalk || this.isAndroid || this.isiOS || this.isWindowsPhone8 || this.isWindowsPhone81 || this.isBlackberry10 || this.isTizen, this.isMobile || (this.isMobile = /(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent)), this.isWKWebView = !!(this.isiOS && this.isCordova), this.isPreview && !this.isNWjs && ("?nw" === window.location.search || /nodewebkit/i.test(navigator.userAgent) || /nwjs/i.test(navigator.userAgent)) && (this.isNWjs = !0), this.isDebug = this.isPreview && -1 < window.location.search.indexOf("debug"), this.useFbInstant = "undefined" != typeof FBInstant && !this.isPreview && !this.isCordova, this.hasInitialized = !1, this.canvas = t, this.gl = null, this.glwrap = null, this.glUnmaskedRenderer = "(unavailable)", this.enableFrontToBack = !1, this.earlyz_index = 0, this.ctx = null, this.firstInFullscreen = !1, this.oldWidth = 0, this.oldHeight = 0, this.canvas.oncontextmenu = function(t) {
                    return t.preventDefault && t.preventDefault(), !1
                }, this.canvas.onselectstart = function(t) {
                    return t.preventDefault && t.preventDefault(), !1
                }, this.canvas.ontouchstart = function(t) {
                    return t.preventDefault && t.preventDefault(), !1
                }, this.isNWjs && (window.ondragover = function(t) {
                    return t.preventDefault(), !1
                }, window.ondrop = function(t) {
                    return t.preventDefault(), !1
                }, window.nwgui && window.nwgui.App.clearCache && window.nwgui.App.clearCache()), this.isCordova && this.isiOS) {
                function e(e) {
                    do {
                        if (e.parentNode && e.hasAttribute("contenteditable")) return !0;
                        e = e.parentNode
                    } while (e);
                    return !1
                }

                function t() {
                    var t = document.activeElement;
                    if (!t) return !1;
                    var r = t.tagName.toLowerCase();
                    return "textarea" === r || ("input" === r ? -1 < ["email", "number", "password", "search", "tel", "text", "url"].indexOf(t.type.toLowerCase() || "text") : e(t))
                }
                window.addEventListener("focusout", () => {
                    t() || (document.scrollingElement.scrollTop = 0)
                })
            }
            this.projectDataUrl = r || "", this.width = t.width, this.height = t.height, this.draw_width = this.width, this.draw_height = this.height, this.cssWidth = this.width, this.cssHeight = this.height, this.lastWindowWidth = window.innerWidth, this.lastWindowHeight = window.innerHeight, this.forceCanvasAlpha = !1, this.redraw = !0, this.isSuspended = !1, Date.now || (Date.now = function() {
                return +new Date
            }), this.plugins = [], this.types = {}, this.types_lowercase = {}, this.types_by_index = [], this.behaviors = [], this.layouts = {}, this.layouts_by_index = [], this.eventsheets = {}, this.eventsheets_by_index = [], this.wait_for_textures = [], this.triggers_to_postinit = [], this.all_global_vars = [], this.all_local_vars = [], this.solidBehavior = null, this.jumpthruBehavior = null, this.shadowcasterBehavior = null, this.deathRow = {}, this.hasPendingInstances = !1, this.isInClearDeathRow = !1, this.isInOnDestroy = 0, this.isRunningEvents = !1, this.isEndingLayout = !1, this.createRow = [], this.isLoadingState = !1, this.saveToSlot = "", this.loadFromSlot = "", this.loadFromJson = null, this.lastSaveJson = "", this.signalledContinuousPreview = !1, this.suspendDrawing = !1, this.fireOnCreateAfterLoad = [], this.dt = 0, this.dt1 = 0, this.minimumFramerate = 30, this.logictime = 0, this.cpuutilisation = 0, this.timescale = 1, this.kahanTime = new cr.KahanAdder, this.wallTime = new cr.KahanAdder, this.last_tick_time = 0, this.fps = 0, this.last_fps_time = 0, this.tickcount = 0, this.tickcount_nosave = 0, this.execcount = 0, this.framecount = 0, this.objectcount = 0, this.gpuTimeStartFrame = 0, this.gpuTimeEndFrame = 0, this.gpuCurUtilisation = -1, this.gpuLastUtilisation = 0, this.changelayout = null, this.destroycallbacks = [], this.event_stack = [], this.event_stack_index = -1, this.localvar_stack = [
                []
            ], this.localvar_stack_index = 0, this.trigger_depth = 0, this.pushEventStack(null), this.loop_stack = [], this.loop_stack_index = -1, this.next_uid = 0, this.next_puid = 0, this.layout_first_tick = !0, this.family_count = 0, this.suspend_events = [], this.raf_id = -1, this.timeout_id = -1, this.isloading = !0, this.loadingprogress = 0, this.stackLocalCount = 0, this.audioInstance = null, this.had_a_click = !1, this.isInUserInputEvent = !1, this.objects_to_pretick = new cr.ObjectSet, this.objects_to_tick = new cr.ObjectSet, this.objects_to_tick2 = new cr.ObjectSet, this.registered_collisions = [], this.temp_poly = new cr.CollisionPoly([]), this.temp_poly2 = new cr.CollisionPoly([]), this.allGroups = [], this.groups_by_name = {}, this.cndsBySid = {}, this.actsBySid = {}, this.varsBySid = {}, this.blocksBySid = {}, this.running_layout = null, this.layer_canvas = null, this.layer_ctx = null, this.layer_tex = null, this.layout_tex = null, this.layout_canvas = null, this.layout_ctx = null, this.is_WebGL_context_lost = !1, this.uses_background_blending = !1, this.fx_tex = [null, null], this.fullscreen_scaling = 0, this.files_subfolder = "", this.objectsByUid = {}, this.loaderlogos = null, this.webFontNames = null, this.enhancedAccelerationPrecision = !0, this.snapshotCanvas = null, this.snapshotData = "", this.objectRefTable = [], "html5" === this.exportType && "file" === location.protocol.substr(0, 4), this.useFbInstant ? (FBInstant.initializeAsync().then(function() {
                n.requestProjectData()
            }).catch(function(e) {
                console.warn("[Instant Games] Unable to load: ", e), n.requestProjectData()
            }), window.setTimeout(function() {
                n.hasInitialized || (console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."), n.useFbInstant = !1, n.requestProjectData())
            }, 4e3)) : this.requestProjectData()
        }
    }

    function t(e, t) {
        B && B.width === e && B.height === t || (B = document.createElement("canvas"), B.width = e, B.height = t, F = B.getContext("2d"))
    }

    function r(e, t) {
        return 128 >= t ? e[2] : 256 >= t ? e[1] : e[0]
    }

    function n() {
        return j.length ? j.pop() : new cr.ObjectSet
    }

    function a(e) {
        e.clear(), j.push(e)
    }

    function o() {
        var e = window.cordova && window.cordova.plugins && window.cordova.plugins.permissions;
        return "object" != typeof e && Promise.reject("Permission API is not loaded"), Promise.resolve(e)
    }

    function i(e) {
        return o().then(function(t) {
            return new Promise(function(r, n) {
                t.requestPermission(t[e], function(e) {
                    r(e.hasPermission)
                }, n)
            })
        })
    }

    function s(e) {
        return o().then(function(t) {
            return new Promise(function(r, n) {
                t.checkPermission(t[e], function(e) {
                    r(e.hasPermission)
                }, n)
            })
        })
    }

    function l() {
        try {
            return !!window.indexedDB
        } catch (t) {
            return !1
        }
    }

    function p(t) {
        var e = t.target.result;
        e.createObjectStore("saves", {
            keyPath: "slot"
        })
    }

    function d(t, r, n, a) {
        try {
            var e = indexedDB.open("_C2SaveStates");
            e.onupgradeneeded = p, e.onerror = a, e.onsuccess = function(o) {
                var e = o.target.result;
                e.onerror = a;
                var i = e.transaction(["saves"], "readwrite"),
                    s = i.objectStore("saves"),
                    l = s.put({
                        slot: t,
                        data: r
                    });
                l.onsuccess = n
            }
        } catch (e) {
            a(e)
        }
    }

    function c(t, e, r) {
        try {
            var n = indexedDB.open("_C2SaveStates");
            n.onupgradeneeded = p, n.onerror = r, n.onsuccess = function(n) {
                var a = n.target.result;
                a.onerror = r;
                var o = a.transaction(["saves"]),
                    i = o.objectStore("saves"),
                    s = i.get(t);
                s.onsuccess = function() {
                    s.result ? e(s.result.data) : e(null)
                }
            }
        } catch (e) {
            r(e)
        }
    }

    function u() {
        cr.logexport("Reloading for continuous preview"), -1 < window.location.search.indexOf("continuous") ? window.location.reload(!0) : window.location += "?continuous"
    }

    function g(e) {
        var t = {},
            r;
        for (r in e)
            if (e.hasOwnProperty(r)) {
                if (e[r] instanceof cr.ObjectSet) continue;
                if (e[r] && "undefined" != typeof e[r].c2userdata) continue;
                if ("spriteCreatedDestroyCallback" === r) continue;
                t[r] = e[r]
            }
        return t
    }
    var y = Math.ceil,
        m = Math.round,
        _ = Math.floor,
        f = Math.max,
        b = Math.min,
        h = Math.cos,
        x = Math.sin,
        v = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame,
        w = new Audio,
        S = {
            "audio/webm; codecs=opus": !!w.canPlayType("audio/webm; codecs=opus"),
            "audio/ogg; codecs=opus": !!w.canPlayType("audio/ogg; codecs=opus"),
            "audio/webm; codecs=vorbis": !!w.canPlayType("audio/webm; codecs=vorbis"),
            "audio/ogg; codecs=vorbis": !!w.canPlayType("audio/ogg; codecs=vorbis"),
            "audio/mp4": !!w.canPlayType("audio/mp4"),
            "audio/mpeg": !!w.canPlayType("audio/mpeg")
        };
    w = null;
    e.prototype.requestProjectData = function() {
        if (!this.hasInitialized) {
            this.hasInitialized = !0;
            var e = this;
            if (this.isWKWebView) return void this.fetchLocalFileViaCordovaAsText("data.js", function(t) {
                e.loadProject(JSON.parse(t))
            }, function() {
                alert("Error fetching data.js")
            });
            var t = this.isWindowsPhone8 ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest;
            var r = this.projectDataUrl || "data.js";
            (this.isWindows8App || this.isWindowsPhone8 || this.isWindowsPhone81 || this.isWindows10) && (r = "data.json"), t.open("GET", r, !0);
            var n = !1;
            if ("response" in t && "responseType" in t) try {
                t.responseType = "json", n = "json" === t.responseType
            } catch (t) {
                n = !1
            }
            if (!n && "responseType" in t) try {
                t.responseType = "text"
            } catch (t) {}
            if ("overrideMimeType" in t) try {
                t.overrideMimeType("application/json; charset=utf-8")
            } catch (t) {}
            this.isWindowsPhone8 ? t.onreadystatechange = function() {
                4 !== t.readyState || e.loadProject(JSON.parse(t.responseText))
            } : (t.onload = function() {
                n ? e.loadProject(t.response) : e.loadProject(JSON.parse(t.responseText))
            }, t.onerror = function(t) {
                cr.logerror("Error requesting " + r + ":"), cr.logerror(t)
            }), t.send()
        }
    }, e.prototype.initRendererAndLoader = function() {
        var e = this,
            r, n, a, o, p, d, c, u, g, _;
        this.isRetina = this.useHighDpi && !this.isAndroidStockBrowser, 0 === this.fullscreen_mode && this.isiOS && (this.isRetina = !1);
        var h = window.devicePixelRatio || window.webkitDevicePixelRatio || window.mozDevicePixelRatio || window.msDevicePixelRatio || 1;
        this.devicePixelRatio = this.isRetina ? h : 1, "object" == typeof window.StatusBar && window.StatusBar.hide(), "object" == typeof window.AndroidFullScreen && window.AndroidFullScreen.immersiveMode(), this.ClearDeathRow();
        var f;
        0 < this.fullscreen_mode && this.setSize(window.innerWidth, window.innerHeight, !0);
        try {
            this.enableWebGL && (f = {
                alpha: !0,
                depth: !1,
                antialias: !1,
                failIfMajorPerformanceCaveat: !0
            }, !this.isAndroid && (this.gl = this.canvas.getContext("webgl2", f)), !this.gl && (this.gl = this.canvas.getContext("webgl", f) || this.canvas.getContext("experimental-webgl", f)))
        } catch (t) {}
        if (this.gl) {
            var b = 0 === this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2"),
                x = this.gl.getExtension("WEBGL_debug_renderer_info");
            if (x) {
                var v = this.gl.getParameter(x.UNMASKED_VENDOR_WEBGL),
                    w = this.gl.getParameter(x.UNMASKED_RENDERER_WEBGL);
                this.glUnmaskedRenderer = w + " [" + v + "]"
            }
            this.enableFrontToBack && (this.glUnmaskedRenderer += " [front-to-back enabled]");
            for (this.overlay_canvas = document.createElement("canvas"), this.canvas.parentNode.appendChild(this.overlay_canvas), this.overlay_canvas.oncontextmenu = function() {
                    return !1
                }, this.overlay_canvas.onselectstart = function() {
                    return !1
                }, this.overlay_canvas.width = m(this.cssWidth * this.devicePixelRatio), this.overlay_canvas.height = m(this.cssHeight * this.devicePixelRatio), this.overlay_canvas.style.width = this.cssWidth + "px", this.overlay_canvas.style.height = this.cssHeight + "px", this.overlay_canvas.style.position = "absolute", this.overlay_ctx = this.overlay_canvas.getContext("2d"), this.glwrap = new cr.GLWrap(this.gl, this.isMobile, this.enableFrontToBack), this.glwrap.setSize(this.canvas.width, this.canvas.height), this.glwrap.enable_mipmaps = 0 !== this.downscalingQuality, this.ctx = null, this.canvas.addEventListener("webglcontextlost", function(t) {
                    t.preventDefault(), e.onContextLost(), cr.logexport("[Construct 2] WebGL context lost"), window.cr_setSuspended(!0)
                }, !1), this.canvas.addEventListener("webglcontextrestored", function() {
                    e.glwrap.initState(), e.glwrap.setSize(e.glwrap.width, e.glwrap.height, !0), e.layer_tex = null, e.layout_tex = null, e.fx_tex[0] = null, e.fx_tex[1] = null, e.onContextRestored(), e.redraw = !0, cr.logexport("[Construct 2] WebGL context restored"), window.cr_setSuspended(!1)
                }, !1), this.glwrap.supportsGpuProfiling() || (this.gpuLastUtilisation = NaN), (r = 0, n = this.types_by_index.length); r < n; r++)
                for (c = this.types_by_index[r], a = 0, o = c.effect_types.length; a < o; a++) u = c.effect_types[a], u.shaderindex = this.glwrap.getShaderIndex(u.id), u.preservesOpaqueness = this.glwrap.programPreservesOpaqueness(u.shaderindex), this.uses_background_blending = this.uses_background_blending || this.glwrap.programUsesDest(u.shaderindex);
            for (r = 0, n = this.layouts_by_index.length; r < n; r++) {
                for (g = this.layouts_by_index[r], a = 0, o = g.effect_types.length; a < o; a++) u = g.effect_types[a], u.shaderindex = this.glwrap.getShaderIndex(u.id), u.preservesOpaqueness = this.glwrap.programPreservesOpaqueness(u.shaderindex);
                for (g.updateActiveEffects(), a = 0, o = g.layers.length; a < o; a++) {
                    for (_ = g.layers[a], p = 0, d = _.effect_types.length; p < d; p++) u = _.effect_types[p], u.shaderindex = this.glwrap.getShaderIndex(u.id), u.preservesOpaqueness = this.glwrap.programPreservesOpaqueness(u.shaderindex), this.uses_background_blending = this.uses_background_blending || this.glwrap.programUsesDest(u.shaderindex);
                    _.updateActiveEffects()
                }
            }
        } else f = {
            alpha: !0
        }, this.ctx = this.canvas.getContext("2d", f), this.ctx.imageSmoothingEnabled = this.linearSampling, this.overlay_canvas = null, this.overlay_ctx = null, this.gpuLastUtilisation = NaN, this.wantFullscreenScalingQuality = !0, this.fullscreenScalingQuality = !0;
        this.tickFunc = function(t) {
            e.tick(!1, t)
        }, window == window.top || this.isWinJS || this.isWindowsPhone8 || (document.addEventListener("mousedown", function() {
            window.focus()
        }, !0), document.addEventListener("touchstart", function() {
            window.focus()
        }, !0)), this.isPreview && (-1 < window.location.search.indexOf("continuous") && (cr.logexport("Reloading for continuous preview"), this.loadFromSlot = "__c2_continuouspreview", this.suspendDrawing = !0), this.pauseOnBlur && !this.isMobile && (window.addEventListener("focus", function() {
            e.setSuspended(!1)
        }), window.addEventListener("blur", function() {
            var t = window.parent;
            t && t.document.hasFocus() || e.setSuspended(!0)
        }))), window.addEventListener("blur", function() {
            e.onWindowBlur()
        });
        var S = function(t) {
            if ("mousedown" === t.type && 1 === t.button && t.preventDefault(), cr.isCanvasInputEvent(t) && document.activeElement && document.activeElement !== document.getElementsByTagName("body")[0] && document.activeElement.blur) try {
                document.activeElement.blur()
            } catch (t) {}
        };
        "undefined" == typeof PointerEvent ? window.navigator.msPointerEnabled ? document.addEventListener("MSPointerDown", S) : document.addEventListener("touchstart", S) : document.addEventListener("pointerdown", S), document.addEventListener("mousedown", S), 0 === this.fullscreen_mode && this.isRetina && 1 < this.devicePixelRatio ? this.setSize(this.original_width, this.original_height, !0) : this.setSize(window.innerWidth, window.innerHeight, !0), this.tryLockOrientation(), this.getready(), this.go(), this.extra = {}, cr.seal(this)
    }, e.prototype.setSize = function(e, t, r) {
        var n = 0,
            a = 0,
            o = 0,
            i = 0,
            s = 0;
        if (this.lastWindowWidth !== e || this.lastWindowHeight !== t || r) {
            if (this.isiPhone && this.isCordova && window.screen) {
                var l = document.documentElement.style,
                    p = document.body.style,
                    d = window.innerWidth < window.innerHeight,
                    c = d ? window.screen.height : window.screen.width,
                    u = d ? window.screen.width : window.screen.height;
                c && u && (p.height = l.height = c + "px", p.width = l.width = u + "px")
            }
            this.lastWindowWidth = e, this.lastWindowHeight = t;
            var g = this.fullscreen_mode,
                f = (document.mozFullScreen || document.webkitIsFullScreen || !!document.msFullscreenElement || document.fullScreen) && !this.isCordova,
                b, x;
            if (f || 0 !== this.fullscreen_mode || r) {
                f && (g = this.fullscreen_scaling);
                var v = this.devicePixelRatio;
                4 <= g ? (5 === g && 1 !== v && (e += 1, t += 1), b = this.original_width / this.original_height, x = e / t, x > b ? (o = t * b, 5 === g ? (s = o * v / this.original_width, 1 < s ? s = _(s) : 1 > s && (s = 1 / y(1 / s)), o = this.original_width * s / v, i = this.original_height * s / v, n = (e - o) / 2, a = (t - i) / 2, e = o, t = i) : (n = (e - o) / 2, e = o)) : (i = e / b, 5 === g ? (s = i * v / this.original_height, 1 < s ? s = _(s) : 1 > s && (s = 1 / y(1 / s)), o = this.original_width * s / v, i = this.original_height * s / v, n = (e - o) / 2, a = (t - i) / 2, e = o, t = i) : (a = (t - i) / 2, t = i))) : f && 0 === g && (n = _((e - this.original_width) / 2), a = _((t - this.original_height) / 2), e = this.original_width, t = this.original_height), 2 > g && (this.aspect_scale = v), this.cssWidth = m(e), this.cssHeight = m(t), this.width = m(e * v), this.height = m(t * v), this.redraw = !0, this.wantFullscreenScalingQuality ? (this.draw_width = this.width, this.draw_height = this.height, this.fullscreenScalingQuality = !0) : this.width < this.original_width && this.height < this.original_height || 1 === g ? (this.draw_width = this.width, this.draw_height = this.height, this.fullscreenScalingQuality = !0) : (this.draw_width = this.original_width, this.draw_height = this.original_height, this.fullscreenScalingQuality = !1, 2 === g ? (b = this.original_width / this.original_height, x = this.lastWindowWidth / this.lastWindowHeight, x < b ? this.draw_width = this.draw_height * x : x > b && (this.draw_height = this.draw_width / x)) : 3 === g && (b = this.original_width / this.original_height, x = this.lastWindowWidth / this.lastWindowHeight, x > b ? this.draw_width = this.draw_height * x : x < b && (this.draw_height = this.draw_width / x))), this.canvas && (this.canvas.width = m(e * v), this.canvas.height = m(t * v), this.isRetina && (this.canvas.style.width = m(e) + "px", this.canvas.style.height = m(t) + "px"), this.canvas.style.marginLeft = _(n) + "px", this.canvas.style.marginTop = _(a) + "px"), this.overlay_canvas && (this.overlay_canvas.width = m(e * v), this.overlay_canvas.height = m(t * v), this.overlay_canvas.style.width = this.cssWidth + "px", this.overlay_canvas.style.height = this.cssHeight + "px", this.overlay_canvas.style.left = _(n) + "px", this.overlay_canvas.style.top = _(a) + "px"), this.glwrap && this.glwrap.setSize(m(e * v), m(t * v)), this.ctx && (this.ctx.imageSmoothingEnabled = this.linearSampling), this.tryLockOrientation(), this.isiPhone && !this.isCordova && window.scrollTo(0, 0)
            }
        }
    }, e.prototype.tryLockOrientation = function() {
        if (this.autoLockOrientation && 0 !== this.orientations) {
            var e = "portrait";
            2 === this.orientations && (e = "landscape");
            try {
                screen.orientation && screen.orientation.lock ? screen.orientation.lock(e).catch(function() {}) : screen.lockOrientation ? screen.lockOrientation(e) : screen.webkitLockOrientation ? screen.webkitLockOrientation(e) : screen.mozLockOrientation ? screen.mozLockOrientation(e) : screen.msLockOrientation && screen.msLockOrientation(e)
            } catch (t) {
                console && console.warn && console.warn("Failed to lock orientation: ", t)
            }
        }
    }, e.prototype.onContextLost = function() {
        this.glwrap.contextLost(), this.is_WebGL_context_lost = !0;
        var e, r, n;
        for (e = 0, r = this.types_by_index.length; e < r; e++) n = this.types_by_index[e], n.onLostWebGLContext && n.onLostWebGLContext()
    }, e.prototype.onContextRestored = function() {
        this.is_WebGL_context_lost = !1;
        var e, r, n;
        for (e = 0, r = this.types_by_index.length; e < r; e++) n = this.types_by_index[e], n.onRestoreWebGLContext && n.onRestoreWebGLContext()
    };
    var T = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.msCancelAnimationFrame || window.oCancelAnimationFrame;
    e.prototype.setSuspended = function(e) {
        var t = this,
            r, n;
        if (e && !this.isSuspended)
            for (cr.logexport("[Construct 2] Suspending"), this.isSuspended = !0, -1 !== this.raf_id && T(this.raf_id), -1 !== this.timeout_id && clearTimeout(this.timeout_id), (r = 0, n = this.suspend_events.length); r < n; r++) this.suspend_events[r](!0);
        else if (!e && this.isSuspended) {
            for (cr.logexport("[Construct 2] Resuming"), this.isSuspended = !1, this.last_tick_time = cr.performance_now(), this.last_fps_time = cr.performance_now(), this.framecount = 0, this.logictime = 0, (r = 0, n = this.suspend_events.length); r < n; r++) this.suspend_events[r](!1);
            this.tick(!1)
        }
    }, e.prototype.addSuspendCallback = function(e) {
        this.suspend_events.push(e)
    }, e.prototype.GetObjectReference = function(e) {
        return this.objectRefTable[e]
    }, e.prototype.loadProject = function(e) {
        e && e.project || cr.logerror("Project model unavailable");
        var r = e.project;
        if (this.name = r[0], this.first_layout = r[1], this.fullscreen_mode = r[12], this.fullscreen_mode_set = r[12], this.original_width = r[10], this.original_height = r[11], this.parallax_x_origin = this.original_width / 2, this.parallax_y_origin = this.original_height / 2, this.uses_loader_layout = r[18], this.loaderstyle = r[19], this.iconsFolder = r[28], this.webFontNames = r[29].map(function(e) {
                return e[0]
            }), 0 === this.loaderstyle) {
            var n = new Image;
            n.crossOrigin = "anonymous", this.loaderlogos = {
                logo: n
            };
            var a = this.loaderlogos;
            n.addEventListener("error", function() {
                a.logo = null
            });
            var o;
            o = this.isPreview ? this.getProjectFileUrl("loading-logo.png") : this.iconsFolder + "loading-logo.png", this.setImageSrc(n, o)
        } else if (4 === this.loaderstyle) {
            var s = new Image;
            s.src = "splash-images/splash-logo.svg";
            var l = new Image;
            l.src = "splash-images/splash-poweredby-512.png";
            var c = new Image;
            c.src = "splash-images/splash-poweredby-256.png";
            var u = new Image;
            u.src = "splash-images/splash-poweredby-128.png";
            var g = new Image;
            g.src = "splash-images/splash-website-512.png";
            var y = new Image;
            y.src = "splash-images/splash-website-256.png";
            var _ = new Image;
            _.src = "splash-images/splash-website-128.png", this.loaderlogos = {
                logo: s,
                powered: [l, c, u],
                website: [g, y, _]
            }
        }
        this.next_uid = r[21], this.objectRefTable = cr.getObjectRefTable(), this.system = new cr.system_object(this);
        var h, x, v, w, T, O, E, C, A, P, L, I, R, B;
        for (h = 0, x = r[2].length; h < x; h++) E = r[2][h], L = this.GetObjectReference(E[0]), cr.add_common_aces(E, L.prototype), R = new L(this), R.singleglobal = E[1], R.is_world = E[2], R.is_rotatable = E[5], R.must_predraw = E[9], R.onCreate && R.onCreate(), cr.seal(R), this.plugins.push(R);
        for (this.objectRefTable = cr.getObjectRefTable(), h = 0, x = r[3].length; h < x; h++) {
            for (E = r[3][h], B = this.GetObjectReference(E[1]), (R = null, v = 0, w = this.plugins.length); v < w; v++)
                if (this.plugins[v] instanceof B) {
                    R = this.plugins[v];
                    break
                }
            var F = new R.Type(R);
            for (F.name = E[0], F.is_family = E[2], F.instvar_sids = E[3].slice(0), F.vars_count = E[3].length, F.behs_count = E[4], F.fx_count = E[5], F.sid = E[11], F.is_family ? (F.members = [], F.family_index = this.family_count++, F.families = null) : (F.members = null, F.family_index = -1, F.families = []), F.family_var_map = null, F.family_beh_map = null, F.family_fx_map = null, F.is_contained = !1, F.container = null, E[6] ? (F.texture_file = E[6][0], F.texture_filesize = E[6][1], F.texture_pixelformat = E[6][2], F.texture_data = E[6]) : (F.texture_file = null, F.texture_filesize = 0, F.texture_pixelformat = 0, F.texture_data = null), F.animations = E[7] ? E[7] : null, F.index = h, F.instances = [], F.deadCache = [], F.solstack = [new cr.selection(F)], F.cur_sol = 0, F.default_instance = null, F.default_layerindex = 0, F.stale_iids = !0, F.updateIIDs = cr.type_updateIIDs, F.getFirstPicked = cr.type_getFirstPicked, F.getPairedInstance = cr.type_getPairedInstance, F.getCurrentSol = cr.type_getCurrentSol, F.pushCleanSol = cr.type_pushCleanSol, F.pushCopySol = cr.type_pushCopySol, F.popSol = cr.type_popSol, F.getBehaviorByName = cr.type_getBehaviorByName, F.getBehaviorIndexByName = cr.type_getBehaviorIndexByName, F.getEffectIndexByName = cr.type_getEffectIndexByName, F.applySolToContainer = cr.type_applySolToContainer, F.getInstanceByIID = cr.type_getInstanceByIID, F.collision_grid = new cr.SparseGrid(this.original_width, this.original_height), F.any_cell_changed = !0, F.any_instance_parallaxed = !1, F.extra = {}, F.toString = cr.type_toString, F.behaviors = [], (v = 0, w = E[8].length); v < w; v++) {
                C = E[8][v];
                var N = this.GetObjectReference(C[1]),
                    D = null;
                for (T = 0, O = this.behaviors.length; T < O; T++)
                    if (this.behaviors[T] instanceof N) {
                        D = this.behaviors[T];
                        break
                    }
                D || (D = new N(this), D.my_types = [], D.my_instances = new cr.ObjectSet, D.onCreate && D.onCreate(), cr.seal(D), this.behaviors.push(D), cr.behaviors.solid && D instanceof cr.behaviors.solid && (this.solidBehavior = D), cr.behaviors.jumpthru && D instanceof cr.behaviors.jumpthru && (this.jumpthruBehavior = D), cr.behaviors.shadowcaster && D instanceof cr.behaviors.shadowcaster && (this.shadowcasterBehavior = D)), -1 === D.my_types.indexOf(F) && D.my_types.push(F);
                var M = new D.Type(D, F);
                M.name = C[0], M.sid = C[2], M.onCreate(), cr.seal(M), F.behaviors.push(M)
            }
            for (F.global = E[9], F.isOnLoaderLayout = E[10], F.effect_types = [], (v = 0, w = E[12].length); v < w; v++) F.effect_types.push({
                id: E[12][v][0],
                name: E[12][v][1],
                shaderindex: -1,
                preservesOpaqueness: !1,
                active: !0,
                index: v
            });
            if (F.tile_poly_data = E[13], (!this.uses_loader_layout || F.is_family || F.isOnLoaderLayout || !R.is_world) && (F.onCreate(), cr.seal(F)), F.name && (this.types[F.name] = F, this.types_lowercase[F.name.toLowerCase()] = F), this.types_by_index.push(F), R.singleglobal) {
                var z = new R.Instance(F);
                z.uid = this.next_uid++, z.puid = this.next_puid++, z.iid = 0, z.get_iid = cr.inst_get_iid, z.toString = cr.inst_toString, z.properties = E[15], z.onCreate(), cr.seal(z), F.instances.push(z), this.objectsByUid[z.uid.toString()] = z
            }
        }
        for (h = 0, x = r[4].length; h < x; h++) {
            var G = r[4][h],
                W = this.types_by_index[G[0]],
                U;
            for (v = 1, w = G.length; v < w; v++) U = this.types_by_index[G[v]], U.families.push(W), W.members.push(U)
        }
        for (h = 0, x = r[27].length; h < x; h++) {
            var V = r[27][h],
                X = [];
            for (v = 0, w = V.length; v < w; v++) X.push(this.types_by_index[V[v]]);
            for (v = 0, w = X.length; v < w; v++) X[v].is_contained = !0, X[v].container = X
        }
        if (0 < this.family_count)
            for (h = 0, x = this.types_by_index.length; h < x; h++)
                if (A = this.types_by_index[h], !A.is_family && A.families.length) {
                    A.family_var_map = Array(this.family_count), A.family_beh_map = Array(this.family_count), A.family_fx_map = Array(this.family_count);
                    var q = [],
                        Y = 0,
                        H = 0,
                        J = 0;
                    for (v = 0, w = A.families.length; v < w; v++)
                        for (P = A.families[v], A.family_var_map[P.family_index] = Y, Y += P.vars_count, A.family_beh_map[P.family_index] = H, H += P.behs_count, A.family_fx_map[P.family_index] = J, J += P.fx_count, (T = 0, O = P.effect_types.length); T < O; T++) q.push(cr.shallowCopy({}, P.effect_types[T]));
                    for (A.effect_types = q.concat(A.effect_types), v = 0, w = A.effect_types.length; v < w; v++) A.effect_types[v].index = v
                }
        for (h = 0, x = r[5].length; h < x; h++) {
            E = r[5][h];
            var Z = new cr.layout(this, E);
            cr.seal(Z), this.layouts[Z.name] = Z, this.layouts_by_index.push(Z)
        }
        for (h = 0, x = r[6].length; h < x; h++) {
            E = r[6][h];
            var Q = new cr.eventsheet(this, E);
            cr.seal(Q), this.eventsheets[Q.name] = Q, this.eventsheets_by_index.push(Q)
        }
        for (h = 0, x = this.eventsheets_by_index.length; h < x; h++) this.eventsheets_by_index[h].postInit();
        for (h = 0, x = this.eventsheets_by_index.length; h < x; h++) this.eventsheets_by_index[h].updateDeepIncludes();
        for (h = 0, x = this.triggers_to_postinit.length; h < x; h++) this.triggers_to_postinit[h].postInit();
        for (cr.clearArray(this.triggers_to_postinit), this.audio_files_info = r[7], this.audio_files_map = {}, (h = 0, x = this.audio_files_info.length); h < x; ++h) I = this.audio_files_info[h], this.audio_files_map[I[0]] = I[1];
        this.files_subfolder = r[8], this.pixel_rounding = r[9], this.aspect_scale = 1, this.enableWebGL = r[13], this.linearSampling = r[14], this.clearBackground = r[15], this.versionstr = r[16], this.useHighDpi = r[17], this.orientations = r[20], this.autoLockOrientation = 0 < this.orientations, this.pauseOnBlur = r[22], this.wantFullscreenScalingQuality = r[23], this.fullscreenScalingQuality = this.wantFullscreenScalingQuality, this.downscalingQuality = r[24], this.preloadSounds = r[25], this.enableFrontToBack = r[26] && !this.isIE, this.enhancedAccelerationPrecision = r[30], this.start_time = Date.now(), cr.clearArray(this.objectRefTable), this.preloadSounds || S["audio/webm; codecs=opus"] || !window.OpusDecoder || window.OpusDecoder.Initialise(), this.initRendererAndLoader()
    };
    var O = !1;
    e.prototype.waitForImageLoad = function(t, r) {
        window.cr_remotePreviewImageFiles && r && "blob:" !== r.substr(0, 5) && (r = window.cr_remotePreviewImageFiles[r]);
        t.onerror = function(r) {
            t.c2error = !0, O = !0, console && console.error && console.error("Error loading image '" + t.src + "': ", r)
        }, t.src || ("undefined" == typeof XAPKReader ? (t.crossOrigin = "anonymous", this.setImageSrc(t, r)) : XAPKReader.get(r, function(e) {
            t.src = e
        }, function(n) {
            t.c2error = !0, O = !0, console && console.error && console.error("Error extracting image '" + r + "' from expansion file: ", n)
        })), this.wait_for_textures.push(t)
    }, e.prototype.findWaitingTexture = function(e) {
        var t, r;
        for (t = 0, r = this.wait_for_textures.length; t < r; t++)
            if (this.wait_for_textures[t].cr_src === e) return this.wait_for_textures[t];
        return null
    };
    var E = 0,
        C = !1;
    e.prototype.getready = function() {
        if (this.audioInstance && this.preloadSounds) {
            var e = [],
                t, n, a, o, s, l;
            for (t = 0, n = this.audio_files_info.length; t < n; ++t) a = this.audio_files_info[t], o = a[0], l = a[2], s = this.getPreferredAudioFile(o), s && !l && e.push({
                filename: o + s[1],
                size: s[2],
                type: s[0]
            });
            E = this.audioInstance.setPreloadList(e)
        }
    }, e.prototype.areAllTexturesAndSoundsLoaded = function() {
        var e = E,
            t = 0,
            r = 0,
            n = !0,
            a, o, s;
        for (a = 0, o = this.wait_for_textures.length; a < o; a++) {
            s = this.wait_for_textures[a];
            var l = s.cr_filesize;
            (!l || 0 >= l) && (l = 5e4), e += l, s.src && s.complete && !s.c2error ? t += l : n = !1
        }
        return n && this.preloadSounds && this.audioInstance && (!C && (this.audioInstance.startPreloads(), C = !0), r = this.audioInstance.getPreloadedSize(), t += r, r < E && (n = !1)), this.progress = 0 == e ? 1 : t / e, n
    };
    var A = !1;
    e.prototype.go = function() {
        if (this.ctx || this.glwrap) {
            var e = this.ctx || this.overlay_ctx;
            if (0 < this.fullscreen_mode) {
                var t = window.innerWidth,
                    r = window.innerHeight;
                (this.lastWindowWidth !== t || this.lastWindowHeight !== r) && this.setSize(t, r)
            }
            this.progress = 0, this.last_progress = -1;
            var n = this;
            if (this.areAllTexturesAndSoundsLoaded() && (4 !== this.loaderstyle || A)) this.useFbInstant ? FBInstant.startGameAsync().then(function() {
                n.go_loading_finished()
            }) : this.go_loading_finished();
            else {
                this.useFbInstant && FBInstant.setLoadingProgress(100 * this.progress);
                var a = Date.now() - this.start_time;
                if (e) {
                    var o = this.width,
                        i = this.height,
                        s = this.devicePixelRatio;
                    if (3 > this.loaderstyle && 500 <= a && this.last_progress != this.progress) {
                        e.clearRect(0, 0, o, i);
                        var l = o / 2,
                            p = i / 2,
                            d = 0 === this.loaderstyle && this.loaderlogos.logo && this.loaderlogos.logo.complete,
                            c = 40 * s,
                            u = 0,
                            g = 80 * s,
                            y;
                        if (d) {
                            var h = this.loaderlogos.logo;
                            g = h.width * s, y = h.height * s, c = g / 2, u = y / 2, e.drawImage(h, cr.floor(l - c), cr.floor(p - u), g, y)
                        }
                        if (1 >= this.loaderstyle) p += u + (d ? 12 * s : 0), l -= c, l = cr.floor(l) + .5, p = cr.floor(p) + .5, e.fillStyle = O ? "red" : "DodgerBlue", e.fillRect(l, p, _(g * this.progress), 6 * s), e.strokeStyle = "black", e.strokeRect(l, p, g, 6 * s), e.strokeStyle = "white", e.strokeRect(l - 1 * s, p - 1 * s, g + 2 * s, 8 * s);
                        else if (2 === this.loaderstyle) {
                            e.font = "12pt Arial", e.fillStyle = O ? "#f00" : "#999", e.textBaseLine = "middle";
                            var f = m(100 * this.progress) + "%",
                                b = e.measureText ? e.measureText(f) : null,
                                x = b ? b.width : 0;
                            e.fillText(f, l - x / 2, p)
                        }
                        this.last_progress = this.progress
                    } else if (4 === this.loaderstyle) return this.draw_c3_splash_loader(e), void(v ? v(function() {
                        n.go()
                    }) : setTimeout(function() {
                        n.go()
                    }, 16))
                }
                setTimeout(function() {
                    n.go()
                }, 100)
            }
        }
    };
    var P = -1,
        L = !0,
        I = !1,
        R = 0,
        k = 0,
        B = null,
        F = null,
        N = 0;
    e.prototype.draw_c3_splash_loader = function(e) {
        if (!A) {
            var n = this.isPreview || this.useFbInstant,
                a = n ? 0 : 200,
                o = n ? 0 : 3e3,
                s = y(this.width),
                l = y(this.height),
                p = this.devicePixelRatio,
                d = this.loaderlogos.logo,
                c = this.loaderlogos.powered,
                u = this.loaderlogos.website;
            if (d.complete) {
                for (var g = 0; 3 > g; ++g)
                    if (!c[g].complete || !u[g].complete) return;
                0 == N && (P = Date.now());
                var m = Date.now(),
                    _ = !1,
                    h = e,
                    x, v;
                L || I ? (e.clearRect(0, 0, s, l), t(s, l), h = F, _ = !0, L && 1 == N && (P = Date.now())) : e.globalAlpha = 1, h.fillStyle = "#3B4045", h.fillRect(0, 0, s, l);
                try {
                    256 < this.cssHeight ? (x = 1.5 * cr.clamp(.22 * l, 105, .6 * s), v = x / 8, h.drawImage(r(c, x), .5 * s - x / 2, .2 * l - v / 2, x, v), x = b(.395 * l, .95 * s), v = x, h.drawImage(d, .5 * s - x / 2, .485 * l - v / 2, x, v), x = 1.5 * cr.clamp(.22 * l, 105, .6 * s), v = x / 8, h.drawImage(r(u, x), .5 * s - x / 2, .868 * l - v / 2, x, v), h.fillStyle = "#4D565D", x = s, v = f(.005 * l, 2), h.fillRect(0, .8 * l - v / 2, x, v), h.fillStyle = O ? "red" : "#29F3D0", x = s * this.progress, h.fillRect(.5 * s - x / 2, .8 * l - v / 2, x, v)) : (x = .55 * l, v = x, h.drawImage(d, .5 * s - x / 2, .45 * l - v / 2, x, v), h.fillStyle = "#4D565D", x = s, v = f(.005 * l, 2), h.fillRect(0, .85 * l - v / 2, x, v), h.fillStyle = O ? "red" : "#29F3D0", x = s * this.progress, h.fillRect(.5 * s - x / 2, .85 * l - v / 2, x, v)), _ && (L ? 0 == N ? e.globalAlpha = 0 : e.globalAlpha = b((m - P) / 300, 1) : I && (e.globalAlpha = f(1 - (m - k) / 300, 0)), e.drawImage(B, 0, 0, s, l))
                } catch (t) {}
                L && 300 <= m - P && 2 <= N && (L = !1, R = m), !L && m - R >= o && !I && 1 <= this.progress && (I = !0, k = m), (I && m - k >= 300 + a || n && 1 <= this.progress && 500 > Date.now() - P) && (A = !0, L = !1, I = !1, B = null, F = null, this.loaderlogos = null), ++N
            }
        }
    }, e.prototype.go_loading_finished = function() {
        if (this.webFontNames.length && document.fonts && document.fonts.load) {
            var e = this;
            Promise.all(this.webFontNames.map(function(e) {
                return document.fonts.load("1em '" + e + "'")
            })).then(function() {
                e.start_first_layout()
            })
        } else this.start_first_layout()
    }, e.prototype.start_first_layout = function() {
        this.overlay_canvas && (this.canvas.parentNode.removeChild(this.overlay_canvas), this.overlay_ctx = null, this.overlay_canvas = null), this.start_time = Date.now(), this.last_fps_time = cr.performance_now();
        var e, r, n;
        if (this.uses_loader_layout)
            for (e = 0, r = this.types_by_index.length; e < r; e++) n = this.types_by_index[e], n.is_family || n.isOnLoaderLayout || !n.plugin.is_world || (n.onCreate(), cr.seal(n));
        else this.isloading = !1;
        for (e = 0, r = this.layouts_by_index.length; e < r; e++) this.layouts_by_index[e].createGlobalNonWorlds();
        if (2 <= this.fullscreen_mode) {
            var a = this.original_width / this.original_height,
                o = this.width / this.height;
            this.aspect_scale = 2 !== this.fullscreen_mode && o > a || 2 === this.fullscreen_mode && o < a ? this.height / this.original_height : this.width / this.original_width
        }
        for (e = 0, r = this.types_by_index.length; e < r; e++) n = this.types_by_index[e], n.onBeforeAppBegin && n.onBeforeAppBegin();
        this.first_layout ? this.layouts[this.first_layout].startRunning() : this.layouts_by_index[0].startRunning();
        for (this.uses_loader_layout || (this.loadingprogress = 1, this.trigger(cr.system_object.prototype.cnds.OnLoadFinished, null), window.C3_RegisterSW && window.C3_RegisterSW()), navigator.splashscreen && navigator.splashscreen.hide && navigator.splashscreen.hide(), (e = 0, r = this.types_by_index.length); e < r; e++) n = this.types_by_index[e], n.onAppBegin && n.onAppBegin();
        var s = function() {
            document.hidden || document.webkitHidden || document.mozHidden || document.msHidden ? window.cr_setSuspended(!0) : window.cr_setSuspended(!1)
        };
        document.addEventListener("visibilitychange", s, !1), document.addEventListener("mozvisibilitychange", s, !1), document.addEventListener("webkitvisibilitychange", s, !1), document.addEventListener("msvisibilitychange", s, !1), this.isCordova && (document.addEventListener("pause", function() {
            window.cr_setSuspended(!0)
        }), document.addEventListener("resume", function() {
            window.cr_setSuspended(!1)
        })), document.hidden || document.webkitHidden || document.mozHidden || document.msHidden ? window.cr_setSuspended(!0) : this.tick(!1)
    }, e.prototype.tick = function(e, t, r) {
        if (this.running_layout) {
            var n = cr.performance_now();
            if (r || !this.isSuspended || e) {
                e || (v ? this.raf_id = v(this.tickFunc) : this.timeout_id = setTimeout(this.tickFunc, this.isMobile ? 1 : 16));
                var a = this.fullscreen_mode,
                    o = (document.mozFullScreen || document.webkitIsFullScreen || document.fullScreen || !!document.msFullscreenElement) && !this.isCordova;
                if (o && 0 < this.fullscreen_scaling && (a = this.fullscreen_scaling), 0 < a) {
                    var i = window.innerWidth,
                        s = window.innerHeight;
                    (this.lastWindowWidth !== i || this.lastWindowHeight !== s) && this.setSize(i, s)
                }
                if (o ? !this.firstInFullscreen && (this.firstInFullscreen = !0) : this.firstInFullscreen ? (this.firstInFullscreen = !1, 0 === this.fullscreen_mode && this.setSize(m(this.oldWidth / this.devicePixelRatio), m(this.oldHeight / this.devicePixelRatio), !0)) : (this.oldWidth = this.width, this.oldHeight = this.height), this.isloading) {
                    var l = this.areAllTexturesAndSoundsLoaded();
                    this.loadingprogress = this.progress, l && (this.isloading = !1, this.progress = 1, this.trigger(cr.system_object.prototype.cnds.OnLoadFinished, null), window.C3_RegisterSW && window.C3_RegisterSW())
                }
                this.logic(t || n), !this.redraw || this.is_WebGL_context_lost || this.suspendDrawing || e || (this.redraw = !1, this.glwrap ? this.drawGL() : this.draw(), this.snapshotCanvas && (this.canvas && this.canvas.toDataURL && (this.snapshotData = this.canvas.toDataURL(this.snapshotCanvas[0], this.snapshotCanvas[1]), window.cr_onSnapshot && window.cr_onSnapshot(this.snapshotData), this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot, null)), this.snapshotCanvas = null)), this.hit_breakpoint || (this.tickcount++, this.tickcount_nosave++, this.execcount++, this.framecount++), this.logictime += cr.performance_now() - n
            }
        }
    }, e.prototype.logic = function(e) {
        var t, r, n, a, o, s, l, p, d;
        if (1e3 <= e - this.last_fps_time && (this.last_fps_time += 1e3, 1e3 <= e - this.last_fps_time && (this.last_fps_time = e), this.fps = this.framecount, this.framecount = 0, this.cpuutilisation = b(this.logictime, 1e3), this.logictime = 0, this.glwrap && 0 === this.gpuTimeEndFrame && (this.gpuTimeEndFrame = this.glwrap.getFrameNumber(), this.gpuCurUtilisation = -1)), this.glwrap && -1 === this.gpuCurUtilisation && this.glwrap.supportsGpuProfiling() && (this.gpuCurUtilisation = this.glwrap.getFrameRangeTimerResults(this.gpuTimeStartFrame, this.gpuTimeEndFrame), -1 !== this.gpuCurUtilisation && (this.glwrap.deleteTimerResultsToFrame(this.gpuTimeEndFrame), this.gpuLastUtilisation = b(this.gpuCurUtilisation, 1), this.gpuTimeStartFrame = this.gpuTimeEndFrame, this.gpuTimeEndFrame = 0)), 0 !== this.last_tick_time) {
            var c = e - this.last_tick_time;
            0 > c && (c = 0), this.dt1 = c / 1e3, .5 < this.dt1 ? this.dt1 = 0 : this.dt1 > 1 / this.minimumFramerate && (this.dt1 = 1 / this.minimumFramerate)
        }
        this.last_tick_time = e, this.dt = this.dt1 * this.timescale, this.kahanTime.add(this.dt), this.wallTime.add(this.dt1);
        var u = (document.mozFullScreen || document.webkitIsFullScreen || document.fullScreen || !!document.msFullscreenElement) && !this.isCordova;
        if (2 <= this.fullscreen_mode || u && 0 < this.fullscreen_scaling) {
            var g = this.original_width / this.original_height,
                y = this.width / this.height,
                m = this.fullscreen_mode;
            u && 0 < this.fullscreen_scaling && (m = this.fullscreen_scaling), this.aspect_scale = 2 !== m && y > g || 2 === m && y < g ? this.height / this.original_height : this.width / this.original_width, this.running_layout && (this.running_layout.scrollToX(this.running_layout.scrollX), this.running_layout.scrollToY(this.running_layout.scrollY))
        } else this.aspect_scale = this.isRetina ? this.devicePixelRatio : 1;
        this.ClearDeathRow(), this.isInOnDestroy++, this.system.runWaits(), this.isInOnDestroy--, this.ClearDeathRow(), this.isInOnDestroy++;
        var _ = this.objects_to_pretick.valuesRef();
        for (t = 0, r = _.length; t < r; t++) _[t].pretick();
        for (t = 0, r = this.types_by_index.length; t < r; t++)
            if (l = this.types_by_index[t], !l.is_family && (l.behaviors.length || l.families.length))
                for (n = 0, a = l.instances.length; n < a; n++)
                    for (p = l.instances[n], o = 0, s = p.behavior_insts.length; o < s; o++) p.behavior_insts[o].tick();
        for (t = 0, r = this.types_by_index.length; t < r; t++)
            if (l = this.types_by_index[t], !l.is_family && (l.behaviors.length || l.families.length))
                for (n = 0, a = l.instances.length; n < a; n++)
                    for (p = l.instances[n], o = 0, s = p.behavior_insts.length; o < s; o++) d = p.behavior_insts[o], d.posttick && d.posttick();
        for (_ = this.objects_to_tick.valuesRef(), t = 0, r = _.length; t < r; t++) _[t].tick();
        for (this.isInOnDestroy--, this.handleSaveLoad(), t = 0; this.changelayout && 10 > t++;) this.doChangeLayout(this.changelayout);
        for (t = 0, r = this.eventsheets_by_index.length; t < r; t++) this.eventsheets_by_index[t].hasRun = !1;
        for (this.running_layout.event_sheet && this.running_layout.event_sheet.run(), cr.clearArray(this.registered_collisions), this.layout_first_tick = !1, this.isInOnDestroy++, (t = 0, r = this.types_by_index.length); t < r; t++)
            if (l = this.types_by_index[t], !l.is_family && (l.behaviors.length || l.families.length))
                for (n = 0, a = l.instances.length; n < a; n++) {
                    var p = l.instances[n];
                    for (o = 0, s = p.behavior_insts.length; o < s; o++) d = p.behavior_insts[o], d.tick2 && d.tick2()
                }
        for (_ = this.objects_to_tick2.valuesRef(), t = 0, r = _.length; t < r; t++) _[t].tick2();
        this.isInOnDestroy--
    }, e.prototype.onWindowBlur = function() {
        var e, t, r, n, a, o, s, l, p;
        for (e = 0, t = this.types_by_index.length; e < t; e++)
            if (s = this.types_by_index[e], !s.is_family)
                for (r = 0, n = s.instances.length; r < n; r++)
                    if (l = s.instances[r], l.onWindowBlur && l.onWindowBlur(), l.behavior_insts)
                        for (a = 0, o = l.behavior_insts.length; a < o; a++) p = l.behavior_insts[a], p.onWindowBlur && p.onWindowBlur()
    }, e.prototype.doChangeLayout = function(e) {
        var t = this.running_layout;
        this.running_layout.stopRunning();
        var r, n, a;
        if (this.glwrap)
            for (r = 0, n = this.types_by_index.length; r < n; r++) a = this.types_by_index[r], a.is_family || !a.unloadTextures || a.global && 0 !== a.instances.length || -1 !== e.initial_types.indexOf(a) || a.unloadTextures();
        t == e && cr.clearArray(this.system.waits), cr.clearArray(this.registered_collisions), this.runLayoutChangeMethods(!0), e.startRunning(), this.runLayoutChangeMethods(!1), this.redraw = !0, this.layout_first_tick = !0, this.ClearDeathRow()
    }, e.prototype.runLayoutChangeMethods = function(e) {
        var t, r, n, a, o, s, l, p, d, c;
        for (t = 0, r = this.behaviors.length; t < r; t++) n = this.behaviors[t], e ? n.onBeforeLayoutChange && n.onBeforeLayoutChange() : n.onLayoutChange && n.onLayoutChange();
        for (t = 0, r = this.types_by_index.length; t < r; t++)
            if (a = this.types_by_index[t], a.global || a.plugin.singleglobal)
                for (o = 0, s = a.instances.length; o < s; o++)
                    if (l = a.instances[o], e ? l.onBeforeLayoutChange && l.onBeforeLayoutChange() : l.onLayoutChange && l.onLayoutChange(), l.behavior_insts)
                        for (p = 0, d = l.behavior_insts.length; p < d; p++) c = l.behavior_insts[p], e ? c.onBeforeLayoutChange && c.onBeforeLayoutChange() : c.onLayoutChange && c.onLayoutChange()
    }, e.prototype.pretickMe = function(e) {
        this.objects_to_pretick.add(e)
    }, e.prototype.unpretickMe = function(e) {
        this.objects_to_pretick.remove(e)
    }, e.prototype.tickMe = function(e) {
        this.objects_to_tick.add(e)
    }, e.prototype.untickMe = function(e) {
        this.objects_to_tick.remove(e)
    }, e.prototype.tick2Me = function(e) {
        this.objects_to_tick2.add(e)
    }, e.prototype.untick2Me = function(e) {
        this.objects_to_tick2.remove(e)
    }, e.prototype.getDt = function(e) {
        return e && -1 !== e.my_timescale ? this.dt1 * e.my_timescale : this.dt
    }, e.prototype.draw = function() {
        this.running_layout.draw(this.ctx)
    }, e.prototype.drawGL = function() {
        this.enableFrontToBack && (this.earlyz_index = 1, this.running_layout.drawGL_earlyZPass(this.glwrap)), this.running_layout.drawGL(this.glwrap), this.glwrap.present()
    }, e.prototype.addDestroyCallback = function(e) {
        e && this.destroycallbacks.push(e)
    }, e.prototype.removeDestroyCallback = function(e) {
        cr.arrayFindRemove(this.destroycallbacks, e)
    }, e.prototype.getObjectByUID = function(e) {
        var t = e.toString();
        return this.objectsByUid.hasOwnProperty(t) ? this.objectsByUid[t] : null
    };
    var j = [];
    e.prototype.DestroyInstance = function(e) {
        var t = e.type,
            r = t.name,
            a = this.deathRow.hasOwnProperty(r),
            o = null,
            s, l;
        if (!a) o = n(), this.deathRow[r] = o;
        else if (o = this.deathRow[r], o.contains(e)) return;
        if (e.isDestroyed = !0, o.add(e), this.hasPendingInstances = !0, e.is_contained)
            for (s = 0, l = e.siblings.length; s < l; s++) this.DestroyInstance(e.siblings[s]);
        this.isInClearDeathRow && o.values_cache.push(e), this.isEndingLayout || (this.isInOnDestroy++, this.trigger(Object.getPrototypeOf(e.type.plugin).cnds.OnDestroyed, e), this.isInOnDestroy--)
    }, e.prototype.ClearDeathRow = function() {
        if (this.hasPendingInstances) {
            var e, t, r, n, a, o;
            for (this.isInClearDeathRow = !0, r = 0, a = this.createRow.length; r < a; ++r)
                for (e = this.createRow[r], t = e.type, t.instances.push(e), (n = 0, o = t.families.length); n < o; ++n) t.families[n].instances.push(e), t.families[n].stale_iids = !0;
            cr.clearArray(this.createRow), this.IterateDeathRow(), cr.wipe(this.deathRow), this.isInClearDeathRow = !1, this.hasPendingInstances = !1
        }
    }, e.prototype.IterateDeathRow = function() {
        for (var e in this.deathRow) this.deathRow.hasOwnProperty(e) && this.ClearDeathRowForType(this.deathRow[e])
    }, e.prototype.ClearDeathRowForType = function(e) {
        var t = e.valuesRef();
        var r = t[0].type;
        var n, o, s, l, p, d, c, u;
        for (cr.arrayRemoveAllFromObjectSet(r.instances, e), r.stale_iids = !0, 0 === r.instances.length && (r.any_instance_parallaxed = !1), (n = 0, o = r.families.length); n < o; ++n) d = r.families[n], cr.arrayRemoveAllFromObjectSet(d.instances, e), d.stale_iids = !0;
        for (n = 0, o = this.system.waits.length; n < o; ++n)
            if (p = this.system.waits[n], p.sols.hasOwnProperty(r.index) && cr.arrayRemoveAllFromObjectSet(p.sols[r.index].insts, e), !r.is_family)
                for (s = 0, l = r.families.length; s < l; ++s) d = r.families[s], p.sols.hasOwnProperty(d.index) && cr.arrayRemoveAllFromObjectSet(p.sols[d.index].insts, e);
        var g = t[0].layer;
        if (g) {
            if (g.useRenderCells)
                for (c = g.instances, n = 0, o = c.length; n < o; ++n) u = c[n], e.contains(u) && (u.update_bbox(), g.render_grid.update(u, u.rendercells, null), u.rendercells.set(0, 0, -1, -1));
            cr.arrayRemoveAllFromObjectSet(g.instances, e), g.setZIndicesStaleFrom(0)
        }
        for (n = 0; n < t.length; ++n) this.ClearDeathRowForSingleInstance(t[n], r);
        a(e), this.redraw = !0
    }, e.prototype.ClearDeathRowForSingleInstance = function(e, t) {
        var r, n, a;
        for (r = 0, n = this.destroycallbacks.length; r < n; ++r) this.destroycallbacks[r](e);
        e.collcells && t.collision_grid.update(e, e.collcells, null);
        var o = e.layer;
        if (o && o.removeFromInstanceList(e, !0), e.behavior_insts)
            for (r = 0, n = e.behavior_insts.length; r < n; ++r) a = e.behavior_insts[r], a.onDestroy && a.onDestroy(), a.behavior.my_instances.remove(e);
        this.objects_to_pretick.remove(e), this.objects_to_tick.remove(e), this.objects_to_tick2.remove(e), e.onDestroy && e.onDestroy(), this.objectsByUid.hasOwnProperty(e.uid.toString()) && delete this.objectsByUid[e.uid.toString()], this.objectcount--, 100 > t.deadCache.length && t.deadCache.push(e)
    }, e.prototype.createInstance = function(e, t, r, n) {
        if (e.is_family) {
            var a = cr.floor(Math.random() * e.members.length);
            return this.createInstance(e.members[a], t, r, n)
        }
        return e.default_instance ? this.createInstanceFromInit(e.default_instance, t, !1, r, n, !1) : null
    };
    var D = [];
    e.prototype.createInstanceFromInit = function(e, t, r, n, a, o) {
        var s, l, p, d, c;
        if (!e) return null;
        var u = this.types_by_index[e[1]],
            g = u.plugin.is_world;
        if (this.isloading && g && !u.isOnLoaderLayout) return null;
        if (g && !this.glwrap && 11 === e[0][11]) return null;
        var y = t;
        g || (t = null);
        var m;
        for (u.deadCache.length ? (m = u.deadCache.pop(), m.recycled = !0, u.plugin.Instance.call(m, u)) : (m = new u.plugin.Instance(u), m.recycled = !1), m.uid = !r || o || this.objectsByUid.hasOwnProperty(e[2].toString()) ? this.next_uid++ : e[2], this.objectsByUid[m.uid.toString()] = m, m.puid = this.next_puid++, m.iid = u.instances.length, (s = 0, l = this.createRow.length); s < l; ++s) this.createRow[s].type === u && m.iid++;
        m.get_iid = cr.inst_get_iid, m.toString = cr.inst_toString, m.isDestroyed = !1;
        var _ = e[3];
        if (m.recycled) cr.wipe(m.extra);
        else {
            if (m.extra = {}, this.isPreview)
                for (m.instance_var_names = [], m.instance_var_names.length = _.length, (s = 0, l = _.length); s < l; s++) m.instance_var_names[s] = _[s][1];
            m.instance_vars = [], m.instance_vars.length = _.length
        }
        for (s = 0, l = _.length; s < l; s++) m.instance_vars[s] = _[s][0];
        if (g) {
            var h = e[0];
            if (m.x = cr.is_undefined(n) ? h[0] : n, m.y = cr.is_undefined(a) ? h[1] : a, m.z = h[2], m.width = h[3], m.height = h[4], m.depth = h[5], m.angle = h[6], m.opacity = h[7], m.hotspotX = h[8], m.hotspotY = h[9], m.blend_mode = h[10], c = h[11], !this.glwrap && u.effect_types.length && (m.blend_mode = c), m.compositeOp = cr.effectToCompositeOp(m.blend_mode), this.gl && cr.setGLBlend(m, m.blend_mode, this.gl), m.recycled) {
                for (s = 0, l = h[12].length; s < l; s++)
                    for (p = 0, d = h[12][s].length; p < d; p++) m.effect_params[s][p] = h[12][s][p], Array.isArray(m.effect_params[s][p]) && (m.effect_params[s][p] = m.effect_params[s][p].slice(0));
                m.bbox.set(0, 0, 0, 0), m.collcells.set(0, 0, -1, -1), m.rendercells.set(0, 0, -1, -1), m.bquad.set_from_rect(m.bbox), cr.clearArray(m.bbox_changed_callbacks)
            } else {
                for (m.effect_params = h[12].slice(0), s = 0, l = m.effect_params.length; s < l; s++)
                    for (m.effect_params[s] = h[12][s].slice(0), p = 0, d = m.effect_params[s].length; p < d; ++p) Array.isArray(m.effect_params[s][p]) && (m.effect_params[s][p] = m.effect_params[s][p].slice(0));
                m.active_effect_types = [], m.active_effect_flags = [], m.active_effect_flags.length = u.effect_types.length, m.bbox = new cr.rect(0, 0, 0, 0), m.collcells = new cr.rect(0, 0, -1, -1), m.rendercells = new cr.rect(0, 0, -1, -1), m.bquad = new cr.quad, m.bbox_changed_callbacks = [], m.set_bbox_changed = cr.set_bbox_changed, m.add_bbox_changed_callback = cr.add_bbox_changed_callback, m.contains_pt = cr.inst_contains_pt, m.update_bbox = cr.update_bbox, m.update_render_cell = cr.update_render_cell, m.update_collision_cell = cr.update_collision_cell, m.get_zindex = cr.inst_get_zindex
            }
            for (m.tilemap_exists = !1, m.tilemap_width = 0, m.tilemap_height = 0, m.tilemap_data = null, 14 === h.length && (m.tilemap_exists = !0, m.tilemap_width = h[13][0], m.tilemap_height = h[13][1], m.tilemap_data = h[13][2]), (s = 0, l = u.effect_types.length); s < l; s++) m.active_effect_flags[s] = !0;
            m.shaders_preserve_opaqueness = !0, m.updateActiveEffects = cr.inst_updateActiveEffects, m.updateActiveEffects(), m.uses_shaders = !!m.active_effect_types.length, m.bbox_changed = !0, m.cell_changed = !0, u.any_cell_changed = !0, m.visible = !0, m.my_timescale = -1, m.layer = t, m.zindex = t.instances.length, m.earlyz_index = 0, "undefined" == typeof m.collision_poly && (m.collision_poly = null), m.collisionsEnabled = !0, this.redraw = !0
        }
        var f, b;
        for (cr.clearArray(D), s = 0, l = u.families.length; s < l; s++) D.push.apply(D, u.families[s].behaviors);
        if (D.push.apply(D, u.behaviors), m.recycled)
            for (s = 0, l = D.length; s < l; s++) {
                var x = D[s];
                for (b = m.behavior_insts[s], b.recycled = !0, x.behavior.Instance.call(b, x, m), f = e[4][s], (p = 0, d = f.length); p < d; p++) b.properties[p] = f[p];
                b.onCreate(), x.behavior.my_instances.add(m)
            } else
                for (m.behavior_insts = [], s = 0, l = D.length; s < l; s++) {
                    var x = D[s],
                        b = new x.behavior.Instance(x, m);
                    b.recycled = !1, b.properties = e[4][s].slice(0), b.onCreate(), cr.seal(b), m.behavior_insts.push(b), x.behavior.my_instances.add(m)
                }
        if (f = e[5], m.recycled)
            for (s = 0, l = f.length; s < l; s++) m.properties[s] = f[s];
        else m.properties = f.slice(0);
        if (this.createRow.push(m), this.hasPendingInstances = !0, (t && (t.appendToInstanceList(m, !0), (1 !== t.parallaxX || 1 !== t.parallaxY) && (u.any_instance_parallaxed = !0)), this.objectcount++, !u.is_contained)) m.is_contained = !1, m.siblings = null;
        else if (m.is_contained = !0, m.recycled ? cr.clearArray(m.siblings) : m.siblings = [], !r && !o) {
            for (s = 0, l = u.container.length; s < l; s++)
                if (u.container[s] !== u) {
                    if (!u.container[s].default_instance) return null;
                    m.siblings.push(this.createInstanceFromInit(u.container[s].default_instance, y, !1, g ? m.x : n, g ? m.y : a, !0))
                }
            for (s = 0, l = m.siblings.length; s < l; s++)
                for (m.siblings[s].siblings.push(m), p = 0; p < l; p++) s !== p && m.siblings[s].siblings.push(m.siblings[p])
        }
        for (m.onCreate(), m.recycled || cr.seal(m), (s = 0, l = m.behavior_insts.length); s < l; s++) m.behavior_insts[s].postCreate && m.behavior_insts[s].postCreate();
        return m
    }, e.prototype.getLayerByName = function(e) {
        var t, r;
        for (t = 0, r = this.running_layout.layers.length; t < r; t++) {
            var n = this.running_layout.layers[t];
            if (cr.equals_nocase(n.name, e)) return n
        }
        return null
    }, e.prototype.getLayerByNumber = function(e) {
        return e = cr.floor(e), 0 > e && (e = 0), e >= this.running_layout.layers.length && (e = this.running_layout.layers.length - 1), this.running_layout.layers[e]
    }, e.prototype.getLayer = function(e) {
        return cr.is_number(e) ? this.getLayerByNumber(e) : this.getLayerByName(e.toString())
    }, e.prototype.clearSol = function(e) {
        var t, r;
        for (t = 0, r = e.length; t < r; t++) e[t].getCurrentSol().select_all = !0
    }, e.prototype.pushCleanSol = function(e) {
        var t, r;
        for (t = 0, r = e.length; t < r; t++) e[t].pushCleanSol()
    }, e.prototype.pushCopySol = function(e) {
        var t, r;
        for (t = 0, r = e.length; t < r; t++) e[t].pushCopySol()
    }, e.prototype.popSol = function(e) {
        var t, r;
        for (t = 0, r = e.length; t < r; t++) e[t].popSol()
    }, e.prototype.updateAllCells = function(e) {
        if (e.any_cell_changed) {
            var t = e.instances,
                r, n;
            for (r = 0, n = t.length; r < n; ++r) t[r].update_collision_cell();
            var a = this.createRow;
            for (r = 0, n = a.length; r < n; ++r) a[r].type === e && a[r].update_collision_cell();
            e.any_cell_changed = !1
        }
    }, e.prototype.getCollisionCandidates = function(e, r, n, a) {
        var o = !!e && (1 !== e.parallaxX || 1 !== e.parallaxY),
            s, l, p;
        if (r.is_family)
            for (s = 0, l = r.members.length; s < l; ++s) p = r.members[s], o || p.any_instance_parallaxed ? cr.appendArray(a, p.instances) : (this.updateAllCells(p), p.collision_grid.queryRange(n, a));
        else o || r.any_instance_parallaxed ? cr.appendArray(a, r.instances) : (this.updateAllCells(r), r.collision_grid.queryRange(n, a))
    }, e.prototype.getTypesCollisionCandidates = function(e, t, r, n) {
        var a, o;
        for (a = 0, o = t.length; a < o; ++a) this.getCollisionCandidates(e, t[a], r, n)
    }, e.prototype.getSolidCollisionCandidates = function(e, t, r) {
        var n = this.getSolidBehavior();
        return n ? void this.getTypesCollisionCandidates(e, n.my_types, t, r) : null
    }, e.prototype.getJumpthruCollisionCandidates = function(e, t, r) {
        var n = this.getJumpthruBehavior();
        return n ? void this.getTypesCollisionCandidates(e, n.my_types, t, r) : null
    }, e.prototype.testAndSelectCanvasPointOverlap = function(e, t, r, n) {
        var a = e.getCurrentSol(),
            o = this.getCurrentEventStack().current_event.orblock,
            s, l, p, d, c, u, g;
        if (a.select_all) {
            for (n || (a.select_all = !1, cr.clearArray(a.instances)), s = 0, d = e.instances.length; s < d; s++)
                if (p = e.instances[s], p.update_bbox(), c = p.layer.canvasToLayer(t, r, !0), u = p.layer.canvasToLayer(t, r, !1), p.contains_pt(c, u)) {
                    if (n) return !1;
                    a.instances.push(p)
                } else o && a.else_instances.push(p);
        } else {
            for (l = 0, g = o ? a.else_instances : a.instances, (s = 0, d = g.length); s < d; s++)
                if (p = g[s], p.update_bbox(), c = p.layer.canvasToLayer(t, r, !0), u = p.layer.canvasToLayer(t, r, !1), p.contains_pt(c, u)) {
                    if (n) return !1;
                    o ? a.instances.push(p) : (a.instances[l] = a.instances[s], l++)
                }
            n || (g.length = l)
        }
        return e.applySolToContainer(), !!n || a.hasObjects()
    }, e.prototype.testOverlap = function(e, t) {
        if (!e || !t || e === t || !e.collisionsEnabled || !t.collisionsEnabled) return !1;
        e.update_bbox(), t.update_bbox();
        var r = e.layer,
            n = t.layer,
            a = r !== n && (r.parallaxX !== n.parallaxX || n.parallaxY !== n.parallaxY || r.scale !== n.scale || r.angle !== n.angle || r.zoomRate !== n.zoomRate),
            o, s, l, p, d, c, u, g, m, _;
        if (!a) return !!e.bbox.intersects_rect(t.bbox) && !!e.bquad.intersects_quad(t.bquad) && !(e.tilemap_exists && t.tilemap_exists) && (e.tilemap_exists ? this.testTilemapOverlap(e, t) : t.tilemap_exists ? this.testTilemapOverlap(t, e) : (u = e.collision_poly && !e.collision_poly.is_empty(), g = t.collision_poly && !t.collision_poly.is_empty(), !(u || g)) || (u ? (e.collision_poly.cache_poly(e.width, e.height, e.angle), m = e.collision_poly) : (this.temp_poly.set_from_quad(e.bquad, e.x, e.y, e.width, e.height), m = this.temp_poly), g ? (t.collision_poly.cache_poly(t.width, t.height, t.angle), _ = t.collision_poly) : (this.temp_poly.set_from_quad(t.bquad, t.x, t.y, t.width, t.height), _ = this.temp_poly), m.intersects_poly(_, t.x - e.x, t.y - e.y)));
        for (u = e.collision_poly && !e.collision_poly.is_empty(), g = t.collision_poly && !t.collision_poly.is_empty(), u ? (e.collision_poly.cache_poly(e.width, e.height, e.angle), this.temp_poly.set_from_poly(e.collision_poly)) : this.temp_poly.set_from_quad(e.bquad, e.x, e.y, e.width, e.height), m = this.temp_poly, g ? (t.collision_poly.cache_poly(t.width, t.height, t.angle), this.temp_poly2.set_from_poly(t.collision_poly)) : this.temp_poly2.set_from_quad(t.bquad, t.x, t.y, t.width, t.height), _ = this.temp_poly2, (o = 0, s = m.pts_count); o < s; o++) l = 2 * o, p = l + 1, d = m.pts_cache[l], c = m.pts_cache[p], m.pts_cache[l] = r.layerToCanvas(d + e.x, c + e.y, !0), m.pts_cache[p] = r.layerToCanvas(d + e.x, c + e.y, !1);
        for (m.update_bbox(), o = 0, s = _.pts_count; o < s; o++) l = 2 * o, p = l + 1, d = _.pts_cache[l], c = _.pts_cache[p], _.pts_cache[l] = n.layerToCanvas(d + t.x, c + t.y, !0), _.pts_cache[p] = n.layerToCanvas(d + t.x, c + t.y, !1);
        return _.update_bbox(), m.intersects_poly(_, 0, 0)
    };
    var M = new cr.quad,
        z = new cr.rect(0, 0, 0, 0),
        G = [];
    e.prototype.testTilemapOverlap = function(e, t) {
        var r = t.bbox,
            n = e.x,
            a = e.y,
            o, s, l, p;
        e.getCollisionRectCandidates(r, G);
        var d = G,
            u = t.collision_poly && !t.collision_poly.is_empty();
        for (o = 0, s = d.length; o < s; ++o)
            if (l = d[o], p = l.rc, r.intersects_rect_off(p, n, a) && (M.set_from_rect(p), M.offset(n, a), M.intersects_quad(t.bquad)))
                if (!u) {
                    if (!l.poly) return cr.clearArray(G), !0;
                    if (this.temp_poly.set_from_quad(t.bquad, 0, 0, t.width, t.height), l.poly.intersects_poly(this.temp_poly, -(n + p.left), -(a + p.top))) return cr.clearArray(G), !0
                } else if (t.collision_poly.cache_poly(t.width, t.height, t.angle), l.poly) {
            if (l.poly.intersects_poly(t.collision_poly, t.x - (n + p.left), t.y - (a + p.top))) return cr.clearArray(G), !0;
        } else if (this.temp_poly.set_from_quad(M, 0, 0, p.right - p.left, p.bottom - p.top), this.temp_poly.intersects_poly(t.collision_poly, t.x, t.y)) return cr.clearArray(G), !0;
        return cr.clearArray(G), !1
    }, e.prototype.testRectOverlap = function(e, t) {
        if (!t || !t.collisionsEnabled) return !1;
        t.update_bbox();
        var r = t.layer,
            n;
        if (!t.bbox.intersects_rect(e)) return !1;
        if (t.tilemap_exists) {
            t.getCollisionRectCandidates(e, G);
            var a = G,
                o = t.x,
                s = t.y,
                l, p, d, u;
            for (l = 0, p = a.length; l < p; ++l)
                if (d = a[l], u = d.rc, e.intersects_rect_off(u, o, s)) {
                    if (!d.poly) return cr.clearArray(G), !0;
                    if (this.temp_poly.set_from_rect(e, 0, 0), d.poly.intersects_poly(this.temp_poly, -(o + u.left), -(s + u.top))) return cr.clearArray(G), !0
                }
            return cr.clearArray(G), !1
        }
        return (M.set_from_rect(e), !!t.bquad.intersects_quad(M)) && ((n = t.collision_poly && !t.collision_poly.is_empty(), !!!n) || (t.collision_poly.cache_poly(t.width, t.height, t.angle), M.offset(-e.left, -e.top), this.temp_poly.set_from_quad(M, 0, 0, 1, 1), t.collision_poly.intersects_poly(this.temp_poly, e.left - t.x, e.top - t.y)))
    }, e.prototype.testSegmentOverlap = function(e, t, r, n, a) {
        if (!a || !a.collisionsEnabled) return !1;
        a.update_bbox();
        var o = a.layer,
            s;
        if (z.set(cr.min(e, r), cr.min(t, n), cr.max(e, r), cr.max(t, n)), !a.bbox.intersects_rect(z)) return !1;
        if (a.tilemap_exists) {
            a.getCollisionRectCandidates(z, G);
            var l = G,
                p = a.x,
                d = a.y,
                u, g, y, m;
            for (u = 0, g = l.length; u < g; ++u)
                if (y = l[u], m = y.rc, z.intersects_rect_off(m, p, d) && (M.set_from_rect(m), M.offset(p, d), M.intersects_segment(e, t, r, n))) {
                    if (!y.poly) return cr.clearArray(G), !0;
                    if (y.poly.intersects_segment(p + m.left, d + m.top, e, t, r, n)) return cr.clearArray(G), !0
                }
            return cr.clearArray(G), !1
        }
        return !!a.bquad.intersects_segment(e, t, r, n) && ((s = a.collision_poly && !a.collision_poly.is_empty(), !!!s) || (a.collision_poly.cache_poly(a.width, a.height, a.angle), a.collision_poly.intersects_segment(a.x, a.y, e, t, r, n)))
    }, e.prototype.typeHasBehavior = function(e, t) {
        if (!t) return !1;
        var r, n, a, o, s;
        for (r = 0, n = e.behaviors.length; r < n; r++)
            if (e.behaviors[r].behavior instanceof t) return !0;
        if (!e.is_family)
            for (r = 0, n = e.families.length; r < n; r++)
                for (s = e.families[r], a = 0, o = s.behaviors.length; a < o; a++)
                    if (s.behaviors[a].behavior instanceof t) return !0;
        return !1
    }, e.prototype.typeHasNoSaveBehavior = function(e) {
        return this.typeHasBehavior(e, cr.behaviors.NoSave)
    }, e.prototype.typeHasPersistBehavior = function(e) {
        return this.typeHasBehavior(e, cr.behaviors.Persist)
    }, e.prototype.getSolidBehavior = function() {
        return this.solidBehavior
    }, e.prototype.getJumpthruBehavior = function() {
        return this.jumpthruBehavior
    };
    var W = [];
    e.prototype.testOverlapSolid = function(e) {
        var t, r, n;
        for (e.update_bbox(), this.getSolidCollisionCandidates(e.layer, e.bbox, W), (t = 0, r = W.length); t < r; ++t)
            if (n = W[t], n.extra.solidEnabled && this.testOverlap(e, n)) return cr.clearArray(W), n;
        return cr.clearArray(W), null
    }, e.prototype.testRectOverlapSolid = function(e) {
        var t, r, n;
        for (this.getSolidCollisionCandidates(null, e, W), t = 0, r = W.length; t < r; ++t)
            if (n = W[t], n.extra.solidEnabled && this.testRectOverlap(e, n)) return cr.clearArray(W), n;
        return cr.clearArray(W), null
    };
    var U = [];
    e.prototype.testOverlapJumpThru = function(e, t) {
        var r = null;
        t && (r = U, cr.clearArray(r)), e.update_bbox(), this.getJumpthruCollisionCandidates(e.layer, e.bbox, W);
        var n, a, o;
        for (n = 0, a = W.length; n < a; ++n)
            if (o = W[n], o.extra.jumpthruEnabled && this.testOverlap(e, o))
                if (t) r.push(o);
                else return cr.clearArray(W), o;
        return cr.clearArray(W), r
    }, e.prototype.pushOutSolid = function(e, t, r, n, a, o) {
        var s = e.x,
            l = e.y,
            p = null,
            d = null,
            c;
        for (c = 0; c < (n || 50); c++)
            if (e.x = s + t * c, e.y = l + r * c, e.set_bbox_changed(), !this.testOverlap(e, p) && (p = this.testOverlapSolid(e), p && (d = p), !p && (a && (p = o ? this.testOverlap(e, o) ? o : null : this.testOverlapJumpThru(e), p && (d = p)), !p))) return d && this.pushInFractional(e, t, r, d, 16), !0;
        return e.x = s, e.y = l, e.set_bbox_changed(), !1
    }, e.prototype.pushOutSolidAxis = function(e, t, r, n) {
        n = n || 50;
        var a = e.x,
            o = e.y,
            s = null,
            l = null,
            p, d, c;
        for (p = 0; p < n; ++p)
            for (d = 0; 2 > d; ++d)
                if (c = 2 * d - 1, e.x = a + t * p * c, e.y = o + r * p * c, e.set_bbox_changed(), !this.testOverlap(e, s))
                    if (s = this.testOverlapSolid(e), s) l = s;
                    else return l && this.pushInFractional(e, t * c, r * c, l, 16), !0;
        return e.x = a, e.y = o, e.set_bbox_changed(), !1
    }, e.prototype.pushOut = function(e, t, r, n, a) {
        var o = e.x,
            s = e.y,
            l;
        for (l = 0; l < (n || 50); l++)
            if (e.x = o + t * l, e.y = s + r * l, e.set_bbox_changed(), !this.testOverlap(e, a)) return !0;
        return e.x = o, e.y = s, e.set_bbox_changed(), !1
    }, e.prototype.pushInFractional = function(e, t, r, n, a) {
        for (var o = 2, i = !1, s = !1, l = e.x, p = e.y, d; o <= a;) d = 1 / o, o *= 2, e.x += t * d * (i ? 1 : -1), e.y += r * d * (i ? 1 : -1), e.set_bbox_changed(), this.testOverlap(e, n) ? (i = !0, s = !0) : (i = !1, s = !1, l = e.x, p = e.y);
        s && (e.x = l, e.y = p, e.set_bbox_changed())
    }, e.prototype.pushOutSolidNearest = function(e, t) {
        var r = cr.is_undefined(t) ? 100 : t,
            n = 0,
            a = e.x,
            o = e.y,
            i = 0,
            s = 0,
            l = 0,
            p = this.testOverlapSolid(e);
        if (!p) return !0;
        for (; n <= r;)
            if (0 == i ? (s = 0, l = -1, n++) : 1 == i ? (s = 1, l = -1) : 2 == i ? (s = 1, l = 0) : 3 == i ? (s = 1, l = 1) : 4 == i ? (s = 0, l = 1) : 5 == i ? (s = -1, l = 1) : 6 == i ? (s = -1, l = 0) : 7 == i ? (s = -1, l = -1) : void 0, i = (i + 1) % 8, e.x = cr.floor(a + s * n), e.y = cr.floor(o + l * n), e.set_bbox_changed(), !this.testOverlap(e, p) && (p = this.testOverlapSolid(e), !p)) return !0;
        return e.x = a, e.y = o, e.set_bbox_changed(), !1
    }, e.prototype.registerCollision = function(e, t) {
        e.collisionsEnabled && t.collisionsEnabled && this.registered_collisions.push([e, t])
    }, e.prototype.addRegisteredCollisionCandidates = function(e, t, n) {
        var a, o, s, l;
        for (a = 0, o = this.registered_collisions.length; a < o; ++a) {
            if (s = this.registered_collisions[a], l = null, s[0] === e) l = s[1];
            else if (s[1] === e) l = s[0];
            else continue;
            if (t.is_family) {
                if (-1 === t.members.indexOf(t)) continue;
            } else if (l.type !== t) continue; - 1 === n.indexOf(l) && n.push(l)
        }
    }, e.prototype.checkRegisteredCollision = function(e, t) {
        var r, n, a;
        for (r = 0, n = this.registered_collisions.length; r < n; r++)
            if (a = this.registered_collisions[r], a[0] === e && a[1] === t || a[0] === t && a[1] === e) return !0;
        return !1
    }, e.prototype.calculateSolidBounceAngle = function(e, t, r, n) {
        var a = e.x,
            o = e.y,
            s = cr.max(10, cr.distanceTo(t, r, a, o)),
            l = cr.angleTo(t, r, a, o),
            p = n || this.testOverlapSolid(e);
        if (!p) return cr.clamp_angle(l + cr.PI);
        var d = p,
            c = cr.to_radians(5),
            u, g, y, m;
        for (u = 1; 36 > u; u++)
            if (g = l - u * c, e.x = t + h(g) * s, e.y = r + x(g) * s, e.set_bbox_changed(), !this.testOverlap(e, d) && (d = n ? null : this.testOverlapSolid(e), !d)) {
                y = g;
                break
            }
        36 === u && (y = cr.clamp_angle(l + cr.PI));
        var d = p;
        for (u = 1; 36 > u; u++)
            if (g = l + u * c, e.x = t + h(g) * s, e.y = r + x(g) * s, e.set_bbox_changed(), !this.testOverlap(e, d) && (d = n ? null : this.testOverlapSolid(e), !d)) {
                m = g;
                break
            }
        if (36 === u && (m = cr.clamp_angle(l + cr.PI)), e.x = a, e.y = o, e.set_bbox_changed(), m === y) return m;
        var _ = cr.angleDiff(m, y) / 2,
            f;
        f = cr.angleClockwise(m, y) ? cr.clamp_angle(y + _ + cr.PI) : cr.clamp_angle(m + _);
        var b = h(l),
            v = x(l),
            w = h(f),
            S = x(f),
            T = b * w + v * S;
        return cr.angleTo(0, 0, b - 2 * T * w, v - 2 * T * S)
    };
    var V = -1;
    e.prototype.trigger = function(e, t, n) {
        if (!this.running_layout) return !1;
        var a = this.running_layout.event_sheet;
        if (!a) return !1;
        var o = !1,
            s, l, p;
        V++;
        var d = a.deep_includes;
        for (l = 0, p = d.length; l < p; ++l) s = this.triggerOnSheet(e, t, d[l], n), o = o || s;
        return s = this.triggerOnSheet(e, t, a, n), o = o || s, V--, o
    }, e.prototype.triggerOnSheet = function(e, t, n, a) {
        var o = !1,
            s, l, p, d;
        if (!t) p = this.triggerOnSheetForTypeName(e, t, "system", n, a), o = o || p;
        else
            for (p = this.triggerOnSheetForTypeName(e, t, t.type.name, n, a), o = o || p, d = t.type.families, (s = 0, l = d.length); s < l; ++s) p = this.triggerOnSheetForTypeName(e, t, d[s].name, n, a), o = o || p;
        return o
    }, e.prototype.triggerOnSheetForTypeName = function(e, t, r, n, a) {
        var o = !1,
            s = !1,
            l = "undefined" != typeof a,
            p = l ? n.fasttriggers : n.triggers,
            d = p[r],
            c, u, g, y;
        if (!d) return o;
        var m = null;
        for (c = 0, u = d.length; c < u; ++c)
            if (d[c].method == e) {
                m = d[c].evs;
                break
            }
        if (!m) return o;
        var _;
        if (_ = l ? m[a] : m, !_) return null;
        for (c = 0, u = _.length; c < u; c++) g = _[c][0], y = _[c][1], s = this.executeSingleTrigger(t, r, g, y), o = o || s;
        return o
    }, e.prototype.executeSingleTrigger = function(e, t, r, n) {
        var a = !1,
            o, s;
        this.trigger_depth++;
        var l = this.getCurrentEventStack().current_event;
        l && this.pushCleanSol(l.solModifiersIncludingParents);
        var p = 1 < this.trigger_depth;
        this.pushCleanSol(r.solModifiersIncludingParents), p && this.pushLocalVarStack();
        var d = this.pushEventStack(r);
        if (d.current_event = r, e) {
            var c = this.types[t].getCurrentSol();
            c.select_all = !1, cr.clearArray(c.instances), c.instances[0] = e, this.types[t].applySolToContainer()
        }
        var u = !0;
        if (r.parent) {
            for (var g = d.temp_parents_arr, y = r.parent; y;) g.push(y), y = y.parent;
            for (g.reverse(), o = 0, s = g.length; o < s; o++)
                if (!g[o].run_pretrigger()) {
                    u = !1;
                    break
                }
        }
        return u && (this.execcount++, r.orblock ? r.run_orblocktrigger(n) : r.run(), a = a || d.last_event_true), this.popEventStack(), p && this.popLocalVarStack(), this.popSol(r.solModifiersIncludingParents), l && this.popSol(l.solModifiersIncludingParents), this.hasPendingInstances && 0 === this.isInOnDestroy && 0 == V && !this.isRunningEvents && this.ClearDeathRow(), this.trigger_depth--, a
    }, e.prototype.getCurrentCondition = function() {
        var e = this.getCurrentEventStack();
        return e.current_event.conditions[e.cndindex]
    }, e.prototype.getCurrentConditionObjectType = function() {
        var e = this.getCurrentCondition();
        return e.type
    }, e.prototype.isCurrentConditionFirst = function() {
        var e = this.getCurrentEventStack();
        return 0 === e.cndindex
    }, e.prototype.getCurrentAction = function() {
        var e = this.getCurrentEventStack();
        return e.current_event.actions[e.actindex]
    }, e.prototype.pushLocalVarStack = function() {
        this.localvar_stack_index++, this.localvar_stack_index >= this.localvar_stack.length && this.localvar_stack.push([])
    }, e.prototype.popLocalVarStack = function() {
        this.localvar_stack_index--
    }, e.prototype.getCurrentLocalVarStack = function() {
        return this.localvar_stack[this.localvar_stack_index]
    }, e.prototype.pushEventStack = function(e) {
        this.event_stack_index++, this.event_stack_index >= this.event_stack.length && this.event_stack.push(new cr.eventStackFrame);
        var t = this.getCurrentEventStack();
        return t.reset(e), t
    }, e.prototype.popEventStack = function() {
        this.event_stack_index--
    }, e.prototype.getCurrentEventStack = function() {
        return this.event_stack[this.event_stack_index]
    }, e.prototype.pushLoopStack = function(e) {
        this.loop_stack_index++, this.loop_stack_index >= this.loop_stack.length && this.loop_stack.push(cr.seal({
            name: e,
            index: 0,
            stopped: !1
        }));
        var t = this.getCurrentLoop();
        return t.name = e, t.index = 0, t.stopped = !1, t
    }, e.prototype.popLoopStack = function() {
        this.loop_stack_index--
    }, e.prototype.getCurrentLoop = function() {
        return this.loop_stack[this.loop_stack_index]
    }, e.prototype.getEventVariableByName = function(t, r) {
        for (var n, a, o, s, l, p; r;) {
            for (n = 0, a = r.subevents.length; n < a; n++)
                if (p = r.subevents[n], p instanceof cr.eventvariable && cr.equals_nocase(t, p.name)) return p;
            r = r.parent
        }
        for (n = 0, a = this.eventsheets_by_index.length; n < a; n++)
            for (l = this.eventsheets_by_index[n], o = 0, s = l.events.length; o < s; o++)
                if (p = l.events[o], p instanceof cr.eventvariable && cr.equals_nocase(t, p.name)) return p;
        return null
    }, e.prototype.getLayoutBySid = function(e) {
        var t, r;
        for (t = 0, r = this.layouts_by_index.length; t < r; t++)
            if (this.layouts_by_index[t].sid === e) return this.layouts_by_index[t];
        return null
    }, e.prototype.getObjectTypeBySid = function(e) {
        var t, r;
        for (t = 0, r = this.types_by_index.length; t < r; t++)
            if (this.types_by_index[t].sid === e) return this.types_by_index[t];
        return null
    }, e.prototype.getGroupBySid = function(e) {
        var t, r;
        for (t = 0, r = this.allGroups.length; t < r; t++)
            if (this.allGroups[t].sid === e) return this.allGroups[t];
        return null
    }, e.prototype.requirePermissions = function(e) {
        return this.getPermissions(e).then(function(e) {
            if (!1 === e) return Promise.reject("Permission not granted")
        })
    }, e.prototype.getPermissions = function(e) {
        return this.isCordova && this.isAndroid ? e.reduce(function(e, t) {
            return e.then(function(e) {
                return !1 !== e && s(t).then(function(e) {
                    return !!e || i(t)
                })
            })
        }, Promise.resolve(!0)) : Promise.resolve(!0)
    }, e.prototype.doCanvasSnapshot = function(e, t) {
        this.snapshotCanvas = [e, t], this.redraw = !0
    };
    e.prototype.signalContinuousPreview = function() {
        this.signalledContinuousPreview = !0
    };
    e.prototype.handleSaveLoad = function() {
        var t = this,
            e = this.saveToSlot,
            r = this.lastSaveJson,
            n = this.loadFromSlot,
            a = !1;
        if (this.signalledContinuousPreview && (a = !0, e = "__c2_continuouspreview", this.signalledContinuousPreview = !1), e.length) {
            if (this.ClearDeathRow(), r = this.saveToJSONString(), l()) d(e, r, function() {
                cr.logexport("Saved state to IndexedDB storage (" + r.length + " bytes)"), t.lastSaveJson = r, t.trigger(cr.system_object.prototype.cnds.OnSaveComplete, null), t.lastSaveJson = "", r = "", a && u()
            }, function(n) {
                try {
                    localStorage.setItem("__c2save_" + e, r), cr.logexport("Saved state to WebStorage (" + r.length + " bytes)"), t.lastSaveJson = r, t.trigger(cr.system_object.prototype.cnds.OnSaveComplete, null), t.lastSaveJson = "", r = "", a && u()
                } catch (e) {
                    cr.logexport("Failed to save game state: " + n + "; " + e), t.trigger(cr.system_object.prototype.cnds.OnSaveFailed, null)
                }
            });
            else try {
                localStorage.setItem("__c2save_" + e, r), cr.logexport("Saved state to WebStorage (" + r.length + " bytes)"), t.lastSaveJson = r, this.trigger(cr.system_object.prototype.cnds.OnSaveComplete, null), t.lastSaveJson = "", r = "", a && u()
            } catch (r) {
                cr.logexport("Error saving to WebStorage: " + r), t.trigger(cr.system_object.prototype.cnds.OnSaveFailed, null)
            }
            this.saveToSlot = "", this.loadFromSlot = "", this.loadFromJson = null
        }
        if (n.length) {
            if (l()) c(n, function(e) {
                e ? (t.loadFromJson = e, cr.logexport("Loaded state from IndexedDB storage (" + t.loadFromJson.length + " bytes)")) : (t.loadFromJson = localStorage.getItem("__c2save_" + n) || "", cr.logexport("Loaded state from WebStorage (" + t.loadFromJson.length + " bytes)")), t.suspendDrawing = !1, t.loadFromJson || (t.loadFromJson = null, t.trigger(cr.system_object.prototype.cnds.OnLoadFailed, null))
            }, function() {
                t.loadFromJson = localStorage.getItem("__c2save_" + n) || "", cr.logexport("Loaded state from WebStorage (" + t.loadFromJson.length + " bytes)"), t.suspendDrawing = !1, t.loadFromJson || (t.loadFromJson = null, t.trigger(cr.system_object.prototype.cnds.OnLoadFailed, null))
            });
            else {
                try {
                    this.loadFromJson = localStorage.getItem("__c2save_" + n) || "", cr.logexport("Loaded state from WebStorage (" + this.loadFromJson.length + " bytes)")
                } catch (t) {
                    this.loadFromJson = null
                }
                this.suspendDrawing = !1, t.loadFromJson || (t.loadFromJson = null, t.trigger(cr.system_object.prototype.cnds.OnLoadFailed, null))
            }
            this.loadFromSlot = "", this.saveToSlot = ""
        }
        if (null !== this.loadFromJson) {
            this.ClearDeathRow();
            var o = this.loadFromJSONString(this.loadFromJson);
            o ? (this.lastSaveJson = this.loadFromJson, this.trigger(cr.system_object.prototype.cnds.OnLoadComplete, null), this.lastSaveJson = "") : t.trigger(cr.system_object.prototype.cnds.OnLoadFailed, null), this.loadFromJson = null
        }
    };
    e.prototype.saveToJSONString = function() {
        var e = {
                c2save: !0,
                version: 1,
                rt: {
                    time: this.kahanTime.sum,
                    walltime: this.wallTime.sum,
                    timescale: this.timescale,
                    tickcount: this.tickcount,
                    execcount: this.execcount,
                    next_uid: this.next_uid,
                    running_layout: this.running_layout.sid,
                    start_time_offset: Date.now() - this.start_time
                },
                types: {},
                layouts: {},
                events: {
                    groups: {},
                    cnds: {},
                    acts: {},
                    vars: {}
                }
            },
            t, r, n, o, s, l, d, u, y, m, _, h;
        for (t = 0, r = this.types_by_index.length; t < r; t++)
            if (s = this.types_by_index[t], !(s.is_family || this.typeHasNoSaveBehavior(s))) {
                for (d = {
                        instances: []
                    }, cr.hasAnyOwnProperty(s.extra) && (d.ex = g(s.extra)), (n = 0, o = s.instances.length); n < o; n++) d.instances.push(this.saveInstanceToJSON(s.instances[n]));
                e.types[s.sid.toString()] = d
            }
        for (t = 0, r = this.layouts_by_index.length; t < r; t++) l = this.layouts_by_index[t], e.layouts[l.sid.toString()] = l.saveToJSON();
        var f = e.events.groups;
        for (t = 0, r = this.allGroups.length; t < r; t++) u = this.allGroups[t], f[u.sid.toString()] = this.groups_by_name[u.group_name].group_active;
        var b = e.events.cnds;
        for (h in this.cndsBySid) this.cndsBySid.hasOwnProperty(h) && (y = this.cndsBySid[h], cr.hasAnyOwnProperty(y.extra) && (b[h] = {
            ex: g(y.extra)
        }));
        var x = e.events.acts;
        for (h in this.actsBySid) this.actsBySid.hasOwnProperty(h) && (m = this.actsBySid[h], cr.hasAnyOwnProperty(m.extra) && (x[h] = {
            ex: g(m.extra)
        }));
        var w = e.events.vars;
        for (h in this.varsBySid) this.varsBySid.hasOwnProperty(h) && (_ = this.varsBySid[h], _.is_constant || _.parent && !_.is_static || (w[h] = _.data));
        return e.system = this.system.saveToJSON(), JSON.stringify(e)
    }, e.prototype.refreshUidMap = function() {
        var e, t, r, n, a, o;
        for (this.objectsByUid = {}, e = 0, t = this.types_by_index.length; e < t; e++)
            if (r = this.types_by_index[e], !r.is_family)
                for (n = 0, a = r.instances.length; n < a; n++) o = r.instances[n], this.objectsByUid[o.uid.toString()] = o
    }, e.prototype.loadFromJSONString = function(e) {
        var r;
        try {
            r = JSON.parse(e)
        } catch (t) {
            return !1
        }
        if (!r.c2save) return !1;
        if (1 < r.version) return !1;
        this.isLoadingState = !0;
        var n = r.rt;
        this.kahanTime.reset(), this.kahanTime.sum = n.time, this.wallTime.reset(), this.wallTime.sum = n.walltime || 0, this.timescale = n.timescale, this.tickcount = n.tickcount, this.execcount = n.execcount, this.start_time = Date.now() - n.start_time_offset;
        var a = n.running_layout;
        if (a !== this.running_layout.sid) {
            var s = this.getLayoutBySid(a);
            if (s) this.doChangeLayout(s);
            else return
        }
        var l = r.types,
            d, c, u, y, m, _, h, f, b, x, v, w, S, T, O, E, C;
        for (h in l)
            if (l.hasOwnProperty(h)) {
                if (f = this.getObjectTypeBySid(parseInt(h, 10)), !f || f.is_family || this.typeHasNoSaveBehavior(f)) continue;
                for (l[h].ex ? f.extra = l[h].ex : cr.wipe(f.extra), b = f.instances, x = l[h].instances, (d = 0, c = cr.min(b.length, x.length)); d < c; d++) this.loadInstanceFromJSON(b[d], x[d]);
                for (d = x.length, c = b.length; d < c; d++) this.DestroyInstance(b[d]);
                for (d = b.length, c = x.length; d < c; d++)(T = null, !(f.plugin.is_world && (T = this.running_layout.getLayerBySid(x[d].w.l), !T))) && (v = this.createInstanceFromInit(f.default_instance, T, !1, 0, 0, !0), this.loadInstanceFromJSON(v, x[d]));
                f.stale_iids = !0
            }
        this.ClearDeathRow(), this.refreshUidMap();
        var A = r.layouts;
        for (h in A)
            if (A.hasOwnProperty(h)) {
                if (S = this.getLayoutBySid(parseInt(h, 10)), !S) continue;
                S.loadFromJSON(A[h])
            }
        var P = r.events.groups;
        for (h in P) P.hasOwnProperty(h) && (O = this.getGroupBySid(parseInt(h, 10)), O && this.groups_by_name[O.group_name] && this.groups_by_name[O.group_name].setGroupActive(P[h]));
        var L = r.events.cnds;
        for (h in this.cndsBySid) this.cndsBySid.hasOwnProperty(h) && (this.cndsBySid[h].extra = L.hasOwnProperty(h) ? L[h].ex : {});
        var I = r.events.acts;
        for (h in this.actsBySid) this.actsBySid.hasOwnProperty(h) && (this.actsBySid[h].extra = I.hasOwnProperty(h) ? I[h].ex : {});
        var R = r.events.vars;
        for (h in R) R.hasOwnProperty(h) && this.varsBySid.hasOwnProperty(h) && (this.varsBySid[h].data = R[h]);
        for (this.next_uid = n.next_uid, this.isLoadingState = !1, (d = 0, c = this.fireOnCreateAfterLoad.length); d < c; ++d) v = this.fireOnCreateAfterLoad[d], this.trigger(Object.getPrototypeOf(v.type.plugin).cnds.OnCreated, v);
        for (cr.clearArray(this.fireOnCreateAfterLoad), this.system.loadFromJSON(r.system), (d = 0, c = this.types_by_index.length); d < c; d++)
            if (f = this.types_by_index[d], !(f.is_family || this.typeHasNoSaveBehavior(f)))
                for (u = 0, y = f.instances.length; u < y; u++) {
                    if (v = f.instances[u], f.is_contained)
                        for (E = v.get_iid(), cr.clearArray(v.siblings), (m = 0, _ = f.container.length); m < _; m++) C = f.container[m], f !== C && v.siblings.push(C.instances[E]);
                    if (v.afterLoad && v.afterLoad(), v.behavior_insts)
                        for (m = 0, _ = v.behavior_insts.length; m < _; m++) w = v.behavior_insts[m], w.afterLoad && w.afterLoad()
                }
        return this.redraw = !0, !0
    }, e.prototype.saveInstanceToJSON = function(e, t) {
        var r = e.type,
            n = r.plugin,
            a = {},
            o, s, l, p, d;
        if (t ? a.c2 = !0 : a.uid = e.uid, cr.hasAnyOwnProperty(e.extra) && (a.ex = g(e.extra)), e.instance_vars && e.instance_vars.length)
            for (a.ivs = {}, o = 0, s = e.instance_vars.length; o < s; o++) a.ivs[e.type.instvar_sids[o].toString()] = e.instance_vars[o];
        if (n.is_world) {
            if (l = {
                    x: e.x,
                    y: e.y,
                    w: e.width,
                    h: e.height,
                    l: e.layer.sid,
                    zi: e.get_zindex()
                }, 0 !== e.angle && (l.a = e.angle), 1 !== e.opacity && (l.o = e.opacity), .5 !== e.hotspotX && (l.hX = e.hotspotX), .5 !== e.hotspotY && (l.hY = e.hotspotY), 0 !== e.blend_mode && (l.bm = e.blend_mode), e.visible || (l.v = e.visible), e.collisionsEnabled || (l.ce = e.collisionsEnabled), -1 !== e.my_timescale && (l.mts = e.my_timescale), r.effect_types.length)
                for (l.fx = [], o = 0, s = r.effect_types.length; o < s; o++) d = r.effect_types[o], l.fx.push({
                    name: d.name,
                    active: e.active_effect_flags[d.index],
                    params: e.effect_params[d.index]
                });
            a.w = l
        }
        if (e.behavior_insts && e.behavior_insts.length)
            for (a.behs = {}, o = 0, s = e.behavior_insts.length; o < s; o++) p = e.behavior_insts[o], p.saveToJSON && (a.behs[p.type.sid.toString()] = p.saveToJSON());
        return e.saveToJSON && (a.data = e.saveToJSON()), a
    }, e.prototype.getInstanceVarIndexBySid = function(e, t) {
        var r, n;
        for (r = 0, n = e.instvar_sids.length; r < n; r++)
            if (e.instvar_sids[r] === t) return r;
        return -1
    }, e.prototype.getBehaviorIndexBySid = function(e, t) {
        var r, n;
        for (r = 0, n = e.behavior_insts.length; r < n; r++)
            if (e.behavior_insts[r].type.sid === t) return r;
        return -1
    }, e.prototype.loadInstanceFromJSON = function(e, t, r) {
        var n = e.type,
            a = n.plugin,
            o, s, l, d, c, u, g, y, m, _, h;
        if (!r) e.uid = t.uid;
        else if (!t.c2) return;
        if (t.ex ? e.extra = t.ex : cr.wipe(e.extra), c = t.ivs, c)
            for (o in c)
                if (c.hasOwnProperty(o)) {
                    if (d = this.getInstanceVarIndexBySid(n, parseInt(o, 10)), 0 > d || d >= e.instance_vars.length) continue;
                    _ = c[o], null === _ && (_ = NaN), e.instance_vars[d] = _
                }
        if (a.is_world) {
            if (u = t.w, e.layer.sid !== u.l && (h = e.layer, e.layer = this.running_layout.getLayerBySid(u.l), e.layer ? (h.removeFromInstanceList(e, !0), e.layer.appendToInstanceList(e, !0), e.set_bbox_changed(), e.layer.setZIndicesStaleFrom(0)) : (e.layer = h, !r && this.DestroyInstance(e))), e.x = u.x, e.y = u.y, e.width = u.w, e.height = u.h, e.zindex = u.zi, e.angle = u.hasOwnProperty("a") ? u.a : 0, e.opacity = u.hasOwnProperty("o") ? u.o : 1, e.hotspotX = u.hasOwnProperty("hX") ? u.hX : .5, e.hotspotY = u.hasOwnProperty("hY") ? u.hY : .5, e.visible = !u.hasOwnProperty("v") || u.v, e.collisionsEnabled = !u.hasOwnProperty("ce") || u.ce, e.my_timescale = u.hasOwnProperty("mts") ? u.mts : -1, e.blend_mode = u.hasOwnProperty("bm") ? u.bm : 0, (e.compositeOp = cr.effectToCompositeOp(e.blend_mode), this.gl && cr.setGLBlend(e, e.blend_mode, this.gl), e.set_bbox_changed(), u.hasOwnProperty("fx")))
                for (s = 0, l = u.fx.length; s < l; s++) g = n.getEffectIndexByName(u.fx[s].name), 0 > g || (e.active_effect_flags[g] = u.fx[s].active, e.effect_params[g] = u.fx[s].params);
            e.updateActiveEffects()
        }
        if (y = t.behs, y)
            for (o in y)
                if (y.hasOwnProperty(o)) {
                    if (m = this.getBehaviorIndexBySid(e, parseInt(o, 10)), 0 > m) continue;
                    e.behavior_insts[m].loadFromJSON(y[o])
                }
        t.data && e.loadFromJSON(t.data)
    }, e.prototype.getProjectFileUrl = function(e) {
        return this.isPreview ? window.cr_previewProjectFiles.hasOwnProperty(e.toLowerCase()) ? window.cr_previewProjectFiles[e.toLowerCase()] : e : this.files_subfolder + e
    }, e.prototype.getProjectFileBlob = function(e) {
        return this.isPreview ? window.cr_previewProjectFileBlobs && window.cr_previewProjectFiles.hasOwnProperty(e.toLowerCase()) ? window.cr_previewProjectFileBlobs[e.toLowerCase()] : null : null
    }, e.prototype.getLocalFileUrl = function(e) {
        return this.isPreview ? window.cr_previewProjectFiles.hasOwnProperty(e.toLowerCase()) ? window.cr_previewProjectFiles[e.toLowerCase()] : e : e
    }, e.prototype.fetchLocalFileViaCordova = function(e, t, r) {
        var n = window.cordova.file.applicationDirectory + "www/" + e;
        window.resolveLocalFileSystemURL(n, function(e) {
            e.file(t, r)
        }, r)
    }, e.prototype.fetchLocalFileViaCordovaAsText = function(e, t, r) {
        this.fetchLocalFileViaCordova(e, function(e) {
            var n = new FileReader;
            n.onload = function(r) {
                t(r.target.result)
            }, n.onerror = r, n.readAsText(e)
        }, r)
    };
    var X = [],
        q = 0;
    e.prototype.maybeStartNextArrayBufferRead = function() {
        if (X.length && !(8 <= q)) {
            q++;
            var e = X.shift();
            this.doFetchLocalFileViaCordovaAsArrayBuffer(e.filename, e.successCallback, e.errorCallback)
        }
    }, e.prototype.fetchLocalFileViaCordovaAsArrayBuffer = function(e, t, r) {
        var n = this;
        X.push({
            filename: e,
            successCallback: function(e) {
                q--, n.maybeStartNextArrayBufferRead(), t(e)
            },
            errorCallback: function(e) {
                q--, n.maybeStartNextArrayBufferRead(), r(e)
            }
        }), this.maybeStartNextArrayBufferRead()
    }, e.prototype.doFetchLocalFileViaCordovaAsArrayBuffer = function(e, t, r) {
        this.fetchLocalFileViaCordova(e, function(e) {
            var r = new FileReader;
            r.onload = function(r) {
                t(r.target.result)
            }, r.readAsArrayBuffer(e)
        }, r)
    }, e.prototype.fetchLocalFileViaCordovaAsURL = function(e, t, r) {
        var n = "",
            a = e.toLowerCase(),
            o = a.substr(a.length - 4),
            i = a.substr(a.length - 5);
        ".mp4" === o ? n = "video/mp4" : ".webm" === i ? n = "video/webm" : ".m4a" === o ? n = "audio/mp4" : ".mp3" === o && (n = "audio/mpeg"), this.fetchLocalFileViaCordovaAsArrayBuffer(e, function(e) {
            var r = new Blob([e], {
                    type: n
                }),
                a = URL.createObjectURL(r);
            t(a)
        }, r)
    }, e.prototype.isAbsoluteUrl = function(e) {
        return /^(?:[a-z]+:)?\/\//.test(e) || "data:" === e.substr(0, 5) || "blob:" === e.substr(0, 5)
    }, e.prototype.setImageSrc = function(e, t) {
        this.isWKWebView && !this.isAbsoluteUrl(t) ? this.fetchLocalFileViaCordovaAsURL(t, function(t) {
            e.src = t
        }, function(e) {
            alert("Failed to load image: " + e)
        }) : this.isPreview && !this.isAbsoluteUrl(t) ? e.src = this.getLocalFileUrl(t) : (!this.isAbsoluteUrl(t) && (t = t.toLowerCase()), e.src = t)
    }, e.prototype.getPreferredAudioFile = function(e) {
        var t = e.toLowerCase();
        if (!this.audio_files_map.hasOwnProperty(t)) return null;
        var n = this.audio_files_map[t],
            a = null,
            o, s, l, p;
        for (o = 0, s = n.length; o < s; ++o)
            if (l = n[o], p = l[0], a || "audio/webm; codecs=opus" !== p || (a = l), S[p]) return l;
        return a
    }, e.prototype.getProjectAudioFileUrl = function(e) {
        var t = e.toLowerCase(),
            r = this.getPreferredAudioFile(e);
        if (!r) return null;
        var n = t + r[1];
        return {
            url: this.getProjectFileUrl(n),
            type: r[0]
        }
    }, e.prototype.getStatusInfo = function() {
        return {
            fps: this.fps,
            cpu: this.cpuutilisation / 1e3,
            gpu: this.gpuLastUtilisation,
            layout: this.running_layout ? this.running_layout.name : "",
            renderer: this.glUnmaskedRenderer
        }
    }, e.prototype.accelerate = function(e, t, r, n, a) {
        if (this.enhancedAccelerationPrecision) {
            return cr.clamp(e * a + .5 * n * a * a, t * a, r * a)
        }
        return e * a
    }, cr.runtime = e, cr.createRuntime = function(t) {
        return new e(t)
    }, window.cr_createRuntime = cr.createRuntime
})(), window.cr_getSnapshot = function(e, t) {
        var r = window.c3runtime;
        r && r.doCanvasSnapshot(e, t)
    }, window.cr_sizeCanvas = function(e, t) {
        if (0 !== e && 0 !== t) {
            var r = window.c3runtime;
            r && r.setSize(e, t)
        }
    }, window.cr_setSuspended = function(e) {
        var t = window.c3runtime;
        t && t.setSuspended(e)
    },
    function() {
        function e(e, t) {
            return e.zindex - t.zindex
        }

        function t(e, t) {
            this.layout = e, this.runtime = e.runtime, this.instances = [], this.scale = 1, this.angle = 0, this.disableAngle = !1, this.tmprect = new cr.rect(0, 0, 0, 0), this.tmpquad = new cr.quad, this.viewLeft = 0, this.viewRight = 0, this.viewTop = 0, this.viewBottom = 0, this.zindices_stale = !1, this.zindices_stale_from = -1, this.clear_earlyz_index = 0, this.name = t[0], this.index = t[1], this.sid = t[2], this.visible = t[3], this.background_color = t[4], this.transparent = t[5], this.parallaxX = t[6], this.parallaxY = t[7], this.opacity = t[8], this.forceOwnTexture = t[9], this.useRenderCells = t[10], this.zoomRate = t[11], this.blend_mode = t[12], this.effect_fallback = t[13], this.compositeOp = "source-over", this.srcBlend = 0, this.destBlend = 0, this.render_grid = null, this.last_render_list = r(), this.render_list_stale = !0, this.last_render_cells = new cr.rect(0, 0, -1, -1), this.cur_render_cells = new cr.rect(0, 0, -1, -1), this.useRenderCells && (this.render_grid = new cr.RenderGrid(this.runtime.original_width, this.runtime.original_height)), this.render_offscreen = !1;
            var n = t[14],
                a, o;
            for (this.startup_initial_instances = [], this.initial_instances = [], this.created_globals = [], (a = 0, o = n.length); a < o; a++) {
                var s = n[a],
                    l = this.runtime.types_by_index[s[1]];
                l.default_instance || (l.default_instance = s, l.default_layerindex = this.index), this.initial_instances.push(s), -1 === this.layout.initial_types.indexOf(l) && this.layout.initial_types.push(l)
            }
            for (cr.shallowAssignArray(this.startup_initial_instances, this.initial_instances), this.effect_types = [], this.active_effect_types = [], this.shaders_preserve_opaqueness = !0, this.effect_params = [], (a = 0, o = t[15].length); a < o; a++) this.effect_types.push({
                id: t[15][a][0],
                name: t[15][a][1],
                shaderindex: -1,
                preservesOpaqueness: !1,
                active: !0,
                index: a
            }), this.effect_params.push(t[15][a][2].slice(0));
            this.updateActiveEffects(), this.rcTexBounce = new cr.rect(0, 0, 1, 1), this.rcTexDest = new cr.rect(0, 0, 1, 1), this.rcTexOrigin = new cr.rect(0, 0, 1, 1)
        }

        function r() {
            return d.length ? d.pop() : []
        }

        function n(e) {
            cr.clearArray(e), d.push(e)
        }

        function a(e, t, r) {
            var n = 0,
                a = 0,
                o = 0,
                s = e.length,
                l = t.length,
                p, d;
            for (r.length = s + l; n < s && a < l; ++o) p = e[n], d = t[a], p.zindex < d.zindex ? (r[o] = p, ++n) : (r[o] = d, ++a);
            for (; n < s; ++n, ++o) r[o] = e[n];
            for (; a < l; ++a, ++o) r[o] = t[a]
        }

        function o(e, t) {
            var o, s, l, p, d;
            for (o = 0, s = e.length; o < s - 1; o += 2) l = e[o], p = e[o + 1], d = r(), a(l, p, d), t || (n(l), n(p)), c.push(d);
            1 == s % 2 && (t ? (l = r(), cr.shallowAssignArray(l, e[s - 1]), c.push(l)) : c.push(e[s - 1])), cr.shallowAssignArray(e, c), cr.clearArray(c)
        }

        function i(e) {
            for (var t = !0; 1 < e.length;) o(e, t), t = !1;
            return e[0]
        }
        var s = Math.round,
            l = Math.cos,
            p = Math.sin;
        t.prototype.updateActiveEffects = function() {
            cr.clearArray(this.active_effect_types), this.shaders_preserve_opaqueness = !0;
            var e, t, r;
            for (e = 0, t = this.effect_types.length; e < t; e++) r = this.effect_types[e], r.active && (this.active_effect_types.push(r), !r.preservesOpaqueness && (this.shaders_preserve_opaqueness = !1))
        }, t.prototype.getEffectByName = function(e) {
            var t, r, n;
            for (t = 0, r = this.effect_types.length; t < r; t++)
                if (n = this.effect_types[t], n.name === e) return n;
            return null
        }, t.prototype.createInitialInstances = function(e) {
            var t, r, n, a, o, s, l, p;
            for (t = 0, r = 0, n = this.initial_instances.length; t < n; t++) {
                if (o = this.initial_instances[t], s = this.runtime.types_by_index[o[1]], (p = this.runtime.typeHasPersistBehavior(s), l = !0, !p || this.layout.first_visit)) {
                    if (a = this.runtime.createInstanceFromInit(o, this, !0), !a) continue;
                    e.push(a), a.type.global && (l = !1, this.created_globals.push(a.uid))
                }
                l && (this.initial_instances[r] = this.initial_instances[t], r++)
            }
            this.initial_instances.length = r, this.runtime.ClearDeathRow(), !this.runtime.glwrap && this.effect_types.length && (this.blend_mode = this.effect_fallback), this.compositeOp = cr.effectToCompositeOp(this.blend_mode), this.runtime.gl && cr.setGLBlend(this, this.blend_mode, this.runtime.gl), this.render_list_stale = !0
        }, t.prototype.recreateInitialObjects = function(e, t) {
            var r = this.runtime.types_by_index,
                n = e.is_family,
                a = e.members,
                o, l, p, d, c, u, g, m, _, h, f;
            for (o = 0, l = this.initial_instances.length; o < l; ++o)
                if (p = this.initial_instances[o], c = p[0], u = c[0], g = c[1], t.contains_pt(u, g)) {
                    if (d = r[p[1]], d !== e)
                        if (!n) continue;
                        else if (0 > a.indexOf(d)) continue;
                    if (m = this.runtime.createInstanceFromInit(p, this, !1), this.runtime.isInOnDestroy++, this.runtime.trigger(Object.getPrototypeOf(d.plugin).cnds.OnCreated, m), m.is_contained)
                        for (_ = 0, h = m.siblings.length; _ < h; _++) f = m.siblings[o], this.runtime.trigger(Object.getPrototypeOf(f.type.plugin).cnds.OnCreated, f);
                    this.runtime.isInOnDestroy--
                }
        }, t.prototype.removeFromInstanceList = function(e, t) {
            var r = cr.fastIndexOf(this.instances, e);
            0 > r || (t && this.useRenderCells && e.rendercells && e.rendercells.right >= e.rendercells.left && (e.update_bbox(), this.render_grid.update(e, e.rendercells, null), e.rendercells.set(0, 0, -1, -1)), r === this.instances.length - 1 ? this.instances.pop() : (cr.arrayRemove(this.instances, r), this.setZIndicesStaleFrom(r)), this.render_list_stale = !0)
        }, t.prototype.appendToInstanceList = function(e, t) {
            e.zindex = this.instances.length, this.instances.push(e), t && this.useRenderCells && e.rendercells && e.set_bbox_changed(), this.render_list_stale = !0
        }, t.prototype.prependToInstanceList = function(e, t) {
            this.instances.unshift(e), this.setZIndicesStaleFrom(0), t && this.useRenderCells && e.rendercells && e.set_bbox_changed()
        }, t.prototype.moveInstanceAdjacent = function(e, t, r) {
            var n = e.get_zindex(),
                a = t.get_zindex();
            cr.arrayRemove(this.instances, n), n < a && a--, r && a++, a === this.instances.length ? this.instances.push(e) : this.instances.splice(a, 0, e), this.setZIndicesStaleFrom(n < a ? n : a)
        }, t.prototype.setZIndicesStaleFrom = function(e) {
            -1 === this.zindices_stale_from ? this.zindices_stale_from = e : e < this.zindices_stale_from && (this.zindices_stale_from = e), this.zindices_stale = !0, this.render_list_stale = !0
        }, t.prototype.updateZIndices = function() {
            if (this.zindices_stale) {
                -1 === this.zindices_stale_from && (this.zindices_stale_from = 0);
                var e, t, r;
                if (this.useRenderCells)
                    for (e = this.zindices_stale_from, t = this.instances.length; e < t; ++e) r = this.instances[e], r.zindex = e, this.render_grid.markRangeChanged(r.rendercells);
                else
                    for (e = this.zindices_stale_from, t = this.instances.length; e < t; ++e) this.instances[e].zindex = e;
                this.zindices_stale = !1, this.zindices_stale_from = -1
            }
        }, t.prototype.getScale = function(e) {
            return this.getNormalScale() * (this.runtime.fullscreenScalingQuality || e ? this.runtime.aspect_scale : 1)
        }, t.prototype.getNormalScale = function() {
            return (this.scale * this.layout.scale - 1) * this.zoomRate + 1
        }, t.prototype.getAngle = function() {
            return this.disableAngle ? 0 : cr.clamp_angle(this.layout.angle + this.angle)
        };
        var d = [];
        var c = [];
        var u = [];
        t.prototype.getRenderCellInstancesToDraw = function() {
            if (this.updateZIndices(), this.render_grid.queryRange(this.viewLeft, this.viewTop, this.viewRight, this.viewBottom, u), !u.length) return r();
            if (1 === u.length) {
                var e = r();
                return cr.shallowAssignArray(e, u[0]), cr.clearArray(u), e
            }
            var t = i(u);
            return cr.clearArray(u), t
        }, t.prototype.draw = function(e) {
            this.render_offscreen = this.forceOwnTexture || 1 !== this.opacity || 0 !== this.blend_mode;
            var t = this.runtime.canvas,
                r = e,
                a = !1;
            this.render_offscreen && (this.runtime.layer_canvas || (this.runtime.layer_canvas = document.createElement("canvas"), t = this.runtime.layer_canvas, t.width = this.runtime.draw_width, t.height = this.runtime.draw_height, this.runtime.layer_ctx = t.getContext("2d"), a = !0), t = this.runtime.layer_canvas, r = this.runtime.layer_ctx, t.width !== this.runtime.draw_width && (t.width = this.runtime.draw_width, a = !0), t.height !== this.runtime.draw_height && (t.height = this.runtime.draw_height, a = !0), a && (r.imageSmoothingEnabled = this.runtime.linearSampling), this.transparent && r.clearRect(0, 0, this.runtime.draw_width, this.runtime.draw_height));
            r.globalAlpha = 1, r.globalCompositeOperation = "source-over", this.transparent || (r.fillStyle = "rgb(" + this.background_color[0] + "," + this.background_color[1] + "," + this.background_color[2] + ")", r.fillRect(0, 0, this.runtime.draw_width, this.runtime.draw_height)), r.save(), this.disableAngle = !0;
            var o = this.canvasToLayer(0, 0, !0, !0),
                l = this.canvasToLayer(0, 0, !1, !0);
            this.disableAngle = !1, this.runtime.pixel_rounding && (o = s(o), l = s(l)), this.rotateViewport(o, l, r);
            var p = this.getScale();
            r.scale(p, p), r.translate(-o, -l);
            var d;
            this.useRenderCells ? (this.cur_render_cells.left = this.render_grid.XToCell(this.viewLeft), this.cur_render_cells.top = this.render_grid.YToCell(this.viewTop), this.cur_render_cells.right = this.render_grid.XToCell(this.viewRight), this.cur_render_cells.bottom = this.render_grid.YToCell(this.viewBottom), this.render_list_stale || !this.cur_render_cells.equals(this.last_render_cells) ? (n(this.last_render_list), d = this.getRenderCellInstancesToDraw(), this.render_list_stale = !1, this.last_render_cells.copy(this.cur_render_cells)) : d = this.last_render_list) : d = this.instances;
            var c = null,
                u, g, y;
            for (u = 0, g = d.length; u < g; ++u) y = d[u], y === c || (this.drawInstance(y, r), c = y);
            this.useRenderCells && (this.last_render_list = d), r.restore(), this.render_offscreen && (e.globalCompositeOperation = this.compositeOp, e.globalAlpha = this.opacity, e.drawImage(t, 0, 0))
        }, t.prototype.drawInstance = function(e, t) {
            if (e.visible && 0 !== e.width && 0 !== e.height) {
                e.update_bbox();
                var r = e.bbox;
                r.right < this.viewLeft || r.bottom < this.viewTop || r.left > this.viewRight || r.top > this.viewBottom || (t.globalCompositeOperation = e.compositeOp, e.draw(t))
            }
        }, t.prototype.updateViewport = function(e) {
            this.disableAngle = !0;
            var t = this.canvasToLayer(0, 0, !0, !0),
                r = this.canvasToLayer(0, 0, !1, !0);
            this.disableAngle = !1, this.runtime.pixel_rounding && (t = s(t), r = s(r)), this.rotateViewport(t, r, e)
        }, t.prototype.rotateViewport = function(e, t, r) {
            var n = this.getScale();
            this.viewLeft = e, this.viewTop = t, this.viewRight = e + this.runtime.draw_width * (1 / n), this.viewBottom = t + this.runtime.draw_height * (1 / n);
            var a = this.getAngle();
            0 !== a && (r && (r.translate(this.runtime.draw_width / 2, this.runtime.draw_height / 2), r.rotate(-a), r.translate(this.runtime.draw_width / -2, this.runtime.draw_height / -2)), this.tmprect.set(this.viewLeft, this.viewTop, this.viewRight, this.viewBottom), this.tmprect.offset((this.viewLeft + this.viewRight) / -2, (this.viewTop + this.viewBottom) / -2), this.tmpquad.set_from_rotated_rect(this.tmprect, a), this.tmpquad.bounding_box(this.tmprect), this.tmprect.offset((this.viewLeft + this.viewRight) / 2, (this.viewTop + this.viewBottom) / 2), this.viewLeft = this.tmprect.left, this.viewTop = this.tmprect.top, this.viewRight = this.tmprect.right, this.viewBottom = this.tmprect.bottom)
        }, t.prototype.drawGL_earlyZPass = function(e) {
            var t = this.runtime.draw_width,
                r = this.runtime.draw_height;
            this.render_offscreen = this.forceOwnTexture, this.render_offscreen && (!this.runtime.layer_tex && (this.runtime.layer_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), (this.runtime.layer_tex.c2width !== this.runtime.draw_width || this.runtime.layer_tex.c2height !== this.runtime.draw_height) && (e.deleteTexture(this.runtime.layer_tex), this.runtime.layer_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), e.setRenderingToTexture(this.runtime.layer_tex)), this.disableAngle = !0;
            var a = this.canvasToLayer(0, 0, !0, !0),
                o = this.canvasToLayer(0, 0, !1, !0);
            this.disableAngle = !1, this.runtime.pixel_rounding && (a = s(a), o = s(o)), this.rotateViewport(a, o, null);
            var l = this.getScale();
            e.resetModelView(), e.scale(l, l), e.rotateZ(-this.getAngle()), e.translate((this.viewLeft + this.viewRight) / -2, (this.viewTop + this.viewBottom) / -2), e.updateModelView();
            var p;
            this.useRenderCells ? (this.cur_render_cells.left = this.render_grid.XToCell(this.viewLeft), this.cur_render_cells.top = this.render_grid.YToCell(this.viewTop), this.cur_render_cells.right = this.render_grid.XToCell(this.viewRight), this.cur_render_cells.bottom = this.render_grid.YToCell(this.viewBottom), this.render_list_stale || !this.cur_render_cells.equals(this.last_render_cells) ? (n(this.last_render_list), p = this.getRenderCellInstancesToDraw(), this.render_list_stale = !1, this.last_render_cells.copy(this.cur_render_cells)) : p = this.last_render_list) : p = this.instances;
            var d = null,
                c, u;
            for (c = p.length - 1; 0 <= c; --c) u = p[c], u === d || (this.drawInstanceGL_earlyZPass(p[c], e), d = u);
            this.useRenderCells && (this.last_render_list = p), this.transparent || (this.clear_earlyz_index = this.runtime.earlyz_index++, e.setEarlyZIndex(this.clear_earlyz_index), e.setColorFillMode(1, 1, 1, 1), e.fullscreenQuad(), e.restoreEarlyZMode())
        }, t.prototype.drawGL = function(e) {
            var t = this.runtime.draw_width,
                r = this.runtime.draw_height,
                a = 0,
                o = 0;
            this.render_offscreen = this.forceOwnTexture || 1 !== this.opacity || 0 < this.active_effect_types.length || 0 !== this.blend_mode, this.render_offscreen && (!this.runtime.layer_tex && (this.runtime.layer_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), (this.runtime.layer_tex.c2width !== this.runtime.draw_width || this.runtime.layer_tex.c2height !== this.runtime.draw_height) && (e.deleteTexture(this.runtime.layer_tex), this.runtime.layer_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), e.setRenderingToTexture(this.runtime.layer_tex), this.transparent && e.clear(0, 0, 0, 0)), this.transparent || (this.runtime.enableFrontToBack ? (e.setEarlyZIndex(this.clear_earlyz_index), e.setColorFillMode(this.background_color[0] / 255, this.background_color[1] / 255, this.background_color[2] / 255, 1), e.fullscreenQuad(), e.setTextureFillMode()) : e.clear(this.background_color[0] / 255, this.background_color[1] / 255, this.background_color[2] / 255, 1)), this.disableAngle = !0;
            var l = this.canvasToLayer(0, 0, !0, !0),
                p = this.canvasToLayer(0, 0, !1, !0);
            this.disableAngle = !1, this.runtime.pixel_rounding && (l = s(l), p = s(p)), this.rotateViewport(l, p, null);
            var d = this.getScale();
            e.resetModelView(), e.scale(d, d), e.rotateZ(-this.getAngle()), e.translate((this.viewLeft + this.viewRight) / -2, (this.viewTop + this.viewBottom) / -2), e.updateModelView();
            var c;
            this.useRenderCells ? (this.cur_render_cells.left = this.render_grid.XToCell(this.viewLeft), this.cur_render_cells.top = this.render_grid.YToCell(this.viewTop), this.cur_render_cells.right = this.render_grid.XToCell(this.viewRight), this.cur_render_cells.bottom = this.render_grid.YToCell(this.viewBottom), this.render_list_stale || !this.cur_render_cells.equals(this.last_render_cells) ? (n(this.last_render_list), c = this.getRenderCellInstancesToDraw(), this.render_list_stale = !1, this.last_render_cells.copy(this.cur_render_cells)) : c = this.last_render_list) : c = this.instances;
            var u = null,
                g, y, m;
            if (this.getNormalScale() > 2220446049250313e-31)
                for (g = 0, y = c.length; g < y; ++g) m = c[g], m === u || (this.drawInstanceGL(c[g], e), u = m);
            if (this.useRenderCells && (this.last_render_list = c), this.render_offscreen)
                if (a = this.active_effect_types.length ? this.active_effect_types[0].shaderindex : 0, o = this.active_effect_types.length ? this.active_effect_types[0].index : 0, 0 === this.active_effect_types.length || 1 === this.active_effect_types.length && !e.programUsesCrossSampling(a) && 1 === this.opacity) {
                    1 === this.active_effect_types.length ? (e.switchProgram(a), e.setProgramParameters(this.layout.getRenderTarget(), 1 / this.runtime.draw_width, 1 / this.runtime.draw_height, 0, 0, 1, 1, 0, 0, 1, 1, this.viewLeft, this.viewTop, this.viewRight, this.viewBottom, 0, 0, 1, 1, d, this.getAngle(), this.runtime.kahanTime.sum, this.effect_params[o]), e.programIsAnimated(a) && (this.runtime.redraw = !0)) : e.switchProgram(0), e.setRenderingToTexture(this.layout.getRenderTarget()), e.setOpacity(this.opacity), e.setTexture(this.runtime.layer_tex), e.setBlend(this.srcBlend, this.destBlend), e.resetModelView(), e.updateModelView();
                    var _ = this.runtime.draw_width / 2,
                        h = this.runtime.draw_height / 2;
                    e.quad(-_, h, _, h, _, -h, -_, -h), e.setTexture(null)
                } else this.layout.renderEffectChain(e, this, null, this.layout.getRenderTarget())
        }, t.prototype.drawInstanceGL = function(e, t) {
            if (e.visible && 0 !== e.width && 0 !== e.height) {
                e.update_bbox();
                var r = e.bbox;
                r.right < this.viewLeft || r.bottom < this.viewTop || r.left > this.viewRight || r.top > this.viewBottom || (t.setEarlyZIndex(e.earlyz_index), e.uses_shaders ? this.drawInstanceWithShadersGL(e, t) : (t.switchProgram(0), t.setBlend(e.srcBlend, e.destBlend), e.drawGL(t)))
            }
        }, t.prototype.drawInstanceGL_earlyZPass = function(e, t) {
            if (e.visible && 0 !== e.width && 0 !== e.height) {
                e.update_bbox();
                var r = e.bbox;
                r.right < this.viewLeft || r.bottom < this.viewTop || r.left > this.viewRight || r.top > this.viewBottom || (e.earlyz_index = this.runtime.earlyz_index++, 0 === e.blend_mode && 1 === e.opacity && e.shaders_preserve_opaqueness && e.drawGL_earlyZPass && (t.setEarlyZIndex(e.earlyz_index), e.drawGL_earlyZPass(t)))
            }
        }, t.prototype.drawInstanceWithShadersGL = function(e, t) {
            var r = e.active_effect_types[0].shaderindex,
                n = e.active_effect_types[0].index,
                a = this.getScale();
            if (1 === e.active_effect_types.length && !t.programUsesCrossSampling(r) && !t.programExtendsBox(r) && (!e.angle && !e.layer.getAngle() || !t.programUsesDest(r)) && 1 === e.opacity && !e.type.plugin.must_predraw) {
                t.switchProgram(r), t.setBlend(e.srcBlend, e.destBlend), t.programIsAnimated(r) && (this.runtime.redraw = !0);
                var o = 0,
                    i = 0,
                    s = 0,
                    l = 0;
                if (t.programUsesDest(r)) {
                    var p = e.bbox,
                        d = this.layerToCanvas(p.left, p.top, !0, !0),
                        c = this.layerToCanvas(p.left, p.top, !1, !0),
                        u = this.layerToCanvas(p.right, p.bottom, !0, !0),
                        g = this.layerToCanvas(p.right, p.bottom, !1, !0);
                    o = d / windowWidth, i = 1 - c / windowHeight, s = u / windowWidth, l = 1 - g / windowHeight
                }
                var y = 0,
                    m = 0,
                    _ = 1,
                    h = 1,
                    f = 1 / e.width,
                    b = 1 / e.height;
                e.curFrame && e.curFrame.sheetTex && (y = e.curFrame.sheetTex.left, m = e.curFrame.sheetTex.top, _ = e.curFrame.sheetTex.right, h = e.curFrame.sheetTex.bottom, e.curFrame.texture_img && (f = 1 / e.curFrame.texture_img.width, b = 1 / e.curFrame.texture_img.height)), t.setProgramParameters(this.render_offscreen ? this.runtime.layer_tex : this.layout.getRenderTarget(), f, b, y, m, _, h, y, m, _, h, e.bbox.left, e.bbox.top, e.bbox.right, e.bbox.bottom, o, i, s, l, a, this.getAngle(), this.runtime.kahanTime.sum, e.effect_params[n]), e.drawGL(t)
            } else this.layout.renderEffectChain(t, this, e, this.render_offscreen ? this.runtime.layer_tex : this.layout.getRenderTarget()), t.resetModelView(), t.scale(a, a), t.rotateZ(-this.getAngle()), t.translate((this.viewLeft + this.viewRight) / -2, (this.viewTop + this.viewBottom) / -2), t.updateModelView()
        }, t.prototype.canvasToLayer = function(e, t, r, n) {
            var o = this.runtime.devicePixelRatio;
            this.runtime.isRetina && (e *= o, t *= o);
            var i = this.runtime.parallax_x_origin,
                s = this.runtime.parallax_y_origin,
                d = (this.layout.scrollX - i) * this.parallaxX + i,
                c = (this.layout.scrollY - s) * this.parallaxY + s,
                u = d,
                g = c,
                m = 1 / this.getScale(!n);
            n ? (u -= this.runtime.draw_width * m / 2, g -= this.runtime.draw_height * m / 2) : (u -= this.runtime.width * m / 2, g -= this.runtime.height * m / 2), u += e * m, g += t * m;
            var _ = this.getAngle();
            if (0 !== _) {
                u -= d, g -= c;
                var a = l(_),
                    h = p(_),
                    f = u * a - g * h;
                g = g * a + u * h, u = f, u += d, g += c
            }
            return r ? u : g
        }, t.prototype.layerToCanvas = function(e, t, r, n) {
            var o = this.runtime.parallax_x_origin,
                i = this.runtime.parallax_y_origin,
                s = (this.layout.scrollX - o) * this.parallaxX + o,
                d = (this.layout.scrollY - i) * this.parallaxY + i,
                c = s,
                u = d,
                g = this.getAngle();
            if (0 !== g) {
                e -= s, t -= d;
                var a = l(-g),
                    m = p(-g),
                    _ = e * a - t * m;
                t = t * a + e * m, e = _, e += s, t += d
            }
            var h = 1 / this.getScale(!n);
            n ? (c -= this.runtime.draw_width * h / 2, u -= this.runtime.draw_height * h / 2) : (c -= this.runtime.width * h / 2, u -= this.runtime.height * h / 2), c = (e - c) / h, u = (t - u) / h;
            var f = this.runtime.devicePixelRatio;
            return this.runtime.isRetina && !n && (c /= f, u /= f), r ? c : u
        }, t.prototype.rotatePt = function(e, t, r) {
            if (0 === this.getAngle()) return r ? e : t;
            var n = this.layerToCanvas(e, t, !0),
                a = this.layerToCanvas(e, t, !1);
            this.disableAngle = !0;
            var o = this.canvasToLayer(n, a, !0),
                i = this.canvasToLayer(n, a, !0);
            return this.disableAngle = !1, r ? o : i
        }, t.prototype.saveToJSON = function() {
            var e = {
                    s: this.scale,
                    a: this.angle,
                    vl: this.viewLeft,
                    vt: this.viewTop,
                    vr: this.viewRight,
                    vb: this.viewBottom,
                    v: this.visible,
                    bc: this.background_color,
                    t: this.transparent,
                    px: this.parallaxX,
                    py: this.parallaxY,
                    o: this.opacity,
                    zr: this.zoomRate,
                    fx: [],
                    cg: this.created_globals,
                    instances: []
                },
                t, r, n;
            for (t = 0, r = this.effect_types.length; t < r; t++) n = this.effect_types[t], e.fx.push({
                name: n.name,
                active: n.active,
                params: this.effect_params[n.index]
            });
            return e
        }, t.prototype.loadFromJSON = function(t) {
            var r, n, a, o;
            this.scale = t.s, this.angle = t.a, this.viewLeft = t.vl, this.viewTop = t.vt, this.viewRight = t.vr, this.viewBottom = t.vb, this.visible = t.v, this.background_color = t.bc, this.transparent = t.t, this.parallaxX = t.px, this.parallaxY = t.py, this.opacity = t.o, this.zoomRate = t.zr, this.created_globals = t.cg || [], cr.shallowAssignArray(this.initial_instances, this.startup_initial_instances);
            var s = new cr.ObjectSet;
            for (r = 0, a = this.created_globals.length; r < a; ++r) s.add(this.created_globals[r]);
            for (r = 0, n = 0, a = this.initial_instances.length; r < a; ++r) s.contains(this.initial_instances[r][2]) || (this.initial_instances[n] = this.initial_instances[r], ++n);
            cr.truncateArray(this.initial_instances, n);
            var l = t.fx;
            for (r = 0, a = l.length; r < a; r++) o = this.getEffectByName(l[r].name), o && (o.active = l[r].active, this.effect_params[o.index] = l[r].params);
            this.updateActiveEffects(), this.instances.sort(e), this.zindices_stale = !0
        }, cr.layer = t
    }();
(function() {
    function e(e, t) {
        this.runtime = e, this.event_sheet = null, this.scrollX = this.runtime.original_width / 2, this.scrollY = this.runtime.original_height / 2, this.scale = 1, this.angle = 0, this.first_visit = !0, this.name = t[0], this.originalWidth = t[1], this.originalHeight = t[2], this.width = t[1], this.height = t[2], this.unbounded_scrolling = t[3], this.sheetname = t[4], this.sid = t[5];
        var r = t[6],
            n, a;
        for (this.layers = [], this.initial_types = [], (n = 0, a = r.length); n < a; n++) {
            var o = new cr.layer(this, r[n]);
            o.number = n, cr.seal(o), this.layers.push(o)
        }
        var s = t[7];
        for (this.initial_nonworld = [], n = 0, a = s.length; n < a; n++) {
            var l = s[n],
                p = this.runtime.types_by_index[l[1]];
            p.default_instance || (p.default_instance = l), this.initial_nonworld.push(l), -1 === this.initial_types.indexOf(p) && this.initial_types.push(p)
        }
        for (this.effect_types = [], this.active_effect_types = [], this.shaders_preserve_opaqueness = !0, this.effect_params = [], (n = 0, a = t[8].length); n < a; n++) this.effect_types.push({
            id: t[8][n][0],
            name: t[8][n][1],
            shaderindex: -1,
            preservesOpaqueness: !1,
            active: !0,
            index: n
        }), this.effect_params.push(t[8][n][2].slice(0));
        this.updateActiveEffects(), this.rcTexBounce = new cr.rect(0, 0, 1, 1), this.rcTexDest = new cr.rect(0, 0, 1, 1), this.rcTexOrigin = new cr.rect(0, 0, 1, 1), this.viewRect = new cr.rect(0, 0, 0, 0), this.persist_data = {}
    }

    function t(e, t) {
        return e.zindex - t.zindex
    }

    function r(e) {
        return e.some(function(e) {
            return e.plugin.is_world
        })
    }
    var n = Math.max,
        a = Math.min;
    e.prototype.saveObjectToPersist = function(e) {
        var t = e.type.sid.toString();
        this.persist_data.hasOwnProperty(t) || (this.persist_data[t] = []);
        var r = this.persist_data[t];
        r.push(this.runtime.saveInstanceToJSON(e))
    }, e.prototype.hasOpaqueBottomLayer = function() {
        var e = this.layers[0];
        return !e.transparent && 1 === e.opacity && !e.forceOwnTexture && e.visible
    }, e.prototype.updateActiveEffects = function() {
        cr.clearArray(this.active_effect_types), this.shaders_preserve_opaqueness = !0;
        var e, t, r;
        for (e = 0, t = this.effect_types.length; e < t; e++) r = this.effect_types[e], r.active && (this.active_effect_types.push(r), !r.preservesOpaqueness && (this.shaders_preserve_opaqueness = !1))
    }, e.prototype.getEffectByName = function(e) {
        var t, r, n;
        for (t = 0, r = this.effect_types.length; t < r; t++)
            if (n = this.effect_types[t], n.name === e) return n;
        return null
    };
    var o = [];
    var s = !0;
    e.prototype.startRunning = function() {
        this.sheetname && (this.event_sheet = this.runtime.eventsheets[this.sheetname], this.event_sheet.updateDeepIncludes()), this.runtime.running_layout = this, this.width = this.originalWidth, this.height = this.originalHeight, this.scrollX = this.runtime.original_width / 2, this.scrollY = this.runtime.original_height / 2;
        var e, r, n, a, l, d, c, u, g, y, m, _;
        for (e = 0, n = this.runtime.types_by_index.length; e < n; e++)
            if (l = this.runtime.types_by_index[e], !l.is_family)
                for (d = l.instances, r = 0, a = d.length; r < a; r++)
                    if (u = d[r], u.layer) {
                        var h = u.layer.number;
                        h >= this.layers.length && (h = this.layers.length - 1), u.layer = this.layers[h], -1 === u.layer.instances.indexOf(u) && u.layer.instances.push(u), u.layer.zindices_stale = !0
                    }
        if (!s)
            for (e = 0, n = this.layers.length; e < n; ++e) this.layers[e].instances.sort(t);
        var _;
        for (cr.clearArray(o), this.boundScrolling(), (e = 0, n = this.layers.length); e < n; e++) _ = this.layers[e], _.createInitialInstances(o), _.updateViewport(null);
        var f = !1;
        if (!this.first_visit) {
            for (y in this.persist_data)
                if (this.persist_data.hasOwnProperty(y)) {
                    if (l = this.runtime.getObjectTypeBySid(parseInt(y, 10)), !l || l.is_family || !this.runtime.typeHasPersistBehavior(l)) continue;
                    for (m = this.persist_data[y], e = 0, n = m.length; e < n; e++)(_ = null, !(l.plugin.is_world && (_ = this.getLayerBySid(m[e].w.l), !_))) && (u = this.runtime.createInstanceFromInit(l.default_instance, _, !1, 0, 0, !0), this.runtime.loadInstanceFromJSON(u, m[e]), f = !0, o.push(u));
                    cr.clearArray(m)
                }
            for (e = 0, n = this.layers.length; e < n; e++) this.layers[e].instances.sort(t), this.layers[e].zindices_stale = !0
        }
        for (f && (this.runtime.ClearDeathRow(), this.runtime.refreshUidMap()), this.createAndLinkContainerInstances(o), (e = 0, n = this.initial_nonworld.length); e < n; e++) c = this.initial_nonworld[e], l = this.runtime.types_by_index[c[1]], l.is_contained || (u = this.runtime.createInstanceFromInit(this.initial_nonworld[e], null, !0));
        if (this.runtime.changelayout = null, this.runtime.ClearDeathRow(), this.runtime.ctx)
            for (e = 0, n = this.runtime.types_by_index.length; e < n; e++) g = this.runtime.types_by_index[e], g.is_family || !g.instances.length || !g.preloadCanvas2D || g.preloadCanvas2D(this.runtime.ctx);
        if (this.runtime.isLoadingState) cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad, o);
        else
            for (e = 0, n = o.length; e < n; e++) u = o[e], this.runtime.trigger(Object.getPrototypeOf(u.type.plugin).cnds.OnCreated, u);
        cr.clearArray(o), this.runtime.isLoadingState || this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart, null), this.first_visit = !1
    }, e.prototype.createAndLinkContainerInstances = function(e) {
        var r, n, a, o, l, p, d;
        for (r = 0; r < e.length; r++)
            if (n = e[r], n.type.is_contained)
                for (a = n.get_iid(), o = 0, l = n.type.container.length; o < l; o++) p = n.type.container[o], n.type === p || (p.instances.length > a ? n.siblings.push(p.instances[a]) : !p.default_instance || (d = this.runtime.createInstanceFromInit(p.default_instance, n.layer, !0, n.x, n.y, !0), this.runtime.ClearDeathRow(), p.updateIIDs(), n.siblings.push(d), e.push(d)))
    }, e.prototype.createGlobalNonWorlds = function() {
        var e = [],
            t, n, a, o, s;
        for (t = 0, n = 0, a = this.initial_nonworld.length; t < a; t++) o = this.initial_nonworld[t], s = this.runtime.types_by_index[o[1]], s.global ? (!s.is_contained || !r(s.container)) && e.push(this.runtime.createInstanceFromInit(o, null, !0)) : (this.initial_nonworld[n] = o, n++);
        cr.truncateArray(this.initial_nonworld, n), this.runtime.ClearDeathRow(), this.createAndLinkContainerInstances(e)
    }, e.prototype.stopRunning = function() {
        this.runtime.isLoadingState || this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd, null), this.runtime.isEndingLayout = !0, cr.clearArray(this.runtime.system.waits);
        var e, t, r, n, a, o, l;
        if (!this.first_visit)
            for (e = 0, t = this.layers.length; e < t; e++)
                for (this.layers[e].updateZIndices(), a = this.layers[e].instances, (r = 0, n = a.length); r < n; r++) o = a[r], !o.type.global && this.runtime.typeHasPersistBehavior(o.type) && this.saveObjectToPersist(o);
        for (e = 0, t = this.layers.length; e < t; e++) {
            for (a = this.layers[e].instances, r = 0, n = a.length; r < n; r++) o = a[r], o.type.global || this.runtime.DestroyInstance(o);
            this.runtime.ClearDeathRow(), cr.clearArray(a), this.layers[e].zindices_stale = !0
        }
        for (e = 0, t = this.runtime.types_by_index.length; e < t; e++)
            if (l = this.runtime.types_by_index[e], !(l.global || l.plugin.is_world || l.plugin.singleglobal || l.is_family)) {
                for (r = 0, n = l.instances.length; r < n; r++) this.runtime.DestroyInstance(l.instances[r]);
                this.runtime.ClearDeathRow()
            }
        s = !1, this.runtime.isEndingLayout = !1
    };
    var l = new cr.rect(0, 0, 0, 0);
    e.prototype.recreateInitialObjects = function(e, t, r, n, a) {
        l.set(t, r, n, a);
        var o, s;
        for (o = 0, s = this.layers.length; o < s; o++) this.layers[o].recreateInitialObjects(e, l)
    }, e.prototype.draw = function(e) {
        var t = e,
            r = !1,
            n = !this.runtime.fullscreenScalingQuality,
            a;
        n && (!this.runtime.layout_canvas && (this.runtime.layout_canvas = document.createElement("canvas"), a = this.runtime.layout_canvas, a.width = this.runtime.draw_width, a.height = this.runtime.draw_height, this.runtime.layout_ctx = a.getContext("2d"), r = !0), a = this.runtime.layout_canvas, t = this.runtime.layout_ctx, a.width !== this.runtime.draw_width && (a.width = this.runtime.draw_width, r = !0), a.height !== this.runtime.draw_height && (a.height = this.runtime.draw_height, r = !0), r && (t.imageSmoothingEnabled = this.runtime.linearSampling)), t.globalAlpha = 1, t.globalCompositeOperation = "source-over", this.runtime.clearBackground && !this.hasOpaqueBottomLayer() && t.clearRect(0, 0, this.runtime.draw_width, this.runtime.draw_height);
        var o, s, p;
        for (o = 0, s = this.layers.length; o < s; o++) p = this.layers[o], p.visible && 0 < p.opacity && 11 !== p.blend_mode && (p.instances.length || !p.transparent) ? p.draw(t) : p.updateViewport(null);
        n && e.drawImage(a, 0, 0, this.runtime.width, this.runtime.height)
    }, e.prototype.drawGL_earlyZPass = function(e) {
        e.setEarlyZPass(!0), this.runtime.layout_tex || (this.runtime.layout_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), (this.runtime.layout_tex.c2width !== this.runtime.draw_width || this.runtime.layout_tex.c2height !== this.runtime.draw_height) && (e.deleteTexture(this.runtime.layout_tex), this.runtime.layout_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), e.setRenderingToTexture(this.runtime.layout_tex), this.runtime.fullscreenScalingQuality || e.setSize(this.runtime.draw_width, this.runtime.draw_height);
        var t, r;
        for (t = this.layers.length - 1; 0 <= t; --t) r = this.layers[t], r.visible && 1 === r.opacity && r.shaders_preserve_opaqueness && 0 === r.blend_mode && (r.instances.length || !r.transparent) ? r.drawGL_earlyZPass(e) : r.updateViewport(null);
        e.setEarlyZPass(!1)
    }, e.prototype.drawGL = function(e) {
        var t = 0 < this.active_effect_types.length || this.runtime.uses_background_blending || !this.runtime.fullscreenScalingQuality || this.runtime.enableFrontToBack;
        t ? (!this.runtime.layout_tex && (this.runtime.layout_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), (this.runtime.layout_tex.c2width !== this.runtime.draw_width || this.runtime.layout_tex.c2height !== this.runtime.draw_height) && (e.deleteTexture(this.runtime.layout_tex), this.runtime.layout_tex = e.createEmptyTexture(this.runtime.draw_width, this.runtime.draw_height, this.runtime.linearSampling)), e.setRenderingToTexture(this.runtime.layout_tex), !this.runtime.fullscreenScalingQuality && e.setSize(this.runtime.draw_width, this.runtime.draw_height)) : this.runtime.layout_tex && (e.setRenderingToTexture(null), e.deleteTexture(this.runtime.layout_tex), this.runtime.layout_tex = null), this.runtime.clearBackground && !this.hasOpaqueBottomLayer() && e.clear(0, 0, 0, 0);
        var r, n, a;
        for (r = 0, n = this.layers.length; r < n; r++) a = this.layers[r], a.visible && 0 < a.opacity && (a.instances.length || !a.transparent) ? a.drawGL(e) : a.updateViewport(null);
        if (t)
            if (0 === this.active_effect_types.length || 1 === this.active_effect_types.length && this.runtime.fullscreenScalingQuality) {
                if (1 === this.active_effect_types.length) {
                    var o = this.active_effect_types[0].index,
                        s = this.calculateViewRect();
                    e.switchProgram(this.active_effect_types[0].shaderindex), e.setProgramParameters(null, 1 / this.runtime.draw_width, 1 / this.runtime.draw_height, 0, 0, 1, 1, 0, 0, 1, 1, s.left, s.top, s.right, s.bottom, 0, 0, 1, 1, this.scale, this.angle, this.runtime.kahanTime.sum, this.effect_params[o]), e.programIsAnimated(this.active_effect_types[0].shaderindex) && (this.runtime.redraw = !0)
                } else e.switchProgram(0);
                this.runtime.fullscreenScalingQuality || e.setSize(this.runtime.width, this.runtime.height), e.setRenderingToTexture(null), e.setDepthTestEnabled(!1), e.setOpacity(1), e.setTexture(this.runtime.layout_tex), e.setAlphaBlend(), e.resetModelView(), e.updateModelView();
                var p = this.runtime.width / 2,
                    d = this.runtime.height / 2;
                e.quad(-p, d, p, d, p, -d, -p, -d), e.setTexture(null), e.setDepthTestEnabled(!0)
            } else this.renderEffectChain(e, null, null, null)
    }, e.prototype.getRenderTarget = function() {
        return 0 < this.active_effect_types.length || this.runtime.uses_background_blending || !this.runtime.fullscreenScalingQuality || this.runtime.enableFrontToBack ? this.runtime.layout_tex : null
    }, e.prototype.getMinLayerScale = function() {
        var e = this.layers[0].getScale(),
            t, r, n;
        for (t = 1, r = this.layers.length; t < r; t++) n = this.layers[t], (0 !== n.parallaxX || 0 !== n.parallaxY) && n.getScale() < e && (e = n.getScale());
        return e
    }, e.prototype.scrollToX = function(e) {
        if (!this.unbounded_scrolling) {
            var t = this.runtime.draw_width * (1 / this.getMinLayerScale()) / 2;
            e > this.width - t && (e = this.width - t), e < t && (e = t)
        }
        this.scrollX !== e && (this.scrollX = e, this.runtime.redraw = !0)
    }, e.prototype.scrollToY = function(e) {
        if (!this.unbounded_scrolling) {
            var t = this.runtime.draw_height * (1 / this.getMinLayerScale()) / 2;
            e > this.height - t && (e = this.height - t), e < t && (e = t)
        }
        this.scrollY !== e && (this.scrollY = e, this.runtime.redraw = !0)
    }, e.prototype.boundScrolling = function() {
        this.scrollToX(this.scrollX), this.scrollToY(this.scrollY)
    }, e.prototype.calculateViewRect = function() {
        var e = this.scrollX,
            t = this.scrollY,
            r = 1 / (this.scale * this.runtime.aspect_scale);
        return e -= this.runtime.width * r / 2, t -= this.runtime.height * r / 2, this.viewRect.set(e, t, e + this.runtime.draw_width * r, t + this.runtime.draw_height * r), this.viewRect
    }, e.prototype.renderEffectChain = function(e, t, r, o) {
        var s = r ? r.active_effect_types : t ? t.active_effect_types : this.active_effect_types,
            l = 1,
            p = 0,
            d = 0,
            c = 0,
            u = this.runtime.draw_width,
            g = this.runtime.draw_height;
        if (r) l = r.layer.getScale(), p = r.layer.getAngle(), d = r.layer.viewLeft, c = r.layer.viewTop, u = r.layer.viewRight, g = r.layer.viewBottom;
        else if (t) l = t.getScale(), p = t.getAngle(), d = t.viewLeft, c = t.viewTop, u = t.viewRight, g = t.viewBottom;
        else {
            l = this.scale, p = this.angle;
            var m = this.calculateViewRect();
            d = m.left, c = m.top, u = m.right, g = m.bottom
        }
        var _ = this.runtime.fx_tex,
            f = 0,
            b = 1,
            x = this.runtime.draw_width,
            v = this.runtime.draw_height,
            w = x / 2,
            S = v / 2,
            T = t ? t.rcTexBounce : this.rcTexBounce,
            O = t ? t.rcTexDest : this.rcTexDest,
            E = t ? t.rcTexOrigin : this.rcTexOrigin,
            C = 0,
            A = 0,
            P = 0,
            L = 0,
            I = x,
            R = x,
            k = v,
            B = v,
            F = 0,
            N = 0,
            j = r ? r.layer.getAngle() : 0,
            D, M, z, G, W, U;
        if (r) {
            for (D = 0, M = s.length; D < M; D++) F += e.getProgramBoxExtendHorizontal(s[D].shaderindex), N += e.getProgramBoxExtendVertical(s[D].shaderindex);
            var V = r.bbox;
            if (C = t.layerToCanvas(V.left, V.top, !0, !0), P = t.layerToCanvas(V.left, V.top, !1, !0), I = t.layerToCanvas(V.right, V.bottom, !0, !0), k = t.layerToCanvas(V.right, V.bottom, !1, !0), 0 !== j) {
                var X = t.layerToCanvas(V.right, V.top, !0, !0),
                    q = t.layerToCanvas(V.right, V.top, !1, !0),
                    Y = t.layerToCanvas(V.left, V.bottom, !0, !0),
                    H = t.layerToCanvas(V.left, V.bottom, !1, !0);
                G = a(C, I, X, Y), I = n(C, I, X, Y), C = G, G = a(P, k, q, H), k = n(P, k, q, H), P = G
            }
            E.left = C / x, E.top = 1 - P / v, E.right = I / x, E.bottom = 1 - k / v, C -= F, P -= N, I += F, k += N, O.left = C / x, O.top = 1 - P / v, O.right = I / x, O.bottom = 1 - k / v, A = C = cr.floor(C), L = P = cr.floor(P), R = I = cr.ceil(I), B = k = cr.ceil(k), A -= F, L -= N, R += F, B += N, 0 > C && (C = 0), 0 > P && (P = 0), I > x && (I = x), k > v && (k = v), 0 > A && (A = 0), 0 > L && (L = 0), R > x && (R = x), B > v && (B = v), T.left = C / x, T.top = 1 - P / v, T.right = I / x, T.bottom = 1 - k / v
        } else T.left = O.left = E.left = 0, T.top = O.top = E.top = 0, T.right = O.right = E.right = 1, T.bottom = O.bottom = O.bottom = 1;
        var J = r && (e.programUsesDest(s[0].shaderindex) || 0 !== F || 0 !== N || 1 !== r.opacity || r.type.plugin.must_predraw) || t && !r && 1 !== t.opacity;
        e.setAlphaBlend(), J && (!_[f] && (_[f] = e.createEmptyTexture(x, v, this.runtime.linearSampling)), (_[f].c2width !== x || _[f].c2height !== v) && (e.deleteTexture(_[f]), _[f] = e.createEmptyTexture(x, v, this.runtime.linearSampling)), e.switchProgram(0), e.setRenderingToTexture(_[f]), U = B - L, W = v - L - U, e.clearRect(A, W, R - A, U), r ? r.drawGL(e) : (e.setTexture(this.runtime.layer_tex), e.setOpacity(t.opacity), e.resetModelView(), e.translate(-w, -S), e.updateModelView(), e.quadTex(C, k, I, k, I, P, C, P, T)), O.left = O.top = 0, O.right = O.bottom = 1, r && (G = T.top, T.top = T.bottom, T.bottom = G), f = 1, b = 0), e.setOpacity(1);
        var z = s.length - 1,
            Z = e.programUsesCrossSampling(s[z].shaderindex) || !t && !r && !this.runtime.fullscreenScalingQuality,
            Q = 0;
        for (D = 0, M = s.length; D < M; D++) {
            if (_[f] || (_[f] = e.createEmptyTexture(x, v, this.runtime.linearSampling)), (_[f].c2width !== x || _[f].c2height !== v) && (e.deleteTexture(_[f]), _[f] = e.createEmptyTexture(x, v, this.runtime.linearSampling)), e.switchProgram(s[D].shaderindex), Q = s[D].index, e.programIsAnimated(s[D].shaderindex) && (this.runtime.redraw = !0), 0 == D && !J) {
                if (e.setRenderingToTexture(_[f]), U = B - L, W = v - L - U, e.clearRect(A, W, R - A, U), r) {
                    var K = 0,
                        $ = 0,
                        ee = 1,
                        te = 1,
                        re = 1 / r.width,
                        ne = 1 / r.height;
                    r.curFrame && r.curFrame.sheetTex && (K = r.curFrame.sheetTex.left, $ = r.curFrame.sheetTex.top, ee = r.curFrame.sheetTex.right, te = r.curFrame.sheetTex.bottom, r.curFrame.texture_img && (re = 1 / r.curFrame.texture_img.width, ne = 1 / r.curFrame.texture_img.height)), e.setProgramParameters(o, re, ne, K, $, ee, te, K, $, ee, te, r.bbox.left, r.bbox.top, r.bbox.right, r.bbox.bottom, O.left, O.top, O.right, O.bottom, l, p, this.runtime.kahanTime.sum, r.effect_params[Q]), r.drawGL(e)
                } else e.setProgramParameters(o, 1 / x, 1 / v, 0, 0, 1, 1, 0, 0, 1, 1, d, c, u, g, 0, 0, 1, 1, l, p, this.runtime.kahanTime.sum, t ? t.effect_params[Q] : this.effect_params[Q]), e.setTexture(t ? this.runtime.layer_tex : this.runtime.layout_tex), e.resetModelView(), e.translate(-w, -S), e.updateModelView(), e.quadTex(C, k, I, k, I, P, C, P, T);
                O.left = O.top = 0, O.right = O.bottom = 1, r && !Z && (G = k, k = P, P = G)
            } else e.setProgramParameters(o, 1 / x, 1 / v, 0, 0, 1, 1, E.left, E.top, E.right, E.bottom, d, c, u, g, O.left, O.top, O.right, O.bottom, l, p, this.runtime.kahanTime.sum, r ? r.effect_params[Q] : t ? t.effect_params[Q] : this.effect_params[Q]), e.setTexture(null), D !== z || Z ? (e.setRenderingToTexture(_[f]), U = B - L, W = v - L - U, e.clearRect(A, W, R - A, U)) : (r ? e.setBlend(r.srcBlend, r.destBlend) : t && e.setBlend(t.srcBlend, t.destBlend), e.setRenderingToTexture(o)), e.setTexture(_[b]), e.resetModelView(), e.translate(-w, -S), e.updateModelView(), e.quadTex(C, k, I, k, I, P, C, P, T), D !== z || Z || e.setTexture(null);
            f = 0 == f ? 1 : 0, b = 0 == f ? 1 : 0
        }
        Z && (e.switchProgram(0), r ? e.setBlend(r.srcBlend, r.destBlend) : t ? e.setBlend(t.srcBlend, t.destBlend) : !this.runtime.fullscreenScalingQuality && (e.setSize(this.runtime.width, this.runtime.height), w = this.runtime.width / 2, S = this.runtime.height / 2, C = 0, P = 0, I = this.runtime.width, k = this.runtime.height), e.setRenderingToTexture(o), e.setTexture(_[b]), e.resetModelView(), e.translate(-w, -S), e.updateModelView(), r && 1 === s.length && !J ? e.quadTex(C, P, I, P, I, k, C, k, T) : e.quadTex(C, k, I, k, I, P, C, P, T), e.setTexture(null))
    }, e.prototype.getLayerBySid = function(e) {
        var t, r;
        for (t = 0, r = this.layers.length; t < r; t++)
            if (this.layers[t].sid === e) return this.layers[t];
        return null
    }, e.prototype.saveToJSON = function() {
        var e = {
                sx: this.scrollX,
                sy: this.scrollY,
                s: this.scale,
                a: this.angle,
                w: this.width,
                h: this.height,
                fv: this.first_visit,
                persist: this.persist_data,
                fx: [],
                layers: {}
            },
            t, r, n, a;
        for (t = 0, r = this.effect_types.length; t < r; t++) a = this.effect_types[t], e.fx.push({
            name: a.name,
            active: a.active,
            params: this.effect_params[a.index]
        });
        for (t = 0, r = this.layers.length; t < r; t++) n = this.layers[t], e.layers[n.sid.toString()] = n.saveToJSON();
        return e
    }, e.prototype.loadFromJSON = function(e) {
        var t, r, n, a, o;
        this.scrollX = e.sx, this.scrollY = e.sy, this.scale = e.s, this.angle = e.a, this.width = e.w, this.height = e.h, this.persist_data = e.persist, "undefined" != typeof e.fv && (this.first_visit = e.fv);
        var s = e.fx;
        for (t = 0, r = s.length; t < r; t++) n = this.getEffectByName(s[t].name), n && (n.active = s[t].active, this.effect_params[n.index] = s[t].params);
        this.updateActiveEffects();
        var l = e.layers;
        for (a in l)
            if (l.hasOwnProperty(a)) {
                if (o = this.getLayerBySid(parseInt(a, 10)), !o) continue;
                o.loadFromJSON(l[a])
            }
    }, cr.layout = e
})();
(function() {
    function e(e, t) {
        var r = e.length,
            n;
        switch (r) {
            case 0:
                return !0;
            case 1:
                return e[0] === t[0];
            case 2:
                return e[0] === t[0] && e[1] === t[1];
            default:
                for (n = 0; n < r; n++)
                    if (e[n] !== t[n]) return !1;
                return !0;
        }
    }

    function t(e, t) {
        return e.index - t.index
    }

    function r(r) {
        var n, a, o, s, l;
        for (2 === r.length ? r[0].index > r[1].index && (s = r[0], r[0] = r[1], r[1] = s) : 2 < r.length && r.sort(t), r.length >= _.length && (_.length = r.length + 1), _[r.length] || (_[r.length] = []), l = _[r.length], (n = 0, a = l.length); n < a; n++)
            if (o = l[n], e(r, o)) return o;
        return l.push(r), r
    }

    function n(e, t) {
        this.runtime = e, this.triggers = {}, this.fasttriggers = {}, this.hasRun = !1, this.includes = new cr.ObjectSet, this.deep_includes = [], this.already_included_sheets = [], this.name = t[0];
        var r = t[1];
        this.events = [];
        var n, a;
        for (n = 0, a = r.length; n < a; n++) this.init_event(r[n], null, this.events)
    }

    function a(e) {
        return !!(cr.plugins_.Sprite && e === cr.plugins_.Sprite.prototype.cnds.OnFrameChanged)
    }

    function o(e) {
        this.type = e, this.instances = [], this.else_instances = [], this.select_all = !0
    }

    function i(e, t, r) {
        this.sheet = e, this.parent = t, this.runtime = e.runtime, this.solModifiers = [], this.solModifiersIncludingParents = [], this.solWriterAfterCnds = !1, this.group = !1, this.initially_activated = !1, this.toplevelevent = !1, this.toplevelgroup = !1, this.has_else_block = !1, this.conditions = [], this.actions = [], this.subevents = [], this.group_name = "", this.group = !1, this.initially_activated = !1, this.group_active = !1, this.contained_includes = null, 3 === r[0] && (this.group_name = r[1][1].toLowerCase(), this.group = !0, this.initially_activated = !!r[1][0], this.contained_includes = [], this.group_active = this.initially_activated, this.runtime.allGroups.push(this), this.runtime.groups_by_name[this.group_name] = this), this.orblock = r[2], this.sid = r[4], this.group || (this.runtime.blocksBySid[this.sid.toString()] = this);
        var n = r[6],
            a, o;
        for (a = 0, o = n.length; a < o; a++) {
            var s = new cr.condition(this, n[a]);
            s.index = a, cr.seal(s), this.conditions.push(s), this.addSolModifier(s.type)
        }
        var l = r[7];
        for (a = 0, o = l.length; a < o; a++) {
            var p = new cr.action(this, l[a]);
            p.index = a, cr.seal(p), this.actions.push(p)
        }
        if (9 === r.length) {
            var d = r[8];
            for (a = 0, o = d.length; a < o; a++) this.sheet.init_event(d[a], this, this.subevents)
        }
        this.is_else_block = !1, this.conditions.length && (this.is_else_block = null == this.conditions[0].type && this.conditions[0].func == cr.system_object.prototype.cnds.Else)
    }

    function s(e, r) {
        var n, a, o;
        if (e && (-1 === r.indexOf(e) && r.push(e), e.is_contained))
            for (n = 0, a = e.container.length; n < a; n++) o = e.container[n], e === o || -1 !== r.indexOf(o) || r.push(o)
    }

    function l(e, t) {
        if (this.block = e, this.sheet = e.sheet, this.runtime = e.runtime, this.parameters = [], this.results = [], this.extra = {}, this.index = -1, this.anyParamVariesPerInstance = !1, this.func = this.runtime.GetObjectReference(t[1]), this.trigger = 0 < t[3], this.fasttrigger = 2 === t[3], this.looping = t[4], this.inverted = t[5], this.isstatic = t[6], this.sid = t[7], this.runtime.cndsBySid[this.sid.toString()] = this, -1 === t[0] ? (this.type = null, this.run = this.run_system, this.behaviortype = null, this.beh_index = -1) : (this.type = this.runtime.types_by_index[t[0]], this.run = this.isstatic ? this.run_static : this.run_object, t[2] ? (this.behaviortype = this.type.getBehaviorByName(t[2]), this.beh_index = this.type.getBehaviorIndexByName(t[2])) : (this.behaviortype = null, this.beh_index = -1), this.block.parent && this.block.parent.setSolWriterAfterCnds()), (this.fasttrigger && (this.run = this.run_true), 10 === t.length)) {
            var r = t[9],
                n, a;
            for (n = 0, a = r.length; n < a; n++) {
                var o = new cr.parameter(this, r[n]);
                cr.seal(o), this.parameters.push(o)
            }
            this.results.length = r.length
        }
    }

    function p(e, t) {
        if (this.block = e, this.sheet = e.sheet, this.runtime = e.runtime, this.parameters = [], this.results = [], this.extra = {}, this.index = -1, this.anyParamVariesPerInstance = !1, this.func = this.runtime.GetObjectReference(t[1]), -1 === t[0] ? (this.type = null, this.run = this.run_system, this.behaviortype = null, this.beh_index = -1) : (this.type = this.runtime.types_by_index[t[0]], this.run = this.run_object, t[2] ? (this.behaviortype = this.type.getBehaviorByName(t[2]), this.beh_index = this.type.getBehaviorIndexByName(t[2])) : (this.behaviortype = null, this.beh_index = -1)), (this.sid = t[3], this.runtime.actsBySid[this.sid.toString()] = this, 7 === t.length)) {
            var r = t[6],
                n, a;
            for (n = 0, a = r.length; n < a; n++) {
                var o = new cr.parameter(this, r[n]);
                cr.seal(o), this.parameters.push(o)
            }
            this.results.length = r.length
        }
    }

    function d() {
        return f++, h.length === f && h.push(new cr.expvalue), h[f]
    }

    function c() {
        f--
    }

    function u(e, t) {
        this.owner = e, this.block = e.block, this.sheet = e.sheet, this.runtime = e.runtime, this.type = t[0], this.expression = null, this.solindex = 0, this.get = null, this.combosel = 0, this.layout = null, this.key = 0, this.object = null, this.index = 0, this.varname = null, this.eventvar = null, this.fileinfo = null, this.subparams = null, this.variadicret = null, this.subparams = null, this.variadicret = null, this.variesPerInstance = !1;
        var r, n, a;
        switch (this.type) {
            case 0:
            case 7:
                this.expression = new cr.expNode(this, t[1]), this.solindex = 0, this.get = this.get_exp;
                break;
            case 1:
            case 14:
                this.expression = new cr.expNode(this, t[1]), this.solindex = 0, this.get = this.get_exp_str, 14 === this.type && (this.block.setAllSolModifiers(), this.owner instanceof cr.action && this.block.setSolWriterAfterCnds());
                break;
            case 5:
                this.expression = new cr.expNode(this, t[1]), this.solindex = 0, this.get = this.get_layer;
                break;
            case 3:
            case 8:
                this.combosel = t[1], this.get = this.get_combosel;
                break;
            case 16:
                this.combosel = t[1] ? 1 : 0, this.get = this.get_boolean;
                break;
            case 6:
                this.layout = this.runtime.layouts[t[1]];;
                this.get = this.get_layout;
                break;
            case 9:
                this.key = t[1], this.get = this.get_key;
                break;
            case 4:
                this.object = this.runtime.types_by_index[t[1]];;
                this.get = this.get_object, this.block.addSolModifier(this.object), this.owner instanceof cr.action ? this.block.setSolWriterAfterCnds() : this.block.parent && this.block.parent.setSolWriterAfterCnds();
                break;
            case 10:
                this.index = t[1], e.type && e.type.is_family ? (this.get = this.get_familyvar, this.variesPerInstance = !0) : this.get = this.get_instvar;
                break;
            case 11:
                this.varname = t[1], this.eventvar = null, this.get = this.get_eventvar;
                break;
            case 2:
            case 12:
                this.fileinfo = t[1], this.get = this.get_audiofile;
                break;
            case 13:
                for (this.get = this.get_variadic, this.subparams = [], this.variadicret = [], (r = 1, n = t.length); r < n; r++) a = new cr.parameter(this.owner, t[r]), cr.seal(a), this.subparams.push(a), this.variadicret.push(0);
                break;
            default:
                ;
        }
    }

    function g(e, t, r) {
        this.sheet = e, this.parent = t, this.runtime = e.runtime, this.solModifiers = [], this.name = r[1], this.vartype = r[2], this.initial = r[3], this.is_static = !!r[4], this.is_constant = !!r[5], this.sid = r[6], this.runtime.varsBySid[this.sid.toString()] = this, this.data = this.initial, this.parent ? (this.localIndex = this.is_static || this.is_constant ? -1 : this.runtime.stackLocalCount++, this.runtime.all_local_vars.push(this)) : (this.localIndex = -1, this.runtime.all_global_vars.push(this))
    }

    function y(e, t, r) {
        this.sheet = e, this.parent = t, this.runtime = e.runtime, this.solModifiers = [], this.include_sheet = null, this.include_sheet_name = r[1], this.active = !0
    }

    function m() {
        this.temp_parents_arr = [], this.reset(null), cr.seal(this)
    }
    var _ = [];
    n.prototype.toString = function() {
        return this.name
    }, n.prototype.init_event = function(e, t, r) {
        switch (e[0]) {
            case 0:
            case 3:
                {
                    var n = new cr.eventblock(this, t, e);
                    if (cr.seal(n), n.orblock) {
                        r.push(n);
                        var a, o;
                        for (a = 0, o = n.conditions.length; a < o; a++) n.conditions[a].trigger && this.init_trigger(n, a)
                    } else n.is_trigger() ? this.init_trigger(n, 0) : r.push(n);
                    break
                }
            case 1:
                {
                    var s = new cr.eventvariable(this, t, e);cr.seal(s),
                    r.push(s);
                    break
                }
            case 2:
                {
                    var l = new cr.eventinclude(this, t, e);cr.seal(l),
                    r.push(l);
                    break
                }
            default:
                ;
        }
    }, n.prototype.postInit = function() {
        var e, t;
        for (e = 0, t = this.events.length; e < t; e++) this.events[e].postInit(e < t - 1 && this.events[e + 1].is_else_block)
    }, n.prototype.updateDeepIncludes = function() {
        cr.clearArray(this.deep_includes), cr.clearArray(this.already_included_sheets), this.addDeepIncludes(this), cr.clearArray(this.already_included_sheets)
    }, n.prototype.addDeepIncludes = function(e) {
        var t = e.deep_includes,
            r = e.already_included_sheets,
            n = this.includes.valuesRef(),
            a, o, s, l;
        for (a = 0, o = n.length; a < o; ++a) s = n[a], l = s.include_sheet, !s.isActive() || e === l || -1 < r.indexOf(l) || (r.push(l), l.addDeepIncludes(e), t.push(l))
    }, n.prototype.run = function(e) {
        this.runtime.resuming_breakpoint || (this.hasRun = !0, !e && (this.runtime.isRunningEvents = !0));
        var t, r;
        for (t = 0, r = this.events.length; t < r; t++) {
            var n = this.events[t];
            n.run(), this.runtime.clearSol(n.solModifiers), this.runtime.hasPendingInstances && this.runtime.ClearDeathRow()
        }
        e || (this.runtime.isRunningEvents = !1)
    };
    n.prototype.init_trigger = function(e, t) {
        e.orblock || this.runtime.triggers_to_postinit.push(e);
        var r = e.conditions[t],
            n, o, s;
        s = r.type ? r.type.name : "system";
        var l = r.fasttrigger,
            p = l ? this.fasttriggers : this.triggers;
        p[s] || (p[s] = []);
        var d = p[s],
            c = r.func;
        if (l) {
            if (!r.parameters.length) return;
            var u = r.parameters[0];
            if (1 !== u.type || 2 !== u.expression.type) return;
            var g = u.expression.value.toLowerCase(),
                y, n, o;
            for (n = 0, o = d.length; n < o; n++)
                if (d[n].method == c) return y = d[n].evs, void(y[g] ? y[g].push([e, t]) : y[g] = [
                    [e, t]
                ]);
            y = {}, y[g] = [
                [e, t]
            ], d.push({
                method: c,
                evs: y
            })
        } else {
            for (n = 0, o = d.length; n < o; n++)
                if (d[n].method == c) return void d[n].evs.push([e, t]);
            a(c) ? d.unshift({
                method: c,
                evs: [
                    [e, t]
                ]
            }) : d.push({
                method: c,
                evs: [
                    [e, t]
                ]
            })
        }
    }, cr.eventsheet = n;
    o.prototype.hasObjects = function() {
        return this.select_all ? this.type.instances.length : this.instances.length
    }, o.prototype.getObjects = function() {
        return this.select_all ? this.type.instances : this.instances
    }, o.prototype.pick_one = function(e) {
        if (e)
            if (e.runtime.getCurrentEventStack().current_event.orblock) {
                this.select_all && (cr.clearArray(this.instances), cr.shallowAssignArray(this.else_instances, e.type.instances), this.select_all = !1);
                var t = this.else_instances.indexOf(e); - 1 !== t && (this.instances.push(this.else_instances[t]), this.else_instances.splice(t, 1))
            } else this.select_all = !1, cr.clearArray(this.instances), this.instances[0] = e
    }, cr.selection = o;
    i.prototype.postInit = function(e) {
        var t = this.parent,
            n, a;
        if (this.group)
            for (this.toplevelgroup = !0; t;) {
                if (!t.group) {
                    this.toplevelgroup = !1;
                    break
                }
                t = t.parent
            }
        this.toplevelevent = !this.is_trigger() && (!this.parent || this.parent.group && this.parent.toplevelgroup), this.has_else_block = !!e;
        var o = this.runtime.types_by_index;
        if (this.solModifiers === o) this.solModifiersIncludingParents = o;
        else {
            for (this.solModifiersIncludingParents = this.solModifiers.slice(0), t = this.parent; t;) {
                for (n = 0, a = t.solModifiers.length; n < a; n++) this.addParentSolModifier(t.solModifiers[n]);
                t = t.parent
            }
            this.solModifiers = r(this.solModifiers), this.solModifiersIncludingParents = r(this.solModifiersIncludingParents)
        }
        var n, a;
        for (n = 0, a = this.conditions.length; n < a; n++) this.conditions[n].postInit();
        for (n = 0, a = this.actions.length; n < a; n++) this.actions[n].postInit();
        for (n = 0, a = this.subevents.length; n < a; n++) this.subevents[n].postInit(n < a - 1 && this.subevents[n + 1].is_else_block)
    }, i.prototype.setGroupActive = function(e) {
        if (this.group_active !== !!e) {
            this.group_active = !!e;
            var t, r;
            for (t = 0, r = this.contained_includes.length; t < r; ++t) this.contained_includes[t].updateActive();
            0 < r && this.runtime.running_layout.event_sheet && this.runtime.running_layout.event_sheet.updateDeepIncludes()
        }
    };
    i.prototype.addSolModifier = function(e) {
        s(e, this.solModifiers)
    }, i.prototype.addParentSolModifier = function(e) {
        s(e, this.solModifiersIncludingParents)
    }, i.prototype.setAllSolModifiers = function() {
        this.solModifiers = this.runtime.types_by_index
    }, i.prototype.setSolWriterAfterCnds = function() {
        this.solWriterAfterCnds = !0, this.parent && this.parent.setSolWriterAfterCnds()
    }, i.prototype.is_trigger = function() {
        return !!this.conditions.length && this.conditions[0].trigger
    }, i.prototype.run = function() {
        var e = !1,
            t = this.runtime,
            r = this.runtime.getCurrentEventStack(),
            n, a, o;
        r.current_event = this;
        var i = this.conditions;
        if (this.is_else_block || (r.else_branch_ran = !1), this.orblock) {
            for (0 === i.length && (e = !0), r.cndindex = 0, n = i.length; r.cndindex < n; r.cndindex++) a = i[r.cndindex], a.trigger || (o = a.run(), o && (e = !0));
            r.last_event_true = e, e && this.run_actions_and_subevents()
        } else {
            for (r.cndindex = 0, n = i.length; r.cndindex < n; r.cndindex++)
                if (o = i[r.cndindex].run(), !o) return r.last_event_true = !1, void(this.toplevelevent && t.hasPendingInstances && t.ClearDeathRow());
            r.last_event_true = !0, this.run_actions_and_subevents()
        }
        this.end_run(r)
    }, i.prototype.end_run = function(e) {
        e.last_event_true && this.has_else_block && (e.else_branch_ran = !0), this.toplevelevent && this.runtime.hasPendingInstances && this.runtime.ClearDeathRow()
    }, i.prototype.run_orblocktrigger = function(e) {
        var t = this.runtime.getCurrentEventStack();
        t.current_event = this, this.conditions[e].run() && (this.run_actions_and_subevents(), this.runtime.getCurrentEventStack().last_event_true = !0)
    }, i.prototype.run_actions_and_subevents = function() {
        var e = this.runtime.getCurrentEventStack(),
            t;
        for (e.actindex = 0, t = this.actions.length; e.actindex < t; e.actindex++)
            if (this.actions[e.actindex].run()) return;
        this.run_subevents()
    }, i.prototype.resume_actions_and_subevents = function() {
        var e = this.runtime.getCurrentEventStack(),
            t;
        for (t = this.actions.length; e.actindex < t; e.actindex++)
            if (this.actions[e.actindex].run()) return;
        this.run_subevents()
    }, i.prototype.run_subevents = function() {
        if (this.subevents.length) {
            var e = this.subevents.length - 1,
                t, r, n, a;
            if (this.runtime.pushEventStack(this), this.solWriterAfterCnds)
                for (t = 0, r = this.subevents.length; t < r; t++) n = this.subevents[t], a = !this.toplevelgroup || !this.group && t < e, a && this.runtime.pushCopySol(n.solModifiers), n.run(), a ? this.runtime.popSol(n.solModifiers) : this.runtime.clearSol(n.solModifiers);
            else
                for (t = 0, r = this.subevents.length; t < r; t++) this.subevents[t].run();
            this.runtime.popEventStack()
        }
    }, i.prototype.run_pretrigger = function() {
        var e = this.runtime.getCurrentEventStack();
        e.current_event = this;
        var t = !1,
            r;
        for (e.cndindex = 0, r = this.conditions.length; e.cndindex < r; e.cndindex++)
            if (this.conditions[e.cndindex].run()) t = !0;
            else if (!this.orblock) return !1;
        return !this.orblock || t
    }, i.prototype.retrigger = function() {
        this.runtime.execcount++;
        var e = this.runtime.getCurrentEventStack().cndindex,
            t = this.runtime.pushEventStack(this),
            r;
        if (!this.orblock)
            for (t.cndindex = e + 1, r = this.conditions.length; t.cndindex < r; t.cndindex++)
                if (!this.conditions[t.cndindex].run()) return this.runtime.popEventStack(), !1;
        return this.run_actions_and_subevents(), this.runtime.popEventStack(), !0
    }, i.prototype.isFirstConditionOfType = function(e) {
        var t = e.index;
        if (0 === t) return !0;
        for (--t; 0 <= t; --t)
            if (this.conditions[t].type === e.type) return !1;
        return !0
    }, cr.eventblock = i;
    l.prototype.postInit = function() {
        var e, t, r;
        for (e = 0, t = this.parameters.length; e < t; e++) r = this.parameters[e], r.postInit(), r.variesPerInstance && (this.anyParamVariesPerInstance = !0)
    }, l.prototype.run_true = function() {
        return !0
    }, l.prototype.run_system = function() {
        var e, t;
        for (e = 0, t = this.parameters.length; e < t; e++) this.results[e] = this.parameters[e].get();
        return cr.xor(this.func.apply(this.runtime.system, this.results), this.inverted)
    }, l.prototype.run_static = function() {
        var e, t;
        for (e = 0, t = this.parameters.length; e < t; e++) this.results[e] = this.parameters[e].get();
        var r = this.func.apply(this.behaviortype ? this.behaviortype : this.type, this.results);
        return this.type.applySolToContainer(), r
    }, l.prototype.run_object = function() {
        var e = this.type,
            t = e.getCurrentSol(),
            r = this.block.orblock && !this.trigger,
            n = 0,
            a = e.is_contained,
            o = e.is_family,
            l = e.family_index,
            d = this.beh_index,
            c = -1 < d,
            u = this.anyParamVariesPerInstance,
            g = this.parameters,
            y = this.results,
            m = this.inverted,
            _ = this.func,
            h, f, b, x, v, w, S, T, O, E, C, A, P;
        if (u)
            for (f = 0, v = g.length; f < v; ++f) w = g[f], w.variesPerInstance || (y[f] = w.get(0));
        else
            for (f = 0, v = g.length; f < v; ++f) y[f] = g[f].get(0);
        if (t.select_all) {
            for (cr.clearArray(t.instances), cr.clearArray(t.else_instances), A = e.instances, (h = 0, x = A.length); h < x; ++h) {
                if (O = A[h], u)
                    for (f = 0, v = g.length; f < v; ++f) w = g[f], w.variesPerInstance && (y[f] = w.get(h));
                c ? (n = 0, o && (n = O.type.family_beh_map[l]), S = _.apply(O.behavior_insts[d + n], y)) : S = _.apply(O, y), T = cr.xor(S, m), T ? t.instances.push(O) : r && t.else_instances.push(O)
            }
            return e.finish && e.finish(!0), t.select_all = !1, e.applySolToContainer(), t.hasObjects()
        }
        b = 0;
        var L = r && !this.block.isFirstConditionOfType(this);
        A = L ? t.else_instances : t.instances;
        var I = !1;
        for (h = 0, x = A.length; h < x; ++h) {
            if (O = A[h], u)
                for (f = 0, v = g.length; f < v; ++f) w = g[f], w.variesPerInstance && (y[f] = w.get(h));
            if (c ? (n = 0, o && (n = O.type.family_beh_map[l]), S = _.apply(O.behavior_insts[d + n], y)) : S = _.apply(O, y), cr.xor(S, m)) {
                if (I = !0, !L) {
                    if (A[b] = O, a)
                        for (f = 0, v = O.siblings.length; f < v; f++) E = O.siblings[f], E.type.getCurrentSol().instances[b] = E;
                    b++
                } else if (t.instances.push(O), a)
                    for (f = 0, v = O.siblings.length; f < v; f++) E = O.siblings[f], E.type.getCurrentSol().instances.push(E);
            } else if (L) {
                if (A[b] = O, a)
                    for (f = 0, v = O.siblings.length; f < v; f++) E = O.siblings[f], E.type.getCurrentSol().else_instances[b] = E;
                b++
            } else if (r && (t.else_instances.push(O), a))
                for (f = 0, v = O.siblings.length; f < v; f++) E = O.siblings[f], E.type.getCurrentSol().else_instances.push(E)
        }
        if (cr.truncateArray(A, b), a)
            for (P = e.container, h = 0, x = P.length; h < x; h++) C = P[h].getCurrentSol(), L ? cr.truncateArray(C.else_instances, b) : cr.truncateArray(C.instances, b);
        var R = I;
        if (L && !I)
            for (h = 0, x = t.instances.length; h < x; h++) {
                if (O = t.instances[h], u)
                    for (f = 0, v = g.length; f < v; f++) w = g[f], w.variesPerInstance && (y[f] = w.get(h));
                if (S = c ? _.apply(O.behavior_insts[d], y) : _.apply(O, y), cr.xor(S, m)) {
                    I = !0;
                    break
                }
            }
        return e.finish && e.finish(R || r), r ? I : t.hasObjects()
    }, cr.condition = l;
    p.prototype.postInit = function() {
        var e, t, r;
        for (e = 0, t = this.parameters.length; e < t; e++) r = this.parameters[e], r.postInit(), r.variesPerInstance && (this.anyParamVariesPerInstance = !0)
    }, p.prototype.run_system = function() {
        var e = this.runtime,
            t = this.parameters,
            r = this.results,
            n, a;
        for (n = 0, a = t.length; n < a; ++n) r[n] = t[n].get();
        return this.func.apply(e.system, r)
    }, p.prototype.run_object = function() {
        var e = this.type,
            t = this.beh_index,
            r = e.family_index,
            n = this.anyParamVariesPerInstance,
            a = this.parameters,
            o = this.results,
            s = this.func,
            l = e.getCurrentSol().getObjects(),
            d = e.is_family,
            c, u, g, y, m, _, h;
        if (n)
            for (u = 0, y = a.length; u < y; ++u) m = a[u], m.variesPerInstance || (o[u] = m.get(0));
        else
            for (u = 0, y = a.length; u < y; ++u) o[u] = a[u].get(0);
        for (c = 0, g = l.length; c < g; ++c) {
            if (_ = l[c], n)
                for (u = 0, y = a.length; u < y; ++u) m = a[u], m.variesPerInstance && (o[u] = m.get(c)); - 1 < t ? (h = 0, d && (h = _.type.family_beh_map[r]), s.apply(_.behavior_insts[t + h], o)) : s.apply(_, o)
        }
        return !1
    }, cr.action = p;
    var h = [],
        f = -1;
    u.prototype.postInit = function() {
        var e, t;
        if (11 === this.type) this.eventvar = this.runtime.getEventVariableByName(this.varname, this.block.parent);
        else if (13 === this.type)
            for (e = 0, t = this.subparams.length; e < t; e++) this.subparams[e].postInit();
        this.expression && this.expression.postInit()
    }, u.prototype.maybeVaryForType = function(e) {
        return this.variesPerInstance ? void 0 : e ? e.plugin.singleglobal ? void 0 : void(this.variesPerInstance = !0) : void 0
    }, u.prototype.setVaries = function() {
        this.variesPerInstance = !0
    }, u.prototype.get_exp = function(e) {
        this.solindex = e || 0;
        var t = d();
        return this.expression.get(t), c(), t.data
    }, u.prototype.get_exp_str = function(e) {
        this.solindex = e || 0;
        var t = d();
        return this.expression.get(t), c(), cr.is_string(t.data) ? t.data : ""
    }, u.prototype.get_object = function() {
        return this.object
    }, u.prototype.get_combosel = function() {
        return this.combosel
    }, u.prototype.get_boolean = function() {
        return !!this.combosel
    }, u.prototype.get_layer = function(e) {
        this.solindex = e || 0;
        var t = d();
        return this.expression.get(t), c(), t.is_number() ? this.runtime.getLayerByNumber(t.data) : this.runtime.getLayerByName(t.data)
    }, u.prototype.get_layout = function() {
        return this.layout
    }, u.prototype.get_key = function() {
        return this.key
    }, u.prototype.get_instvar = function() {
        return this.index
    }, u.prototype.get_familyvar = function(e) {
        var t = e || 0,
            r = this.owner.type,
            n = null,
            a = r.getCurrentSol(),
            o = a.getObjects();
        if (o.length) n = o[t % o.length].type;
        else if (a.else_instances.length) n = a.else_instances[t % a.else_instances.length].type;
        else if (r.instances.length) n = r.instances[t % r.instances.length].type;
        else return 0;
        return this.index + n.family_var_map[r.family_index]
    }, u.prototype.get_eventvar = function() {
        return this.eventvar
    }, u.prototype.get_audiofile = function() {
        return this.fileinfo
    }, u.prototype.get_variadic = function() {
        var e, t;
        for (e = 0, t = this.subparams.length; e < t; e++) this.variadicret[e] = this.subparams[e].get();
        return this.variadicret
    }, cr.parameter = u;
    g.prototype.postInit = function() {
        this.solModifiers = r(this.solModifiers)
    }, g.prototype.setValue = function(e) {
        var t = this.runtime.getCurrentLocalVarStack();
        this.parent && !this.is_static && t ? (this.localIndex >= t.length && (t.length = this.localIndex + 1), t[this.localIndex] = e) : this.data = e
    }, g.prototype.getValue = function() {
        var e = this.runtime.getCurrentLocalVarStack();
        return !this.parent || this.is_static || !e || this.is_constant ? this.data : this.localIndex >= e.length ? this.initial : "undefined" == typeof e[this.localIndex] ? this.initial : e[this.localIndex]
    }, g.prototype.run = function() {
        !this.parent || this.is_static || this.is_constant || this.setValue(this.initial)
    }, cr.eventvariable = g;
    y.prototype.toString = function() {
        return "include:" + this.include_sheet.toString()
    }, y.prototype.postInit = function() {
        this.include_sheet = this.runtime.eventsheets[this.include_sheet_name];
        this.sheet.includes.add(this), this.solModifiers = r(this.solModifiers);
        for (var e = this.parent; e;) e.group && e.contained_includes.push(this), e = e.parent;
        this.updateActive()
    }, y.prototype.run = function() {
        this.parent && this.runtime.pushCleanSol(this.runtime.types_by_index), this.include_sheet.hasRun || this.include_sheet.run(!0), this.parent && this.runtime.popSol(this.runtime.types_by_index)
    }, y.prototype.updateActive = function() {
        for (var e = this.parent; e;) {
            if (e.group && !e.group_active) return void(this.active = !1);
            e = e.parent
        }
        this.active = !0
    }, y.prototype.isActive = function() {
        return this.active
    }, cr.eventinclude = y;
    m.prototype.reset = function(e) {
        this.current_event = e, this.cndindex = 0, this.actindex = 0, cr.clearArray(this.temp_parents_arr), this.last_event_true = !1, this.else_branch_ran = !1, this.any_true_state = !1
    }, m.prototype.isModifierAfterCnds = function() {
        return !!this.current_event.solWriterAfterCnds || !!(this.cndindex < this.current_event.conditions.length - 1) && !!this.current_event.solModifiers.length
    }, cr.eventStackFrame = m
})(),
function() {
    function e(e, t) {
        this.owner = e, this.runtime = e.runtime, this.type = t[0], this.get = [this.eval_int, this.eval_float, this.eval_string, this.eval_unaryminus, this.eval_add, this.eval_subtract, this.eval_multiply, this.eval_divide, this.eval_mod, this.eval_power, this.eval_and, this.eval_or, this.eval_equal, this.eval_notequal, this.eval_less, this.eval_lessequal, this.eval_greater, this.eval_greaterequal, this.eval_conditional, this.eval_system_exp, this.eval_object_exp, this.eval_instvar_exp, this.eval_behavior_exp, this.eval_eventvar_exp][this.type];
        var r = null;
        switch (this.value = null, this.first = null, this.second = null, this.third = null, this.func = null, this.results = null, this.parameters = null, this.object_type = null, this.beh_index = -1, this.instance_expr = null, this.varindex = -1, this.behavior_type = null, this.varname = null, this.eventvar = null, this.return_string = !1, this.type) {
            case 0:
            case 1:
            case 2:
                this.value = t[1];
                break;
            case 3:
                this.first = new cr.expNode(e, t[1]);
                break;
            case 18:
                this.first = new cr.expNode(e, t[1]), this.second = new cr.expNode(e, t[2]), this.third = new cr.expNode(e, t[3]);
                break;
            case 19:
                this.func = this.runtime.GetObjectReference(t[1]);;
                (this.func === cr.system_object.prototype.exps.random || this.func === cr.system_object.prototype.exps.choose) && this.owner.setVaries(), this.results = [], this.parameters = [], 3 === t.length ? (r = t[2], this.results.length = r.length + 1) : this.results.length = 1;
                break;
            case 20:
                this.object_type = this.runtime.types_by_index[t[1]];;
                this.beh_index = -1, this.func = this.runtime.GetObjectReference(t[2]), this.return_string = t[3], cr.plugins_.Function && this.func === cr.plugins_.Function.prototype.exps.Call && this.owner.setVaries(), this.instance_expr = t[4] ? new cr.expNode(e, t[4]) : null, this.results = [], this.parameters = [], 6 === t.length ? (r = t[5], this.results.length = r.length + 1) : this.results.length = 1;
                break;
            case 21:
                this.object_type = this.runtime.types_by_index[t[1]];;
                this.return_string = t[2], this.instance_expr = t[3] ? new cr.expNode(e, t[3]) : null, this.varindex = t[4];
                break;
            case 22:
                this.object_type = this.runtime.types_by_index[t[1]];;
                this.behavior_type = this.object_type.getBehaviorByName(t[2]);;
                this.beh_index = this.object_type.getBehaviorIndexByName(t[2]), this.func = this.runtime.GetObjectReference(t[3]), this.return_string = t[4], this.instance_expr = t[5] ? new cr.expNode(e, t[5]) : null, this.results = [], this.parameters = [], 7 === t.length ? (r = t[6], this.results.length = r.length + 1) : this.results.length = 1;
                break;
            case 23:
                this.varname = t[1], this.eventvar = null;
        }
        if (this.owner.maybeVaryForType(this.object_type), 4 <= this.type && 17 >= this.type && (this.first = new cr.expNode(e, t[1]), this.second = new cr.expNode(e, t[2])), r) {
            var n, a;
            for (n = 0, a = r.length; n < a; n++) this.parameters.push(new cr.expNode(e, r[n]))
        }
        cr.seal(this)
    }

    function t() {
        return ++s, i.length === s && i.push(new cr.expvalue), i[s]
    }

    function r() {
        --s
    }

    function n(e, t, r) {
        var n, a;
        for (n = 0, a = e.length; n < a; ++n) e[n].get(r), t[n + 1] = r.data
    }

    function a(e, t) {
        this.type = e || cr.exptype.Integer, this.data = t || 0, this.object_class = null;
        this.type == cr.exptype.Integer && (this.data = o(this.data)), cr.seal(this)
    }
    var o = Math.floor;
    e.prototype.postInit = function() {
        if (23 === this.type && (this.eventvar = this.owner.runtime.getEventVariableByName(this.varname, this.owner.block.parent)), this.first && this.first.postInit(), this.second && this.second.postInit(), this.third && this.third.postInit(), this.instance_expr && this.instance_expr.postInit(), this.parameters) {
            var e, t;
            for (e = 0, t = this.parameters.length; e < t; e++) this.parameters[e].postInit()
        }
    };
    var i = [],
        s = -1;
    e.prototype.eval_system_exp = function(e) {
        var a = this.parameters,
            o = this.results;
        o[0] = e;
        var i = t();
        n(a, o, i), r(), this.func.apply(this.runtime.system, o)
    }, e.prototype.eval_object_exp = function(e) {
        var a = this.object_type,
            o = this.results,
            i = this.parameters,
            s = this.instance_expr,
            l = this.func,
            p = this.owner.solindex,
            d = a.getCurrentSol(),
            c = d.getObjects();
        if (!c.length)
            if (d.else_instances.length) c = d.else_instances;
            else return void(this.return_string ? e.set_string("") : e.set_int(0));
        o[0] = e, e.object_class = a;
        var u = t();
        n(i, o, u), s && (s.get(u), u.is_number() && (p = u.data, c = a.instances)), r();
        var g = c.length;
        (p >= g || p <= -g) && (p %= g), 0 > p && (p += g);
        l.apply(c[p], o)
    }, e.prototype.eval_behavior_exp = function(e) {
        var a = this.object_type,
            o = this.results,
            i = this.parameters,
            s = this.instance_expr,
            l = this.beh_index,
            p = this.func,
            d = this.owner.solindex,
            c = a.getCurrentSol(),
            u = c.getObjects();
        if (!u.length)
            if (c.else_instances.length) u = c.else_instances;
            else return void(this.return_string ? e.set_string("") : e.set_int(0));
        o[0] = e, e.object_class = a;
        var g = t();
        n(i, o, g), s && (s.get(g), g.is_number() && (d = g.data, u = a.instances)), r();
        var y = u.length;
        (d >= y || d <= -y) && (d %= y), 0 > d && (d += y);
        var m = u[d],
            _ = 0;
        a.is_family && (_ = m.type.family_beh_map[a.family_index]);
        p.apply(m.behavior_insts[l + _], o)
    }, e.prototype.eval_instvar_exp = function(e) {
        var n = this.instance_expr,
            a = this.object_type,
            o = this.varindex,
            i = this.owner.solindex,
            s = a.getCurrentSol(),
            l = s.getObjects(),
            p;
        if (!l.length)
            if (s.else_instances.length) l = s.else_instances;
            else return void(this.return_string ? e.set_string("") : e.set_int(0));
        if (n) {
            var d = t();
            if (n.get(d), d.is_number()) {
                i = d.data;
                var c = a.instances;
                0 !== c.length && (i %= c.length, 0 > i && (i += c.length)), p = a.getInstanceByIID(i);
                var u = p.instance_vars[o];
                return cr.is_string(u) ? e.set_string(u) : e.set_float(u), void r()
            }
            r()
        }
        var g = l.length;
        (i >= g || i <= -g) && (i %= g), 0 > i && (i += g), p = l[i];
        var y = 0;
        a.is_family && (y = p.type.family_var_map[a.family_index]);
        var u = p.instance_vars[o + y];
        cr.is_string(u) ? e.set_string(u) : e.set_float(u)
    }, e.prototype.eval_int = function(e) {
        e.type = cr.exptype.Integer, e.data = this.value
    }, e.prototype.eval_float = function(e) {
        e.type = cr.exptype.Float, e.data = this.value
    }, e.prototype.eval_string = function(e) {
        e.type = cr.exptype.String, e.data = this.value
    }, e.prototype.eval_unaryminus = function(e) {
        this.first.get(e), e.is_number() && (e.data = -e.data)
    }, e.prototype.eval_add = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data += n.data, n.is_float() && e.make_float()), r()
    }, e.prototype.eval_subtract = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data -= n.data, n.is_float() && e.make_float()), r()
    }, e.prototype.eval_multiply = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data *= n.data, n.is_float() && e.make_float()), r()
    }, e.prototype.eval_divide = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data /= n.data, e.make_float()), r()
    }, e.prototype.eval_mod = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data %= n.data, n.is_float() && e.make_float()), r()
    }, e.prototype.eval_power = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data = Math.pow(e.data, n.data), n.is_float() && e.make_float()), r()
    }, e.prototype.eval_and = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), n.is_string() || e.is_string() ? this.eval_and_stringconcat(e, n) : this.eval_and_logical(e, n), r()
    }, e.prototype.eval_and_stringconcat = function(e, t) {
        e.is_string() && t.is_string() ? this.eval_and_stringconcat_str_str(e, t) : this.eval_and_stringconcat_num(e, t)
    }, e.prototype.eval_and_stringconcat_str_str = function(e, t) {
        e.data += t.data
    }, e.prototype.eval_and_stringconcat_num = function(e, t) {
        e.is_string() ? e.data += (Math.round(1e10 * t.data) / 1e10).toString() : e.set_string(e.data.toString() + t.data)
    }, e.prototype.eval_and_logical = function(e, t) {
        e.set_int(e.data && t.data ? 1 : 0)
    }, e.prototype.eval_or = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.is_number() && n.is_number() && (e.data || n.data ? e.set_int(1) : e.set_int(0)), r()
    }, e.prototype.eval_conditional = function(e) {
        this.first.get(e), e.data ? this.second.get(e) : this.third.get(e)
    }, e.prototype.eval_equal = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.set_int(e.data === n.data ? 1 : 0), r()
    }, e.prototype.eval_notequal = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.set_int(e.data === n.data ? 0 : 1), r()
    }, e.prototype.eval_less = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.set_int(e.data < n.data ? 1 : 0), r()
    }, e.prototype.eval_lessequal = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.set_int(e.data <= n.data ? 1 : 0), r()
    }, e.prototype.eval_greater = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.set_int(e.data > n.data ? 1 : 0), r()
    }, e.prototype.eval_greaterequal = function(e) {
        this.first.get(e);
        var n = t();
        this.second.get(n), e.set_int(e.data >= n.data ? 1 : 0), r()
    }, e.prototype.eval_eventvar_exp = function(e) {
        var t = this.eventvar.getValue();
        "number" == typeof t ? e.set_float(t) : "boolean" == typeof t ? e.set_int(t ? 1 : 0) : e.set_string(t)
    }, cr.expNode = e;
    a.prototype.is_int = function() {
        return this.type === cr.exptype.Integer
    }, a.prototype.is_float = function() {
        return this.type === cr.exptype.Float
    }, a.prototype.is_number = function() {
        return this.type === cr.exptype.Integer || this.type === cr.exptype.Float
    }, a.prototype.is_string = function() {
        return this.type === cr.exptype.String
    }, a.prototype.make_int = function() {
        this.is_int() || (this.is_float() ? this.data = o(this.data) : this.is_string() && (this.data = parseInt(this.data, 10)), this.type = cr.exptype.Integer)
    }, a.prototype.make_float = function() {
        this.is_float() || (this.is_string() && (this.data = parseFloat(this.data)), this.type = cr.exptype.Float)
    }, a.prototype.make_string = function() {
        this.is_string() || (this.data = this.data.toString(), this.type = cr.exptype.String)
    }, a.prototype.set_int = function(e) {
        this.type = cr.exptype.Integer, this.data = o(e)
    }, a.prototype.set_float = function(e) {
        this.type = cr.exptype.Float, this.data = e
    }, a.prototype.set_string = function(e) {
        this.type = cr.exptype.String, this.data = e
    }, a.prototype.set_any = function(e) {
        cr.is_number(e) ? (this.type = cr.exptype.Float, this.data = e) : cr.is_string(e) ? (this.type = cr.exptype.String, this.data = e.toString()) : (this.type = cr.exptype.Integer, this.data = 0)
    }, cr.expvalue = a, cr.exptype = {
        Integer: 0,
        Float: 1,
        String: 2
    }
}();
cr.system_object = function(e) {
        this.runtime = e, this.waits = []
    }, cr.system_object.prototype.saveToJSON = function() {
        var e = {},
            r, n, a, o, s, l, d, c;
        e.waits = [];
        var u = e.waits,
            g;
        for (r = 0, n = this.waits.length; r < n; r++) {
            for (l = this.waits[r], g = {
                    t: l.time,
                    st: l.signaltag,
                    s: l.signalled,
                    ev: l.ev.sid,
                    sm: [],
                    sols: {}
                }, l.ev.actions[l.actindex] && (g.act = l.ev.actions[l.actindex].sid), (a = 0, o = l.solModifiers.length); a < o; a++) g.sm.push(l.solModifiers[a].sid);
            for (s in l.sols)
                if (l.sols.hasOwnProperty(s)) {
                    d = this.runtime.types_by_index[parseInt(s, 10)];
                    for (c = {
                            sa: l.sols[s].sa,
                            insts: []
                        }, a = 0, o = l.sols[s].insts.length; a < o; a++) c.insts.push(l.sols[s].insts[a].uid);
                    g.sols[d.sid.toString()] = c
                }
            u.push(g)
        }
        return e
    }, cr.system_object.prototype.loadFromJSON = function(r) {
        var n = r.waits,
            a, o, s, l, d, c, u, g, y, m, _, h, f;
        for (cr.clearArray(this.waits), a = 0, o = n.length; a < o; a++)
            if (c = n[a], g = this.runtime.blocksBySid[c.ev.toString()], g) {
                for (y = -1, s = 0, l = g.actions.length; s < l; s++)
                    if (g.actions[s].sid === c.act) {
                        y = s;
                        break
                    }
                if (-1 !== y) {
                    for (u = {}, u.sols = {}, u.solModifiers = [], u.deleteme = !1, u.time = c.t, u.signaltag = c.st || "", u.signalled = !!c.s, u.ev = g, u.actindex = y, (s = 0, l = c.sm.length); s < l; s++) m = this.runtime.getObjectTypeBySid(c.sm[s]), m && u.solModifiers.push(m);
                    for (d in c.sols)
                        if (c.sols.hasOwnProperty(d)) {
                            if (m = this.runtime.getObjectTypeBySid(parseInt(d, 10)), !m) continue;
                            for (_ = c.sols[d], h = {
                                    sa: _.sa,
                                    insts: []
                                }, (s = 0, l = _.insts.length); s < l; s++) f = this.runtime.getObjectByUID(_.insts[s]), f && h.insts.push(f);
                            u.sols[m.index.toString()] = h
                        }
                    this.waits.push(u)
                }
            }
    },
    function() {
        function e() {}

        function t(e, t) {
            var r = e.extra.c2_feo_val,
                n = t.extra.c2_feo_val;
            return cr.is_number(r) && cr.is_number(n) ? r - n : (r = "" + r, n = "" + n, r < n ? -1 : r > n ? 1 : 0)
        }

        function r(e, t) {
            return f && e === b && t === x || (f = new RegExp(e, t), b = e, x = t), f.lastIndex = 0, f
        }

        function n() {}

        function a() {
            var e;
            return S.length ? e = S.pop() : (e = {}, e.sols = {}, e.solModifiers = []), e.deleteme = !1, e
        }

        function o(e) {
            cr.wipe(e.sols), cr.clearArray(e.solModifiers), S.push(e)
        }

        function l() {
            var e;
            return w.length ? e = w.pop() : (e = {}, e.insts = []), e.sa = !1, e
        }

        function i(e) {
            cr.clearArray(e.insts), w.push(e)
        }

        function s(e, t) {
            var r = e[0],
                n = t[0],
                a = r - n;
            if (0 != a) return a;
            var o = e[1],
                i = t[1];
            return o - i
        }

        function p(e, t) {
            return e[1] - t[1]
        }

        function d() {}

        function c(e, t, n) {
            if (e !== O || t !== E || n !== C) {
                var a = r(t, n);
                T = e.match(a), O = e, E = t, C = n
            }
        }
        var u = Math.log,
            g = Math.round,
            y = Math.floor,
            m = cr.system_object.prototype;
        e.prototype.EveryTick = function() {
            return !0
        }, e.prototype.OnLayoutStart = function() {
            return !0
        }, e.prototype.OnLayoutEnd = function() {
            return !0
        }, e.prototype.Compare = function(e, t, r) {
            return cr.do_cmp(e, t, r)
        }, e.prototype.CompareTime = function(e, r) {
            var t = this.runtime.kahanTime.sum;
            if (0 === e) {
                var n = this.runtime.getCurrentCondition();
                return !(n.extra.CompareTime_executed || !(t >= r)) && (n.extra.CompareTime_executed = !0, !0)
            }
            return cr.do_cmp(t, e, r)
        }, e.prototype.LayerVisible = function(e) {
            return !!e && e.visible
        }, e.prototype.LayerEmpty = function(e) {
            return !!e && !e.instances.length
        }, e.prototype.LayerCmpOpacity = function(e, t, r) {
            return !!e && cr.do_cmp(100 * e.opacity, t, r)
        }, e.prototype.Repeat = function(e) {
            var t = this.runtime.getCurrentEventStack(),
                r = t.current_event,
                n = t.isModifierAfterCnds(),
                a = this.runtime.pushLoopStack(),
                o;
            if (n)
                for (o = 0; o < e && !a.stopped; o++) this.runtime.pushCopySol(r.solModifiers), a.index = o, r.retrigger(), this.runtime.popSol(r.solModifiers);
            else
                for (o = 0; o < e && !a.stopped; o++) a.index = o, r.retrigger();
            return this.runtime.popLoopStack(), !1
        }, e.prototype.While = function() {
            var e = this.runtime.getCurrentEventStack(),
                t = e.current_event,
                r = e.isModifierAfterCnds(),
                n = this.runtime.pushLoopStack(),
                a;
            if (r)
                for (a = 0; !n.stopped; a++) this.runtime.pushCopySol(t.solModifiers), n.index = a, t.retrigger() || (n.stopped = !0), this.runtime.popSol(t.solModifiers);
            else
                for (a = 0; !n.stopped; a++) n.index = a, t.retrigger() || (n.stopped = !0);
            return this.runtime.popLoopStack(), !1
        }, e.prototype.For = function(e, t, r) {
            var n = this.runtime.getCurrentEventStack(),
                a = n.current_event,
                o = n.isModifierAfterCnds(),
                s = this.runtime.pushLoopStack(e),
                l;
            if (r < t) {
                if (o)
                    for (l = t; l >= r && !s.stopped; --l) this.runtime.pushCopySol(a.solModifiers), s.index = l, a.retrigger(), this.runtime.popSol(a.solModifiers);
                else
                    for (l = t; l >= r && !s.stopped; --l) s.index = l, a.retrigger();
            } else if (o)
                for (l = t; l <= r && !s.stopped; ++l) this.runtime.pushCopySol(a.solModifiers), s.index = l, a.retrigger(), this.runtime.popSol(a.solModifiers);
            else
                for (l = t; l <= r && !s.stopped; ++l) s.index = l, a.retrigger();
            return this.runtime.popLoopStack(), !1
        };
        var _ = [],
            h = -1;
        e.prototype.ForEach = function(e) {
            var t = e.getCurrentSol();
            h++, _.length === h && _.push([]);
            var r = _[h];
            cr.shallowAssignArray(r, t.getObjects());
            var n = this.runtime.getCurrentEventStack(),
                a = n.current_event,
                o = n.isModifierAfterCnds(),
                l = this.runtime.pushLoopStack(),
                p = e.is_contained,
                d, c, u, g, y, m, f;
            if (o)
                for (d = 0, c = r.length; d < c && !l.stopped; d++) {
                    if (this.runtime.pushCopySol(a.solModifiers), y = r[d], t = e.getCurrentSol(), t.select_all = !1, cr.clearArray(t.instances), t.instances[0] = y, p)
                        for (u = 0, g = y.siblings.length; u < g; u++) m = y.siblings[u], f = m.type.getCurrentSol(), f.select_all = !1, cr.clearArray(f.instances), f.instances[0] = m;
                    l.index = d, a.retrigger(), this.runtime.popSol(a.solModifiers)
                } else
                    for (t.select_all = !1, cr.clearArray(t.instances), (d = 0, c = r.length); d < c && !l.stopped; d++) {
                        if (y = r[d], t.instances[0] = y, p)
                            for (u = 0, g = y.siblings.length; u < g; u++) m = y.siblings[u], f = m.type.getCurrentSol(), f.select_all = !1, cr.clearArray(f.instances), f.instances[0] = m;
                        l.index = d, a.retrigger()
                    }
            return cr.clearArray(r), this.runtime.popLoopStack(), h--, !1
        };
        e.prototype.ForEachOrdered = function(e, r, n) {
            var a = e.getCurrentSol();
            h++, _.length === h && _.push([]);
            var o = _[h];
            cr.shallowAssignArray(o, a.getObjects());
            var l = this.runtime.getCurrentEventStack(),
                p = l.current_event,
                d = this.runtime.getCurrentCondition(),
                c = l.isModifierAfterCnds(),
                u = this.runtime.pushLoopStack(),
                g, y, m, f, b, x, v;
            for (g = 0, y = o.length; g < y; g++) o[g].extra.c2_feo_val = d.parameters[1].get(g);
            o.sort(t), 1 === n && o.reverse();
            var w = e.is_contained;
            if (c)
                for (g = 0, y = o.length; g < y && !u.stopped; g++) {
                    if (this.runtime.pushCopySol(p.solModifiers), b = o[g], a = e.getCurrentSol(), a.select_all = !1, cr.clearArray(a.instances), a.instances[0] = b, w)
                        for (m = 0, f = b.siblings.length; m < f; m++) x = b.siblings[m], v = x.type.getCurrentSol(), v.select_all = !1, cr.clearArray(v.instances), v.instances[0] = x;
                    u.index = g, p.retrigger(), this.runtime.popSol(p.solModifiers)
                } else
                    for (a.select_all = !1, cr.clearArray(a.instances), (g = 0, y = o.length); g < y && !u.stopped; g++) {
                        if (b = o[g], a.instances[0] = b, w)
                            for (m = 0, f = b.siblings.length; m < f; m++) x = b.siblings[m], v = x.type.getCurrentSol(), v.select_all = !1, cr.clearArray(v.instances), v.instances[0] = x;
                        u.index = g, p.retrigger()
                    }
            return cr.clearArray(o), this.runtime.popLoopStack(), h--, !1
        }, e.prototype.PickByComparison = function(e, t, r, n) {
            var a, o, s, l;
            if (e) {
                h++, _.length === h && _.push([]);
                var p = _[h],
                    d = e.getCurrentSol();
                cr.shallowAssignArray(p, d.getObjects()), d.select_all && cr.clearArray(d.else_instances);
                var c = this.runtime.getCurrentCondition();
                for (a = 0, s = 0, o = p.length; a < o; a++) l = p[a], p[s] = l, t = c.parameters[1].get(a), n = c.parameters[3].get(a), cr.do_cmp(t, r, n) ? s++ : d.else_instances.push(l);
                return cr.truncateArray(p, s), d.select_all = !1, cr.shallowAssignArray(d.instances, p), cr.clearArray(p), h--, e.applySolToContainer(), !!d.instances.length
            }
        }, e.prototype.PickByEvaluate = function(e, t) {
            var r, n, a, o;
            if (e) {
                h++, _.length === h && _.push([]);
                var s = _[h],
                    l = e.getCurrentSol();
                cr.shallowAssignArray(s, l.getObjects()), l.select_all && cr.clearArray(l.else_instances);
                var p = this.runtime.getCurrentCondition();
                for (r = 0, a = 0, n = s.length; r < n; r++) o = s[r], s[a] = o, t = p.parameters[1].get(r), t ? a++ : l.else_instances.push(o);
                return cr.truncateArray(s, a), l.select_all = !1, cr.shallowAssignArray(l.instances, s), cr.clearArray(s), h--, e.applySolToContainer(), !!l.instances.length
            }
        }, e.prototype.TriggerOnce = function() {
            var e = this.runtime.getCurrentCondition().extra;
            "undefined" == typeof e.TriggerOnce_lastTick && (e.TriggerOnce_lastTick = -1);
            var t = e.TriggerOnce_lastTick,
                r = this.runtime.tickcount;
            return e.TriggerOnce_lastTick = r, this.runtime.layout_first_tick || t !== r - 1
        }, e.prototype.Every = function(e) {
            var t = this.runtime.getCurrentCondition(),
                r = t.extra.Every_lastTime || 0,
                n = this.runtime.kahanTime.sum;
            "undefined" == typeof t.extra.Every_seconds && (t.extra.Every_seconds = e);
            var a = t.extra.Every_seconds;
            return n >= r + a ? (t.extra.Every_lastTime = r + a, n >= t.extra.Every_lastTime + .04 && (t.extra.Every_lastTime = n), t.extra.Every_seconds = e, !0) : (n < r - .1 && (t.extra.Every_lastTime = n), !1)
        }, e.prototype.PickNth = function(e, t) {
            if (!e) return !1;
            var r = e.getCurrentSol(),
                n = r.getObjects();
            if (t = cr.floor(t), 0 > t || t >= n.length) return !1;
            var a = n[t];
            return r.pick_one(a), e.applySolToContainer(), !0
        }, e.prototype.PickRandom = function(e) {
            if (!e) return !1;
            var t = e.getCurrentSol(),
                r = t.getObjects(),
                n = cr.floor(Math.random() * r.length);
            if (n >= r.length) return !1;
            var a = r[n];
            return t.pick_one(a), e.applySolToContainer(), !0
        }, e.prototype.CompareVar = function(e, t, r) {
            return cr.do_cmp(e.getValue(), t, r)
        }, e.prototype.CompareBoolVar = function(e) {
            return e.getValue()
        }, e.prototype.IsGroupActive = function(e) {
            var t = this.runtime.groups_by_name[e.toLowerCase()];
            return t && t.group_active
        }, e.prototype.IsPreview = function() {
            return this.runtime.isPreview
        }, e.prototype.PickAll = function(e) {
            if (!e) return !1;
            if (!e.instances.length) return !1;
            var t = e.getCurrentSol();
            return t.select_all = !0, e.applySolToContainer(), !0
        }, e.prototype.IsMobile = function() {
            return this.runtime.isMobile
        }, e.prototype.CompareBetween = function(e, t, r) {
            return e >= t && e <= r
        }, e.prototype.Else = function() {
            var e = this.runtime.getCurrentEventStack();
            return !e.else_branch_ran && !e.last_event_true
        }, e.prototype.OnLoadFinished = function() {
            return !0
        }, e.prototype.OnCanvasSnapshot = function() {
            return !0
        }, e.prototype.EffectsSupported = function() {
            return !!this.runtime.glwrap
        }, e.prototype.OnSaveComplete = function() {
            return !0
        }, e.prototype.OnSaveFailed = function() {
            return !0
        }, e.prototype.OnLoadComplete = function() {
            return !0
        }, e.prototype.OnLoadFailed = function() {
            return !0
        }, e.prototype.ObjectUIDExists = function(e) {
            return !!this.runtime.getObjectByUID(e)
        }, e.prototype.IsOnPlatform = function(e) {
            var t = this.runtime;
            return 0 === e ? !t.isNodeWebkit && !t.isCordova && !t.isWinJS && !t.isWindowsPhone8 && !t.isBlackberry10 && !t.isAmazonWebApp : 1 === e ? t.isiOS : 2 === e ? t.isAndroid : 3 === e ? t.isWindows8App : 4 === e ? t.isWindowsPhone8 : 5 === e ? t.isBlackberry10 : 6 === e ? t.isTizen : 7 != e && (8 === e ? t.isCordova : 9 === e ? t.isArcade : 10 === e ? t.isNodeWebkit : 11 === e ? t.isCrosswalk : 12 === e ? t.isAmazonWebApp : !(13 != e) && t.isWindows10)
        };
        var f = null,
            b = "",
            x = "";
        e.prototype.RegexTest = function(e, t, n) {
            var a = r(t, n);
            return a.test(e)
        };
        var v = [];
        e.prototype.PickOverlappingPoint = function(e, t, r) {
            if (!e) return !1;
            var n = e.getCurrentSol(),
                a = n.getObjects(),
                o = this.runtime.getCurrentEventStack().current_event,
                s = o.orblock,
                l = this.runtime.getCurrentCondition(),
                p, d, c, u;
            for (n.select_all ? (cr.shallowAssignArray(v, a), cr.clearArray(n.else_instances), n.select_all = !1, cr.clearArray(n.instances)) : s ? (cr.shallowAssignArray(v, n.else_instances), cr.clearArray(n.else_instances)) : (cr.shallowAssignArray(v, a), cr.clearArray(n.instances)), p = 0, d = v.length; p < d; ++p) c = v[p], c.update_bbox(), u = cr.xor(c.contains_pt(t, r), l.inverted), u ? n.instances.push(c) : n.else_instances.push(c);
            return e.applySolToContainer(), cr.xor(!!n.instances.length, l.inverted)
        }, e.prototype.PickLastCreated = function(e) {
            if (!e) return !1;
            var t = this.runtime.createRow,
                r = null,
                n = e.is_family,
                a, o;
            for (a = t.length - 1; 0 <= a; --a)
                if (o = t[a], n) {
                    if (0 <= o.type.families.indexOf(e)) {
                        r = o;
                        break
                    }
                } else if (o.type === e) {
                r = o;
                break
            }
            if (!r && e.instances.length && (r = e.instances[e.instances.length - 1]), !r) return !1;
            var s = e.getCurrentSol();
            return s.pick_one(r), e.applySolToContainer(), !0
        }, e.prototype.IsNaN = function(e) {
            return !!isNaN(e)
        }, e.prototype.AngleWithin = function(e, t, r) {
            return cr.angleDiff(cr.to_radians(e), cr.to_radians(r)) <= cr.to_radians(t)
        }, e.prototype.IsClockwiseFrom = function(e, t) {
            return cr.angleClockwise(cr.to_radians(e), cr.to_radians(t))
        }, e.prototype.IsBetweenAngles = function(e, t, r) {
            var n = cr.to_clamped_radians(e),
                a = cr.to_clamped_radians(t),
                o = cr.to_clamped_radians(r),
                i = !cr.angleClockwise(o, a);
            return i ? cr.angleClockwise(n, a) || !cr.angleClockwise(n, o) : cr.angleClockwise(n, a) && !cr.angleClockwise(n, o)
        }, e.prototype.IsValueType = function(e, r) {
            return "number" == typeof e ? 0 === r : 1 === r
        }, m.cnds = new e;
        n.prototype.GoToLayout = function(e) {
            this.runtime.isloading || this.runtime.changelayout || (this.runtime.changelayout = e)
        }, n.prototype.NextPrevLayout = function(e) {
            if (!this.runtime.isloading && !this.runtime.changelayout) {
                var t = this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);
                if (!(e && 0 === t) && (e || t !== this.runtime.layouts_by_index.length - 1)) {
                    var r = this.runtime.layouts_by_index[t + (e ? -1 : 1)];
                    this.runtime.changelayout = r
                }
            }
        }, n.prototype.CreateObject = function(e, t, r, n) {
            if (t && e) {
                var a = this.runtime.createInstance(e, t, r, n);
                if (a) {
                    this.runtime.isInOnDestroy++;
                    var o, l, p;
                    if (this.runtime.trigger(Object.getPrototypeOf(e.plugin).cnds.OnCreated, a), a.is_contained)
                        for (o = 0, l = a.siblings.length; o < l; o++) p = a.siblings[o], this.runtime.trigger(Object.getPrototypeOf(p.type.plugin).cnds.OnCreated, p);
                    this.runtime.isInOnDestroy--;
                    var d = e.getCurrentSol();
                    if (d.select_all = !1, cr.clearArray(d.instances), d.instances[0] = a, a.is_contained)
                        for (o = 0, l = a.siblings.length; o < l; o++) p = a.siblings[o], d = p.type.getCurrentSol(), d.select_all = !1, cr.clearArray(d.instances), d.instances[0] = p
                }
            }
        }, n.prototype.CreateObjectByName = function(e, t, r, a) {
            if (t && e) {
                var o = this.runtime.types_lowercase[e.toLowerCase()];
                o && n.prototype.CreateObject.call(this, o, t, r, a)
            }
        }, n.prototype.SetLayerVisible = function(e, t) {
            e && (e.visible === t || (e.visible = t, this.runtime.redraw = !0))
        }, n.prototype.SetLayerOpacity = function(e, t) {
            e && (t = cr.clamp(t / 100, 0, 1), e.opacity !== t && (e.opacity = t, this.runtime.redraw = !0))
        }, n.prototype.SetLayerScaleRate = function(e, t) {
            e && (e.zoomRate === t || (e.zoomRate = t, this.runtime.redraw = !0))
        }, n.prototype.SetLayerForceOwnTexture = function(e, t) {
            e && (t = !!t, e.forceOwnTexture !== t && (e.forceOwnTexture = t, this.runtime.redraw = !0))
        }, n.prototype.SetLayoutScale = function(e) {
            this.runtime.running_layout && (this.runtime.running_layout.scale === e || (this.runtime.running_layout.scale = e, this.runtime.running_layout.boundScrolling(), this.runtime.redraw = !0))
        }, n.prototype.ScrollX = function(e) {
            this.runtime.running_layout.scrollToX(e)
        }, n.prototype.ScrollY = function(e) {
            this.runtime.running_layout.scrollToY(e)
        }, n.prototype.Scroll = function(e, t) {
            this.runtime.running_layout.scrollToX(e), this.runtime.running_layout.scrollToY(t)
        }, n.prototype.ScrollToObject = function(e) {
            var t = e.getFirstPicked();
            t && (this.runtime.running_layout.scrollToX(t.x), this.runtime.running_layout.scrollToY(t.y))
        }, n.prototype.SetVar = function(e, t) {
            0 === e.vartype ? cr.is_number(t) ? e.setValue(t) : e.setValue(parseFloat(t)) : 1 === e.vartype && e.setValue(t.toString())
        }, n.prototype.AddVar = function(e, t) {
            0 === e.vartype ? cr.is_number(t) ? e.setValue(e.getValue() + t) : e.setValue(e.getValue() + parseFloat(t)) : 1 === e.vartype && e.setValue(e.getValue() + t.toString())
        }, n.prototype.SubVar = function(e, t) {
            0 === e.vartype && (cr.is_number(t) ? e.setValue(e.getValue() - t) : e.setValue(e.getValue() - parseFloat(t)))
        }, n.prototype.SetBoolVar = function(e, t) {
            e.setValue(0 !== t)
        }, n.prototype.ToggleBoolVar = function(e) {
            e.setValue(!e.getValue())
        }, n.prototype.SetGroupActive = function(e, t) {
            var r = this.runtime.groups_by_name[e.toLowerCase()];
            r && (0 === t ? r.setGroupActive(!1) : 1 === t ? r.setGroupActive(!0) : 2 === t ? r.setGroupActive(!r.group_active) : void 0)
        }, n.prototype.SetTimescale = function(e) {
            var t = e;
            0 > t && (t = 0), this.runtime.timescale = t
        }, n.prototype.SetObjectTimescale = function(e, t) {
            var r = t;
            if (0 > r && (r = 0), !!e) {
                var n = e.getCurrentSol(),
                    a = n.getObjects(),
                    o, s;
                for (o = 0, s = a.length; o < s; o++) a[o].my_timescale = r
            }
        }, n.prototype.RestoreObjectTimescale = function(e) {
            if (!e) return !1;
            var t = e.getCurrentSol(),
                r = t.getObjects(),
                n, a;
            for (n = 0, a = r.length; n < a; n++) r[n].my_timescale = -1
        };
        var S = [];
        var w = [];
        n.prototype.Wait = function(e) {
            if (!(0 > e)) {
                var r = this.runtime.getCurrentEventStack(),
                    n = a(),
                    o, p, d, c, u;
                for (n.time = this.runtime.kahanTime.sum + e, n.signaltag = "", n.signalled = !1, n.ev = r.current_event, n.actindex = r.actindex + 1, (o = 0, p = this.runtime.types_by_index.length); o < p; o++) c = this.runtime.types_by_index[o], d = c.getCurrentSol(), d.select_all && -1 === r.current_event.solModifiers.indexOf(c) || (n.solModifiers.push(c), u = l(), u.sa = d.select_all, cr.shallowAssignArray(u.insts, d.instances), n.sols[o.toString()] = u);
                return this.waits.push(n), !0
            }
        }, n.prototype.WaitForSignal = function(e) {
            var r = this.runtime.getCurrentEventStack(),
                n = a(),
                o, p, d, c, u;
            for (n.time = -1, n.signaltag = e.toLowerCase(), n.signalled = !1, n.ev = r.current_event, n.actindex = r.actindex + 1, (o = 0, p = this.runtime.types_by_index.length); o < p; o++) c = this.runtime.types_by_index[o], d = c.getCurrentSol(), d.select_all && -1 === r.current_event.solModifiers.indexOf(c) || (n.solModifiers.push(c), u = l(), u.sa = d.select_all, cr.shallowAssignArray(u.insts, d.instances), n.sols[o.toString()] = u);
            return this.waits.push(n), !0
        }, n.prototype.Signal = function(e) {
            var t = e.toLowerCase(),
                r, n, a;
            for (r = 0, n = this.waits.length; r < n; ++r) a = this.waits[r], -1 === a.time && a.signaltag === t && (a.signalled = !0)
        }, n.prototype.SetLayerScale = function(e, t) {
            e && e.scale !== t && (e.scale = t, this.runtime.redraw = !0)
        }, n.prototype.ResetGlobals = function() {
            var e, t, r;
            for (e = 0, t = this.runtime.all_global_vars.length; e < t; e++) r = this.runtime.all_global_vars[e], r.data = r.initial
        }, n.prototype.SetLayoutAngle = function(e) {
            e = cr.to_radians(e), e = cr.clamp_angle(e), this.runtime.running_layout && this.runtime.running_layout.angle !== e && (this.runtime.running_layout.angle = e, this.runtime.redraw = !0)
        }, n.prototype.SetLayerAngle = function(e, t) {
            e && (t = cr.to_radians(t), t = cr.clamp_angle(t), e.angle === t || (e.angle = t, this.runtime.redraw = !0))
        }, n.prototype.SetLayerParallax = function(e, t, r) {
            if (e && (e.parallaxX !== t / 100 || e.parallaxY !== r / 100)) {
                if (e.parallaxX = t / 100, e.parallaxY = r / 100, 1 !== e.parallaxX || 1 !== e.parallaxY) {
                    var n = e.instances,
                        a, o;
                    for (a = 0, o = n.length; a < o; ++a) n[a].type.any_instance_parallaxed = !0
                }
                this.runtime.redraw = !0
            }
        }, n.prototype.SetLayerBackground = function(e, t) {
            if (e) {
                var n = cr.clamp(y(255 * cr.GetRValue(t)), 0, 255),
                    r = cr.clamp(y(255 * cr.GetGValue(t)), 0, 255),
                    a = cr.clamp(y(255 * cr.GetBValue(t)), 0, 255);
                e.background_color[0] === n && e.background_color[1] === r && e.background_color[2] === a || (e.background_color[0] = n, e.background_color[1] = r, e.background_color[2] = a, this.runtime.redraw = !0)
            }
        }, n.prototype.SetLayerTransparent = function(e, r) {
            e && !!r != !!e.transparent && (e.transparent = !!r, this.runtime.redraw = !0)
        }, n.prototype.SetLayerBlendMode = function(e, t) {
            e && e.blend_mode !== t && (e.blend_mode = t, e.compositeOp = cr.effectToCompositeOp(e.blend_mode), this.runtime.gl && cr.setGLBlend(e, e.blend_mode, this.runtime.gl), this.runtime.redraw = !0)
        }, n.prototype.StopLoop = function() {
            0 > this.runtime.loop_stack_index || (this.runtime.getCurrentLoop().stopped = !0)
        }, n.prototype.GoToLayoutByName = function(e) {
            if (!this.runtime.isloading && !this.runtime.changelayout) {
                for (var t in this.runtime.layouts)
                    if (this.runtime.layouts.hasOwnProperty(t) && cr.equals_nocase(t, e)) return void(this.runtime.changelayout = this.runtime.layouts[t])
            }
        }, n.prototype.RestartLayout = function() {
            if (!this.runtime.isloading && !this.runtime.changelayout && this.runtime.running_layout) {
                this.runtime.changelayout = this.runtime.running_layout;
                var e, t, r;
                for (e = 0, t = this.runtime.allGroups.length; e < t; e++) r = this.runtime.allGroups[e], r.setGroupActive(r.initially_activated)
            }
        }, n.prototype.SnapshotCanvas = function(e, t) {
            this.runtime.doCanvasSnapshot(0 === e ? "image/png" : "image/jpeg", t / 100)
        }, n.prototype.SetCanvasSize = function(e, t) {
            if (!(0 >= e || 0 >= t)) {
                var r = this.runtime.fullscreen_mode,
                    n = document.mozFullScreen || document.webkitIsFullScreen || !!document.msFullscreenElement || document.fullScreen;
                n && 0 < this.runtime.fullscreen_scaling && (r = this.runtime.fullscreen_scaling), 0 === r ? this.runtime.setSize(e, t, !0) : (this.runtime.original_width = e, this.runtime.original_height = t, this.runtime.setSize(this.runtime.lastWindowWidth, this.runtime.lastWindowHeight, !0))
            }
        }, n.prototype.SetLayoutEffectEnabled = function(e, t) {
            if (this.runtime.running_layout && this.runtime.glwrap) {
                var r = this.runtime.running_layout.getEffectByName(t);
                if (r) {
                    var n = 1 === e;
                    r.active == n || (r.active = n, this.runtime.running_layout.updateActiveEffects(), this.runtime.redraw = !0)
                }
            }
        }, n.prototype.SetLayerEffectEnabled = function(e, t, r) {
            if (e && this.runtime.glwrap) {
                var n = e.getEffectByName(r);
                if (n) {
                    var a = 1 === t;
                    n.active == a || (n.active = a, e.updateActiveEffects(), this.runtime.redraw = !0)
                }
            }
        }, n.prototype.SetLayoutEffectParam = function(e, t, r) {
            if (this.runtime.running_layout && this.runtime.glwrap) {
                var n = this.runtime.running_layout.getEffectByName(e);
                if (n) {
                    var a = this.runtime.running_layout.effect_params[n.index];
                    if (t = y(t), !(0 > t || t >= a.length)) {
                        var o = this.runtime.glwrap.getProgramParameterType(n.shaderindex, t);
                        1 === o ? r /= 100 : 2 === o && (r = [cr.GetRValue(r), cr.GetGValue(r), cr.GetBValue(r)]), a[t] === r || (a[t] = r, n.active && (this.runtime.redraw = !0))
                    }
                }
            }
        }, n.prototype.SetLayerEffectParam = function(e, t, r, n) {
            if (e && this.runtime.glwrap) {
                var a = e.getEffectByName(t);
                if (a) {
                    var o = e.effect_params[a.index];
                    if (r = y(r), !(0 > r || r >= o.length)) {
                        var i = this.runtime.glwrap.getProgramParameterType(a.shaderindex, r);
                        1 === i ? n /= 100 : 2 === i && (n = [cr.GetRValue(n), cr.GetGValue(n), cr.GetBValue(n)]), o[r] === n || (o[r] = n, a.active && (this.runtime.redraw = !0))
                    }
                }
            }
        }, n.prototype.SaveState = function(e) {
            this.runtime.saveToSlot = e
        }, n.prototype.LoadState = function(e) {
            this.runtime.loadFromSlot = e
        }, n.prototype.LoadStateJSON = function(e) {
            this.runtime.loadFromJson = e
        }, n.prototype.SetHalfFramerateMode = function(e) {
            this.runtime.halfFramerateMode = 0 !== e
        }, n.prototype.SetFullscreenQuality = function(e) {
            var t = document.mozFullScreen || document.webkitIsFullScreen || !!document.msFullscreenElement || document.fullScreen;
            (t || 0 !== this.runtime.fullscreen_mode) && (this.runtime.wantFullscreenScalingQuality = 0 !== e, this.runtime.setSize(this.runtime.lastWindowWidth, this.runtime.lastWindowHeight, !0))
        }, n.prototype.ResetPersisted = function() {
            var e, t;
            for (e = 0, t = this.runtime.layouts_by_index.length; e < t; ++e) this.runtime.layouts_by_index[e].persist_data = {}, this.runtime.layouts_by_index[e].first_visit = !0
        }, n.prototype.RecreateInitialObjects = function(e, t, r, n, a) {
            e && this.runtime.running_layout.recreateInitialObjects(e, t, r, n, a)
        }, n.prototype.SetPixelRounding = function(e) {
            this.runtime.pixel_rounding = 0 !== e, this.runtime.redraw = !0
        }, n.prototype.SetMinimumFramerate = function(e) {
            1 > e && (e = 1), 120 < e && (e = 120), this.runtime.minimumFramerate = e
        };
        n.prototype.SortZOrderByInstVar = function(e, t) {
            if (e) {
                var r = e.getCurrentSol(),
                    n = r.getObjects(),
                    a = [],
                    o = [],
                    l = this.runtime.running_layout,
                    d = e.is_family,
                    c = e.family_index,
                    u = !1,
                    g, y, m, _, h, f;
                for (g = 0, y = n.length; g < y; ++g) m = n[g], m.layer && (_ = d ? m.instance_vars[t + m.type.family_var_map[c]] : m.instance_vars[t], a.push([m.layer.index, m.get_zindex()]), o.push([m, _]));
                if (a.length) {
                    for (a.sort(s), o.sort(p), (g = 0, y = a.length); g < y; ++g) m = o[g][0], h = l.layers[a[g][0]], f = a[g][1], h.instances[f] !== m && (h.instances[f] = m, m.layer = h, h.setZIndicesStaleFrom(f), u = !0);
                    u && (this.runtime.redraw = !0)
                }
            }
        }, m.acts = new n;
        d.prototype.int = function(e, t) {
            cr.is_string(t) ? (e.set_int(parseInt(t, 10)), isNaN(e.data) && (e.data = 0)) : e.set_int(t)
        }, d.prototype.float = function(e, t) {
            cr.is_string(t) ? (e.set_float(parseFloat(t)), isNaN(e.data) && (e.data = 0)) : e.set_float(t)
        }, d.prototype.str = function(e, t) {
            cr.is_string(t) ? e.set_string(t) : e.set_string(t.toString())
        }, d.prototype.len = function(e, t) {
            e.set_int(t.length || 0)
        }, d.prototype.random = function(e, t, r) {
            r === void 0 ? e.set_float(Math.random() * t) : e.set_float(Math.random() * (r - t) + t)
        }, d.prototype.sqrt = function(e, t) {
            e.set_float(Math.sqrt(t))
        }, d.prototype.abs = function(e, t) {
            e.set_float(Math.abs(t))
        }, d.prototype.round = function(e, t) {
            e.set_int(g(t))
        }, d.prototype.floor = function(e, t) {
            e.set_int(y(t))
        }, d.prototype.ceil = function(e, t) {
            e.set_int(Math.ceil(t))
        }, d.prototype.sign = function(e, t) {
            e.set_float(Math.sign(t))
        }, d.prototype.sin = function(e, t) {
            e.set_float(Math.sin(cr.to_radians(t)))
        }, d.prototype.cos = function(e, t) {
            e.set_float(Math.cos(cr.to_radians(t)))
        }, d.prototype.tan = function(e, t) {
            e.set_float(Math.tan(cr.to_radians(t)))
        }, d.prototype.asin = function(e, t) {
            e.set_float(cr.to_degrees(Math.asin(t)))
        }, d.prototype.acos = function(e, t) {
            e.set_float(cr.to_degrees(Math.acos(t)))
        }, d.prototype.atan = function(e, t) {
            e.set_float(cr.to_degrees(Math.atan(t)))
        }, d.prototype.exp = function(e, t) {
            e.set_float(Math.exp(t))
        }, d.prototype.ln = function(e, t) {
            e.set_float(u(t))
        }, d.prototype.log10 = function(e, t) {
            e.set_float(u(t) / Math.LN10)
        }, d.prototype.max = function(e) {
            var t = arguments[1];
            "number" != typeof t && (t = 0);
            var r, n, o;
            for (r = 2, n = arguments.length; r < n; r++) o = arguments[r], "number" == typeof o && t < o && (t = o);
            e.set_float(t)
        }, d.prototype.min = function(e) {
            var t = arguments[1];
            "number" != typeof t && (t = 0);
            var r, n, o;
            for (r = 2, n = arguments.length; r < n; r++) o = arguments[r], "number" == typeof o && t > o && (t = o);
            e.set_float(t)
        }, d.prototype.dt = function(e) {
            e.set_float(this.runtime.dt)
        }, d.prototype.timescale = function(e) {
            e.set_float(this.runtime.timescale)
        }, d.prototype.wallclocktime = function(e) {
            e.set_float((Date.now() - this.runtime.start_time) / 1e3)
        }, d.prototype.unixtime = function(e) {
            e.set_float(Date.now())
        }, d.prototype.time = function(e) {
            e.set_float(this.runtime.kahanTime.sum)
        }, d.prototype.tickcount = function(e) {
            e.set_int(this.runtime.tickcount)
        }, d.prototype.objectcount = function(e) {
            e.set_int(this.runtime.objectcount)
        }, d.prototype.fps = function(e) {
            e.set_int(this.runtime.fps)
        }, d.prototype.loopindex = function(e, t) {
            var r, n;
            if (!this.runtime.loop_stack.length) return void e.set_int(0);
            if (t) {
                for (n = this.runtime.loop_stack_index; 0 <= n; --n)
                    if (r = this.runtime.loop_stack[n], r.name === t) return void e.set_int(r.index);
                e.set_int(0)
            } else r = this.runtime.getCurrentLoop(), e.set_int(r ? r.index : -1)
        }, d.prototype.distance = function(e, t, r, n, a) {
            e.set_float(cr.distanceTo(t, r, n, a))
        }, d.prototype.angle = function(e, t, r, n, a) {
            e.set_float(cr.to_degrees(cr.angleTo(t, r, n, a)))
        }, d.prototype.scrollx = function(e) {
            e.set_float(this.runtime.running_layout.scrollX)
        }, d.prototype.scrolly = function(e) {
            e.set_float(this.runtime.running_layout.scrollY)
        }, d.prototype.newline = function(e) {
            e.set_string("\n")
        }, d.prototype.lerp = function(e, t, r, n) {
            e.set_float(cr.lerp(t, r, n))
        }, d.prototype.qarp = function(e, t, r, n, a) {
            e.set_float(cr.qarp(t, r, n, a))
        }, d.prototype.cubic = function(e, t, r, n, a, o) {
            e.set_float(cr.cubic(t, r, n, a, o))
        }, d.prototype.cosp = function(e, t, r, n) {
            e.set_float(cr.cosp(t, r, n))
        }, d.prototype.windowwidth = function(e) {
            e.set_int(this.runtime.width)
        }, d.prototype.windowheight = function(e) {
            e.set_int(this.runtime.height)
        }, d.prototype.uppercase = function(e, t) {
            e.set_string(cr.is_string(t) ? t.toUpperCase() : "")
        }, d.prototype.lowercase = function(e, t) {
            e.set_string(cr.is_string(t) ? t.toLowerCase() : "")
        }, d.prototype.clamp = function(e, t, r, n) {
            t < r ? e.set_float(r) : t > n ? e.set_float(n) : e.set_float(t)
        }, d.prototype.layerscale = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_float(r.scale) : e.set_float(0)
        }, d.prototype.layeropacity = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_float(100 * r.opacity) : e.set_float(0)
        }, d.prototype.layerscalerate = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_float(r.zoomRate) : e.set_float(0)
        }, d.prototype.layerparallaxx = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_float(100 * r.parallaxX) : e.set_float(0)
        }, d.prototype.layerparallaxy = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_float(100 * r.parallaxY) : e.set_float(0)
        }, d.prototype.layerindex = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_int(r.index) : e.set_int(-1)
        }, d.prototype.layoutscale = function(e) {
            this.runtime.running_layout ? e.set_float(this.runtime.running_layout.scale) : e.set_float(0)
        }, d.prototype.layoutangle = function(e) {
            e.set_float(cr.to_degrees(this.runtime.running_layout.angle))
        }, d.prototype.layerangle = function(e, t) {
            var r = this.runtime.getLayer(t);
            r ? e.set_float(cr.to_degrees(r.angle)) : e.set_float(0)
        }, d.prototype.layoutwidth = function(e) {
            e.set_int(this.runtime.running_layout.width)
        }, d.prototype.layoutheight = function(e) {
            e.set_int(this.runtime.running_layout.height)
        }, d.prototype.find = function(e, t, r) {
            cr.is_string(t) && cr.is_string(r) ? e.set_int(t.search(new RegExp(cr.regexp_escape(r), "i"))) : e.set_int(-1)
        }, d.prototype.findcase = function(e, t, r) {
            cr.is_string(t) && cr.is_string(r) ? e.set_int(t.search(new RegExp(cr.regexp_escape(r), ""))) : e.set_int(-1)
        }, d.prototype.left = function(e, t, r) {
            e.set_string(cr.is_string(t) ? t.substr(0, r) : "")
        }, d.prototype.right = function(e, t, r) {
            e.set_string(cr.is_string(t) ? t.substr(t.length - r) : "")
        }, d.prototype.mid = function(e, t, r, n) {
            e.set_string(cr.is_string(t) ? t.substr(r, n) : "")
        }, d.prototype.tokenat = function(e, t, r, n) {
            if (cr.is_string(t) && cr.is_string(n)) {
                var a = t.split(n),
                    o = cr.floor(r);
                0 > o || o >= a.length ? e.set_string("") : e.set_string(a[o])
            } else e.set_string("")
        }, d.prototype.tokencount = function(e, t, r) {
            cr.is_string(t) && t.length ? e.set_int(t.split(r).length) : e.set_int(0)
        }, d.prototype.replace = function(e, t, r, n) {
            cr.is_string(t) && cr.is_string(r) && cr.is_string(n) ? e.set_string(t.replace(new RegExp(cr.regexp_escape(r), "gi"), n)) : e.set_string(cr.is_string(t) ? t : "")
        }, d.prototype.trim = function(e, t) {
            e.set_string(cr.is_string(t) ? t.trim() : "")
        }, d.prototype.pi = function(e) {
            e.set_float(cr.PI)
        }, d.prototype.layoutname = function(e) {
            this.runtime.running_layout ? e.set_string(this.runtime.running_layout.name) : e.set_string("")
        }, d.prototype.renderer = function(e) {
            e.set_string(this.runtime.gl ? "webgl" : "canvas2d")
        }, d.prototype.rendererdetail = function(e) {
            e.set_string(this.runtime.glUnmaskedRenderer)
        }, d.prototype.anglediff = function(e, t, r) {
            e.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(t), cr.to_radians(r))))
        }, d.prototype.choose = function(e) {
            var t = cr.floor(Math.random() * (arguments.length - 1));
            e.set_any(arguments[t + 1])
        }, d.prototype.rgb = function(e, t, r, n) {
            e.set_int(cr.RGB(t, r, n))
        }, d.prototype.rgbex = function(e, t, r, n) {
            e.set_float(cr.RGBEx(t / 100, r / 100, n / 100))
        }, d.prototype.projectversion = function(e) {
            e.set_string(this.runtime.versionstr)
        }, d.prototype.projectname = function(e) {
            e.set_string(this.runtime.name)
        }, d.prototype.anglelerp = function(e, t, r, n) {
            t = cr.to_radians(t), r = cr.to_radians(r);
            var o = cr.angleDiff(t, r);
            cr.angleClockwise(r, t) ? e.set_float(cr.to_clamped_degrees(t + o * n)) : e.set_float(cr.to_clamped_degrees(t - o * n))
        }, d.prototype.anglerotate = function(e, t, r, n) {
            t = cr.to_radians(t), r = cr.to_radians(r), n = cr.to_radians(n), e.set_float(cr.to_clamped_degrees(cr.angleRotate(t, r, n)))
        }, d.prototype.zeropad = function(e, t, r) {
            var a = 0 > t ? "-" : "";
            0 > t && (t = -t);
            for (var o = r - t.toString().length, l = 0; l < o; l++) a += "0";
            e.set_string(a + t.toString())
        }, d.prototype.cpuutilisation = function(e) {
            e.set_float(this.runtime.cpuutilisation / 1e3)
        }, d.prototype.gpuutilisation = function(e) {
            e.set_float(this.runtime.gpuLastUtilisation)
        }, d.prototype.viewportleft = function(e, t) {
            var r = this.runtime.getLayer(t);
            e.set_float(r ? r.viewLeft : 0)
        }, d.prototype.viewporttop = function(e, t) {
            var r = this.runtime.getLayer(t);
            e.set_float(r ? r.viewTop : 0)
        }, d.prototype.viewportright = function(e, t) {
            var r = this.runtime.getLayer(t);
            e.set_float(r ? r.viewRight : 0)
        }, d.prototype.viewportbottom = function(e, t) {
            var r = this.runtime.getLayer(t);
            e.set_float(r ? r.viewBottom : 0)
        }, d.prototype.loadingprogress = function(e) {
            e.set_float(this.runtime.loadingprogress)
        }, d.prototype.unlerp = function(e, t, r, n) {
            e.set_float(cr.unlerp(t, r, n))
        }, d.prototype.canvassnapshot = function(e) {
            e.set_string(this.runtime.snapshotData)
        }, d.prototype.urlencode = function(e, t) {
            e.set_string(encodeURIComponent(t))
        }, d.prototype.urldecode = function(e, t) {
            e.set_string(decodeURIComponent(t))
        }, d.prototype.canvastolayerx = function(e, t, r, n) {
            var a = this.runtime.getLayer(t);
            e.set_float(a ? a.canvasToLayer(r, n, !0) : 0)
        }, d.prototype.canvastolayery = function(e, t, r, n) {
            var a = this.runtime.getLayer(t);
            e.set_float(a ? a.canvasToLayer(r, n, !1) : 0)
        }, d.prototype.layertocanvasx = function(e, t, r, n) {
            var a = this.runtime.getLayer(t);
            e.set_float(a ? a.layerToCanvas(r, n, !0) : 0)
        }, d.prototype.layertocanvasy = function(e, t, r, n) {
            var a = this.runtime.getLayer(t);
            e.set_float(a ? a.layerToCanvas(r, n, !1) : 0)
        }, d.prototype.savestatejson = function(e) {
            e.set_string(this.runtime.lastSaveJson)
        }, d.prototype.imagememoryusage = function(e) {
            this.runtime.glwrap ? e.set_float(g(100 * this.runtime.glwrap.estimateVRAM() / 1048576) / 100) : e.set_float(0)
        }, d.prototype.regexsearch = function(e, t, n, a) {
            var o = r(n, a);
            e.set_int(t ? t.search(o) : -1)
        }, d.prototype.regexreplace = function(e, t, n, a, o) {
            var i = r(n, a);
            e.set_string(t ? t.replace(i, o) : "")
        };
        var T = [],
            O = "",
            E = "",
            C = "";
        d.prototype.regexmatchcount = function(e, t, n, a) {
            r(n, a);
            c(t.toString(), n, a), e.set_int(T ? T.length : 0)
        }, d.prototype.regexmatchat = function(e, t, n, a, o) {
            o = y(o);
            r(n, a);
            c(t.toString(), n, a), !T || 0 > o || o >= T.length ? e.set_string("") : e.set_string(T[o])
        }, d.prototype.infinity = function(e) {
            e.set_float(1 / 0)
        }, d.prototype.setbit = function(e, t, r, a) {
            t |= 0, r |= 0, a = 0 === a ? 0 : 1, e.set_int(t & ~(1 << r) | a << r)
        }, d.prototype.togglebit = function(e, t, r) {
            t |= 0, r |= 0, e.set_int(t ^ 1 << r)
        }, d.prototype.getbit = function(e, t, r) {
            t |= 0, r |= 0, e.set_int(t & 1 << r ? 1 : 0)
        }, d.prototype.originalwindowwidth = function(e) {
            e.set_int(this.runtime.original_width)
        }, d.prototype.originalwindowheight = function(e) {
            e.set_int(this.runtime.original_height)
        }, d.prototype.originalviewportwidth = function(e) {
            e.set_int(this.runtime.original_width)
        }, d.prototype.originalviewportheight = function(e) {
            e.set_int(this.runtime.original_height)
        }, m.exps = new d, m.runWaits = function() {
            var e = this.runtime.getCurrentEventStack(),
                t, r, n, a, l, p, d;
            for (t = 0, n = this.waits.length; t < n; t++) {
                if (a = this.waits[t], -1 === a.time) {
                    if (!a.signalled) continue;
                } else if (a.time > this.runtime.kahanTime.sum) continue;
                for (l in e.current_event = a.ev, e.actindex = a.actindex, e.cndindex = 0, a.sols) a.sols.hasOwnProperty(l) && (p = this.runtime.types_by_index[parseInt(l, 10)].getCurrentSol(), d = a.sols[l], p.select_all = d.sa, cr.shallowAssignArray(p.instances, d.insts), i(d));
                a.ev.resume_actions_and_subevents(), this.runtime.clearSol(a.solModifiers), a.deleteme = !0
            }
            for (t = 0, r = 0, n = this.waits.length; t < n; t++) a = this.waits[t], this.waits[r] = a, a.deleteme ? o(a) : r++;
            cr.truncateArray(this.waits, r)
        }
    }();
(function() {
    var e = Math.atan2,
        t = Math.cos,
        r = Math.sin;
    cr.add_common_aces = function(n, a) {
        var o = n[1],
            i = n[3],
            s = n[4],
            l = n[5],
            p = n[6],
            d = n[7],
            c = n[8];
        a.cnds || (a.cnds = {}), a.acts || (a.acts = {}), a.exps || (a.exps = {});
        var u = a.cnds,
            g = a.acts,
            y = a.exps;
        i && (u.CompareX = function(e, t) {
            return cr.do_cmp(this.x, e, t)
        }, u.CompareY = function(e, t) {
            return cr.do_cmp(this.y, e, t)
        }, u.IsOnScreen = function() {
            var e = this.layer;
            this.update_bbox();
            var t = this.bbox;
            return !(t.right < e.viewLeft || t.bottom < e.viewTop || t.left > e.viewRight || t.top > e.viewBottom)
        }, u.IsOutsideLayout = function() {
            this.update_bbox();
            var e = this.bbox,
                t = this.runtime.running_layout;
            return 0 > e.right || 0 > e.bottom || e.left > t.width || e.top > t.height
        }, u.PickDistance = function(e, t, r) {
            var n = this.getCurrentSol(),
                a = n.getObjects();
            if (!a.length) return !1;
            var o = a[0],
                s = o,
                l = cr.distanceTo(o.x, o.y, t, r),
                p, c, u;
            for (p = 1, c = a.length; p < c; p++) o = a[p], u = cr.distanceTo(o.x, o.y, t, r), (0 === e && u < l || 1 === e && u > l) && (l = u, s = o);
            return n.pick_one(s), !0
        }, g.SetX = function(e) {
            this.x !== e && (this.x = e, this.set_bbox_changed())
        }, g.SetY = function(e) {
            this.y !== e && (this.y = e, this.set_bbox_changed())
        }, g.SetPos = function(e, t) {
            (this.x !== e || this.y !== t) && (this.x = e, this.y = t, this.set_bbox_changed())
        }, g.SetPosToObject = function(e, t) {
            var r = e.getPairedInstance(this);
            if (r) {
                var n, a;
                r.getImagePoint ? (n = r.getImagePoint(t, !0), a = r.getImagePoint(t, !1)) : (n = r.x, a = r.y), (this.x !== n || this.y !== a) && (this.x = n, this.y = a, this.set_bbox_changed())
            }
        }, g.MoveForward = function(e) {
            0 !== e && (this.x += t(this.angle) * e, this.y += r(this.angle) * e, this.set_bbox_changed())
        }, g.MoveAtAngle = function(e, n) {
            0 !== n && (this.x += t(cr.to_radians(e)) * n, this.y += r(cr.to_radians(e)) * n, this.set_bbox_changed())
        }, y.X = function(e) {
            e.set_float(this.x)
        }, y.Y = function(e) {
            e.set_float(this.y)
        }, y.dt = function(e) {
            e.set_float(this.runtime.getDt(this))
        }), s && (u.CompareWidth = function(e, t) {
            return cr.do_cmp(this.width, e, t)
        }, u.CompareHeight = function(e, t) {
            return cr.do_cmp(this.height, e, t)
        }, g.SetWidth = function(e) {
            this.width !== e && (this.width = e, this.set_bbox_changed())
        }, g.SetHeight = function(e) {
            this.height !== e && (this.height = e, this.set_bbox_changed())
        }, g.SetSize = function(e, t) {
            (this.width !== e || this.height !== t) && (this.width = e, this.height = t, this.set_bbox_changed())
        }, y.Width = function(e) {
            e.set_float(this.width)
        }, y.Height = function(e) {
            e.set_float(this.height)
        }, y.BBoxLeft = function(e) {
            this.update_bbox(), e.set_float(this.bbox.left)
        }, y.BBoxTop = function(e) {
            this.update_bbox(), e.set_float(this.bbox.top)
        }, y.BBoxRight = function(e) {
            this.update_bbox(), e.set_float(this.bbox.right)
        }, y.BBoxBottom = function(e) {
            this.update_bbox(), e.set_float(this.bbox.bottom)
        }), l && (u.AngleWithin = function(e, t) {
            return cr.angleDiff(this.angle, cr.to_radians(t)) <= cr.to_radians(e)
        }, u.IsClockwiseFrom = function(e) {
            return cr.angleClockwise(this.angle, cr.to_radians(e))
        }, u.IsBetweenAngles = function(e, t) {
            var r = cr.to_clamped_radians(e),
                n = cr.to_clamped_radians(t),
                a = cr.clamp_angle(this.angle),
                o = !cr.angleClockwise(n, r);
            return o ? cr.angleClockwise(a, r) || !cr.angleClockwise(a, n) : cr.angleClockwise(a, r) && !cr.angleClockwise(a, n)
        }, g.SetAngle = function(e) {
            var t = cr.to_radians(cr.clamp_angle_degrees(e));
            isNaN(t) || this.angle !== t && (this.angle = t, this.set_bbox_changed())
        }, g.RotateClockwise = function(e) {
            0 === e || isNaN(e) || (this.angle += cr.to_radians(e), this.angle = cr.clamp_angle(this.angle), this.set_bbox_changed())
        }, g.RotateCounterclockwise = function(e) {
            0 === e || isNaN(e) || (this.angle -= cr.to_radians(e), this.angle = cr.clamp_angle(this.angle), this.set_bbox_changed())
        }, g.RotateTowardAngle = function(e, t) {
            var r = cr.angleRotate(this.angle, cr.to_radians(t), cr.to_radians(e));
            isNaN(r) || this.angle !== r && (this.angle = r, this.set_bbox_changed())
        }, g.RotateTowardPosition = function(t, r, n) {
            var a = r - this.x,
                o = n - this.y,
                i = e(o, a),
                s = cr.angleRotate(this.angle, i, cr.to_radians(t));
            isNaN(s) || this.angle !== s && (this.angle = s, this.set_bbox_changed())
        }, g.SetTowardPosition = function(t, r) {
            var n = t - this.x,
                a = r - this.y,
                o = e(a, n);
            isNaN(o) || this.angle !== o && (this.angle = o, this.set_bbox_changed())
        }, y.Angle = function(e) {
            e.set_float(cr.to_clamped_degrees(this.angle))
        }), o || (u.CompareInstanceVar = function(e, t, r) {
            return cr.do_cmp(this.instance_vars[e], t, r)
        }, u.IsBoolInstanceVarSet = function(e) {
            return this.instance_vars[e]
        }, u.PickInstVarHiLow = function(e, t) {
            var r = this.getCurrentSol(),
                n = r.getObjects();
            if (!n.length) return !1;
            var a = n[0],
                o = a,
                s = a.instance_vars[t],
                l, p, d;
            for (l = 1, p = n.length; l < p; l++) a = n[l], d = a.instance_vars[t], (0 === e && d < s || 1 === e && d > s) && (s = d, o = a);
            return r.pick_one(o), !0
        }, u.PickByUID = function(e) {
            var t = this.runtime.getCurrentCondition(),
                r, n, a, o, s, l, p;
            if (t.inverted) {
                if (p = this.getCurrentSol(), p.select_all) {
                    for (p.select_all = !1, cr.clearArray(p.instances), cr.clearArray(p.else_instances), l = this.instances, (r = 0, n = l.length); r < n; r++) o = l[r], o.uid === e ? p.else_instances.push(o) : p.instances.push(o);
                    return this.applySolToContainer(), !!p.instances.length
                }
                for (r = 0, a = 0, n = p.instances.length; r < n; r++) o = p.instances[r], p.instances[a] = o, o.uid === e ? p.else_instances.push(o) : a++;
                return cr.truncateArray(p.instances, a), this.applySolToContainer(), !!p.instances.length
            }
            if (o = this.runtime.getObjectByUID(e), !o) return !1;
            if (p = this.getCurrentSol(), !p.select_all && -1 === p.instances.indexOf(o)) return !1;
            if (this.is_family) {
                for (s = o.type.families, r = 0, n = s.length; r < n; r++)
                    if (s[r] === this) return p.pick_one(o), this.applySolToContainer(), !0;
            } else if (o.type === this) return p.pick_one(o), this.applySolToContainer(), !0;
            return !1
        }, u.OnCreated = function() {
            return !0
        }, u.OnDestroyed = function() {
            return !0
        }, g.SetInstanceVar = function(e, t) {
            var r = this.instance_vars;
            if (cr.is_number(r[e])) r[e] = cr.is_number(t) ? t : parseFloat(t);
            else if (cr.is_string(r[e])) r[e] = cr.is_string(t) ? t : t.toString();
            else;
        }, g.AddInstanceVar = function(e, t) {
            var r = this.instance_vars;
            if (cr.is_number(r[e])) r[e] += cr.is_number(t) ? t : parseFloat(t);
            else if (cr.is_string(r[e])) r[e] += cr.is_string(t) ? t : t.toString();
            else;
        }, g.SubInstanceVar = function(e, t) {
            var r = this.instance_vars;
            if (cr.is_number(r[e])) r[e] -= cr.is_number(t) ? t : parseFloat(t);
            else;
        }, g.SetBoolInstanceVar = function(e, t) {
            this.instance_vars[e] = t ? 1 : 0
        }, g.ToggleBoolInstanceVar = function(e) {
            this.instance_vars[e] = 1 - this.instance_vars[e]
        }, g.Destroy = function() {
            this.runtime.DestroyInstance(this)
        }, !g.LoadFromJsonString && (g.LoadFromJsonString = function(e) {
            var t, r, n, a;
            try {
                t = JSON.parse(e)
            } catch (t) {
                return
            }
            if (this.runtime.loadInstanceFromJSON(this, t, !0), this.afterLoad && this.afterLoad(), this.behavior_insts)
                for (r = 0, n = this.behavior_insts.length; r < n; ++r) a = this.behavior_insts[r], a.afterLoad && a.afterLoad()
        }), y.Count = function(e) {
            var t = e.object_class.instances.length,
                r, n, a;
            for (r = 0, n = this.runtime.createRow.length; r < n; r++) a = this.runtime.createRow[r], e.object_class.is_family ? 0 <= a.type.families.indexOf(e.object_class) && t++ : a.type === e.object_class && t++;
            e.set_int(t)
        }, y.PickedCount = function(e) {
            e.set_int(e.object_class.getCurrentSol().getObjects().length)
        }, y.UID = function(e) {
            e.set_int(this.uid)
        }, y.IID = function(e) {
            e.set_int(this.get_iid())
        }, !y.AsJSON && (y.AsJSON = function(e) {
            e.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this, !0)))
        })), p && (u.IsVisible = function() {
            return this.visible
        }, g.SetVisible = function(e) {
            e = 2 === e ? !this.visible : 0 != e, e !== this.visible && (this.visible = e, this.runtime.redraw = !0)
        }, u.CompareOpacity = function(e, t) {
            return cr.do_cmp(cr.round6dp(100 * this.opacity), e, t)
        }, g.SetOpacity = function(e) {
            var t = e / 100;
            0 > t ? t = 0 : 1 < t && (t = 1), t !== this.opacity && (this.opacity = t, this.runtime.redraw = !0)
        }, y.Opacity = function(e) {
            e.set_float(cr.round6dp(100 * this.opacity))
        }), d && (u.IsOnLayer = function(e) {
            return !!e && this.layer === e
        }, u.PickTopBottom = function(e) {
            var t = this.getCurrentSol(),
                r = t.getObjects();
            if (!r.length) return !1;
            var n = r[0],
                a = n,
                o, s;
            for (o = 1, s = r.length; o < s; o++) n = r[o], 0 === e ? (n.layer.index > a.layer.index || n.layer.index === a.layer.index && n.get_zindex() > a.get_zindex()) && (a = n) : (n.layer.index < a.layer.index || n.layer.index === a.layer.index && n.get_zindex() < a.get_zindex()) && (a = n);
            return t.pick_one(a), !0
        }, g.MoveToTop = function() {
            var e = this.layer,
                t = e.instances;
            t.length && t[t.length - 1] === this || (e.removeFromInstanceList(this, !1), e.appendToInstanceList(this, !1), this.runtime.redraw = !0)
        }, g.MoveToBottom = function() {
            var e = this.layer,
                t = e.instances;
            t.length && t[0] === this || (e.removeFromInstanceList(this, !1), e.prependToInstanceList(this, !1), this.runtime.redraw = !0)
        }, g.MoveToLayer = function(e) {
            e && e != this.layer && (this.layer.removeFromInstanceList(this, !0), this.layer = e, e.appendToInstanceList(this, !0), this.runtime.redraw = !0)
        }, g.ZMoveToObject = function(e, t) {
            if (t) {
                var r = t.getFirstPicked(this);
                r && r.uid !== this.uid && (this.layer.index !== r.layer.index && (this.layer.removeFromInstanceList(this, !0), this.layer = r.layer, r.layer.appendToInstanceList(this, !0)), this.layer.moveInstanceAdjacent(this, r, 0 === e), this.runtime.redraw = !0)
            }
        }, y.LayerNumber = function(e) {
            e.set_int(this.layer.number)
        }, y.LayerName = function(e) {
            e.set_string(this.layer.name)
        }, y.ZIndex = function(e) {
            e.set_int(this.get_zindex())
        }), c && (g.SetEffectEnabled = function(e, t) {
            if (this.runtime.glwrap) {
                var r = this.type.getEffectIndexByName(t);
                if (!(0 > r)) {
                    var n = 1 === e;
                    this.active_effect_flags[r] === n || (this.active_effect_flags[r] = n, this.updateActiveEffects(), this.runtime.redraw = !0)
                }
            }
        }, g.SetEffectParam = function(e, t, n) {
            if (this.runtime.glwrap) {
                var a = this.type.getEffectIndexByName(e);
                if (!(0 > a)) {
                    var o = this.type.effect_types[a],
                        i = this.effect_params[a],
                        s, l, p;
                    if (t = Math.floor(t), !(0 > t || t >= i.length)) {
                        var d = this.runtime.glwrap.getProgramParameterType(o.shaderindex, t);
                        if (1 === d && (n /= 100), 2 === d) {
                            s = cr.GetRValue(n), l = cr.GetGValue(n), p = cr.GetBValue(n);
                            var c = i[t];
                            if (c[0] === s && c[1] === l && c[2] === p) return;
                            c[0] = s, c[1] = l, c[2] = p, o.active && (this.runtime.redraw = !0)
                        } else {
                            if (i[t] === n) return;
                            i[t] = n, o.active && (this.runtime.redraw = !0)
                        }
                    }
                }
            }
        })
    }, cr.set_bbox_changed = function() {
        this.bbox_changed = !0, this.cell_changed = !0, this.type.any_cell_changed = !0, this.runtime.redraw = !0;
        var e = this.bbox_changed_callbacks,
            t, r;
        for (t = 0, r = e.length; t < r; ++t) e[t](this);
        this.layer.useRenderCells && this.update_bbox()
    }, cr.add_bbox_changed_callback = function(e) {
        e && this.bbox_changed_callbacks.push(e)
    }, cr.update_bbox = function() {
        if (this.bbox_changed) {
            var e = this.bbox,
                t = this.bquad;
            e.set(this.x, this.y, this.x + this.width, this.y + this.height), e.offset(-this.hotspotX * this.width, -this.hotspotY * this.height), this.angle ? (e.offset(-this.x, -this.y), t.set_from_rotated_rect(e, this.angle), t.offset(this.x, this.y), t.bounding_box(e)) : t.set_from_rect(e), e.normalize(), this.bbox_changed = !1, this.update_render_cell()
        }
    };
    var n = new cr.rect(0, 0, 0, 0);
    cr.update_render_cell = function() {
        if (this.layer.useRenderCells) {
            var e = this.layer.render_grid,
                t = this.bbox;
            n.set(e.XToCell(t.left), e.YToCell(t.top), e.XToCell(t.right), e.YToCell(t.bottom)), this.rendercells.equals(n) || (this.rendercells.right < this.rendercells.left ? e.update(this, null, n) : e.update(this, this.rendercells, n), this.rendercells.copy(n), this.layer.render_list_stale = !0)
        }
    }, cr.update_collision_cell = function() {
        if (this.cell_changed && this.collisionsEnabled) {
            this.update_bbox();
            var e = this.type.collision_grid,
                t = this.bbox;
            n.set(e.XToCell(t.left), e.YToCell(t.top), e.XToCell(t.right), e.YToCell(t.bottom)), this.collcells.equals(n) || (this.collcells.right < this.collcells.left ? e.update(this, null, n) : e.update(this, this.collcells, n), this.collcells.copy(n), this.cell_changed = !1)
        }
    }, cr.inst_contains_pt = function(e, t) {
        return !!this.bbox.contains_pt(e, t) && !!this.bquad.contains_pt(e, t) && (this.tilemap_exists ? this.testPointOverlapTile(e, t) : !this.collision_poly || this.collision_poly.is_empty() || (this.collision_poly.cache_poly(this.width, this.height, this.angle), this.collision_poly.contains_pt(e - this.x, t - this.y)))
    }, cr.inst_get_iid = function() {
        return this.type.updateIIDs(), this.iid
    }, cr.inst_get_zindex = function() {
        return this.layer.updateZIndices(), this.zindex
    }, cr.inst_updateActiveEffects = function() {
        cr.clearArray(this.active_effect_types);
        var e = !0,
            t, r, n;
        for (t = 0, r = this.active_effect_flags.length; t < r; t++) this.active_effect_flags[t] && (n = this.type.effect_types[t], this.active_effect_types.push(n), n.preservesOpaqueness || (e = !1));
        this.uses_shaders = !!this.active_effect_types.length, this.shaders_preserve_opaqueness = e
    }, cr.inst_toString = function() {
        return "Inst" + this.puid
    }, cr.type_getFirstPicked = function(e) {
        if (e && e.is_contained && e.type != this) {
            var t, r, n;
            for (t = 0, r = e.siblings.length; t < r; t++)
                if (n = e.siblings[t], n.type == this) return n
        }
        var a = this.getCurrentSol().getObjects();
        return a.length ? a[0] : null
    }, cr.type_getPairedInstance = function(e) {
        var t = this.getCurrentSol().getObjects();
        return t.length ? t[e.get_iid() % t.length] : null
    }, cr.type_updateIIDs = function() {
        if (this.stale_iids && !this.is_family) {
            var e, t;
            for (e = 0, t = this.instances.length; e < t; e++) this.instances[e].iid = e;
            var r = e,
                n = this.runtime.createRow;
            for (e = 0, t = n.length; e < t; ++e) n[e].type === this && (n[e].iid = r++);
            this.stale_iids = !1
        }
    }, cr.type_getInstanceByIID = function(e) {
        if (e < this.instances.length) return this.instances[e];
        e -= this.instances.length;
        var t = this.runtime.createRow,
            r, n;
        for (r = 0, n = t.length; r < n; ++r)
            if (t[r].type === this) {
                if (0 === e) return t[r];
                --e
            }
        return null
    }, cr.type_getCurrentSol = function() {
        return this.solstack[this.cur_sol]
    }, cr.type_pushCleanSol = function() {
        this.cur_sol++, this.cur_sol === this.solstack.length ? this.solstack.push(new cr.selection(this)) : (this.solstack[this.cur_sol].select_all = !0, cr.clearArray(this.solstack[this.cur_sol].else_instances))
    }, cr.type_pushCopySol = function() {
        this.cur_sol++, this.cur_sol === this.solstack.length && this.solstack.push(new cr.selection(this));
        var e = this.solstack[this.cur_sol],
            t = this.solstack[this.cur_sol - 1];
        t.select_all ? e.select_all = !0 : (e.select_all = !1, cr.shallowAssignArray(e.instances, t.instances)), cr.clearArray(e.else_instances)
    }, cr.type_popSol = function() {
        this.cur_sol--
    }, cr.type_getBehaviorByName = function(e) {
        var t = 0,
            r, n, a, o, s;
        if (!this.is_family)
            for (r = 0, n = this.families.length; r < n; r++)
                for (s = this.families[r], a = 0, o = s.behaviors.length; a < o; a++) {
                    if (e === s.behaviors[a].name) return this.extra.lastBehIndex = t, s.behaviors[a];
                    t++
                }
        for (r = 0, n = this.behaviors.length; r < n; r++) {
            if (e === this.behaviors[r].name) return this.extra.lastBehIndex = t, this.behaviors[r];
            t++
        }
        return null
    }, cr.type_getBehaviorIndexByName = function(e) {
        var t = this.getBehaviorByName(e);
        return t ? this.extra.lastBehIndex : -1
    }, cr.type_getEffectIndexByName = function(e) {
        var t, r;
        for (t = 0, r = this.effect_types.length; t < r; t++)
            if (this.effect_types[t].name === e) return t;
        return -1
    }, cr.type_applySolToContainer = function() {
        if (this.is_contained && !this.is_family) {
            var e, r, n, a, o, s, l;
            this.updateIIDs(), s = this.getCurrentSol();
            var p = s.select_all,
                d = this.runtime.getCurrentEventStack(),
                c = d && d.current_event && d.current_event.orblock;
            for (e = 0, r = this.container.length; e < r; e++)
                if (o = this.container[e], o !== this && (o.updateIIDs(), l = o.getCurrentSol(), l.select_all = p, !p)) {
                    for (cr.clearArray(l.instances), n = 0, a = s.instances.length; n < a; ++n) l.instances[n] = o.getInstanceByIID(s.instances[n].iid);
                    if (c)
                        for (cr.clearArray(l.else_instances), n = 0, a = s.else_instances.length; n < a; ++n) l.else_instances[n] = o.getInstanceByIID(s.else_instances[n].iid)
                }
        }
    }, cr.type_toString = function() {
        return "Type" + this.sid
    }, cr.do_cmp = function(e, t, r) {
        if ("undefined" == typeof e || "undefined" == typeof r) return !1;
        switch (t) {
            case 0:
                return e === r;
            case 1:
                return e !== r;
            case 2:
                return e < r;
            case 3:
                return e <= r;
            case 4:
                return e > r;
            case 5:
                return e >= r;
            default:
                ;
                return !1;
        }
    }
})(), cr.shaders = {};
cr.plugins_.Touch = function(e) {
        this.runtime = e
    },
    function() {
        function e(e) {
            g = e.x, y = e.y, m = e.z
        }

        function r(e, r, n, a) {
            var o;
            return o = h.length ? h.pop() : new t, o.init(e, r, n, a), o
        }

        function n(e) {
            100 > h.length && h.push(e)
        }

        function t() {
            this.starttime = 0, this.time = 0, this.lasttime = 0, this.startx = 0, this.starty = 0, this.x = 0, this.y = 0, this.lastx = 0, this.lasty = 0, this.id = 0, this.startindex = 0, this.triggeredHold = !1, this.tooFarForHold = !1
        }

        function a(t) {
            return t.sourceCapabilities && t.sourceCapabilities.firesTouchEvents || t.originalEvent && t.originalEvent.sourceCapabilities && t.originalEvent.sourceCapabilities.firesTouchEvents
        }

        function o() {}

        function i() {}

        function s() {}
        var l = Math.floor,
            p = Math.max,
            d = cr.plugins_.Touch.prototype;
        d.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var c = d.Type.prototype;
        c.onCreate = function() {}, d.Instance = function(e) {
            this.type = e, this.runtime = e.runtime, this.touches = [], this.mouseDown = !1
        };
        var u = d.Instance.prototype;
        u.findTouch = function(e) {
            var t, r;
            for (t = 0, r = this.touches.length; t < r; t++)
                if (this.touches[t].id === e) return t;
            return -1
        };
        var g = 0,
            y = 0,
            m = 0;
        var _ = null,
            h = [];
        t.prototype.init = function(e, t, r, n) {
            var a = cr.performance_now();
            this.time = a, this.lasttime = a, this.starttime = a, this.startx = e, this.starty = t, this.x = e, this.y = t, this.lastx = e, this.lasty = t, this.width = 0, this.height = 0, this.pressure = 0, this.id = r, this.startindex = n, this.triggeredHold = !1, this.tooFarForHold = !1
        }, t.prototype.update = function(e, t, r, n, a, o) {
            this.lasttime = this.time, this.time = e, this.lastx = this.x, this.lasty = this.y, this.x = t, this.y = r, this.width = n, this.height = a, this.pressure = o, !this.tooFarForHold && cr.distanceTo(this.startx, this.starty, this.x, this.y) >= 15 && (this.tooFarForHold = !0)
        }, t.prototype.maybeTriggerHold = function(e, t) {
            if (!this.triggeredHold) {
                var r = cr.performance_now();
                500 <= r - this.starttime && !this.tooFarForHold && 15 > cr.distanceTo(this.startx, this.starty, this.x, this.y) && (this.triggeredHold = !0, e.trigger_index = this.startindex, e.trigger_id = this.id, e.getTouchIndex = t, e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture, e), e.curTouchX = this.x, e.curTouchY = this.y, e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject, e), e.getTouchIndex = 0)
            }
        };
        var f = -1e3,
            b = -1e3,
            x = -1e4;
        t.prototype.maybeTriggerTap = function(e, t) {
            if (!this.triggeredHold) {
                var r = cr.performance_now();
                333 >= r - this.starttime && !this.tooFarForHold && 15 > cr.distanceTo(this.startx, this.starty, this.x, this.y) && (e.trigger_index = this.startindex, e.trigger_id = this.id, e.getTouchIndex = t, 666 >= r - x && 25 > cr.distanceTo(f, b, this.x, this.y) ? (e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture, e), e.curTouchX = this.x, e.curTouchY = this.y, e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject, e), f = -1e3, b = -1e3, x = -1e4) : (e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture, e), e.curTouchX = this.x, e.curTouchY = this.y, e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject, e), f = this.x, b = this.y, x = r), e.getTouchIndex = 0)
            }
        }, u.onCreate = function() {
            _ = this, this.isWindows8 = !!("undefined" != typeof window.c2isWindows8 && window.c2isWindows8), this.orient_alpha = 0, this.orient_beta = 0, this.orient_gamma = 0, this.acc_g_x = 0, this.acc_g_y = 0, this.acc_g_z = 0, this.acc_x = 0, this.acc_y = 0, this.acc_z = 0, this.curTouchX = 0, this.curTouchY = 0, this.trigger_index = 0, this.trigger_id = 0, this.trigger_permission = 0, this.getTouchIndex = 0, this.useMouseInput = this.properties[0];
            var t = 0 < this.runtime.fullscreen_mode ? document : this.runtime.canvas,
                r = document,
                n = this;
            if ("undefined" == typeof PointerEvent ? window.navigator.msPointerEnabled ? (t.addEventListener("MSPointerDown", function(e) {
                    n.onPointerStart(e)
                }, !1), t.addEventListener("MSPointerMove", function(e) {
                    n.onPointerMove(e)
                }, !1), r.addEventListener("MSPointerUp", function(e) {
                    n.onPointerEnd(e, !1)
                }, !1), r.addEventListener("MSPointerCancel", function(e) {
                    n.onPointerEnd(e, !0)
                }, !1), this.runtime.canvas && (this.runtime.canvas.addEventListener("MSGestureHold", function(t) {
                    t.preventDefault()
                }, !1), document.addEventListener("MSGestureHold", function(t) {
                    t.preventDefault()
                }, !1))) : (t.addEventListener("touchstart", function(e) {
                    n.onTouchStart(e)
                }, !1), t.addEventListener("touchmove", function(e) {
                    n.onTouchMove(e)
                }, !1), r.addEventListener("touchend", function(e) {
                    n.onTouchEnd(e, !1)
                }, !1), r.addEventListener("touchcancel", function(e) {
                    n.onTouchEnd(e, !0)
                }, !1)) : (t.addEventListener("pointerdown", function(e) {
                    n.onPointerStart(e)
                }, !1), t.addEventListener("pointermove", function(e) {
                    n.onPointerMove(e)
                }, !1), r.addEventListener("pointerup", function(e) {
                    n.onPointerEnd(e, !1)
                }, !1), r.addEventListener("pointercancel", function(e) {
                    n.onPointerEnd(e, !0)
                }, !1), this.runtime.canvas && (this.runtime.canvas.addEventListener("MSGestureHold", function(t) {
                    t.preventDefault()
                }, !1), document.addEventListener("MSGestureHold", function(t) {
                    t.preventDefault()
                }, !1), this.runtime.canvas.addEventListener("gesturehold", function(t) {
                    t.preventDefault()
                }, !1), document.addEventListener("gesturehold", function(t) {
                    t.preventDefault()
                }, !1))), this.isWindows8) {
                var a = function(t) {
                        var e = t.reading;
                        n.acc_x = e.accelerationX, n.acc_y = e.accelerationY, n.acc_z = e.accelerationZ
                    },
                    o = function(t) {
                        var e = t.reading;
                        n.orient_alpha = e.yawDegrees, n.orient_beta = e.pitchDegrees, n.orient_gamma = e.rollDegrees
                    },
                    i = Windows.Devices.Sensors.Accelerometer.getDefault();
                i && (i.reportInterval = p(i.minimumReportInterval, 16), i.addEventListener("readingchanged", a));
                var s = Windows.Devices.Sensors.Inclinometer.getDefault();
                s && (s.reportInterval = p(s.minimumReportInterval, 16), s.addEventListener("readingchanged", o)), document.addEventListener("visibilitychange", function() {
                    document.hidden || document.msHidden ? (i && i.removeEventListener("readingchanged", a), s && s.removeEventListener("readingchanged", o)) : (i && i.addEventListener("readingchanged", a), s && s.addEventListener("readingchanged", o))
                }, !1)
            } else window.addEventListener("deviceorientation", function(e) {
                n.orient_alpha = e.alpha || 0, n.orient_beta = e.beta || 0, n.orient_gamma = e.gamma || 0
            }, !1), window.addEventListener("devicemotion", function(e) {
                e.accelerationIncludingGravity && (n.acc_g_x = e.accelerationIncludingGravity.x || 0, n.acc_g_y = e.accelerationIncludingGravity.y || 0, n.acc_g_z = e.accelerationIncludingGravity.z || 0), e.acceleration && (n.acc_x = e.acceleration.x || 0, n.acc_y = e.acceleration.y || 0, n.acc_z = e.acceleration.z || 0)
            }, !1);
            this.useMouseInput && (document.addEventListener("mousemove", function(e) {
                n.onMouseMove(e)
            }), document.addEventListener("mousedown", function(e) {
                n.onMouseDown(e)
            }), document.addEventListener("mouseup", function(e) {
                n.onMouseUp(e)
            })), !this.runtime.isiOS && this.runtime.isCordova && navigator.accelerometer && navigator.accelerometer.watchAcceleration && navigator.accelerometer.watchAcceleration(e, null, {
                frequency: 40
            }), this.runtime.tick2Me(this)
        }, u.onPointerMove = function(e) {
            if (e.pointerType !== e.MSPOINTER_TYPE_MOUSE && "mouse" !== e.pointerType) {
                e.preventDefault && e.preventDefault();
                var r = this.findTouch(e.pointerId),
                    n = cr.performance_now();
                if (0 <= r) {
                    var a = this.runtime.canvas.offsetLeft,
                        o = this.runtime.canvas.offsetTop,
                        i = this.touches[r];
                    if (2 > n - i.time) return;
                    i.update(n, e.pageX - a, e.pageY - o, e.width || 0, e.height || 0, e.pressure || 0)
                }
            }
        }, u.onPointerStart = function(e) {
            if (e.pointerType !== e.MSPOINTER_TYPE_MOUSE && "mouse" !== e.pointerType) {
                var t = this.findTouch(e.pointerId);
                if (-1 === t) {
                    e.preventDefault && cr.isCanvasInputEvent(e) && e.preventDefault();
                    var n = this.runtime.canvas.offsetLeft,
                        a = this.runtime.canvas.offsetTop,
                        o = e.pageX - n,
                        i = e.pageY - a,
                        s = cr.performance_now();
                    this.trigger_index = this.touches.length, this.trigger_id = e.pointerId, this.touches.push(r(o, i, e.pointerId, this.trigger_index)), this.runtime.isInUserInputEvent = !0, this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart, this), this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart, this), this.curTouchX = o, this.curTouchY = i, this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject, this), this.runtime.isInUserInputEvent = !1
                }
            }
        }, u.onPointerEnd = function(e, t) {
            if (e.pointerType !== e.MSPOINTER_TYPE_MOUSE && "mouse" !== e.pointerType) {
                e.preventDefault && cr.isCanvasInputEvent(e) && e.preventDefault();
                var r = this.findTouch(e.pointerId);
                this.trigger_index = 0 <= r ? this.touches[r].startindex : -1, this.trigger_id = 0 <= r ? this.touches[r].id : -1, this.runtime.isInUserInputEvent = !0, this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd, this), this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd, this), 0 <= r && (!t && this.touches[r].maybeTriggerTap(this, r), n(this.touches[r]), this.touches.splice(r, 1)), this.runtime.isInUserInputEvent = !1
            }
        }, u.onTouchMove = function(e) {
            e.preventDefault && e.preventDefault();
            var r = cr.performance_now(),
                n, a, o, s;
            for (n = 0, a = e.changedTouches.length; n < a; n++) {
                o = e.changedTouches[n];
                var l = this.findTouch(o.identifier);
                if (0 <= l) {
                    var p = this.runtime.canvas.offsetLeft,
                        d = this.runtime.canvas.offsetTop;
                    if (s = this.touches[l], 2 > r - s.time) continue;
                    var c = 2 * (o.radiusX || o.webkitRadiusX || o.mozRadiusX || o.msRadiusX || 0),
                        g = 2 * (o.radiusY || o.webkitRadiusY || o.mozRadiusY || o.msRadiusY || 0),
                        y = o.force || o.webkitForce || o.mozForce || o.msForce || 0;
                    s.update(r, o.pageX - p, o.pageY - d, c, g, y)
                }
            }
        }, u.onTouchStart = function(e) {
            e.preventDefault && cr.isCanvasInputEvent(e) && e.preventDefault();
            var n = this.runtime.canvas.offsetLeft,
                a = this.runtime.canvas.offsetTop,
                o = cr.performance_now();
            this.runtime.isInUserInputEvent = !0;
            var s, l, p, d;
            for (s = 0, l = e.changedTouches.length; s < l; s++)
                if (p = e.changedTouches[s], d = this.findTouch(p.identifier), -1 === d) {
                    var c = p.pageX - n,
                        u = p.pageY - a;
                    this.trigger_index = this.touches.length, this.trigger_id = p.identifier, this.touches.push(r(c, u, p.identifier, this.trigger_index)), this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart, this), this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart, this), this.curTouchX = c, this.curTouchY = u, this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject, this)
                }
            this.runtime.isInUserInputEvent = !1
        }, u.onTouchEnd = function(e, r) {
            e.preventDefault && cr.isCanvasInputEvent(e) && e.preventDefault(), this.runtime.isInUserInputEvent = !0;
            var a, o, s, l;
            for (a = 0, o = e.changedTouches.length; a < o; a++) s = e.changedTouches[a], l = this.findTouch(s.identifier), 0 <= l && (this.trigger_index = this.touches[l].startindex, this.trigger_id = this.touches[l].id, this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd, this), this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd, this), !r && this.touches[l].maybeTriggerTap(this, l), n(this.touches[l]), this.touches.splice(l, 1));
            this.runtime.isInUserInputEvent = !1
        }, u.getAlpha = function() {
            return this.runtime.isCordova && 0 === this.orient_alpha && 0 !== m ? 90 * m : this.orient_alpha
        }, u.getBeta = function() {
            return this.runtime.isCordova && 0 === this.orient_beta && 0 !== y ? 90 * y : this.orient_beta
        }, u.getGamma = function() {
            return this.runtime.isCordova && 0 === this.orient_gamma && 0 !== g ? 90 * g : this.orient_gamma
        };
        u.onMouseDown = function(e) {
            if (!a(e)) {
                var r = {
                    pageX: e.pageX,
                    pageY: e.pageY,
                    identifier: 0
                };
                this.onTouchStart({
                    changedTouches: [r]
                }), this.mouseDown = !0
            }
        }, u.onMouseMove = function(e) {
            if (this.mouseDown && !a(e)) {
                var r = {
                    pageX: e.pageX,
                    pageY: e.pageY,
                    identifier: 0
                };
                this.onTouchMove({
                    changedTouches: [r]
                })
            }
        }, u.onMouseUp = function(e) {
            if (e.preventDefault && this.runtime.had_a_click && !this.runtime.isMobile && e.preventDefault(), this.runtime.had_a_click = !0, !a(e)) {
                var r = {
                    pageX: e.pageX,
                    pageY: e.pageY,
                    identifier: 0
                };
                this.onTouchEnd({
                    changedTouches: [r]
                }), this.mouseDown = !1
            }
        }, u.isClientPosOverCanvas = function(e, t) {
            return 0 <= e && 0 <= t && e < this.runtime.width && t < this.runtime.height
        }, u.tick2 = function() {
            var e = cr.performance_now(),
                r, n, a;
            for (r = 0, n = this.touches.length; r < n; ++r) a = this.touches[r], a.time <= e - 50 && (a.lasttime = e), a.maybeTriggerHold(this, r)
        };
        o.prototype.OnTouchStart = function() {
            return !0
        }, o.prototype.OnTouchEnd = function() {
            return !0
        }, o.prototype.IsInTouch = function() {
            return this.touches.length
        }, o.prototype.OnTouchObject = function(e) {
            return !!e && !!this.isClientPosOverCanvas(this.curTouchX, this.curTouchY) && this.runtime.testAndSelectCanvasPointOverlap(e, this.curTouchX, this.curTouchY, !1)
        };
        var v = [];
        o.prototype.IsTouchingObject = function(e) {
            if (!e) return !1;
            var t = e.getCurrentSol(),
                r = t.getObjects(),
                n, a, o, s, l, p;
            for (o = 0, s = r.length; o < s; o++) {
                var d = r[o];
                for (d.update_bbox(), l = 0, p = this.touches.length; l < p; l++) {
                    var c = this.touches[l];
                    if (this.isClientPosOverCanvas(c.x, c.y) && (n = d.layer.canvasToLayer(c.x, c.y, !0), a = d.layer.canvasToLayer(c.x, c.y, !1), d.contains_pt(n, a))) {
                        v.push(d);
                        break
                    }
                }
            }
            return !!v.length && (t.select_all = !1, cr.shallowAssignArray(t.instances, v), e.applySolToContainer(), cr.clearArray(v), !0)
        }, o.prototype.CompareTouchSpeed = function(e, r, n) {
            if (e = l(e), 0 > e || e >= this.touches.length) return !1;
            var a = this.touches[e],
                t = cr.distanceTo(a.x, a.y, a.lastx, a.lasty),
                o = (a.time - a.lasttime) / 1e3,
                i = 0;
            return 0 < o && (i = t / o), cr.do_cmp(i, r, n)
        }, o.prototype.OrientationSupported = function() {
            return "undefined" != typeof window.DeviceOrientationEvent
        }, o.prototype.MotionSupported = function() {
            return "undefined" != typeof window.DeviceMotionEvent
        }, o.prototype.CompareOrientation = function(e, t, r) {
            var n = 0;
            return n = 0 === e ? this.getAlpha() : 1 === e ? this.getBeta() : this.getGamma(), cr.do_cmp(n, t, r)
        }, o.prototype.CompareAcceleration = function(e, t, r) {
            var n = 0;
            return 0 === e ? n = this.acc_g_x : 1 === e ? n = this.acc_g_y : 2 === e ? n = this.acc_g_z : 3 === e ? n = this.acc_x : 4 === e ? n = this.acc_y : 5 == e && (n = this.acc_z), cr.do_cmp(n, t, r)
        }, o.prototype.OnNthTouchStart = function(e) {
            return e = l(e), e === this.trigger_index
        }, o.prototype.OnNthTouchEnd = function(e) {
            return e = l(e), e === this.trigger_index
        }, o.prototype.HasNthTouch = function(e) {
            return e = l(e), this.touches.length >= e + 1
        }, o.prototype.OnHoldGesture = function() {
            return !0
        }, o.prototype.OnTapGesture = function() {
            return !0
        }, o.prototype.OnDoubleTapGesture = function() {
            return !0
        }, o.prototype.OnHoldGestureObject = function(e) {
            return !!e && !!this.isClientPosOverCanvas(this.curTouchX, this.curTouchY) && this.runtime.testAndSelectCanvasPointOverlap(e, this.curTouchX, this.curTouchY, !1)
        }, o.prototype.OnTapGestureObject = function(e) {
            return !!e && !!this.isClientPosOverCanvas(this.curTouchX, this.curTouchY) && this.runtime.testAndSelectCanvasPointOverlap(e, this.curTouchX, this.curTouchY, !1)
        }, o.prototype.OnDoubleTapGestureObject = function(e) {
            return !!e && !!this.isClientPosOverCanvas(this.curTouchX, this.curTouchY) && this.runtime.testAndSelectCanvasPointOverlap(e, this.curTouchX, this.curTouchY, !1)
        }, o.prototype.OnPermissionGranted = function(e) {
            return this.trigger_permission === e
        }, o.prototype.OnPermissionDenied = function(e) {
            return this.trigger_permission === e
        }, d.cnds = new o;
        i.prototype.RequestPermission = function(e) {
            var t = this,
                r = Promise.resolve(!0);
            0 === e ? window.DeviceOrientationEvent && window.DeviceOrientationEvent.requestPermission && (r = window.DeviceOrientationEvent.requestPermission().then(function(e) {
                return "granted" === e
            })) : window.DeviceMotionEvent && window.DeviceMotionEvent.requestPermission && (r = window.DeviceMotionEvent.requestPermission().then(function(e) {
                return "granted" === e
            })), r.then(function(r) {
                t.trigger_permission = e, r ? t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted, t) : t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied, t)
            })
        }, d.acts = new i;
        s.prototype.TouchCount = function(e) {
            e.set_int(this.touches.length)
        }, s.prototype.X = function(e, t) {
            var r = this.getTouchIndex;
            if (0 > r || r >= this.touches.length) return void e.set_float(0);
            var n, a, o, i, s;
            cr.is_undefined(t) ? (n = this.runtime.getLayerByNumber(0), a = n.scale, o = n.zoomRate, i = n.parallaxX, s = n.angle, n.scale = 1, n.zoomRate = 1, n.parallaxX = 1, n.angle = 0, e.set_float(n.canvasToLayer(this.touches[r].x, this.touches[r].y, !0)), n.scale = a, n.zoomRate = o, n.parallaxX = i, n.angle = s) : (n = cr.is_number(t) ? this.runtime.getLayerByNumber(t) : this.runtime.getLayerByName(t), n ? e.set_float(n.canvasToLayer(this.touches[r].x, this.touches[r].y, !0)) : e.set_float(0))
        }, s.prototype.XAt = function(e, t, r) {
            if (t = l(t), 0 > t || t >= this.touches.length) return void e.set_float(0);
            var n, a, o, i, s;
            cr.is_undefined(r) ? (n = this.runtime.getLayerByNumber(0), a = n.scale, o = n.zoomRate, i = n.parallaxX, s = n.angle, n.scale = 1, n.zoomRate = 1, n.parallaxX = 1, n.angle = 0, e.set_float(n.canvasToLayer(this.touches[t].x, this.touches[t].y, !0)), n.scale = a, n.zoomRate = o, n.parallaxX = i, n.angle = s) : (n = cr.is_number(r) ? this.runtime.getLayerByNumber(r) : this.runtime.getLayerByName(r), n ? e.set_float(n.canvasToLayer(this.touches[t].x, this.touches[t].y, !0)) : e.set_float(0))
        }, s.prototype.XForID = function(e, t, r) {
            var n = this.findTouch(t);
            if (0 > n) return void e.set_float(0);
            var a = this.touches[n],
                o, i, s, l, p;
            cr.is_undefined(r) ? (o = this.runtime.getLayerByNumber(0), i = o.scale, s = o.zoomRate, l = o.parallaxX, p = o.angle, o.scale = 1, o.zoomRate = 1, o.parallaxX = 1, o.angle = 0, e.set_float(o.canvasToLayer(a.x, a.y, !0)), o.scale = i, o.zoomRate = s, o.parallaxX = l, o.angle = p) : (o = cr.is_number(r) ? this.runtime.getLayerByNumber(r) : this.runtime.getLayerByName(r), o ? e.set_float(o.canvasToLayer(a.x, a.y, !0)) : e.set_float(0))
        }, s.prototype.Y = function(e, t) {
            var r = this.getTouchIndex;
            if (0 > r || r >= this.touches.length) return void e.set_float(0);
            var n, a, o, i, s;
            cr.is_undefined(t) ? (n = this.runtime.getLayerByNumber(0), a = n.scale, o = n.zoomRate, i = n.parallaxY, s = n.angle, n.scale = 1, n.zoomRate = 1, n.parallaxY = 1, n.angle = 0, e.set_float(n.canvasToLayer(this.touches[r].x, this.touches[r].y, !1)), n.scale = a, n.zoomRate = o, n.parallaxY = i, n.angle = s) : (n = cr.is_number(t) ? this.runtime.getLayerByNumber(t) : this.runtime.getLayerByName(t), n ? e.set_float(n.canvasToLayer(this.touches[r].x, this.touches[r].y, !1)) : e.set_float(0))
        }, s.prototype.YAt = function(e, t, r) {
            if (t = l(t), 0 > t || t >= this.touches.length) return void e.set_float(0);
            var n, a, o, i, s;
            cr.is_undefined(r) ? (n = this.runtime.getLayerByNumber(0), a = n.scale, o = n.zoomRate, i = n.parallaxY, s = n.angle, n.scale = 1, n.zoomRate = 1, n.parallaxY = 1, n.angle = 0, e.set_float(n.canvasToLayer(this.touches[t].x, this.touches[t].y, !1)), n.scale = a, n.zoomRate = o, n.parallaxY = i, n.angle = s) : (n = cr.is_number(r) ? this.runtime.getLayerByNumber(r) : this.runtime.getLayerByName(r), n ? e.set_float(n.canvasToLayer(this.touches[t].x, this.touches[t].y, !1)) : e.set_float(0))
        }, s.prototype.YForID = function(e, t, r) {
            var n = this.findTouch(t);
            if (0 > n) return void e.set_float(0);
            var a = this.touches[n],
                o, i, s, l, p;
            cr.is_undefined(r) ? (o = this.runtime.getLayerByNumber(0), i = o.scale, s = o.zoomRate, l = o.parallaxY, p = o.angle, o.scale = 1, o.zoomRate = 1, o.parallaxY = 1, o.angle = 0, e.set_float(o.canvasToLayer(a.x, a.y, !1)), o.scale = i, o.zoomRate = s, o.parallaxY = l, o.angle = p) : (o = cr.is_number(r) ? this.runtime.getLayerByNumber(r) : this.runtime.getLayerByName(r), o ? e.set_float(o.canvasToLayer(a.x, a.y, !1)) : e.set_float(0))
        }, s.prototype.AbsoluteX = function(e) {
            this.touches.length ? e.set_float(this.touches[0].x) : e.set_float(0)
        }, s.prototype.AbsoluteXAt = function(e, t) {
            return t = l(t), 0 > t || t >= this.touches.length ? void e.set_float(0) : void e.set_float(this.touches[t].x)
        }, s.prototype.AbsoluteXForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(n.x)
        }, s.prototype.AbsoluteY = function(e) {
            this.touches.length ? e.set_float(this.touches[0].y) : e.set_float(0)
        }, s.prototype.AbsoluteYAt = function(e, t) {
            return t = l(t), 0 > t || t >= this.touches.length ? void e.set_float(0) : void e.set_float(this.touches[t].y)
        }, s.prototype.AbsoluteYForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(n.y)
        }, s.prototype.SpeedAt = function(e, r) {
            if (r = l(r), 0 > r || r >= this.touches.length) return void e.set_float(0);
            var n = this.touches[r],
                t = cr.distanceTo(n.x, n.y, n.lastx, n.lasty),
                a = (n.time - n.lasttime) / 1e3;
            0 >= a ? e.set_float(0) : e.set_float(t / a)
        }, s.prototype.SpeedForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r],
                a = cr.distanceTo(n.x, n.y, n.lastx, n.lasty),
                o = (n.time - n.lasttime) / 1e3;
            0 >= o ? e.set_float(0) : e.set_float(a / o)
        }, s.prototype.AngleAt = function(e, r) {
            if (r = l(r), 0 > r || r >= this.touches.length) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(cr.to_degrees(cr.angleTo(n.lastx, n.lasty, n.x, n.y)))
        }, s.prototype.AngleForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(cr.to_degrees(cr.angleTo(n.lastx, n.lasty, n.x, n.y)))
        }, s.prototype.Alpha = function(e) {
            e.set_float(this.getAlpha())
        }, s.prototype.Beta = function(e) {
            e.set_float(this.getBeta())
        }, s.prototype.Gamma = function(e) {
            e.set_float(this.getGamma())
        }, s.prototype.AccelerationXWithG = function(e) {
            e.set_float(this.acc_g_x)
        }, s.prototype.AccelerationYWithG = function(e) {
            e.set_float(this.acc_g_y)
        }, s.prototype.AccelerationZWithG = function(e) {
            e.set_float(this.acc_g_z)
        }, s.prototype.AccelerationX = function(e) {
            e.set_float(this.acc_x)
        }, s.prototype.AccelerationY = function(e) {
            e.set_float(this.acc_y)
        }, s.prototype.AccelerationZ = function(e) {
            e.set_float(this.acc_z)
        }, s.prototype.TouchIndex = function(e) {
            e.set_int(this.trigger_index)
        }, s.prototype.TouchID = function(e) {
            e.set_float(this.trigger_id)
        }, s.prototype.WidthForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(n.width)
        }, s.prototype.HeightForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(n.height)
        }, s.prototype.PressureForID = function(e, t) {
            var r = this.findTouch(t);
            if (0 > r) return void e.set_float(0);
            var n = this.touches[r];
            e.set_float(n.pressure)
        }, d.exps = new s
    }();
cr.plugins_.Audio = function(e) {
        this.runtime = e
    },
    function() {
        function e(e) {
            var t = ye.indexOf(e); - 1 === t && ye.push(e)
        }

        function t(t) {
            var r = t.instanceObject,
                n;
            try {
                n = r.play()
            } catch (r) {
                return void e(t)
            }
            n ? n.catch(function() {
                e(t)
            }) : ge && !V.isInUserInputEvent && e(t)
        }

        function r() {
            var t, r, a, o;
            he || ae || !J || (n(), "running" === J.state && (he = !0));
            var s = ye.slice(0);
            if (cr.clearArray(ye), !ee)
                for (t = 0, r = s.length; t < r; ++t) a = s[t], a.stopped || a.is_paused || (o = a.instanceObject.play(), o && o.catch(function() {
                    e(a)
                }))
        }

        function n() {
            if ("suspended" === J.state && J.resume && J.resume(), !!J.createBuffer) {
                var e = J.createBuffer(1, 220, 22050),
                    t = J.createBufferSource();
                t.buffer = e, t.connect(J.destination), c(t)
            }
        }

        function a(e) {
            var t = s(e);
            return isFinite(t) || (t = 0), 0 > t && (t = 0), 1 < t && (t = 1), t
        }

        function o(e) {
            return 0 > e && (e = 0), 1 < e && (e = 1), i(e)
        }

        function s(e) {
            return D(10, e / 20)
        }

        function i(e) {
            return 20 * (Math.log(e) / 2.302585092994046)
        }

        function l(e) {
            return e = e.toLowerCase(), fe.hasOwnProperty(e) && fe[e].length ? fe[e][0].getInputNode() : J.destination
        }

        function p() {
            return J.createGain ? J.createGain() : J.createGainNode()
        }

        function d(e) {
            return J.createDelay ? J.createDelay(e) : J.createDelayNode(e)
        }

        function c(e, t) {
            e.start ? e.start(t || 0) : e.noteOn(t || 0)
        }

        function u(e, t, r, n) {
            e.start ? e.start(n || 0, t) : e.noteGrainOn(n || 0, t, r - t)
        }

        function g(e) {
            try {
                e.stop ? e.stop(0) : e.noteOff(0)
            } catch (t) {}
        }

        function y(e, t, r, n) {
            if (e) {
                if (e.cancelScheduledValues(0), 0 === n) return void(e.value = t);
                var a = J.currentTime;
                n += a, 0 === r ? e.setValueAtTime(t, n) : 1 === r ? (e.setValueAtTime(e.value, a), e.linearRampToValueAtTime(t, n)) : 2 === r ? (e.setValueAtTime(e.value, a), e.exponentialRampToValueAtTime(t, n)) : void 0
            }
        }

        function m(e, t, r, n, a, o) {
            this.type = "filter", this.params = [e, t, r, n, a, o], this.inputNode = p(), this.wetNode = p(), this.wetNode.gain.value = o, this.dryNode = p(), this.dryNode.gain.value = 1 - o, this.filterNode = J.createBiquadFilter(), this.filterNode.type = "number" == typeof this.filterNode.type ? e : be[e], this.filterNode.frequency.value = t, this.filterNode.detune && (this.filterNode.detune.value = r), this.filterNode.Q.value = n, this.filterNode.gain.value = a, this.inputNode.connect(this.filterNode), this.inputNode.connect(this.dryNode), this.filterNode.connect(this.wetNode)
        }

        function _(e, t, r) {
            this.type = "delay", this.params = [e, t, r], this.inputNode = p(), this.wetNode = p(), this.wetNode.gain.value = r, this.dryNode = p(), this.dryNode.gain.value = 1 - r, this.mainNode = p(), this.delayNode = d(e), this.delayNode.delayTime.value = e, this.delayGainNode = p(), this.delayGainNode.gain.value = t, this.inputNode.connect(this.mainNode), this.inputNode.connect(this.dryNode), this.mainNode.connect(this.wetNode), this.mainNode.connect(this.delayNode), this.delayNode.connect(this.delayGainNode), this.delayGainNode.connect(this.mainNode)
        }

        function h(e, t, r, n) {
            this.type = "convolve", this.params = [t, r, n], this.inputNode = p(), this.wetNode = p(), this.wetNode.gain.value = r, this.dryNode = p(), this.dryNode.gain.value = 1 - r, this.convolveNode = J.createConvolver(), e && (this.convolveNode.normalize = t, this.convolveNode.buffer = e), this.inputNode.connect(this.convolveNode), this.inputNode.connect(this.dryNode), this.convolveNode.connect(this.wetNode)
        }

        function f(e, t, r, n, a) {
            this.type = "flanger", this.params = [e, t, r, n, a], this.inputNode = p(), this.dryNode = p(), this.dryNode.gain.value = 1 - a / 2, this.wetNode = p(), this.wetNode.gain.value = a / 2, this.feedbackNode = p(), this.feedbackNode.gain.value = n, this.delayNode = d(e + t), this.delayNode.delayTime.value = e, this.oscNode = J.createOscillator(), this.oscNode.frequency.value = r, this.oscGainNode = p(), this.oscGainNode.gain.value = t, this.inputNode.connect(this.delayNode), this.inputNode.connect(this.dryNode), this.delayNode.connect(this.wetNode), this.delayNode.connect(this.feedbackNode), this.feedbackNode.connect(this.delayNode), this.oscNode.connect(this.oscGainNode), this.oscGainNode.connect(this.delayNode.delayTime), c(this.oscNode)
        }

        function x(e, t, r, n, a, o) {
            this.type = "phaser", this.params = [e, t, r, n, a, o], this.inputNode = p(), this.dryNode = p(), this.dryNode.gain.value = 1 - o / 2, this.wetNode = p(), this.wetNode.gain.value = o / 2, this.filterNode = J.createBiquadFilter(), this.filterNode.type = "number" == typeof this.filterNode.type ? 7 : "allpass", this.filterNode.frequency.value = e, this.filterNode.detune && (this.filterNode.detune.value = t), this.filterNode.Q.value = r, this.oscNode = J.createOscillator(), this.oscNode.frequency.value = a, this.oscGainNode = p(), this.oscGainNode.gain.value = n, this.inputNode.connect(this.filterNode), this.inputNode.connect(this.dryNode), this.filterNode.connect(this.wetNode), this.oscNode.connect(this.oscGainNode), this.oscGainNode.connect(this.filterNode.frequency), c(this.oscNode)
        }

        function v(e) {
            this.type = "gain", this.params = [e], this.node = p(), this.node.gain.value = e
        }

        function w(e, t) {
            this.type = "tremolo", this.params = [e, t], this.node = p(), this.node.gain.value = 1 - t / 2, this.oscNode = J.createOscillator(), this.oscNode.frequency.value = e, this.oscGainNode = p(), this.oscGainNode.gain.value = t / 2, this.oscNode.connect(this.oscGainNode), this.oscGainNode.connect(this.node.gain), c(this.oscNode)
        }

        function S(e, t) {
            this.type = "ringmod", this.params = [e, t], this.inputNode = p(), this.wetNode = p(), this.wetNode.gain.value = t, this.dryNode = p(), this.dryNode.gain.value = 1 - t, this.ringNode = p(), this.ringNode.gain.value = 0, this.oscNode = J.createOscillator(), this.oscNode.frequency.value = e, this.oscNode.connect(this.ringNode.gain), c(this.oscNode), this.inputNode.connect(this.ringNode), this.inputNode.connect(this.dryNode), this.ringNode.connect(this.wetNode)
        }

        function T(e, t, r, n, a) {
            this.type = "distortion", this.params = [e, t, r, n, a], this.inputNode = p(), this.preGain = p(), this.postGain = p(), this.setDrive(r, s(n)), this.wetNode = p(), this.wetNode.gain.value = a, this.dryNode = p(), this.dryNode.gain.value = 1 - a, this.waveShaper = J.createWaveShaper(), this.curve = new Float32Array(65536), this.generateColortouchCurve(e, t), this.waveShaper.curve = this.curve, this.inputNode.connect(this.preGain), this.inputNode.connect(this.dryNode), this.preGain.connect(this.waveShaper), this.waveShaper.connect(this.postGain), this.postGain.connect(this.wetNode)
        }

        function b(e, t) {
            return 1 - Math.exp(-t * e)
        }

        function O(e, t, r, n, a) {
            this.type = "compressor", this.params = [e, t, r, n, a], this.node = J.createDynamicsCompressor();
            try {
                this.node.threshold.value = e, this.node.knee.value = t, this.node.ratio.value = r, this.node.attack.value = n, this.node.release.value = a
            } catch (t) {}
        }

        function E(e, t) {
            this.type = "analyser", this.params = [e, t], this.node = J.createAnalyser(), this.node.fftSize = e, this.node.smoothingTimeConstant = t, this.freqBins = new Float32Array(this.node.frequencyBinCount), this.signal = new Uint8Array(e), this.peak = 0, this.rms = 0
        }

        function C() {
            this.obj = null, this.loadUid = 0
        }

        function A(e, t, r) {
            this.src = e, this.type = t, this.myapi = H, this.is_music = r, this.added_end_listener = !1;
            var n = this;
            this.outNode = null, this.mediaSourceNode = null, this.panWhenReady = [], this.seekWhenReady = 0, this.pauseWhenReady = !1, this.supportWebAudioAPI = !1, this.failedToLoad = !1, this.needsSoftwareDecode = "audio/webm; codecs=opus" === this.type && !oe, this.wasEverReady = !1, this.is_music && this.needsSoftwareDecode && (_e = !0), H !== 1 || !r || me || this.needsSoftwareDecode || (this.myapi = 0, this.outNode = p()), this.bufferObject = null, this.audioData = null;
            var a;
            switch (this.myapi) {
                case 0:
                    this.bufferObject = new Audio, this.bufferObject.crossOrigin = "anonymous", this.bufferObject.addEventListener("canplaythrough", function() {
                        n.wasEverReady = !0
                    }), H === 1 && J.createMediaElementSource && !/wiiu/i.test(navigator.userAgent) && (this.supportWebAudioAPI = !0, this.bufferObject.addEventListener("canplay", function() {
                        !n.mediaSourceNode && n.bufferObject && (n.mediaSourceNode = J.createMediaElementSource(n.bufferObject), n.mediaSourceNode.connect(n.outNode))
                    })), this.bufferObject.autoplay = !1, this.bufferObject.preload = "auto", this.bufferObject.src = e;
                    break;
                case 1:
                    V.isWKWebView ? V.fetchLocalFileViaCordovaAsArrayBuffer(e, function(e) {
                        n.audioData = e, n.decodeAudioBuffer()
                    }, function() {
                        n.failedToLoad = !0
                    }) : (a = new XMLHttpRequest, a.open("GET", e, !0), a.responseType = "arraybuffer", a.onload = function() {
                        n.audioData = a.response, n.decodeAudioBuffer()
                    }, a.onerror = function() {
                        n.failedToLoad = !0
                    }, a.send());
                    break;
                case 2:
                    this.bufferObject = !0;
            }
        }

        function P(e, t) {
            var r = this;
            this.tag = t, this.fresh = !0, this.stopped = !0, this.src = e.src, this.buffer = e, this.myapi = H, this.is_music = e.is_music, this.playbackRate = 1, this.hasPlaybackEnded = !0, this.resume_me = !1, this.is_paused = !1, this.resume_position = 0, this.looping = !1, this.is_muted = !1, this.is_silent = !1, this.volume = 1, this.onended_handler = function(t) {
                if (!(r.is_paused || r.resume_me)) {
                    var e = this;
                    e || (e = t.target), e !== r.active_buffer || (r.hasPlaybackEnded = !0, r.stopped = !0, q = r.tag, V.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded, X))
                }
            }, this.active_buffer = null, this.isTimescaled = 1 === $ && !this.is_music || 2 === $, this.mutevol = 1, this.startTime = this.isTimescaled ? V.kahanTime.sum : V.wallTime.sum, this.gainNode = null, this.pannerNode = null, this.pannerEnabled = !1, this.objectTracker = null, this.panX = 0, this.panY = 0, this.panAngle = 0, this.panConeInner = 0, this.panConeOuter = 0, this.panConeOuterGain = 0, this.instanceObject = null;
            var n = !1;
            switch (1 !== this.myapi || 0 !== this.buffer.myapi || this.buffer.supportWebAudioAPI || (this.myapi = 0), this.myapi) {
                case 0:
                    this.is_music ? (this.instanceObject = e.bufferObject, n = !e.added_end_listener, e.added_end_listener = !0) : (this.instanceObject = new Audio, this.instanceObject.crossOrigin = "anonymous", this.instanceObject.autoplay = !1, this.instanceObject.src = e.bufferObject.src, n = !0), n && this.instanceObject.addEventListener("ended", function() {
                        q = r.tag, r.stopped = !0, V.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded, X)
                    });
                    break;
                case 1:
                    this.gainNode = p(), this.gainNode.connect(l(t)), 1 === this.buffer.myapi ? e.bufferObject && (this.instanceObject = J.createBufferSource(), this.instanceObject.buffer = e.bufferObject, this.instanceObject.connect(this.gainNode)) : (this.instanceObject = this.buffer.bufferObject, this.buffer.outNode.connect(this.gainNode), !this.buffer.added_end_listener && (this.buffer.added_end_listener = !0, this.buffer.bufferObject.addEventListener("ended", function() {
                        q = r.tag, r.stopped = !0, V.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded, X)
                    })));
                    break;
                case 2:
                    this.instanceObject = new window.Media(Y + this.src, null, null, function(e) {
                        e === window.Media.MEDIA_STOPPED && (r.hasPlaybackEnded = !0, r.stopped = !0, q = r.tag, V.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded, X))
                    });
            }
        }

        function L(e, t) {
            var r = e.isPlaying() ? 1 : 0,
                n = t.isPlaying() ? 1 : 0;
            return r == n ? 0 : r < n ? 1 : -1
        }

        function I(e, t) {
            if (cr.clearArray(Se), !e.length) return !K || K.hasEnded() ? void 0 : (cr.clearArray(Se), void(Se[0] = K));
            var r, n, o;
            for (r = 0, n = Q.length; r < n; r++) o = Q[r], cr.equals_nocase(e, o.tag) && Se.push(o);
            t && Se.sort(L)
        }

        function R(e) {
            var t = J.destination,
                r, a, o, s;
            if (fe.hasOwnProperty(e) && (o = fe[e], o.length))
                for (t = o[0].getInputNode(), r = 0, a = o.length; r < a; r++) s = o[r], r + 1 === a ? s.connectTo(J.destination) : s.connectTo(o[r + 1].getInputNode());
            for (I(e), r = 0, a = Se.length; r < a; r++) Se[r].reconnect(t);
            ce && ue === e && (ce.disconnect(), ce.connect(t))
        }

        function k(e, t) {
            fe.hasOwnProperty(e) ? fe[e].push(t) : fe[e] = [t], R(e)
        }

        function B() {}

        function F() {}

        function N() {}

        function j(e, t) {
            var r = null;
            return fe.hasOwnProperty(e) && (r = fe[e]), r && 0 <= t && t < r.length && r[t].freqBins ? r[t] : null
        }
        var D = Math.pow,
            M = Math.floor,
            z = Math.cos,
            G = Math.sin,
            W = cr.plugins_.Audio.prototype;
        W.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var U = W.Type.prototype;
        U.onCreate = function() {};
        var V = null,
            X = null,
            q = "",
            Y = "",
            H = 0,
            J = null,
            Z = [],
            Q = [],
            K = null,
            $ = 0,
            ee = !1,
            te = 1,
            re = 0,
            ne = 0,
            ae = !1,
            oe = !!new Audio().canPlayType("audio/webm; codecs=opus"),
            ie = 1,
            se = 1,
            le = 10,
            pe = 1e4,
            de = 1,
            ce = null,
            ue = "",
            ge = !1,
            ye = [],
            me = !1,
            _e = !1,
            he = !1;
        document.addEventListener("pointerup", r, !0), document.addEventListener("touchend", r, !0), document.addEventListener("click", r, !0), document.addEventListener("keydown", r, !0), document.addEventListener("gamepadconnected", r, !0);
        var fe = {};
        var be = ["lowpass", "highpass", "bandpass", "lowshelf", "highshelf", "peaking", "notch", "allpass"];
        m.prototype.connectTo = function(e) {
            this.wetNode.disconnect(), this.wetNode.connect(e), this.dryNode.disconnect(), this.dryNode.connect(e)
        }, m.prototype.remove = function() {
            this.inputNode.disconnect(), this.filterNode.disconnect(), this.wetNode.disconnect(), this.dryNode.disconnect()
        }, m.prototype.getInputNode = function() {
            return this.inputNode
        }, m.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[5] = t, y(this.wetNode.gain, t, r, n), y(this.dryNode.gain, 1 - t, r, n)) : 1 === e ? (this.params[1] = t, y(this.filterNode.frequency, t, r, n)) : 2 === e ? (this.params[2] = t, y(this.filterNode.detune, t, r, n)) : 3 === e ? (this.params[3] = t, y(this.filterNode.Q, t, r, n)) : 4 === e ? (this.params[4] = t, y(this.filterNode.gain, t, r, n)) : void 0
        };
        _.prototype.connectTo = function(e) {
            this.wetNode.disconnect(), this.wetNode.connect(e), this.dryNode.disconnect(), this.dryNode.connect(e)
        }, _.prototype.remove = function() {
            this.inputNode.disconnect(), this.mainNode.disconnect(), this.delayNode.disconnect(), this.delayGainNode.disconnect(), this.wetNode.disconnect(), this.dryNode.disconnect()
        }, _.prototype.getInputNode = function() {
            return this.inputNode
        }, _.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[2] = t, y(this.wetNode.gain, t, r, n), y(this.dryNode.gain, 1 - t, r, n)) : 4 === e ? (this.params[1] = a(t), y(this.delayGainNode.gain, a(t), r, n)) : 5 === e ? (this.params[0] = t, y(this.delayNode.delayTime, t, r, n)) : void 0
        };
        h.prototype.connectTo = function(e) {
            this.wetNode.disconnect(), this.wetNode.connect(e), this.dryNode.disconnect(), this.dryNode.connect(e)
        }, h.prototype.remove = function() {
            this.inputNode.disconnect(), this.convolveNode.disconnect(), this.wetNode.disconnect(), this.dryNode.disconnect()
        }, h.prototype.getInputNode = function() {
            return this.inputNode
        }, h.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[1] = t, y(this.wetNode.gain, t, r, n), y(this.dryNode.gain, 1 - t, r, n)) : void 0
        };
        f.prototype.connectTo = function(e) {
            this.dryNode.disconnect(), this.dryNode.connect(e), this.wetNode.disconnect(), this.wetNode.connect(e)
        }, f.prototype.remove = function() {
            this.inputNode.disconnect(), this.delayNode.disconnect(), this.oscNode.disconnect(), this.oscGainNode.disconnect(), this.dryNode.disconnect(), this.wetNode.disconnect(), this.feedbackNode.disconnect()
        }, f.prototype.getInputNode = function() {
            return this.inputNode
        }, f.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[4] = t, y(this.wetNode.gain, t / 2, r, n), y(this.dryNode.gain, 1 - t / 2, r, n)) : 6 === e ? (this.params[1] = t / 1e3, y(this.oscGainNode.gain, t / 1e3, r, n)) : 7 === e ? (this.params[2] = t, y(this.oscNode.frequency, t, r, n)) : 8 === e ? (this.params[3] = t / 100, y(this.feedbackNode.gain, t / 100, r, n)) : void 0
        };
        x.prototype.connectTo = function(e) {
            this.dryNode.disconnect(), this.dryNode.connect(e), this.wetNode.disconnect(), this.wetNode.connect(e)
        }, x.prototype.remove = function() {
            this.inputNode.disconnect(), this.filterNode.disconnect(), this.oscNode.disconnect(), this.oscGainNode.disconnect(), this.dryNode.disconnect(), this.wetNode.disconnect()
        }, x.prototype.getInputNode = function() {
            return this.inputNode
        }, x.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[5] = t, y(this.wetNode.gain, t / 2, r, n), y(this.dryNode.gain, 1 - t / 2, r, n)) : 1 === e ? (this.params[0] = t, y(this.filterNode.frequency, t, r, n)) : 2 === e ? (this.params[1] = t, y(this.filterNode.detune, t, r, n)) : 3 === e ? (this.params[2] = t, y(this.filterNode.Q, t, r, n)) : 6 === e ? (this.params[3] = t, y(this.oscGainNode.gain, t, r, n)) : 7 === e ? (this.params[4] = t, y(this.oscNode.frequency, t, r, n)) : void 0
        };
        v.prototype.connectTo = function(e) {
            this.node.disconnect(), this.node.connect(e)
        }, v.prototype.remove = function() {
            this.node.disconnect()
        }, v.prototype.getInputNode = function() {
            return this.node
        }, v.prototype.setParam = function(e, t, r, n) {
            4 === e ? (this.params[0] = a(t), y(this.node.gain, a(t), r, n)) : void 0
        };
        w.prototype.connectTo = function(e) {
            this.node.disconnect(), this.node.connect(e)
        }, w.prototype.remove = function() {
            this.oscNode.disconnect(), this.oscGainNode.disconnect(), this.node.disconnect()
        }, w.prototype.getInputNode = function() {
            return this.node
        }, w.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[1] = t, y(this.node.gain.value, 1 - t / 2, r, n), y(this.oscGainNode.gain.value, t / 2, r, n)) : 7 === e ? (this.params[0] = t, y(this.oscNode.frequency, t, r, n)) : void 0
        };
        S.prototype.connectTo = function(e) {
            this.wetNode.disconnect(), this.wetNode.connect(e), this.dryNode.disconnect(), this.dryNode.connect(e)
        }, S.prototype.remove = function() {
            this.oscNode.disconnect(), this.ringNode.disconnect(), this.inputNode.disconnect(), this.wetNode.disconnect(), this.dryNode.disconnect()
        }, S.prototype.getInputNode = function() {
            return this.inputNode
        }, S.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[1] = t, y(this.wetNode.gain, t, r, n), y(this.dryNode.gain, 1 - t, r, n)) : 7 === e ? (this.params[0] = t, y(this.oscNode.frequency, t, r, n)) : void 0
        };
        T.prototype.setDrive = function(e, t) {
            .01 > e && (e = .01), this.preGain.gain.value = e, this.postGain.gain.value = D(1 / e, .6) * t
        }, T.prototype.shape = function(e, t, r) {
            var n = 1.05 * r * t - t,
                a = 0 > e ? -1 : 1,
                o = 0 > e ? -e : e,
                i = o < t ? o : t + n * b(o - t, 1 / n);
            return i *= a, i
        }, T.prototype.generateColortouchCurve = function(e, t) {
            for (var r = s(e), n = s(t), a = 0, o = 0; o < 32768; ++o) a = o / 32768, a = this.shape(a, r, n), this.curve[32768 + o] = a, this.curve[32768 - o - 1] = -a
        }, T.prototype.connectTo = function(e) {
            this.wetNode.disconnect(), this.wetNode.connect(e), this.dryNode.disconnect(), this.dryNode.connect(e)
        }, T.prototype.remove = function() {
            this.inputNode.disconnect(), this.preGain.disconnect(), this.waveShaper.disconnect(), this.postGain.disconnect(), this.wetNode.disconnect(), this.dryNode.disconnect()
        }, T.prototype.getInputNode = function() {
            return this.inputNode
        }, T.prototype.setParam = function(e, t, r, n) {
            0 === e ? (t /= 100, 0 > t && (t = 0), 1 < t && (t = 1), this.params[4] = t, y(this.wetNode.gain, t, r, n), y(this.dryNode.gain, 1 - t, r, n)) : void 0
        };
        O.prototype.connectTo = function(e) {
            this.node.disconnect(), this.node.connect(e)
        }, O.prototype.remove = function() {
            this.node.disconnect()
        }, O.prototype.getInputNode = function() {
            return this.node
        }, O.prototype.setParam = function() {};
        E.prototype.tick = function() {
            this.node.getFloatFrequencyData(this.freqBins), this.node.getByteTimeDomainData(this.signal);
            var e = this.node.fftSize,
                t = 0;
            this.peak = 0;
            for (var r = 0, n = 0; t < e; t++) n = (this.signal[t] - 128) / 128, 0 > n && (n = -n), this.peak < n && (this.peak = n), r += n * n;
            this.peak = o(this.peak), this.rms = o(Math.sqrt(r / e))
        }, E.prototype.connectTo = function(e) {
            this.node.disconnect(), this.node.connect(e)
        }, E.prototype.remove = function() {
            this.node.disconnect()
        }, E.prototype.getInputNode = function() {
            return this.node
        }, E.prototype.setParam = function() {};
        C.prototype.setObject = function(e) {
            this.obj = e
        }, C.prototype.hasObject = function() {
            return !!this.obj
        }, C.prototype.tick = function() {};
        A.prototype.release = function() {
            var e, t, r, n;
            for (e = 0, r = 0, t = Q.length; e < t; ++e) n = Q[e], Q[r] = n, n.buffer === this ? n.stop() : ++r;
            Q.length = r, this.mediaSourceNode && (this.mediaSourceNode.disconnect(), this.mediaSourceNode = null), this.outNode && (this.outNode.disconnect(), this.outNode = null), this.bufferObject = null, this.audioData = null
        }, A.prototype.decodeAudioBuffer = function() {
            if (!this.bufferObject && this.audioData) {
                var t = this;
                if (this.needsSoftwareDecode) {
                    var e = this.audioData;
                    this.audioData = null, window.OpusDecoder(e, function(e, r) {
                        if (e) return void t.onDecodeError(e);
                        var n = new Float32Array(r),
                            a = J.createBuffer(1, n.length, 48e3),
                            o = a.getChannelData(0);
                        o.set(n), t.onDecodeComplete(a)
                    })
                } else J.decodeAudioData(this.audioData, function(e) {
                    t.onDecodeComplete(e)
                }, function(r) {
                    t.onDecodeError(r)
                })
            }
        }, A.prototype.onDecodeComplete = function(e) {
            this.bufferObject = e, this.audioData = null;
            var t, r, n, o;
            if (!cr.is_undefined(this.playTagWhenReady) && !ee) {
                if (this.panWhenReady.length) {
                    for (r = 0, n = this.panWhenReady.length; r < n; r++)
                        if (t = this.panWhenReady[r], o = new P(this, t.thistag), o.setPannerEnabled(!0), !("undefined" != typeof t.objUid && (t.obj = V.getObjectByUID(t.objUid), !t.obj))) {
                            if (t.obj) {
                                var s = cr.rotatePtAround(t.obj.x, t.obj.y, -t.obj.layer.getAngle(), re, ne, !0),
                                    l = cr.rotatePtAround(t.obj.x, t.obj.y, -t.obj.layer.getAngle(), re, ne, !1);
                                o.setPan(s, l, cr.to_degrees(t.obj.angle - t.obj.layer.getAngle()), t.ia, t.oa, t.og), o.setObject(t.obj)
                            } else o.setPan(t.x, t.y, t.a, t.ia, t.oa, t.og);
                            o.play(this.loopWhenReady, this.volumeWhenReady, this.seekWhenReady), this.pauseWhenReady && o.pause(), Q.push(o)
                        }
                    cr.clearArray(this.panWhenReady)
                } else o = new P(this, this.playTagWhenReady || ""), o.play(this.loopWhenReady, this.volumeWhenReady, this.seekWhenReady), this.pauseWhenReady && o.pause(), Q.push(o);
            } else if (!cr.is_undefined(this.convolveWhenReady)) {
                var d = this.convolveWhenReady.convolveNode;
                d.normalize = this.normalizeWhenReady, d.buffer = e
            }
        }, A.prototype.onDecodeError = function(e) {
            self.failedToLoad = !0, console.error("Failed to decode audio '" + this.src + "': " + e)
        }, A.prototype.isLoaded = function() {
            switch (this.myapi) {
                case 0:
                    var e = 4 <= this.bufferObject.readyState;
                    return e && (this.wasEverReady = !0), e || this.wasEverReady;
                case 1:
                    return !!this.audioData || !!this.bufferObject;
                case 2:
                    return !0;
            }
            return !1
        }, A.prototype.isLoadedAndDecoded = function() {
            switch (this.myapi) {
                case 0:
                    return this.isLoaded();
                case 1:
                    return !!this.bufferObject;
                case 2:
                    return !0;
            }
            return !1
        }, A.prototype.hasFailedToLoad = function() {
            switch (this.myapi) {
                case 0:
                    return !!this.bufferObject.error;
                case 1:
                    return this.failedToLoad;
            }
            return !1
        };
        P.prototype.hasEnded = function() {
            switch (this.myapi) {
                case 0:
                    return this.instanceObject.ended;
                case 1:
                    return 1 === this.buffer.myapi ? !!(this.fresh || this.stopped || !this.instanceObject.loop) && !this.is_paused && this.hasPlaybackEnded : this.instanceObject.ended;
                case 2:
                    return this.hasPlaybackEnded;
            }
            return !0
        }, P.prototype.canBeRecycled = function() {
            return !!(this.fresh || this.stopped) || this.hasEnded()
        }, P.prototype.setPannerEnabled = function(e) {
            if (1 === H)
                if (!this.pannerEnabled && e) {
                    if (!this.gainNode) return;
                    this.pannerNode || (this.pannerNode = J.createPanner(), this.pannerNode.panningModel = "number" == typeof this.pannerNode.panningModel ? ie : ["equalpower", "HRTF", "soundfield"][ie], this.pannerNode.distanceModel = "number" == typeof this.pannerNode.distanceModel ? se : ["linear", "inverse", "exponential"][se], this.pannerNode.refDistance = le, this.pannerNode.maxDistance = pe, this.pannerNode.rolloffFactor = de), this.gainNode.disconnect(), this.gainNode.connect(this.pannerNode), this.pannerNode.connect(l(this.tag)), this.pannerEnabled = !0
                } else if (this.pannerEnabled && !e) {
                if (!this.gainNode) return;
                this.pannerNode.disconnect(), this.gainNode.disconnect(), this.gainNode.connect(l(this.tag)), this.pannerEnabled = !1
            }
        }, P.prototype.setPan = function(e, t, r, n, a, o) {
            this.pannerEnabled && 1 === H && (this.pannerNode.setPosition(e, t, 0), this.pannerNode.setOrientation(z(cr.to_radians(r)), G(cr.to_radians(r)), 0), this.pannerNode.coneInnerAngle = n, this.pannerNode.coneOuterAngle = a, this.pannerNode.coneOuterGain = o, this.panX = e, this.panY = t, this.panAngle = r, this.panConeInner = n, this.panConeOuter = a, this.panConeOuterGain = o)
        }, P.prototype.setObject = function(e) {
            this.pannerEnabled && 1 === H && (!this.objectTracker && (this.objectTracker = new C), this.objectTracker.setObject(e))
        }, P.prototype.tick = function(e) {
            if (this.pannerEnabled && 1 === H && this.objectTracker && this.objectTracker.hasObject() && this.isPlaying()) {
                this.objectTracker.tick(e);
                var t = this.objectTracker.obj,
                    r = cr.rotatePtAround(t.x, t.y, -t.layer.getAngle(), re, ne, !0),
                    n = cr.rotatePtAround(t.x, t.y, -t.layer.getAngle(), re, ne, !1);
                this.pannerNode.setPosition(r, n, 0);
                var o = 0;
                "undefined" != typeof this.objectTracker.obj.angle && (o = t.angle - t.layer.getAngle(), this.pannerNode.setOrientation(z(o), G(o), 0))
            }
        }, P.prototype.play = function(e, r, n, a) {
            var o = this.instanceObject;
            this.looping = e, this.volume = r;
            var i = n || 0;
            switch (a = a || 0, this.myapi) {
                case 0:
                    if (1 !== o.playbackRate && (o.playbackRate = 1), o.volume !== r * te && (o.volume = r * te), o.loop !== e && (o.loop = e), o.muted && (o.muted = !1), o.currentTime !== i) try {
                        o.currentTime = i
                    } catch (e) {}
                    t(this);
                    break;
                case 1:
                    if (this.muted = !1, this.mutevol = 1, 1 === this.buffer.myapi) this.gainNode.gain.value = r * te, this.fresh || (this.instanceObject = J.createBufferSource(), this.instanceObject.buffer = this.buffer.bufferObject, this.instanceObject.connect(this.gainNode)), this.instanceObject.onended = this.onended_handler, this.active_buffer = this.instanceObject, this.instanceObject.loop = e, this.hasPlaybackEnded = !1, 0 === i ? c(this.instanceObject, a) : u(this.instanceObject, i, this.getDuration(), a);
                    else {
                        if (1 !== o.playbackRate && (o.playbackRate = 1), o.loop !== e && (o.loop = e), o.volume = r * te, o.currentTime !== i) try {
                            o.currentTime = i
                        } catch (e) {}
                        t(this)
                    }
                    break;
                case 2:
                    (!this.fresh && this.stopped || 0 !== i) && o.seekTo(i), o.play(), this.hasPlaybackEnded = !1;
            }
            this.playbackRate = 1, this.startTime = (this.isTimescaled ? V.kahanTime.sum : V.wallTime.sum) - i, this.fresh = !1, this.stopped = !1, this.is_paused = !1
        }, P.prototype.stop = function() {
            switch (this.myapi) {
                case 0:
                    this.instanceObject.paused || this.instanceObject.pause();
                    break;
                case 1:
                    this.buffer.myapi === 1 ? g(this.instanceObject) : !this.instanceObject.paused && this.instanceObject.pause();
                    break;
                case 2:
                    this.instanceObject.stop();
            }
            this.stopped = !0, this.is_paused = !1
        }, P.prototype.pause = function() {
            if (!(this.fresh || this.stopped || this.hasEnded() || this.is_paused)) {
                switch (this.myapi) {
                    case 0:
                        this.instanceObject.paused || this.instanceObject.pause();
                        break;
                    case 1:
                        1 === this.buffer.myapi ? (this.resume_position = this.getPlaybackTime(!0), this.looping && (this.resume_position %= this.getDuration()), this.is_paused = !0, g(this.instanceObject)) : !this.instanceObject.paused && this.instanceObject.pause();
                        break;
                    case 2:
                        this.instanceObject.pause();
                }
                this.is_paused = !0
            }
        }, P.prototype.resume = function() {
            if (!(this.fresh || this.stopped || this.hasEnded() || !this.is_paused)) {
                switch (this.myapi) {
                    case 0:
                        t(this);
                        break;
                    case 1:
                        1 === this.buffer.myapi ? (this.instanceObject = J.createBufferSource(), this.instanceObject.buffer = this.buffer.bufferObject, this.instanceObject.connect(this.gainNode), this.instanceObject.onended = this.onended_handler, this.active_buffer = this.instanceObject, this.instanceObject.loop = this.looping, this.gainNode.gain.value = te * this.volume * this.mutevol, this.updatePlaybackRate(), this.startTime = (this.isTimescaled ? V.kahanTime.sum : V.wallTime.sum) - this.resume_position / (this.playbackRate || .001), u(this.instanceObject, this.resume_position, this.getDuration())) : t(this);
                        break;
                    case 2:
                        this.instanceObject.play();
                }
                this.is_paused = !1
            }
        }, P.prototype.seek = function(e) {
            if (!(this.fresh || this.stopped || this.hasEnded())) switch (this.myapi) {
                case 0:
                    try {
                        this.instanceObject.currentTime = e
                    } catch (t) {}
                    break;
                case 1:
                    if (1 === this.buffer.myapi) this.is_paused ? this.resume_position = e : (this.pause(), this.resume_position = e, this.resume());
                    else try {
                        this.instanceObject.currentTime = e
                    } catch (t) {}
                    break;
                case 2:
            }
        }, P.prototype.reconnect = function(e) {
            1 !== this.myapi || (this.pannerEnabled ? (this.pannerNode.disconnect(), this.pannerNode.connect(e)) : (this.gainNode.disconnect(), this.gainNode.connect(e)))
        }, P.prototype.getDuration = function(e) {
            var t = 0;
            switch (this.myapi) {
                case 0:
                    "undefined" != typeof this.instanceObject.duration && (t = this.instanceObject.duration);
                    break;
                case 1:
                    t = this.buffer.bufferObject.duration;
                    break;
                case 2:
                    t = this.instanceObject.getDuration();
            }
            return e && (t /= this.playbackRate || .001), t
        }, P.prototype.getPlaybackTime = function(e) {
            var t = this.getDuration(),
                r = 0;
            switch (this.myapi) {
                case 0:
                    "undefined" != typeof this.instanceObject.currentTime && (r = this.instanceObject.currentTime);
                    break;
                case 1:
                    if (1 === this.buffer.myapi) {
                        if (this.is_paused) return this.resume_position;
                        r = (this.isTimescaled ? V.kahanTime.sum : V.wallTime.sum) - this.startTime
                    } else "undefined" != typeof this.instanceObject.currentTime && (r = this.instanceObject.currentTime);
                    break;
                case 2:
            }
            return e && (r *= this.playbackRate), !this.looping && r > t && (r = t), r
        }, P.prototype.isPlaying = function() {
            return !this.is_paused && !this.fresh && !this.stopped && !this.hasEnded()
        }, P.prototype.shouldSave = function() {
            return !this.fresh && !this.stopped && !this.hasEnded()
        }, P.prototype.setVolume = function(e) {
            this.volume = e, this.updateVolume()
        }, P.prototype.updateVolume = function() {
            var e = this.volume * te;
            switch (isFinite(e) || (e = 0), this.myapi) {
                case 0:
                    "undefined" != typeof this.instanceObject.volume && this.instanceObject.volume !== e && (this.instanceObject.volume = e);
                    break;
                case 1:
                    1 === this.buffer.myapi ? this.gainNode.gain.value = e * this.mutevol : "undefined" != typeof this.instanceObject.volume && this.instanceObject.volume !== e && (this.instanceObject.volume = e);
                    break;
                case 2:
            }
        }, P.prototype.getVolume = function() {
            return this.volume
        }, P.prototype.doSetMuted = function(e) {
            switch (this.myapi) {
                case 0:
                    this.instanceObject.muted !== !!e && (this.instanceObject.muted = !!e);
                    break;
                case 1:
                    this.buffer.myapi === 1 ? (this.mutevol = e ? 0 : 1, this.gainNode.gain.value = te * this.volume * this.mutevol) : this.instanceObject.muted !== !!e && (this.instanceObject.muted = !!e);
                    break;
                case 2:
            }
        }, P.prototype.setMuted = function(e) {
            this.is_muted = !!e, this.doSetMuted(this.is_muted || this.is_silent)
        }, P.prototype.setSilent = function(e) {
            this.is_silent = !!e, this.doSetMuted(this.is_muted || this.is_silent)
        }, P.prototype.setLooping = function(e) {
            switch (this.looping = e, this.myapi) {
                case 0:
                    this.instanceObject.loop !== !!e && (this.instanceObject.loop = !!e);
                    break;
                case 1:
                    this.instanceObject.loop !== !!e && (this.instanceObject.loop = !!e);
                    break;
                case 2:
            }
        }, P.prototype.setPlaybackRate = function(e) {
            this.playbackRate = e, this.updatePlaybackRate()
        }, P.prototype.getPlaybackRate = function() {
            return this.playbackRate
        }, P.prototype.updatePlaybackRate = function() {
            var e = this.playbackRate;
            switch (this.isTimescaled && (e *= V.timescale), this.myapi) {
                case 0:
                    this.instanceObject.playbackRate !== e && (this.instanceObject.playbackRate = e);
                    break;
                case 1:
                    1 === this.buffer.myapi ? this.instanceObject.playbackRate.value !== e && (this.instanceObject.playbackRate.value = e) : this.instanceObject.playbackRate !== e && (this.instanceObject.playbackRate = e);
                    break;
                case 2:
            }
        }, P.prototype.setSuspended = function(e) {
            switch (this.myapi) {
                case 0:
                    e ? this.isPlaying() ? (this.resume_me = !0, this.instanceObject.pause()) : this.resume_me = !1 : this.resume_me && (this.instanceObject.play(), this.resume_me = !1);
                    break;
                case 1:
                    e ? this.isPlaying() ? (this.resume_me = !0, this.buffer.myapi === 1 ? (this.resume_position = this.getPlaybackTime(!0), this.looping && (this.resume_position %= this.getDuration()), g(this.instanceObject)) : this.instanceObject.pause()) : this.resume_me = !1 : this.resume_me && (this.buffer.myapi === 1 ? (this.instanceObject = J.createBufferSource(), this.instanceObject.buffer = this.buffer.bufferObject, this.instanceObject.connect(this.gainNode), this.instanceObject.onended = this.onended_handler, this.active_buffer = this.instanceObject, this.instanceObject.loop = this.looping, this.gainNode.gain.value = te * this.volume * this.mutevol, this.updatePlaybackRate(), this.startTime = (this.isTimescaled ? V.kahanTime.sum : V.wallTime.sum) - this.resume_position / (this.playbackRate || .001), u(this.instanceObject, this.resume_position, this.getDuration())) : this.instanceObject.play(), this.resume_me = !1);
                    break;
                case 2:
                    e ? this.isPlaying() ? (this.instanceObject.pause(), this.resume_me = !0) : this.resume_me = !1 : this.resume_me && (this.resume_me = !1, this.instanceObject.play());
            }
        }, W.Instance = function(e) {
            if (this.type = e, this.runtime = e.runtime, V = this.runtime, X = this, this.listenerTracker = null, this.listenerZ = -600, this.runtime.isWKWebView && (me = !0), (this.runtime.isiOS || this.runtime.isAndroid && (this.runtime.isChrome || this.runtime.isAndroidStockBrowser)) && !this.runtime.isCrosswalk && !this.runtime.isAmazonWebApp && !me && (ge = !0), J = null, "undefined" == typeof AudioContext ? "undefined" != typeof webkitAudioContext && (H = 1, J = new webkitAudioContext) : (H = 1, J = new AudioContext), this.runtime.isiOS && J && (J.close && J.close(), "undefined" == typeof AudioContext ? "undefined" != typeof webkitAudioContext && (J = new webkitAudioContext) : J = new AudioContext), 1 !== H && this.runtime.isCordova && "undefined" != typeof window.Media && (H = 2), 2 === H) {
                Y = location.href;
                var t = Y.lastIndexOf("/"); - 1 < t && (Y = Y.substr(0, t + 1)), Y = Y.replace("file://", "")
            }
            this.runtime.tickMe(this)
        };
        var xe = W.Instance.prototype;
        xe.onCreate = function() {
            this.runtime.audioInstance = this, $ = this.properties[0], this.saveload = this.properties[1], this.playinbackground = this.properties[2], this.nextPlayTime = 0, ie = this.properties[4], se = this.properties[5], this.listenerZ = -this.properties[6], le = this.properties[7], pe = this.properties[8], de = this.properties[9], this.listenerTracker = new C;
            var e = this.runtime.draw_width || this.runtime.width,
                t = this.runtime.draw_height || this.runtime.height;
            H === 1 && (J.listener.setPosition(e / 2, t / 2, this.listenerZ), J.listener.setOrientation(0, 0, 1, 0, -1, 0), window.c2OnAudioMicStream = function(e, t) {
                ce && ce.disconnect(), ue = t.toLowerCase(), ce = J.createMediaStreamSource(e), ce.connect(l(ue))
            }), this.runtime.addSuspendCallback(function(e) {
                X.onSuspend(e)
            });
            var r = this;
            this.runtime.addDestroyCallback(function(e) {
                r.onInstanceDestroyed(e)
            })
        }, xe.onInstanceDestroyed = function(e) {
            var t, r, n;
            for (t = 0, r = Q.length; t < r; t++) n = Q[t], n.objectTracker && n.objectTracker.obj === e && (n.objectTracker.obj = null, n.pannerEnabled && n.isPlaying() && n.looping && n.stop());
            this.listenerTracker.obj === e && (this.listenerTracker.obj = null)
        }, xe.saveToJSON = function() {
            var e = {
                    silent: ee,
                    masterVolume: te,
                    listenerZ: this.listenerZ,
                    listenerUid: this.listenerTracker.hasObject() ? this.listenerTracker.obj.uid : -1,
                    playing: [],
                    effects: {}
                },
                t = e.playing,
                r, n, o, s, l, c, u;
            for (r = 0, n = Q.length; r < n; r++) o = Q[r], !o.shouldSave() || 3 === this.saveload || o.is_music && 1 === this.saveload || !o.is_music && 2 === this.saveload || (u = o.getPlaybackTime(), o.looping && (u %= o.getDuration()), s = {
                tag: o.tag,
                buffersrc: o.buffer.src,
                buffertype: o.buffer.type,
                is_music: o.is_music,
                playbackTime: u,
                volume: o.volume,
                looping: o.looping,
                muted: o.is_muted,
                playbackRate: o.playbackRate,
                paused: o.is_paused,
                resume_position: o.resume_position
            }, o.pannerEnabled && (s.pan = {}, c = s.pan, o.objectTracker && o.objectTracker.hasObject() ? c.objUid = o.objectTracker.obj.uid : (c.x = o.panX, c.y = o.panY, c.a = o.panAngle), c.ia = o.panConeInner, c.oa = o.panConeOuter, c.og = o.panConeOuterGain), t.push(s));
            var g = e.effects,
                y;
            for (l in fe)
                if (fe.hasOwnProperty(l)) {
                    for (y = [], r = 0, n = fe[l].length; r < n; r++) y.push({
                        type: fe[l][r].type,
                        params: fe[l][r].params
                    });
                    g[l] = y
                }
            return e
        };
        var ve = [];
        xe.loadFromJSON = function(e) {
            var t = e.silent;
            te = e.masterVolume, this.listenerZ = e.listenerZ, this.listenerTracker.setObject(null);
            var r = e.listenerUid; - 1 !== r && (this.listenerTracker.loadUid = r, ve.push(this.listenerTracker));
            var n = e.playing,
                o, s, l, c, u, g, y, A, P, L, I, R, B, F, N;
            if (3 !== this.saveload)
                for (o = 0, s = Q.length; o < s; o++) R = Q[o], R.is_music && 1 === this.saveload || !R.is_music && 2 === this.saveload || R.stop();
            var j, D, M, z;
            for (B in fe)
                if (fe.hasOwnProperty(B))
                    for (o = 0, s = fe[B].length; o < s; o++) fe[B][o].remove();
            for (B in cr.wipe(fe), e.effects)
                if (e.effects.hasOwnProperty(B))
                    for (j = e.effects[B], o = 0, s = j.length; o < s; o++) D = j[o].type, M = j[o].params, "filter" === D ? k(B, new m(M[0], M[1], M[2], M[3], M[4], M[5])) : "delay" === D ? k(B, new _(M[0], M[1], M[2])) : "convolve" === D ? (c = M[2], I = this.getAudioBuffer(c, !1), I.bufferObject ? z = new h(I.bufferObject, M[0], M[1], c) : (z = new h(null, M[0], M[1], c), I.normalizeWhenReady = M[0], I.convolveWhenReady = z), k(B, z)) : "flanger" === D ? k(B, new f(M[0], M[1], M[2], M[3], M[4])) : "phaser" === D ? k(B, new x(M[0], M[1], M[2], M[3], M[4], M[5])) : "gain" === D ? k(B, new v(M[0])) : "tremolo" === D ? k(B, new w(M[0], M[1])) : "ringmod" === D ? k(B, new S(M[0], M[1])) : "distortion" === D ? k(B, new T(M[0], M[1], M[2], M[3], M[4])) : "compressor" === D ? k(B, new O(M[0], M[1], M[2], M[3], M[4])) : "analyser" === D ? k(B, new E(M[0], M[1])) : void 0;
            for (o = 0, s = n.length; o < s; o++)
                if (3 !== this.saveload && (l = n[o], c = l.buffersrc, u = l.buffertype || "", g = l.is_music, y = l.tag, A = l.playbackTime, P = l.looping, L = l.volume, F = l.pan, N = F && F.hasOwnProperty("objUid") ? F.objUid : -1, !(g && 1 === this.saveload) && (g || 2 !== this.saveload))) {
                    if (R = this.getAudioInstance({
                            url: c,
                            type: u
                        }, y, g, P, L), !R) {
                        I = this.getAudioBuffer({
                            url: c,
                            type: ""
                        }, g), I.seekWhenReady = A, I.pauseWhenReady = l.paused, F && (-1 === N ? I.panWhenReady.push({
                            x: F.x,
                            y: F.y,
                            a: F.a,
                            ia: F.ia,
                            oa: F.oa,
                            og: F.og,
                            thistag: y
                        }) : I.panWhenReady.push({
                            objUid: N,
                            ia: F.ia,
                            oa: F.oa,
                            og: F.og,
                            thistag: y
                        }));
                        continue
                    }
                    R.resume_position = l.resume_position, R.setPannerEnabled(!!F), R.play(P, L, A), R.updatePlaybackRate(), R.updateVolume(), R.doSetMuted(R.is_muted || R.is_silent), l.paused && R.pause(), l.muted && R.setMuted(!0), R.doSetMuted(R.is_muted || R.is_silent), F && (-1 === N ? R.setPan(F.x, F.y, F.a, F.ia, F.oa, F.og) : (R.objectTracker = R.objectTracker || new C, R.objectTracker.loadUid = N, ve.push(R.objectTracker)))
                }
            if (t && !ee) {
                for (o = 0, s = Q.length; o < s; o++) Q[o].setSilent(!0);
                ee = !0
            } else if (!t && ee) {
                for (o = 0, s = Q.length; o < s; o++) Q[o].setSilent(!1);
                ee = !1
            }
        }, xe.afterLoad = function() {
            var e, t, r, n;
            for (e = 0, t = ve.length; e < t; e++) r = ve[e], n = this.runtime.getObjectByUID(r.loadUid), r.setObject(n), r.loadUid = -1, n && (re = n.x, ne = n.y);
            cr.clearArray(ve)
        }, xe.onSuspend = function(e) {
            if (!this.playinbackground) {
                !e && J && J.resume && (J.resume(), ae = !1);
                var t, r;
                for (t = 0, r = Q.length; t < r; t++) Q[t].setSuspended(e);
                e && J && J.suspend && (J.suspend(), ae = !0)
            }
        }, xe.tick = function() {
            var e = this.runtime.dt,
                t, r, n;
            for (t = 0, r = Q.length; t < r; t++) n = Q[t], n.tick(e), 0 !== $ && n.updatePlaybackRate();
            var o, s, l;
            for (o in fe)
                if (fe.hasOwnProperty(o))
                    for (s = fe[o], t = 0, r = s.length; t < r; t++) l = s[t], l.tick && l.tick();
            H === 1 && this.listenerTracker.hasObject() && (this.listenerTracker.tick(e), re = this.listenerTracker.obj.x, ne = this.listenerTracker.obj.y, J.listener.setPosition(this.listenerTracker.obj.x, this.listenerTracker.obj.y, this.listenerZ))
        };
        var we = [];
        xe.setPreloadList = function(e) {
            var t = 0,
                r, n, a, o;
            for (r = 0, n = e.length; r < n; ++r) a = e[r], o = 2 * a.size, we.push({
                filename: a.filename,
                size: o,
                type: a.type,
                obj: null
            }), t += o;
            return t
        }, xe.startPreloads = function() {
            var e, t, r, n;
            for (e = 0, t = we.length; e < t; ++e) r = we[e], n = this.runtime.getProjectFileUrl(r.filename), r.obj = this.getAudioBuffer({
                url: n,
                type: r.type
            }, !1)
        }, xe.getPreloadedSize = function() {
            var e = 0,
                t, r, n;
            for (t = 0, r = we.length; t < r; ++t) n = we[t], n.obj.isLoadedAndDecoded() || n.obj.hasFailedToLoad() || this.runtime.isAndroidStockBrowser ? e += n.size : n.obj.isLoaded() && (e += M(n.size / 2));
            return e
        }, xe.releaseAllMusicBuffers = function() {
            var e, t, r, n;
            for (e = 0, r = 0, t = Z.length; e < t; ++e) n = Z[e], Z[r] = n, n.is_music ? n.release() : ++r;
            Z.length = r
        }, xe.getAudioBuffer = function(e, t, r) {
            var n = null,
                o = e.url,
                s, l, p;
            for (s = 0, l = Z.length; s < l; s++)
                if (p = Z[s], p.src === o) {
                    n = p;
                    break
                }
            return n || r || ((me || _e) && t && this.releaseAllMusicBuffers(), n = new A(o, e.type, t), Z.push(n)), n
        }, xe.getAudioInstance = function(e, t, r, n, o) {
            var s = e.url,
                l, p, d;
            for (l = 0, p = Q.length; l < p; l++)
                if (d = Q[l], d.src === s && (d.canBeRecycled() || r)) return d.tag = t, d;
            var c = this.getAudioBuffer(e, r);
            return c.bufferObject ? (d = new P(c, t), Q.push(d), d) : ("<preload>" !== t && (c.playTagWhenReady = t, c.loopWhenReady = n, c.volumeWhenReady = o), null)
        };
        var Se = [];
        B.prototype.OnEnded = function(e) {
            return cr.equals_nocase(q, e)
        }, B.prototype.PreloadsComplete = function() {
            var e, t;
            for (e = 0, t = Z.length; e < t; e++)
                if (!Z[e].isLoadedAndDecoded() && !Z[e].hasFailedToLoad()) return !1;
            return !0
        }, B.prototype.AdvancedAudioSupported = function() {
            return H === 1
        }, B.prototype.IsSilent = function() {
            return ee
        }, B.prototype.IsAnyPlaying = function() {
            var e, t;
            for (e = 0, t = Q.length; e < t; e++)
                if (Q[e].isPlaying()) return !0;
            return !1
        }, B.prototype.IsTagPlaying = function(e) {
            I(e);
            var t, r;
            for (t = 0, r = Se.length; t < r; t++)
                if (Se[t].isPlaying()) return !0;
            return !1
        }, W.cnds = new B;
        F.prototype.Play = function(e, t, r, n) {
            if (!ee) {
                var o = a(r),
                    i = e[1],
                    s = this.runtime.getProjectAudioFileUrl(e[0]);
                s && (K = this.getAudioInstance(s, n, i, 0 !== t, o), K && (K.setPannerEnabled(!1), K.play(0 !== t, o, 0, this.nextPlayTime), this.nextPlayTime = 0))
            }
        }, F.prototype.PlayAtPosition = function(e, t, r, n, o, i, s, l, p, d) {
            if (!ee) {
                var c = a(r),
                    u = e[1],
                    g = this.runtime.getProjectAudioFileUrl(e[0]);
                if (g) {
                    if (K = this.getAudioInstance(g, d, u, 0 !== t, c), !K) {
                        var y = this.getAudioBuffer(g, u);
                        return void y.panWhenReady.push({
                            x: n,
                            y: o,
                            a: i,
                            ia: s,
                            oa: l,
                            og: a(p),
                            thistag: d
                        })
                    }
                    K.setPannerEnabled(!0), K.setPan(n, o, i, s, l, a(p)), K.play(0 !== t, c, 0, this.nextPlayTime), this.nextPlayTime = 0
                }
            }
        }, F.prototype.PlayAtObject = function(e, t, r, n, o, i, s, l) {
            if (!ee && n) {
                var p = n.getFirstPicked();
                if (p) {
                    var d = a(r),
                        c = e[1],
                        u = this.runtime.getProjectAudioFileUrl(e[0]);
                    if (u) {
                        if (K = this.getAudioInstance(u, l, c, 0 !== t, d), !K) {
                            var g = this.getAudioBuffer(u, c);
                            return void g.panWhenReady.push({
                                obj: p,
                                ia: o,
                                oa: i,
                                og: a(s),
                                thistag: l
                            })
                        }
                        K.setPannerEnabled(!0);
                        var y = cr.rotatePtAround(p.x, p.y, -p.layer.getAngle(), re, ne, !0),
                            m = cr.rotatePtAround(p.x, p.y, -p.layer.getAngle(), re, ne, !1);
                        K.setPan(y, m, cr.to_degrees(p.angle - p.layer.getAngle()), o, i, a(s)), K.setObject(p), K.play(0 !== t, d, 0, this.nextPlayTime), this.nextPlayTime = 0
                    }
                }
            }
        }, F.prototype.PlayByName = function(e, t, r, n, o) {
            if (!ee) {
                var i = a(n),
                    s = this.runtime.getProjectAudioFileUrl(t);
                s && (K = this.getAudioInstance(s, o, 1 === e, 0 !== r, i), K && (K.setPannerEnabled(!1), K.play(0 !== r, i, 0, this.nextPlayTime), this.nextPlayTime = 0))
            }
        }, F.prototype.PlayAtPositionByName = function(e, t, r, n, o, i, s, l, p, d, c) {
            if (!ee) {
                var u = a(n),
                    g = 1 === e,
                    y = this.runtime.getProjectAudioFileUrl(t);
                if (y) {
                    if (K = this.getAudioInstance(y, c, g, 0 !== r, u), !K) {
                        var m = this.getAudioBuffer(y, g);
                        return void m.panWhenReady.push({
                            x: o,
                            y: i,
                            a: s,
                            ia: l,
                            oa: p,
                            og: a(d),
                            thistag: c
                        })
                    }
                    K.setPannerEnabled(!0), K.setPan(o, i, s, l, p, a(d)), K.play(0 !== r, u, 0, this.nextPlayTime), this.nextPlayTime = 0
                }
            }
        }, F.prototype.PlayAtObjectByName = function(e, t, r, n, o, i, s, l, p) {
            if (!ee && o) {
                var d = o.getFirstPicked();
                if (d) {
                    var c = a(n),
                        u = 1 === e,
                        g = this.runtime.getProjectAudioFileUrl(t);
                    if (g) {
                        if (K = this.getAudioInstance(g, p, u, 0 !== r, c), !K) {
                            var y = this.getAudioBuffer(g, u);
                            return void y.panWhenReady.push({
                                obj: d,
                                ia: i,
                                oa: s,
                                og: a(l),
                                thistag: p
                            })
                        }
                        K.setPannerEnabled(!0);
                        var m = cr.rotatePtAround(d.x, d.y, -d.layer.getAngle(), re, ne, !0),
                            _ = cr.rotatePtAround(d.x, d.y, -d.layer.getAngle(), re, ne, !1);
                        K.setPan(m, _, cr.to_degrees(d.angle - d.layer.getAngle()), i, s, a(l)), K.setObject(d), K.play(0 !== r, c, 0, this.nextPlayTime), this.nextPlayTime = 0
                    }
                }
            }
        }, F.prototype.SetLooping = function(e, t) {
            I(e);
            var r, n;
            for (r = 0, n = Se.length; r < n; r++) Se[r].setLooping(0 === t)
        }, F.prototype.SetMuted = function(e, t) {
            I(e);
            var r, n;
            for (r = 0, n = Se.length; r < n; r++) Se[r].setMuted(0 === t)
        }, F.prototype.SetVolume = function(e, t) {
            I(e);
            var r = a(t),
                n, o;
            for (n = 0, o = Se.length; n < o; n++) Se[n].setVolume(r)
        }, F.prototype.Preload = function(e) {
            if (!ee) {
                var t = e[1],
                    r = this.runtime.getProjectAudioFileUrl(e[0]);
                r && 2 !== H && this.getAudioInstance(r, "<preload>", t, !1)
            }
        }, F.prototype.PreloadByName = function(e, t) {
            if (!ee) {
                var r = this.runtime.getProjectAudioFileUrl(t);
                r && 2 !== H && this.getAudioInstance(r, "<preload>", 1 === e, !1)
            }
        }, F.prototype.SetPlaybackRate = function(e, t) {
            I(e), 0 > t && (t = 0);
            var r, n;
            for (r = 0, n = Se.length; r < n; r++) Se[r].setPlaybackRate(t)
        }, F.prototype.Stop = function(e) {
            I(e);
            var t, r;
            for (t = 0, r = Se.length; t < r; t++) Se[t].stop()
        }, F.prototype.StopAll = function() {
            var e, t;
            for (e = 0, t = Q.length; e < t; e++) Q[e].stop()
        }, F.prototype.SetPaused = function(e, t) {
            I(e);
            var r, n;
            for (r = 0, n = Se.length; r < n; r++) 0 === t ? Se[r].pause() : Se[r].resume()
        }, F.prototype.Seek = function(e, t) {
            I(e);
            var r, n;
            for (r = 0, n = Se.length; r < n; r++) Se[r].seek(t)
        }, F.prototype.SetSilent = function(e) {
            var t, r;
            if (2 === e && (e = ee ? 1 : 0), 0 === e && !ee) {
                for (t = 0, r = Q.length; t < r; t++) Q[t].setSilent(!0);
                ee = !0
            } else if (1 === e && ee) {
                for (t = 0, r = Q.length; t < r; t++) Q[t].setSilent(!1);
                ee = !1
            }
        }, F.prototype.SetMasterVolume = function(e) {
            te = a(e);
            var t, r;
            for (t = 0, r = Q.length; t < r; t++) Q[t].updateVolume()
        }, F.prototype.AddFilterEffect = function(e, t, r, n, a, o, i) {
            1 !== H || 0 > t || t >= be.length || !J.createBiquadFilter || (e = e.toLowerCase(), i /= 100, 0 > i && (i = 0), 1 < i && (i = 1), k(e, new m(t, r, n, a, o, i)))
        }, F.prototype.AddDelayEffect = function(e, t, r, n) {
            1 !== H || (e = e.toLowerCase(), n /= 100, 0 > n && (n = 0), 1 < n && (n = 1), k(e, new _(t, a(r), n)))
        }, F.prototype.AddFlangerEffect = function(e, t, r, n, a, o) {
            1 === H && J.createOscillator && (e = e.toLowerCase(), o /= 100, 0 > o && (o = 0), 1 < o && (o = 1), k(e, new f(t / 1e3, r / 1e3, n, a / 100, o)))
        }, F.prototype.AddPhaserEffect = function(e, t, r, n, a, o, i) {
            1 === H && J.createOscillator && (e = e.toLowerCase(), i /= 100, 0 > i && (i = 0), 1 < i && (i = 1), k(e, new x(t, r, n, a, o, i)))
        }, F.prototype.AddConvolutionEffect = function(e, t, r, n) {
            if (1 === H && J.createConvolver) {
                var a = 0 === r,
                    o = this.runtime.getProjectAudioFileUrl(t[0]);
                if (o) {
                    var i = this.getAudioBuffer(o, !1);
                    e = e.toLowerCase(), n /= 100, 0 > n && (n = 0), 1 < n && (n = 1);
                    var s;
                    i.bufferObject ? s = new h(i.bufferObject, a, n, o.url) : (s = new h(null, a, n, o.url), i.normalizeWhenReady = a, i.convolveWhenReady = s), k(e, s)
                }
            }
        }, F.prototype.AddGainEffect = function(e, t) {
            1 !== H || (e = e.toLowerCase(), k(e, new v(a(t))))
        }, F.prototype.AddMuteEffect = function(e) {
            1 !== H || (e = e.toLowerCase(), k(e, new v(0)))
        }, F.prototype.AddTremoloEffect = function(e, t, r) {
            1 === H && J.createOscillator && (e = e.toLowerCase(), r /= 100, 0 > r && (r = 0), 1 < r && (r = 1), k(e, new w(t, r)))
        }, F.prototype.AddRingModEffect = function(e, t, r) {
            1 === H && J.createOscillator && (e = e.toLowerCase(), r /= 100, 0 > r && (r = 0), 1 < r && (r = 1), k(e, new S(t, r)))
        }, F.prototype.AddDistortionEffect = function(e, t, r, n, a, o) {
            1 === H && J.createWaveShaper && (e = e.toLowerCase(), o /= 100, 0 > o && (o = 0), 1 < o && (o = 1), k(e, new T(t, r, n, a, o)))
        }, F.prototype.AddCompressorEffect = function(e, t, r, n, a, o) {
            1 === H && J.createDynamicsCompressor && (e = e.toLowerCase(), k(e, new O(t, r, n, a / 1e3, o / 1e3)))
        }, F.prototype.AddAnalyserEffect = function(e, t, r) {
            1 !== H || (e = e.toLowerCase(), k(e, new E(t, r)))
        }, F.prototype.RemoveEffects = function(e) {
            if (1 === H) {
                e = e.toLowerCase();
                var t, r, n;
                if (fe.hasOwnProperty(e) && (n = fe[e], n.length)) {
                    for (t = 0, r = n.length; t < r; t++) n[t].remove();
                    cr.clearArray(n), R(e)
                }
            }
        }, F.prototype.SetEffectParameter = function(e, t, r, n, a, o) {
            if (1 === H) {
                e = e.toLowerCase(), t = M(t);
                var i;
                fe.hasOwnProperty(e) && (i = fe[e], 0 > t || t >= i.length || i[t].setParam(r, n, a, o))
            }
        }, F.prototype.SetListenerObject = function(e) {
            if (e && 1 === H) {
                var t = e.getFirstPicked();
                t && (this.listenerTracker.setObject(t), re = t.x, ne = t.y)
            }
        }, F.prototype.SetListenerZ = function(e) {
            this.listenerZ = e
        }, F.prototype.ScheduleNextPlay = function(e) {
            J && (this.nextPlayTime = e)
        }, F.prototype.UnloadAudio = function(e) {
            var t = e[1],
                r = this.runtime.getProjectAudioFileUrl(e[0]);
            if (r) {
                var n = this.getAudioBuffer(r, t, !0);
                n && (n.release(), cr.arrayFindRemove(Z, n))
            }
        }, F.prototype.UnloadAudioByName = function(e, t) {
            var r = this.runtime.getProjectAudioFileUrl(t);
            if (r) {
                var n = this.getAudioBuffer(r, 1 === e, !0);
                n && (n.release(), cr.arrayFindRemove(Z, n))
            }
        }, F.prototype.UnloadAll = function() {
            var e, t;
            for (e = 0, t = Z.length; e < t; ++e) Z[e].release();
            cr.clearArray(Z)
        }, W.acts = new F;
        N.prototype.Duration = function(e, t) {
            I(t, !0), Se.length ? e.set_float(Se[0].getDuration()) : e.set_float(0)
        }, N.prototype.PlaybackTime = function(e, t) {
            I(t, !0), Se.length ? e.set_float(Se[0].getPlaybackTime(!0)) : e.set_float(0)
        }, N.prototype.PlaybackRate = function(e, t) {
            I(t, !0), Se.length ? e.set_float(Se[0].getPlaybackRate()) : e.set_float(0)
        }, N.prototype.Volume = function(e, t) {
            if (I(t, !0), Se.length) {
                var r = Se[0].getVolume();
                e.set_float(o(r))
            } else e.set_float(0)
        }, N.prototype.MasterVolume = function(e) {
            e.set_float(o(te))
        }, N.prototype.EffectCount = function(e, t) {
            t = t.toLowerCase();
            var r = null;
            fe.hasOwnProperty(t) && (r = fe[t]), e.set_int(r ? r.length : 0)
        };
        N.prototype.AnalyserFreqBinCount = function(e, t, r) {
            t = t.toLowerCase(), r = M(r);
            var n = j(t, r);
            e.set_int(n ? n.node.frequencyBinCount : 0)
        }, N.prototype.AnalyserFreqBinAt = function(e, t, r, n) {
            t = t.toLowerCase(), r = M(r), n = M(n);
            var a = j(t, r);
            a ? 0 > n || n >= a.node.frequencyBinCount ? e.set_float(0) : e.set_float(a.freqBins[n]) : e.set_float(0)
        }, N.prototype.AnalyserPeakLevel = function(e, t, r) {
            t = t.toLowerCase(), r = M(r);
            var n = j(t, r);
            n ? e.set_float(n.peak) : e.set_float(0)
        }, N.prototype.AnalyserRMSLevel = function(e, t, r) {
            t = t.toLowerCase(), r = M(r);
            var n = j(t, r);
            n ? e.set_float(n.rms) : e.set_float(0)
        }, N.prototype.SampleRate = function(e) {
            e.set_int(J ? J.sampleRate : 0)
        }, N.prototype.CurrentTime = function(e) {
            e.set_float(J ? J.currentTime : cr.performance_now())
        }, W.exps = new N
    }();
cr.plugins_.Sprite = function(e) {
        this.runtime = e
    },
    function() {
        function e() {
            if (0 === this.datauri.length) {
                var e = document.createElement("canvas");
                e.width = this.width, e.height = this.height;
                var t = e.getContext("2d");
                this.spritesheeted ? t.drawImage(this.texture_img, this.offx, this.offy, this.width, this.height, 0, 0, this.width, this.height) : t.drawImage(this.texture_img, 0, 0, this.width, this.height), this.datauri = e.toDataURL("image/png")
            }
            return this.datauri
        }

        function t() {}

        function r() {
            return f.length ? f.pop() : [0, 0, 0]
        }

        function n(e) {
            e[0] = 0, e[1] = 0, e[2] = 0, f.push(e)
        }

        function o(e, t) {
            return e < t ? "" + e + "," + t : "" + t + "," + e
        }

        function a(e, t, n, a) {
            var i = t.uid,
                s = n.uid,
                l = o(i, s);
            if (e.hasOwnProperty(l)) return void(e[l][2] = a);
            var p = r();
            p[0] = i, p[1] = s, p[2] = a, e[l] = p
        }

        function i(e, t, r) {
            var a = o(t.uid, r.uid);
            e.hasOwnProperty(a) && (n(e[a]), delete e[a])
        }

        function s(e, t) {
            var r = t.uid,
                a, o;
            for (a in e) e.hasOwnProperty(a) && (o = e[a], (o[0] === r || o[1] === r) && (n(e[a]), delete e[a]))
        }

        function p(e, t, r) {
            var n = o(t.uid, r.uid);
            return e.hasOwnProperty(n) ? (x = e[n][2], !0) : (x = -2, !1)
        }

        function l(e, t, n) {
            if (!e) return !1;
            var a = 0 !== t || 0 !== n,
                o = !1,
                i = this.runtime.getCurrentCondition(),
                s = i.type,
                l = i.inverted,
                p = e.getCurrentSol(),
                d = this.runtime.getCurrentEventStack().current_event.orblock,
                c, u, g, y, m, _;
            for (p.select_all ? (this.update_bbox(), O.copy(this.bbox), O.offset(t, n), this.runtime.getCollisionCandidates(this.layer, e, O, T), _ = T) : d ? this.runtime.isCurrentConditionFirst() && !p.else_instances.length && p.instances.length ? _ = p.instances : _ = p.else_instances : _ = p.instances, v = e, S = s !== e && !l, a && (c = this.x, u = this.y, this.x += t, this.y += n, this.set_bbox_changed()), (g = 0, y = _.length); g < y; g++)
                if (m = _[g], this.runtime.testOverlap(this, m)) {
                    if (o = !0, l) break;
                    s !== e && w.add(m)
                }
            return a && (this.x = c, this.y = u, this.set_bbox_changed()), cr.clearArray(T), o
        }

        function d() {}

        function c() {}
        var u = Math.abs,
            g = Math.round,
            y = cr.plugins_.Sprite.prototype;
        y.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var m = y.Type.prototype;
        m.onCreate = function() {
            if (!this.is_family) {
                var t, r, n, a, o, s, l, p, d, c;
                for (this.all_frames = [], this.has_loaded_textures = !1, (t = 0, r = this.animations.length); t < r; t++) {
                    for (o = this.animations[t], l = {}, l.name = o[0], l.speed = o[1], l.loop = o[2], l.repeatcount = o[3], l.repeatto = o[4], l.pingpong = o[5], l.sid = o[6], l.frames = [], (n = 0, a = o[7].length); n < a; n++) s = o[7][n], p = {}, p.texture_file = s[0], p.texture_filesize = s[1], p.offx = s[2], p.offy = s[3], p.width = s[4], p.height = s[5], p.duration = s[6], p.hotspotX = s[7], p.hotspotY = s[8], p.image_points = s[9], p.poly_pts = s[10], p.pixelformat = s[11], p.spritesheeted = 0 !== p.width, p.datauri = "", p.getDataUri = e, c = {}, c.left = 0, c.top = 0, c.right = 1, c.bottom = 1, p.sheetTex = c, p.webGL_texture = null, d = this.runtime.findWaitingTexture(s[0]), d ? p.texture_img = d : (p.texture_img = new Image, p.texture_img.cr_src = s[0], p.texture_img.cr_filesize = s[1], p.texture_img.c2webGL_texture = null, this.runtime.waitForImageLoad(p.texture_img, s[0])), cr.seal(p), l.frames.push(p), this.all_frames.push(p);
                    cr.seal(l), this.animations[t] = l
                }
            }
        }, m.updateAllCurrentTexture = function() {
            var e, t, r;
            for (e = 0, t = this.instances.length; e < t; e++) r = this.instances[e], r.curWebGLTexture = r.curFrame.webGL_texture
        }, m.onLostWebGLContext = function() {
            if (!this.is_family) {
                var e, t, r;
                for (e = 0, t = this.all_frames.length; e < t; ++e) r = this.all_frames[e], r.texture_img.c2webGL_texture = null, r.webGL_texture = null;
                this.has_loaded_textures = !1, this.updateAllCurrentTexture()
            }
        }, m.onRestoreWebGLContext = function() {
            if (!this.is_family && this.instances.length) {
                var e, t, r;
                for (e = 0, t = this.all_frames.length; e < t; ++e) r = this.all_frames[e], r.webGL_texture = this.runtime.glwrap.loadTexture(r.texture_img, !1, this.runtime.linearSampling, r.pixelformat);
                this.updateAllCurrentTexture()
            }
        }, m.loadTextures = function() {
            if (!(this.is_family || this.has_loaded_textures || !this.runtime.glwrap)) {
                var e, t, r;
                for (e = 0, t = this.all_frames.length; e < t; ++e) r = this.all_frames[e], r.webGL_texture = this.runtime.glwrap.loadTexture(r.texture_img, !1, this.runtime.linearSampling, r.pixelformat);
                this.has_loaded_textures = !0
            }
        }, m.unloadTextures = function() {
            if (!(this.is_family || this.instances.length || !this.has_loaded_textures)) {
                var e, t, r;
                for (e = 0, t = this.all_frames.length; e < t; ++e) r = this.all_frames[e], this.runtime.glwrap.deleteTexture(r.webGL_texture), r.webGL_texture = null;
                this.has_loaded_textures = !1
            }
        };
        var _ = [];
        m.preloadCanvas2D = function(e) {
            var t, r, n;
            for (cr.clearArray(_), t = 0, r = this.all_frames.length; t < r; ++t) n = this.all_frames[t].texture_img, -1 === _.indexOf(n) && (e.drawImage(n, 0, 0), _.push(n))
        }, y.Instance = function(e) {
            this.type = e, this.runtime = e.runtime;
            var t = this.type.animations[0].frames[0].poly_pts;
            this.recycled ? this.collision_poly.set_pts(t) : this.collision_poly = new cr.CollisionPoly(t)
        };
        var h = y.Instance.prototype;
        h.onCreate = function() {
            this.visible = this.properties[0], this.isTicking = !1, this.inAnimTrigger = !1, this.collisionsEnabled = this.properties[3], this.cur_animation = this.getAnimationByName(this.properties[1]) || this.type.animations[0], this.cur_frame = this.properties[2], 0 > this.cur_frame && (this.cur_frame = 0), this.cur_frame >= this.cur_animation.frames.length && (this.cur_frame = this.cur_animation.frames.length - 1);
            var e = this.cur_animation.frames[this.cur_frame];
            this.collision_poly.set_pts(e.poly_pts), this.hotspotX = e.hotspotX, this.hotspotY = e.hotspotY, this.animForwards = 0 <= this.cur_animation.speed, this.cur_anim_speed = u(this.cur_animation.speed), this.cur_anim_repeatto = this.cur_animation.repeatto, 1 === this.type.animations.length && 1 === this.type.animations[0].frames.length || 0 === this.cur_anim_speed || (this.runtime.tickMe(this), this.isTicking = !0), this.recycled ? this.animTimer.reset() : this.animTimer = new cr.KahanAdder, this.frameStart = this.getNowTime(), this.animPlaying = !0, this.animRepeats = 0, this.animTriggerName = "", this.changeAnimName = "", this.changeAnimFrom = 0, this.changeAnimFrame = -1, this.type.loadTextures();
            var t, r, n, a, o, s, l, p;
            for (t = 0, r = this.type.animations.length; t < r; t++)
                for (o = this.type.animations[t], n = 0, a = o.frames.length; n < a; n++) s = o.frames[n], 0 === s.width && (s.width = s.texture_img.width, s.height = s.texture_img.height), s.spritesheeted && (p = s.texture_img, l = s.sheetTex, l.left = s.offx / p.width, l.top = s.offy / p.height, l.right = (s.offx + s.width) / p.width, l.bottom = (s.offy + s.height) / p.height, 0 === s.offx && 0 === s.offy && s.width === p.width && s.height === p.height && (s.spritesheeted = !1));
            this.curFrame = this.cur_animation.frames[this.cur_frame], this.curWebGLTexture = this.curFrame.webGL_texture
        }, h.saveToJSON = function() {
            var e = {
                a: this.cur_animation.sid,
                f: this.cur_frame,
                cas: this.cur_anim_speed,
                fs: this.frameStart,
                ar: this.animRepeats,
                at: this.animTimer.sum,
                rt: this.cur_anim_repeatto
            };
            return this.animPlaying || (e.ap = this.animPlaying), this.animForwards || (e.af = this.animForwards), e
        }, h.loadFromJSON = function(e) {
            var t = this.getAnimationBySid(e.a);
            t && (this.cur_animation = t), this.cur_frame = e.f, 0 > this.cur_frame && (this.cur_frame = 0), this.cur_frame >= this.cur_animation.frames.length && (this.cur_frame = this.cur_animation.frames.length - 1), this.cur_anim_speed = e.cas, this.frameStart = e.fs, this.animRepeats = e.ar, this.animTimer.reset(), this.animTimer.sum = e.at, this.animPlaying = !e.hasOwnProperty("ap") || e.ap, this.animForwards = !e.hasOwnProperty("af") || e.af, this.cur_anim_repeatto = e.hasOwnProperty("rt") ? e.rt : this.cur_animation.repeatto, this.curFrame = this.cur_animation.frames[this.cur_frame], this.curWebGLTexture = this.curFrame.webGL_texture, this.collision_poly.set_pts(this.curFrame.poly_pts), this.hotspotX = this.curFrame.hotspotX, this.hotspotY = this.curFrame.hotspotY
        }, h.animationFinish = function(e) {
            this.cur_frame = e ? 0 : this.cur_animation.frames.length - 1, this.animPlaying = !1, this.animTriggerName = this.cur_animation.name, this.inAnimTrigger = !0, this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished, this), this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished, this), this.inAnimTrigger = !1, this.animRepeats = 0
        }, h.getNowTime = function() {
            return this.animTimer.sum
        }, h.tick = function() {
            this.animTimer.add(this.runtime.getDt(this)), this.changeAnimName.length && this.doChangeAnim(), 0 <= this.changeAnimFrame && this.doChangeAnimFrame();
            var e = this.getNowTime(),
                t = this.cur_animation,
                r = t.frames[this.cur_frame],
                n = r.duration / this.cur_anim_speed,
                a;
            this.animPlaying && e >= this.frameStart + n && (this.animForwards ? this.cur_frame++ : this.cur_frame--, this.frameStart += n, this.cur_frame >= t.frames.length && (t.pingpong ? (this.animForwards = !1, this.cur_frame = t.frames.length - 2) : t.loop ? this.cur_frame = this.cur_anim_repeatto : (this.animRepeats++, this.animRepeats >= t.repeatcount ? this.animationFinish(!1) : this.cur_frame = this.cur_anim_repeatto)), 0 > this.cur_frame && (t.pingpong ? (this.cur_frame = 1, this.animForwards = !0, !t.loop && (this.animRepeats++, this.animRepeats >= t.repeatcount && this.animationFinish(!0))) : t.loop ? this.cur_frame = this.cur_anim_repeatto : (this.animRepeats++, this.animRepeats >= t.repeatcount ? this.animationFinish(!0) : this.cur_frame = this.cur_anim_repeatto)), 0 > this.cur_frame ? this.cur_frame = 0 : this.cur_frame >= t.frames.length && (this.cur_frame = t.frames.length - 1), e > this.frameStart + t.frames[this.cur_frame].duration / this.cur_anim_speed && (this.frameStart = e), a = t.frames[this.cur_frame], this.OnFrameChanged(r, a), this.runtime.redraw = !0)
        }, h.getAnimationByName = function(e) {
            var t, r, n;
            for (t = 0, r = this.type.animations.length; t < r; t++)
                if (n = this.type.animations[t], cr.equals_nocase(n.name, e)) return n;
            return null
        }, h.getAnimationBySid = function(e) {
            var t, r, n;
            for (t = 0, r = this.type.animations.length; t < r; t++)
                if (n = this.type.animations[t], n.sid === e) return n;
            return null
        }, h.doChangeAnim = function() {
            var e = this.cur_animation.frames[this.cur_frame],
                t = this.getAnimationByName(this.changeAnimName);
            this.changeAnimName = "";
            !t || cr.equals_nocase(t.name, this.cur_animation.name) && this.animPlaying || (this.cur_animation = t, this.animForwards = 0 <= t.speed, this.cur_anim_speed = u(t.speed), this.cur_anim_repeatto = t.repeatto, 0 > this.cur_frame && (this.cur_frame = 0), this.cur_frame >= this.cur_animation.frames.length && (this.cur_frame = this.cur_animation.frames.length - 1), 1 === this.changeAnimFrom && (this.cur_frame = 0), this.animPlaying = !0, this.frameStart = this.getNowTime(), this.OnFrameChanged(e, this.cur_animation.frames[this.cur_frame]), this.runtime.redraw = !0)
        }, h.doChangeAnimFrame = function() {
            var e = this.cur_animation.frames[this.cur_frame],
                t = this.cur_frame;
            this.cur_frame = cr.floor(this.changeAnimFrame), 0 > this.cur_frame && (this.cur_frame = 0), this.cur_frame >= this.cur_animation.frames.length && (this.cur_frame = this.cur_animation.frames.length - 1), t !== this.cur_frame && (this.OnFrameChanged(e, this.cur_animation.frames[this.cur_frame]), this.frameStart = this.getNowTime(), this.runtime.redraw = !0), this.changeAnimFrame = -1
        }, h.OnFrameChanged = function(e, t) {
            var r = e.width,
                n = e.height,
                a = t.width,
                o = t.height;
            r != a && (this.width *= a / r), n != o && (this.height *= o / n), this.hotspotX = t.hotspotX, this.hotspotY = t.hotspotY, this.collision_poly.set_pts(t.poly_pts), this.set_bbox_changed(), this.curFrame = t, this.curWebGLTexture = t.webGL_texture;
            var s, l, p;
            for (s = 0, l = this.behavior_insts.length; s < l; s++) p = this.behavior_insts[s], p.onSpriteFrameChanged && p.onSpriteFrameChanged(e, t);
            this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged, this)
        }, h.draw = function(e) {
            e.globalAlpha = this.opacity;
            var t = this.curFrame,
                r = t.spritesheeted,
                n = t.texture_img,
                a = this.x,
                o = this.y,
                i = this.width,
                s = this.height;
            if (0 === this.angle && 0 <= i && 0 <= s) a -= this.hotspotX * i, o -= this.hotspotY * s, this.runtime.pixel_rounding && (a = g(a), o = g(o)), r ? e.drawImage(n, t.offx, t.offy, t.width, t.height, a, o, i, s) : e.drawImage(n, a, o, i, s);
            else {
                this.runtime.pixel_rounding && (a = g(a), o = g(o)), e.save();
                var l = 0 < i ? 1 : -1,
                    p = 0 < s ? 1 : -1;
                e.translate(a, o), (1 != l || 1 != p) && e.scale(l, p), e.rotate(this.angle * l * p);
                var d = 0 - this.hotspotX * cr.abs(i),
                    c = 0 - this.hotspotY * cr.abs(s);
                r ? e.drawImage(n, t.offx, t.offy, t.width, t.height, d, c, cr.abs(i), cr.abs(s)) : e.drawImage(n, d, c, cr.abs(i), cr.abs(s)), e.restore()
            }
        }, h.drawGL_earlyZPass = function(e) {
            this.drawGL(e)
        }, h.drawGL = function(e) {
            e.setTexture(this.curWebGLTexture), e.setOpacity(this.opacity);
            var t = this.curFrame,
                r = this.bquad;
            if (this.runtime.pixel_rounding) {
                var n = g(this.x) - this.x,
                    a = g(this.y) - this.y;
                t.spritesheeted ? e.quadTex(r.tlx + n, r.tly + a, r.trx + n, r.try_ + a, r.brx + n, r.bry + a, r.blx + n, r.bly + a, t.sheetTex) : e.quad(r.tlx + n, r.tly + a, r.trx + n, r.try_ + a, r.brx + n, r.bry + a, r.blx + n, r.bly + a)
            } else t.spritesheeted ? e.quadTex(r.tlx, r.tly, r.trx, r.try_, r.brx, r.bry, r.blx, r.bly, t.sheetTex) : e.quad(r.tlx, r.tly, r.trx, r.try_, r.brx, r.bry, r.blx, r.bly)
        }, h.getImagePointIndexByName = function(e) {
            var t = this.curFrame,
                r, n;
            for (r = 0, n = t.image_points.length; r < n; r++)
                if (cr.equals_nocase(e, t.image_points[r][0])) return r;
            return -1
        }, h.getImagePoint = function(e, t) {
            var r = this.curFrame,
                n = r.image_points,
                a;
            if (a = cr.is_string(e) ? this.getImagePointIndexByName(e) : e - 1, a = cr.floor(a), 0 > a || a >= n.length) return t ? this.x : this.y;
            var o = (n[a][1] - r.hotspotX) * this.width,
                i = n[a][2];
            i = (i - r.hotspotY) * this.height;
            var s = Math.cos(this.angle),
                l = Math.sin(this.angle),
                p = o * s - i * l;
            return i = i * s + o * l, o = p, o += this.x, i += this.y, t ? o : i
        };
        var f = [];
        var x = -2;
        var b = [];
        t.prototype.OnCollision = function(e) {
            if (!e) return !1;
            var t = this.runtime,
                n = t.getCurrentCondition(),
                o = n.type,
                d = null;
            n.extra.collmemory ? d = n.extra.collmemory : (d = {}, n.extra.collmemory = d), n.extra.spriteCreatedDestroyCallback || (n.extra.spriteCreatedDestroyCallback = !0, t.addDestroyCallback(function(e) {
                s(n.extra.collmemory, e)
            }));
            var c = o.getCurrentSol(),
                u = e.getCurrentSol(),
                g = c.getObjects(),
                y = this.runtime.tickcount,
                m = t.getCurrentEventStack().current_event,
                _ = m.orblock,
                h, f, v, w, S, T, O, E, C;
            for (f = 0; f < g.length; f++) {
                for (v = g[f], u.select_all ? (v.update_bbox(), this.runtime.getCollisionCandidates(v.layer, e, v.bbox, b), h = b, this.runtime.addRegisteredCollisionCandidates(v, e, h)) : h = u.getObjects(), w = 0; w < h.length; w++) S = h[w], t.testOverlap(v, S) || t.checkRegisteredCollision(v, S) ? (E = p(d, v, S), C = !E || x < y - 1, a(d, v, S, y), C && (t.pushCopySol(m.solModifiers), T = o.getCurrentSol(), O = e.getCurrentSol(), T.select_all = !1, O.select_all = !1, o === e ? (T.instances.length = 2, T.instances[0] = v, T.instances[1] = S, o.applySolToContainer()) : (T.instances.length = 1, O.instances.length = 1, T.instances[0] = v, O.instances[0] = S, o.applySolToContainer(), e.applySolToContainer()), m.retrigger(), t.popSol(m.solModifiers))) : i(d, v, S);
                cr.clearArray(b)
            }
            return !1
        };
        var v = null,
            w = new cr.ObjectSet,
            S = !1,
            T = [],
            O = new cr.rect(0, 0, 0, 0);
        m.finish = function(e) {
            if (S) {
                if (e) {
                    var t = this.runtime.getCurrentEventStack().current_event.orblock,
                        r = v.getCurrentSol(),
                        n = w.valuesRef(),
                        a, o, s;
                    if (r.select_all) {
                        for (r.select_all = !1, cr.clearArray(r.instances), (a = 0, o = n.length); a < o; ++a) r.instances[a] = n[a];
                        if (t)
                            for (cr.clearArray(r.else_instances), a = 0, o = v.instances.length; a < o; ++a) s = v.instances[a], w.contains(s) || r.else_instances.push(s)
                    } else if (t) {
                        var l = r.instances.length;
                        for (a = 0, o = n.length; a < o; ++a) r.instances[l + a] = n[a], cr.arrayFindRemove(r.else_instances, n[a])
                    } else cr.shallowAssignArray(r.instances, n);
                    v.applySolToContainer()
                }
                w.clear(), S = !1
            }
        }, t.prototype.IsOverlapping = function(e) {
            return l.call(this, e, 0, 0)
        }, t.prototype.IsOverlappingOffset = function(e, t, r) {
            return l.call(this, e, t, r)
        }, t.prototype.IsAnimPlaying = function(e) {
            return this.changeAnimName.length ? cr.equals_nocase(this.changeAnimName, e) : cr.equals_nocase(this.cur_animation.name, e)
        }, t.prototype.CompareFrame = function(e, t) {
            return cr.do_cmp(this.cur_frame, e, t)
        }, t.prototype.CompareAnimSpeed = function(e, t) {
            var r = this.animForwards ? this.cur_anim_speed : -this.cur_anim_speed;
            return cr.do_cmp(r, e, t)
        }, t.prototype.OnAnimFinished = function(e) {
            return cr.equals_nocase(this.animTriggerName, e)
        }, t.prototype.OnAnyAnimFinished = function() {
            return !0
        }, t.prototype.OnFrameChanged = function() {
            return !0
        }, t.prototype.IsMirrored = function() {
            return 0 > this.width
        }, t.prototype.IsFlipped = function() {
            return 0 > this.height
        }, t.prototype.OnURLLoaded = function() {
            return !0
        }, t.prototype.IsCollisionEnabled = function() {
            return this.collisionsEnabled
        }, y.cnds = new t;
        d.prototype.Spawn = function(e, t, r) {
            if (e && t) {
                var n = this.runtime.createInstance(e, t, this.getImagePoint(r, !0), this.getImagePoint(r, !1));
                if (n) {
                    "undefined" != typeof n.angle && (n.angle = this.angle, n.set_bbox_changed()), this.runtime.isInOnDestroy++;
                    var a, o, l;
                    if (this.runtime.trigger(Object.getPrototypeOf(e.plugin).cnds.OnCreated, n), n.is_contained)
                        for (a = 0, o = n.siblings.length; a < o; a++) l = n.siblings[a], this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated, l);
                    this.runtime.isInOnDestroy--;
                    var p = this.runtime.getCurrentAction(),
                        d = !1;
                    (cr.is_undefined(p.extra.Spawn_LastExec) || p.extra.Spawn_LastExec < this.runtime.execcount) && (d = !0, p.extra.Spawn_LastExec = this.runtime.execcount);
                    var c;
                    if (e != this.type && (c = e.getCurrentSol(), c.select_all = !1, d ? (cr.clearArray(c.instances), c.instances[0] = n) : c.instances.push(n), n.is_contained))
                        for (a = 0, o = n.siblings.length; a < o; a++) l = n.siblings[a], c = l.type.getCurrentSol(), c.select_all = !1, d ? (cr.clearArray(c.instances), c.instances[0] = l) : c.instances.push(l)
                }
            }
        }, d.prototype.SetEffect = function(e) {
            this.blend_mode = e, this.compositeOp = cr.effectToCompositeOp(e), cr.setGLBlend(this, e, this.runtime.gl), this.runtime.redraw = !0
        }, d.prototype.StopAnim = function() {
            this.animPlaying = !1
        }, d.prototype.StartAnim = function(e) {
            this.animPlaying = !0, this.frameStart = this.getNowTime(), 1 === e && 0 !== this.cur_frame && (this.changeAnimFrame = 0, !this.inAnimTrigger && this.doChangeAnimFrame()), this.isTicking || (this.runtime.tickMe(this), this.isTicking = !0)
        }, d.prototype.SetAnim = function(e, t) {
            this.changeAnimName = e, this.changeAnimFrom = t, this.isTicking || (this.runtime.tickMe(this), this.isTicking = !0), this.inAnimTrigger || this.doChangeAnim()
        }, d.prototype.SetAnimFrame = function(e) {
            this.changeAnimFrame = e, this.isTicking || (this.runtime.tickMe(this), this.isTicking = !0), this.inAnimTrigger || this.doChangeAnimFrame()
        }, d.prototype.SetAnimSpeed = function(e) {
            this.cur_anim_speed = cr.abs(e), this.animForwards = 0 <= e, this.isTicking || (this.runtime.tickMe(this), this.isTicking = !0)
        }, d.prototype.SetAnimRepeatToFrame = function(e) {
            e = Math.floor(e), 0 > e && (e = 0), e >= this.cur_animation.frames.length && (e = this.cur_animation.frames.length - 1), this.cur_anim_repeatto = e
        }, d.prototype.SetMirrored = function(e) {
            var t = cr.abs(this.width) * (0 === e ? -1 : 1);
            this.width === t || (this.width = t, this.set_bbox_changed())
        }, d.prototype.SetFlipped = function(e) {
            var t = cr.abs(this.height) * (0 === e ? -1 : 1);
            this.height === t || (this.height = t, this.set_bbox_changed())
        }, d.prototype.SetScale = function(e) {
            var t = this.curFrame,
                r = 0 > this.width ? -1 : 1,
                n = 0 > this.height ? -1 : 1,
                a = t.width * e * r,
                o = t.height * e * n;
            (this.width !== a || this.height !== o) && (this.width = a, this.height = o, this.set_bbox_changed())
        }, d.prototype.LoadURL = function(e, t, r) {
            var n = new Image,
                a = this,
                o = this.curFrame;
            n.onload = function() {
                return o.texture_img.src === n.src ? (a.runtime.glwrap && a.curFrame === o && (a.curWebGLTexture = o.webGL_texture), 0 === t && (a.width = n.width, a.height = n.height, a.set_bbox_changed()), a.runtime.redraw = !0, void a.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded, a)) : void(o.texture_img = n, o.offx = 0, o.offy = 0, o.width = n.width, o.height = n.height, o.spritesheeted = !1, o.datauri = "", o.pixelformat = 0, a.runtime.glwrap && (o.webGL_texture && a.runtime.glwrap.deleteTexture(o.webGL_texture), o.webGL_texture = a.runtime.glwrap.loadTexture(n, !1, a.runtime.linearSampling), a.curFrame === o && (a.curWebGLTexture = o.webGL_texture), a.type.updateAllCurrentTexture()), 0 === t && (a.width = n.width, a.height = n.height, a.set_bbox_changed()), a.runtime.redraw = !0, a.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded, a))
            }, "data:" !== e.substr(0, 5) && 0 === r && (n.crossOrigin = "anonymous"), this.runtime.setImageSrc(n, e)
        }, d.prototype.SetCollisions = function(e) {
            this.collisionsEnabled === (0 !== e) || (this.collisionsEnabled = 0 !== e, this.collisionsEnabled ? this.set_bbox_changed() : (this.collcells.right >= this.collcells.left && this.type.collision_grid.update(this, this.collcells, null), this.collcells.set(0, 0, -1, -1)))
        }, y.acts = new d;
        c.prototype.AnimationFrame = function(e) {
            e.set_int(this.cur_frame)
        }, c.prototype.AnimationFrameCount = function(e) {
            e.set_int(this.cur_animation.frames.length)
        }, c.prototype.AnimationName = function(e) {
            e.set_string(this.cur_animation.name)
        }, c.prototype.AnimationSpeed = function(e) {
            e.set_float(this.animForwards ? this.cur_anim_speed : -this.cur_anim_speed)
        }, c.prototype.ImagePointX = function(e, t) {
            e.set_float(this.getImagePoint(t, !0))
        }, c.prototype.ImagePointY = function(e, t) {
            e.set_float(this.getImagePoint(t, !1))
        }, c.prototype.ImagePointCount = function(e) {
            e.set_int(this.curFrame.image_points.length)
        }, c.prototype.ImageWidth = function(e) {
            e.set_float(this.curFrame.width)
        }, c.prototype.ImageHeight = function(e) {
            e.set_float(this.curFrame.height)
        }, y.exps = new c
    }();
cr.plugins_.TiledBg = function(e) {
        this.runtime = e
    },
    function() {
        function e() {}

        function t() {}

        function r() {}
        var n = Math.round,
            a = cr.plugins_.TiledBg.prototype;
        a.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var o = a.Type.prototype;
        o.onCreate = function() {
            this.is_family || (this.texture_img = this.runtime.findWaitingTexture(this.texture_file), !this.texture_img && (this.texture_img = new Image, this.texture_img.cr_src = this.texture_file, this.texture_img.cr_filesize = this.texture_filesize, this.texture_img.c2webGL_texture = null, this.runtime.waitForImageLoad(this.texture_img, this.texture_file)), this.pattern = null, this.webGL_texture = null)
        }, o.onLostWebGLContext = function() {
            this.is_family || (this.webGL_texture = null)
        }, o.onRestoreWebGLContext = function() {
            if (!this.is_family && this.instances.length) {
                this.webGL_texture || (this.webGL_texture = this.runtime.glwrap.loadTexture(this.texture_img, !0, this.runtime.linearSampling, this.texture_pixelformat));
                var e, t;
                for (e = 0, t = this.instances.length; e < t; e++) this.instances[e].webGL_texture = this.webGL_texture
            }
        }, o.loadTextures = function() {
            this.is_family || this.webGL_texture || !this.runtime.glwrap || (this.webGL_texture = this.runtime.glwrap.loadTexture(this.texture_img, !0, this.runtime.linearSampling, this.texture_pixelformat))
        }, o.unloadTextures = function() {
            this.is_family || this.instances.length || !this.webGL_texture || (this.runtime.glwrap.deleteTexture(this.webGL_texture), this.webGL_texture = null)
        }, o.preloadCanvas2D = function(e) {
            e.drawImage(this.texture_img, 0, 0)
        }, a.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var i = a.Instance.prototype;
        i.onCreate = function() {
            this.visible = this.properties[0], this.rcTex = new cr.rect(0, 0, 0, 0), this.has_own_texture = !1, this.texture_img = this.type.texture_img, this.runtime.glwrap ? (this.type.loadTextures(), this.webGL_texture = this.type.webGL_texture) : (!this.type.pattern && (this.type.pattern = this.runtime.ctx.createPattern(this.type.texture_img, "repeat")), this.pattern = this.type.pattern)
        }, i.afterLoad = function() {
            this.has_own_texture = !1, this.texture_img = this.type.texture_img
        }, i.onDestroy = function() {
            this.runtime.glwrap && this.has_own_texture && this.webGL_texture && (this.runtime.glwrap.deleteTexture(this.webGL_texture), this.webGL_texture = null)
        }, i.draw = function(e) {
            e.globalAlpha = this.opacity, e.save(), e.fillStyle = this.pattern;
            var t = this.x,
                r = this.y;
            this.runtime.pixel_rounding && (t = n(t), r = n(r));
            var a = -(this.hotspotX * this.width),
                o = -(this.hotspotY * this.height),
                i = a % this.texture_img.width,
                s = o % this.texture_img.height;
            0 > i && (i += this.texture_img.width), 0 > s && (s += this.texture_img.height), e.translate(t, r), e.rotate(this.angle), e.translate(i, s), e.fillRect(a - i, o - s, this.width, this.height), e.restore()
        }, i.drawGL_earlyZPass = function(e) {
            this.drawGL(e)
        }, i.drawGL = function(e) {
            e.setTexture(this.webGL_texture), e.setOpacity(this.opacity);
            var t = this.rcTex;
            t.right = this.width / this.texture_img.width, t.bottom = this.height / this.texture_img.height;
            var r = this.bquad;
            if (this.runtime.pixel_rounding) {
                var a = n(this.x) - this.x,
                    o = n(this.y) - this.y;
                e.quadTex(r.tlx + a, r.tly + o, r.trx + a, r.try_ + o, r.brx + a, r.bry + o, r.blx + a, r.bly + o, t)
            } else e.quadTex(r.tlx, r.tly, r.trx, r.try_, r.brx, r.bry, r.blx, r.bly, t)
        };
        e.prototype.OnURLLoaded = function() {
            return !0
        }, a.cnds = new e;
        t.prototype.SetEffect = function(e) {
            this.blend_mode = e, this.compositeOp = cr.effectToCompositeOp(e), cr.setGLBlend(this, e, this.runtime.gl), this.runtime.redraw = !0
        }, t.prototype.LoadURL = function(e, t) {
            var r = new Image,
                n = this;
            r.onload = function() {
                n.texture_img = r, n.runtime.glwrap ? (n.has_own_texture && n.webGL_texture && n.runtime.glwrap.deleteTexture(n.webGL_texture), n.webGL_texture = n.runtime.glwrap.loadTexture(r, !0, n.runtime.linearSampling)) : n.pattern = n.runtime.ctx.createPattern(r, "repeat"), n.has_own_texture = !0, n.runtime.redraw = !0, n.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded, n)
            }, "data:" !== e.substr(0, 5) && 0 === t && (r.crossOrigin = "anonymous"), this.runtime.setImageSrc(r, e)
        }, a.acts = new t;
        r.prototype.ImageWidth = function(e) {
            e.set_float(this.texture_img.width)
        }, r.prototype.ImageHeight = function(e) {
            e.set_float(this.texture_img.height)
        }, a.exps = new r
    }();
cr.plugins_.Arr = function(e) {
        this.runtime = e
    },
    function() {
        function e() {
            return d.length ? d.pop() : []
        }

        function t(e) {
            var r, n;
            for (r = 0, n = e.length; r < n; r++) Array.isArray(e[r]) && t(e[r]);
            cr.clearArray(e), d.push(e)
        }

        function r() {}

        function n() {}

        function o(e, t) {
            if (cr.is_number(e) && cr.is_number(t)) return e - t;
            var r = "" + e,
                n = "" + t;
            return r < n ? -1 : r > n ? 1 : 0
        }

        function a() {}
        var i = Math.floor,
            s = cr.plugins_.Arr.prototype;
        s.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var l = s.Type.prototype;
        l.onCreate = function() {}, s.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var p = s.Instance.prototype,
            d = [];
        Array.isArray || (Array.isArray = function(e) {
            return "[object Array]" === Object.prototype.toString.call(e)
        });
        p.onCreate = function() {
            this.cx = this.properties[0], this.cy = this.properties[1], this.cz = this.properties[2], this.recycled || (this.arr = e());
            var t = this.arr;
            t.length = this.cx;
            var r, n, a;
            for (r = 0; r < this.cx; r++)
                for (t[r] || (t[r] = e()), t[r].length = this.cy, n = 0; n < this.cy; n++)
                    for (t[r][n] || (t[r][n] = e()), t[r][n].length = this.cz, a = 0; a < this.cz; a++) t[r][n][a] = 0;
            this.forX = [], this.forY = [], this.forZ = [], this.forDepth = -1
        }, p.onDestroy = function() {
            var e;
            for (e = 0; e < this.cx; e++) t(this.arr[e]);
            cr.clearArray(this.arr)
        }, p.at = function(e, t, r) {
            return e = i(e), t = i(t), r = i(r), isNaN(e) || 0 > e || e > this.cx - 1 ? 0 : isNaN(t) || 0 > t || t > this.cy - 1 ? 0 : isNaN(r) || 0 > r || r > this.cz - 1 ? 0 : this.arr[e][t][r]
        }, p.set = function(e, t, r, n) {
            e = i(e), t = i(t), r = i(r);
            isNaN(e) || 0 > e || e > this.cx - 1 || isNaN(t) || 0 > t || t > this.cy - 1 || isNaN(r) || 0 > r || r > this.cz - 1 || (this.arr[e][t][r] = n)
        }, p.getAsJSON = function() {
            return JSON.stringify({
                c2array: !0,
                size: [this.cx, this.cy, this.cz],
                data: this.arr
            })
        }, p.saveToJSON = function() {
            return {
                size: [this.cx, this.cy, this.cz],
                data: this.arr
            }
        }, p.loadFromJSON = function(e) {
            var t = e.size;
            this.cx = t[0], this.cy = t[1], this.cz = t[2], this.arr = e.data
        }, p.setSize = function(t, r, n) {
            if (0 > t && (t = 0), 0 > r && (r = 0), 0 > n && (n = 0), this.cx !== t || this.cy !== r || this.cz !== n) {
                this.cx = t, this.cy = r, this.cz = n;
                var o = this.arr,
                    a, i, s;
                for (o.length = t, a = 0; a < this.cx; a++)
                    for (cr.is_undefined(o[a]) && (o[a] = e()), o[a].length = r, i = 0; i < this.cy; i++)
                        for (cr.is_undefined(o[a][i]) && (o[a][i] = e()), o[a][i].length = n, s = 0; s < this.cz; s++) cr.is_undefined(o[a][i][s]) && (o[a][i][s] = 0)
            }
        }, p.getForX = function() {
            return 0 <= this.forDepth && this.forDepth < this.forX.length ? this.forX[this.forDepth] : 0
        }, p.getForY = function() {
            return 0 <= this.forDepth && this.forDepth < this.forY.length ? this.forY[this.forDepth] : 0
        }, p.getForZ = function() {
            return 0 <= this.forDepth && this.forDepth < this.forZ.length ? this.forZ[this.forDepth] : 0
        };
        r.prototype.CompareX = function(e, t, r) {
            return cr.do_cmp(this.at(e, 0, 0), t, r)
        }, r.prototype.CompareXY = function(e, t, r, n) {
            return cr.do_cmp(this.at(e, t, 0), r, n)
        }, r.prototype.CompareXYZ = function(e, t, r, n, a) {
            return cr.do_cmp(this.at(e, t, r), n, a)
        }, p.doForEachTrigger = function(e) {
            this.runtime.pushCopySol(e.solModifiers), e.retrigger(), this.runtime.popSol(e.solModifiers)
        }, r.prototype.ArrForEach = function(e) {
            var t = this.runtime.getCurrentEventStack().current_event;
            this.forDepth++;
            var r = this.forDepth;
            switch (r === this.forX.length ? (this.forX.push(0), this.forY.push(0), this.forZ.push(0)) : (this.forX[r] = 0, this.forY[r] = 0, this.forZ[r] = 0), e) {
                case 0:
                    for (this.forX[r] = 0; this.forX[r] < this.cx; this.forX[r]++)
                        for (this.forY[r] = 0; this.forY[r] < this.cy; this.forY[r]++)
                            for (this.forZ[r] = 0; this.forZ[r] < this.cz; this.forZ[r]++) this.doForEachTrigger(t);
                    break;
                case 1:
                    for (this.forX[r] = 0; this.forX[r] < this.cx; this.forX[r]++)
                        for (this.forY[r] = 0; this.forY[r] < this.cy; this.forY[r]++) this.doForEachTrigger(t);
                    break;
                case 2:
                    for (this.forX[r] = 0; this.forX[r] < this.cx; this.forX[r]++) this.doForEachTrigger(t);
            }
            return this.forDepth--, !1
        }, r.prototype.CompareCurrent = function(e, t) {
            return cr.do_cmp(this.at(this.getForX(), this.getForY(), this.getForZ()), e, t)
        }, r.prototype.Contains = function(e) {
            var t, r, n;
            for (t = 0; t < this.cx; t++)
                for (r = 0; r < this.cy; r++)
                    for (n = 0; n < this.cz; n++)
                        if (this.arr[t][r][n] === e) return !0;
            return !1
        }, r.prototype.IsEmpty = function() {
            return 0 === this.cx || 0 === this.cy || 0 === this.cz
        }, r.prototype.CompareSize = function(e, t, r) {
            var n = 0;
            return 0 === e ? n = this.cx : 1 === e ? n = this.cy : 2 === e ? n = this.cz : void 0, cr.do_cmp(n, t, r)
        }, s.cnds = new r;
        n.prototype.Clear = function(e) {
            var t, r, n;
            for (t = 0; t < this.cx; t++)
                for (r = 0; r < this.cy; r++)
                    for (n = 0; n < this.cz; n++) this.arr[t][r][n] = e
        }, n.prototype.SetSize = function(e, t, r) {
            this.setSize(e, t, r)
        }, n.prototype.SetX = function(e, t) {
            this.set(e, 0, 0, t)
        }, n.prototype.SetXY = function(e, t, r) {
            this.set(e, t, 0, r)
        }, n.prototype.SetXYZ = function(e, t, r, n) {
            this.set(e, t, r, n)
        }, n.prototype.Push = function(t, r, n) {
            var o = 0,
                i = 0,
                s = 0,
                l = this.arr;
            switch (n) {
                case 0:
                    for (0 === t ? (o = l.length, l.push(e())) : (o = 0, l.unshift(e())), l[o].length = this.cy; i < this.cy; i++)
                        for (l[o][i] = e(), l[o][i].length = this.cz, s = 0; s < this.cz; s++) l[o][i][s] = r;
                    this.cx++;
                    break;
                case 1:
                    for (; o < this.cx; o++)
                        for (0 === t ? (i = l[o].length, l[o].push(e())) : (i = 0, l[o].unshift(e())), l[o][i].length = this.cz, s = 0; s < this.cz; s++) l[o][i][s] = r;
                    this.cy++;
                    break;
                case 2:
                    for (; o < this.cx; o++)
                        for (i = 0; i < this.cy; i++) 0 === t ? l[o][i].push(r) : l[o][i].unshift(r);
                    this.cz++;
            }
        }, n.prototype.Pop = function(e, r) {
            var n = 0,
                o = 0,
                i = this.arr;
            switch (r) {
                case 0:
                    if (0 === this.cx) break;
                    0 === e ? t(i.pop()) : t(i.shift()), this.cx--;
                    break;
                case 1:
                    if (0 === this.cy) break;
                    for (; n < this.cx; n++) 0 === e ? t(i[n].pop()) : t(i[n].shift());
                    this.cy--;
                    break;
                case 2:
                    if (0 === this.cz) break;
                    for (; n < this.cx; n++)
                        for (o = 0; o < this.cy; o++) 0 === e ? i[n][o].pop() : i[n][o].shift();
                    this.cz--;
            }
        }, n.prototype.Reverse = function(e) {
            var t = 0,
                r = 0,
                n = this.arr;
            if (0 !== this.cx && 0 !== this.cy && 0 !== this.cz) switch (e) {
                case 0:
                    n.reverse();
                    break;
                case 1:
                    for (; t < this.cx; t++) n[t].reverse();
                    break;
                case 2:
                    for (; t < this.cx; t++)
                        for (r = 0; r < this.cy; r++) n[t][r].reverse();
            }
        }, n.prototype.Sort = function(e) {
            var t = 0,
                r = 0,
                n = this.arr;
            if (0 !== this.cx && 0 !== this.cy && 0 !== this.cz) switch (e) {
                case 0:
                    n.sort(function(e, t) {
                        return o(e[0][0], t[0][0])
                    });
                    break;
                case 1:
                    for (; t < this.cx; t++) n[t].sort(function(e, t) {
                        return o(e[0], t[0])
                    });
                    break;
                case 2:
                    for (; t < this.cx; t++)
                        for (r = 0; r < this.cy; r++) n[t][r].sort(o);
            }
        }, n.prototype.Delete = function(e, r) {
            var n = 0,
                o = 0;
            e = i(e);
            var s = this.arr;
            if (!(0 > e)) switch (r) {
                case 0:
                    if (e >= this.cx) break;
                    t(s[e]), s.splice(e, 1), this.cx--;
                    break;
                case 1:
                    if (e >= this.cy) break;
                    for (; n < this.cx; n++) t(s[n][e]), s[n].splice(e, 1);
                    this.cy--;
                    break;
                case 2:
                    if (e >= this.cz) break;
                    for (; n < this.cx; n++)
                        for (o = 0; o < this.cy; o++) s[n][o].splice(e, 1);
                    this.cz--;
            }
        }, n.prototype.Insert = function(t, r, n) {
            var o = 0,
                s = 0,
                l = 0;
            r = i(r);
            var p = this.arr;
            if (!(0 > r)) switch (n) {
                case 0:
                    if (r > this.cx) return;
                    for (o = r, p.splice(o, 0, e()), p[o].length = this.cy; s < this.cy; s++)
                        for (p[o][s] = e(), p[o][s].length = this.cz, l = 0; l < this.cz; l++) p[o][s][l] = t;
                    this.cx++;
                    break;
                case 1:
                    if (r > this.cy) return;
                    for (; o < this.cx; o++)
                        for (s = r, p[o].splice(s, 0, e()), p[o][s].length = this.cz, l = 0; l < this.cz; l++) p[o][s][l] = t;
                    this.cy++;
                    break;
                case 2:
                    if (r > this.cz) return;
                    for (; o < this.cx; o++)
                        for (s = 0; s < this.cy; s++) p[o][s].splice(r, 0, t);
                    this.cz++;
            }
        }, n.prototype.JSONLoad = function(e) {
            var t;
            try {
                t = JSON.parse(e)
            } catch (t) {
                return
            }
            if (t.c2array) {
                var r = t.size;
                this.cx = r[0], this.cy = r[1], this.cz = r[2], this.arr = t.data
            }
        }, n.prototype.JSONDownload = function(e) {
            var t = document.createElement("a");
            if ("undefined" == typeof t.download) {
                var r = "data:text/html," + encodeURIComponent("<p><a download='" + e + "' href=\"data:application/json," + encodeURIComponent(this.getAsJSON()) + "\">Download link</a></p>");
                window.open(r)
            } else {
                var n = document.getElementsByTagName("body")[0];
                t.textContent = e, t.href = "data:application/json," + encodeURIComponent(this.getAsJSON()), t.download = e, n.appendChild(t), t.click(), n.removeChild(t)
            }
        }, s.acts = new n;
        a.prototype.At = function(e, t, r, n) {
            e.set_any(this.at(t, r || 0, n || 0))
        }, a.prototype.Width = function(e) {
            e.set_int(this.cx)
        }, a.prototype.Height = function(e) {
            e.set_int(this.cy)
        }, a.prototype.Depth = function(e) {
            e.set_int(this.cz)
        }, a.prototype.CurX = function(e) {
            e.set_int(this.getForX())
        }, a.prototype.CurY = function(e) {
            e.set_int(this.getForY())
        }, a.prototype.CurZ = function(e) {
            e.set_int(this.getForZ())
        }, a.prototype.CurValue = function(e) {
            e.set_any(this.at(this.getForX(), this.getForY(), this.getForZ()))
        }, a.prototype.Front = function(e) {
            e.set_any(this.at(0, 0, 0))
        }, a.prototype.Back = function(e) {
            e.set_any(this.at(this.cx - 1, 0, 0))
        }, a.prototype.IndexOf = function(e, t) {
            for (var r = 0; r < this.cx; r++)
                if (this.arr[r][0][0] === t) return void e.set_int(r);
            e.set_int(-1)
        }, a.prototype.LastIndexOf = function(e, t) {
            for (var r = this.cx - 1; 0 <= r; r--)
                if (this.arr[r][0][0] === t) return void e.set_int(r);
            e.set_int(-1)
        }, a.prototype.AsJSON = function(e) {
            e.set_string(this.getAsJSON())
        }, s.exps = new a
    }();
cr.plugins_.Spritefont2 = function(e) {
        this.runtime = e
    },
    function() {
        function e(e) {
            return e.replace(/\s\s*$/, "")
        }

        function t(e, t) {
            return e.length ? e.pop() : new t
        }

        function r(e, t) {
            e.length < 1000 && e.push(t)
        }

        function n(e, t, n) {
            if (n) {
                var a, o;
                for (a = 0, o = t.length; a < o; a++) r(e, t[a]);
                cr.clearArray(t)
            } else {
                for (var s in t) Object.prototype.hasOwnProperty.call(t, s) && (r(e, t[s]), delete t[s])
            }
        }

        function a(t, r, n) {
            var a = t.lines,
                i;
            n = e(n), r >= a.length && a.push(o()), i = a[r], i.text = n, i.width = t.measureWidth(n), t.textWidth = cr.max(t.textWidth, i.width)
        }

        function o() {
            return t(v, Object)
        }

        function s(e) {
            r(v, e)
        }

        function i(e) {
            n(v, e, !0)
        }

        function l(e, r, n, a, o, i) {
            e[r] === void 0 && (e[r] = t(S, Object)), e[r].x = n, e[r].y = a, e[r].w = o, e[r].h = i
        }

        function p(e) {
            n(S, e, !1)
        }

        function d(e, r, n, a, o, i) {
            e[r] === void 0 && (e[r] = t(w, cr.rect)), e[r].left = n, e[r].top = a, e[r].right = o, e[r].bottom = i
        }

        function c(e) {
            n(w, e, !1)
        }

        function u(e, t, r) {
            var n;
            n = e.tlx * t - e.tly * r, e.tly = e.tly * t + e.tlx * r, e.tlx = n, n = e.trx * t - e.try_ * r, e.try_ = e.try_ * t + e.trx * r, e.trx = n, n = e.blx * t - e.bly * r, e.bly = e.bly * t + e.blx * r, e.blx = n, n = e.brx * t - e.bry * r, e.bry = e.bry * t + e.brx * r, e.brx = n
        }

        function g() {}

        function y() {}

        function m() {}
        var _ = Math.round,
            h = Math.floor,
            f = cr.plugins_.Spritefont2.prototype;
        f.onCreate = function() {}, f.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var b = f.Type.prototype;
        b.onCreate = function() {
            this.is_family || (this.texture_img = this.runtime.findWaitingTexture(this.texture_file), !this.texture_img && (this.texture_img = new Image, this.texture_img.cr_src = this.texture_file, this.texture_img.cr_filesize = this.texture_filesize, this.texture_img.c2webGL_texture = null, this.runtime.waitForImageLoad(this.texture_img, this.texture_file)), this.spriteX = this.texture_data[3], this.spriteY = this.texture_data[4], this.spriteWidth = this.texture_data[5], this.spriteHeight = this.texture_data[6], this.webGL_texture = null)
        }, b.onLostWebGLContext = function() {
            this.is_family || (this.webGL_texture = null)
        }, b.onRestoreWebGLContext = function() {
            if (!this.is_family && this.instances.length) {
                this.webGL_texture || (this.webGL_texture = this.runtime.glwrap.loadTexture(this.texture_img, !1, this.runtime.linearSampling, this.texture_pixelformat));
                var e, t;
                for (e = 0, t = this.instances.length; e < t; e++) this.instances[e].webGL_texture = this.webGL_texture
            }
        }, b.unloadTextures = function() {
            this.is_family || this.instances.length || !this.webGL_texture || (this.runtime.glwrap.deleteTexture(this.webGL_texture), this.webGL_texture = null)
        }, b.preloadCanvas2D = function(e) {
            e.drawImage(this.texture_img, 0, 0)
        }, f.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var x = f.Instance.prototype;
        x.onDestroy = function() {
            i(this.lines), p(this.clipList), c(this.clipUV), cr.wipe(this.characterWidthList)
        }, x.onCreate = function() {
            this.texture_img = this.type.texture_img, this.text = this.properties[0], this.characterWidth = this.properties[2], this.characterHeight = this.properties[3], this.characterSet = this.properties[4];
            var e = this.properties[5];
            this.characterScale = this.properties[6], this.characterSpacing = this.properties[7], this.lineHeight = this.properties[8], this.halign = this.properties[9] / 2, this.valign = this.properties[10] / 2, this.wrapbyword = 0 === this.properties[11], this.visible = this.properties[12], this.textWidth = 0, this.textHeight = 0, this.recycled ? (cr.clearArray(this.lines), cr.wipe(this.clipList), cr.wipe(this.clipUV), cr.wipe(this.characterWidthList)) : (this.lines = [], this.clipList = {}, this.clipUV = {}, this.characterWidthList = {}), this.text_changed = !0, this.lastwrapwidth = this.width, this.runtime.glwrap && (!this.type.webGL_texture && (this.type.webGL_texture = this.runtime.glwrap.loadTexture(this.type.texture_img, !1, this.runtime.linearSampling, this.type.texture_pixelformat)), this.webGL_texture = this.type.webGL_texture), this.LoadCharacterSpacingData(e), this.SplitSheet()
        }, x.saveToJSON = function() {
            var e = {
                t: this.text,
                csc: this.characterScale,
                csp: this.characterSpacing,
                lh: this.lineHeight,
                tw: this.textWidth,
                th: this.textHeight,
                lrt: this.last_render_tick,
                ha: this.halign,
                va: this.valign,
                cw: {}
            };
            for (var t in this.characterWidthList) e.cw[t] = this.characterWidthList[t];
            return e
        }, x.loadFromJSON = function(e) {
            for (var t in this.text = e.t, this.characterScale = e.csc, this.characterSpacing = e.csp, this.lineHeight = e.lh, this.textWidth = e.tw, this.textHeight = e.th, this.last_render_tick = e.lrt, e.hasOwnProperty("ha") && (this.halign = e.ha), e.hasOwnProperty("va") && (this.valign = e.va), e.cw) this.characterWidthList[t] = e.cw[t];
            this.text_changed = !0, this.lastwrapwidth = this.width
        };
        var v = [],
            S = [],
            w = [];
        x.SplitSheet = function() {
            for (var e = this.texture_img, t = this.texture_img.width, r = this.texture_img.height, n = this.type.spriteWidth, a = this.type.spriteHeight, o = this.type.spriteX, i = this.type.spriteY, s = this.characterWidth, p = this.characterHeight, u = o / t, g = i / r, m = s / t, _ = p / r, f = this.characterSet, b = h(n / s), v = h(a / p), w = 0; w < f.length && !(w >= b * v); w++) {
                var S = w % b,
                    x = h(w / b),
                    y = f.charAt(w);
                this.runtime.glwrap ? d(this.clipUV, y, S * m + u, x * _ + g, (S + 1) * m + u, (x + 1) * _ + g) : l(this.clipList, y, S * s + o, x * p + i, s, p)
            }
        };
        var T = [];
        f.TokeniseWords = function(e) {
            cr.clearArray(T);
            for (var t = "", r = 0, n; r < e.length;)
                if (n = e.charAt(r), "\n" === n) t.length && (T.push(t), t = ""), T.push("\n"), ++r;
                else if (" " === n || "\t" === n || "-" === n) {
                do t += e.charAt(r), r++; while (r < e.length && (" " === e.charAt(r) || "\t" === e.charAt(r)));
                T.push(t), t = ""
            } else r < e.length && (t += n, r++);
            t.length && T.push(t)
        }, f.WordWrap = function(e) {
            var t = e.text,
                r = e.lines;
            if (!t || !t.length) return void i(r);
            var n = e.width;
            if (2 >= n) return void i(r);
            var a = e.characterWidth,
                s = e.characterScale,
                l = e.characterSpacing;
            if (t.length * (a * s + l) - l <= n && -1 === t.indexOf("\n")) {
                var p = e.measureWidth(t);
                if (p <= n) return i(r), r.push(o()), r[0].text = t, r[0].width = p, e.textWidth = p, void(e.textHeight = e.characterHeight * s + e.lineHeight)
            }
            e.wrapbyword;
            this.WrapText(e), e.textHeight = r.length * (e.characterHeight * s + e.lineHeight)
        }, f.WrapText = function(t) {
            var r = t.wrapbyword,
                n = t.text,
                o = t.lines,
                l = t.width,
                p;
            r ? (this.TokeniseWords(n), p = T) : p = n;
            var d = "",
                c = 0,
                u = !1,
                g, y, m;
            for (m = 0; m < p.length; m++) {
                if ("\n" === p[m]) {
                    !0 == u ? u = !1 : (a(t, c, d), c++), d = "";
                    continue
                }
                u = !1, g = d, d += p[m], y = t.measureWidth(e(d)), y > l && ("" === g ? (a(t, c, d), d = "", u = !0) : (a(t, c, g), d = p[m]), c++, !r && " " === d && (d = ""))
            }
            for (e(d).length && (a(t, c, d), c++), m = c; m < o.length; m++) s(o[m]);
            o.length = c
        }, x.measureWidth = function(e) {
            for (var t = this.characterSpacing, r = e.length, n = 0, a = 0; a < r; a++) n += this.getCharacterWidth(e.charAt(a)) * this.characterScale + t;
            return n -= 0 < n ? t : 0, n
        }, x.getCharacterWidth = function(e) {
            var t = this.characterWidthList;
            return void 0 === t[e] ? this.characterWidth : t[e]
        }, x.rebuildText = function() {
            (this.text_changed || this.width !== this.lastwrapwidth) && (this.textWidth = 0, this.textHeight = 0, this.type.plugin.WordWrap(this), this.text_changed = !1, this.lastwrapwidth = this.width)
        };
        var O = 1e-5;
        x.draw = function(e) {
            var t = this.texture_img;
            if ("" !== this.text && null != t) {
                if (this.rebuildText(), this.height < this.characterHeight * this.characterScale + this.lineHeight) return;
                e.globalAlpha = this.opacity;
                var r = this.x,
                    n = this.y;
                this.runtime.pixel_rounding && (r = _(r), n = _(n));
                var a = this.layer.viewLeft,
                    o = this.layer.viewTop,
                    s = this.layer.viewRight,
                    l = this.layer.viewBottom;
                e.save(), e.translate(r, n), e.rotate(this.angle);
                var p = this.angle,
                    d = this.halign,
                    c = this.valign,
                    u = this.characterScale,
                    g = this.characterHeight * u,
                    y = this.lineHeight,
                    m = this.characterSpacing,
                    h = this.lines,
                    f = this.textHeight,
                    b = c * cr.max(0, this.height - f),
                    x = -(this.hotspotX * this.width),
                    v = -(this.hotspotY * this.height),
                    w, S;
                v += b;
                for (var T = v, E = 0, C, A, P; E < h.length; E++) {
                    var L = h[E].text,
                        I = h[E].width;
                    if (S = d * cr.max(0, this.width - I), C = x + S, T += y, 0 === p && n + T + g < o) {
                        T += g;
                        continue
                    }
                    for (var R = 0, k; R < L.length; R++) {
                        k = L.charAt(R), w = this.getCharacterWidth(k);
                        var B = this.clipList[k];
                        if (0 === p && r + C + w * u + m < a) {
                            C += w * u + m;
                            continue
                        }
                        if (C + w * u > this.width + O) break;
                        if (void 0 !== B && (A = C, P = T, 0 === p && 1 === u && (A = _(A), P = _(P)), e.drawImage(this.texture_img, B.x, B.y, B.w, B.h, A, P, B.w * u, B.h * u)), C += w * u + m, 0 === p && r + C > s) break
                    }
                    if (T += g, 0 === p && (T + g + y > this.height || n + T > l)) break
                }
                e.restore()
            }
        };
        var E = new cr.quad;
        x.drawGL = function(e) {
            if ((e.setTexture(this.webGL_texture), e.setOpacity(this.opacity), !!this.text) && (this.rebuildText(), !(this.height < this.characterHeight * this.characterScale + this.lineHeight))) {
                this.update_bbox();
                var t = this.bquad,
                    r = 0,
                    n = 0;
                this.runtime.pixel_rounding && (r = _(this.x) - this.x, n = _(this.y) - this.y);
                var a = this.layer.viewLeft,
                    o = this.layer.viewTop,
                    s = this.layer.viewRight,
                    l = this.layer.viewBottom,
                    p = this.angle,
                    d = this.halign,
                    c = this.valign,
                    g = this.characterScale,
                    y = this.characterHeight * g,
                    m = this.lineHeight,
                    h = this.characterSpacing,
                    f = this.lines,
                    b = this.textHeight,
                    x, v, w;
                0 !== p && (v = Math.cos(p), w = Math.sin(p));
                for (var S = c * cr.max(0, this.height - b), T = t.tlx + r, C = t.tly + n, A = S, P = 0, L, I, R, k; P < f.length; P++) {
                    var B = f[P].text,
                        F = f[P].width;
                    if (L = d * cr.max(0, this.width - F), I = L, A += m, 0 === p && C + A + y < o) {
                        A += y;
                        continue
                    }
                    for (var N = 0, D; N < B.length; N++) {
                        D = B.charAt(N), x = this.getCharacterWidth(D);
                        var M = this.clipUV[D];
                        if (0 === p && T + I + x * g + h < a) {
                            I += x * g + h;
                            continue
                        }
                        if (I + x * g > this.width + O) break;
                        if (void 0 !== M) {
                            var z = this.characterWidth * g,
                                G = this.characterHeight * g;
                            R = I, k = A, 0 === p && 1 === g && (R = _(R), k = _(k)), E.tlx = R, E.tly = k, E.trx = R + z, E.try_ = k, E.blx = R, E.bly = k + G, E.brx = R + z, E.bry = k + G, 0 !== p && u(E, v, w), E.offset(T, C), e.quadTex(E.tlx, E.tly, E.trx, E.try_, E.brx, E.bry, E.blx, E.bly, M)
                        }
                        if (I += x * g + h, 0 === p && T + I > s) break
                    }
                    if (A += y, 0 === p && (A + y + m > this.height || C + A > l)) break
                }
            }
        }, g.prototype.CompareText = function(e, t) {
            return t ? this.text == e : cr.equals_nocase(this.text, e)
        }, f.cnds = new g, y.prototype.SetText = function(e) {
            cr.is_number(e) && 1e9 > e && (e = _(1e10 * e) / 1e10);
            var t = e.toString();
            this.text !== t && (this.text = t, this.text_changed = !0, this.runtime.redraw = !0)
        }, y.prototype.AppendText = function(e) {
            cr.is_number(e) && (e = _(1e10 * e) / 1e10);
            var t = e.toString();
            t && (this.text += t, this.text_changed = !0, this.runtime.redraw = !0)
        }, y.prototype.SetScale = function(e) {
            e !== this.characterScale && (this.characterScale = e, this.text_changed = !0, this.runtime.redraw = !0)
        }, y.prototype.SetCharacterSpacing = function(e) {
            e !== this.CharacterSpacing && (this.characterSpacing = e, this.text_changed = !0, this.runtime.redraw = !0)
        }, y.prototype.SetLineHeight = function(e) {
            e !== this.lineHeight && (this.lineHeight = e, this.text_changed = !0, this.runtime.redraw = !0)
        }, x.SetCharWidth = function(e, t) {
            var r = parseInt(t, 10);
            this.characterWidthList[e] !== r && (this.characterWidthList[e] = r, this.text_changed = !0, this.runtime.redraw = !0)
        }, x.LoadCharacterSpacingData = function(e) {
            var t, r, n, a, o, s, l, p;
            if (e) {
                try {
                    t = JSON.parse(e)
                } catch (t) {
                    return
                }
                if (Array.isArray(t))
                    for (r = 0, n = t.length; r < n; ++r)
                        if (a = t[r], Array.isArray(a) && 2 === a.length && "number" == typeof a[0] && "string" == typeof a[1])
                            for (o = a[0], s = a[1], (l = 0, p = s.length); l < p; ++l) this.SetCharWidth(s.charAt(l), o)
            }
        }, y.prototype.SetCharacterWidth = function(e, t) {
            if ("" !== e)
                for (var r = 0; r < e.length; r++) this.SetCharWidth(e.charAt(r), t)
        }, y.prototype.SetEffect = function(e) {
            this.blend_mode = e, this.compositeOp = cr.effectToCompositeOp(e), cr.setGLBlend(this, e, this.runtime.gl), this.runtime.redraw = !0
        }, y.prototype.SetHAlign = function(e) {
            this.halign = e / 2, this.text_changed = !0, this.runtime.redraw = !0
        }, y.prototype.SetVAlign = function(e) {
            this.valign = e / 2, this.text_changed = !0, this.runtime.redraw = !0
        }, f.acts = new y, m.prototype.CharacterWidth = function(e, t) {
            e.set_int(this.getCharacterWidth(t))
        }, m.prototype.CharacterHeight = function(e) {
            e.set_int(this.characterHeight)
        }, m.prototype.CharacterScale = function(e) {
            e.set_float(this.characterScale)
        }, m.prototype.CharacterSpacing = function(e) {
            e.set_int(this.characterSpacing)
        }, m.prototype.LineHeight = function(e) {
            e.set_int(this.lineHeight)
        }, m.prototype.Text = function(e) {
            e.set_string(this.text)
        }, m.prototype.TextWidth = function(e) {
            this.rebuildText(), e.set_float(this.textWidth)
        }, m.prototype.TextHeight = function(e) {
            this.rebuildText(), e.set_float(this.textHeight)
        }, f.exps = new m
    }();
cr.plugins_.Particles = function(e) {
        this.runtime = e
    },
    function() {
        function e(e) {
            this.owner = e, this.active = !1, this.x = 0, this.y = 0, this.speed = 0, this.angle = 0, this.opacity = 1, this.grow = 0, this.size = 0, this.gs = 0, this.age = 0, cr.seal(this)
        }

        function t() {}

        function r() {}

        function n() {}
        var a = cr.plugins_.Particles.prototype;
        a.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var o = a.Type.prototype;
        o.onCreate = function() {
            this.is_family || (this.texture_img = this.runtime.findWaitingTexture(this.texture_file), !this.texture_img && (this.texture_img = new Image, this.texture_img.cr_src = this.texture_file, this.texture_img.cr_filesize = this.texture_filesize, this.texture_img.c2webGL_texture = null, this.runtime.waitForImageLoad(this.texture_img, this.texture_file)), this.spriteX = this.texture_data[3], this.spriteY = this.texture_data[4], this.spriteWidth = this.texture_data[5], this.spriteHeight = this.texture_data[6])
        }, o.onLostWebGLContext = function() {
            this.is_family || (this.webGL_texture = null)
        }, o.createParticleTexture = function() {
            var e = document.createElement("canvas"),
                t = this.spriteWidth,
                r = this.spriteHeight;
            e.width = t, e.height = r;
            var n = e.getContext("2d");
            n.drawImage(this.texture_img, this.spriteX, this.spriteY, t, r, 0, 0, t, r), this.webGL_texture = this.runtime.glwrap.loadTexture(e, !0, this.runtime.linearSampling, this.texture_pixelformat)
        }, o.onRestoreWebGLContext = function() {
            !this.is_family && this.instances.length && (this.webGL_texture || this.createParticleTexture())
        }, o.loadTextures = function() {
            this.is_family || this.webGL_texture || !this.runtime.glwrap || this.createParticleTexture()
        }, o.unloadTextures = function() {
            this.is_family || this.instances.length || !this.webGL_texture || (this.runtime.glwrap.deleteTexture(this.webGL_texture), this.webGL_texture = null)
        }, o.preloadCanvas2D = function(e) {
            e.drawImage(this.texture_img, 0, 0)
        };
        e.prototype.init = function() {
            var e = this.owner;
            this.x = e.x - e.xrandom / 2 + Math.random() * e.xrandom, this.y = e.y - e.yrandom / 2 + Math.random() * e.yrandom, this.speed = e.initspeed - e.speedrandom / 2 + Math.random() * e.speedrandom, this.angle = e.angle - e.spraycone / 2 + Math.random() * e.spraycone, this.opacity = e.initopacity, this.size = e.initsize - e.sizerandom / 2 + Math.random() * e.sizerandom, this.grow = e.growrate - e.growrandom / 2 + Math.random() * e.growrandom, this.gs = 0, this.age = 0
        }, e.prototype.tick = function(e) {
            var t = this.owner;
            return this.x += Math.cos(this.angle) * this.speed * e, this.y += Math.sin(this.angle) * this.speed * e, this.y += this.gs * e, this.speed += t.acc * e, this.size += this.grow * e, this.gs += t.g * e, this.age += e, 1 > this.size ? void(this.active = !1) : void(0 !== t.lifeanglerandom && (this.angle += Math.random() * t.lifeanglerandom * e - t.lifeanglerandom * e / 2), 0 !== t.lifespeedrandom && (this.speed += Math.random() * t.lifespeedrandom * e - t.lifespeedrandom * e / 2), 0 !== t.lifeopacityrandom && (this.opacity += Math.random() * t.lifeopacityrandom * e - t.lifeopacityrandom * e / 2, 0 > this.opacity ? this.opacity = 0 : 1 < this.opacity && (this.opacity = 1)), 1 >= t.destroymode && this.age >= t.timeout && (this.active = !1), 2 === t.destroymode && 0 >= this.speed && (this.active = !1))
        }, e.prototype.draw = function(e) {
            var t = this.owner.opacity * this.opacity;
            if (0 != t) {
                0 === this.owner.destroymode && (t *= 1 - this.age / this.owner.timeout), e.globalAlpha = t;
                var r = this.x - this.size / 2,
                    n = this.y - this.size / 2;
                this.owner.runtime.pixel_rounding && (r = 0 | r + .5, n = 0 | n + .5);
                var a = this.owner.type;
                e.drawImage(a.texture_img, a.spriteX, a.spriteY, a.spriteWidth, a.spriteHeight, r, n, this.size, this.size)
            }
        }, e.prototype.drawGL = function(e) {
            var t = this.owner.opacity * this.opacity;
            0 === this.owner.destroymode && (t *= 1 - this.age / this.owner.timeout);
            var r = this.size,
                n = r * this.owner.particlescale,
                a = this.x - r / 2,
                o = this.y - r / 2;
            this.owner.runtime.pixel_rounding && (a = 0 | a + .5, o = 0 | o + .5);
            1 > n || 0 == t || (n < e.minPointSize || n > e.maxPointSize ? (e.setOpacity(t), e.quad(a, o, a + r, o, a + r, o + r, a, o + r)) : e.point(this.x, this.y, n, t))
        }, e.prototype.left = function() {
            return this.x - this.size / 2
        }, e.prototype.right = function() {
            return this.x + this.size / 2
        }, e.prototype.top = function() {
            return this.y - this.size / 2
        }, e.prototype.bottom = function() {
            return this.y + this.size / 2
        }, a.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var i = a.Instance.prototype,
            s = [];
        i.onCreate = function() {
            var e = this.properties;
            if (this.rate = e[0], this.spraycone = cr.to_radians(e[1]), this.spraytype = e[2], this.spraying = !0, this.initspeed = e[4], this.initsize = e[5], this.initopacity = e[6] / 100, this.growrate = e[7], this.xrandom = e[8], this.yrandom = e[9], this.speedrandom = e[10], this.sizerandom = e[11], this.growrandom = e[12], this.acc = e[13], this.g = e[14], this.lifeanglerandom = e[15], this.lifespeedrandom = e[16], this.lifeopacityrandom = e[17], this.destroymode = e[18], this.timeout = e[19], this.particleCreateCounter = 0, this.particlescale = 1, this.particleBoxLeft = this.x, this.particleBoxTop = this.y, this.particleBoxRight = this.x, this.particleBoxBottom = this.y, this.add_bbox_changed_callback(function(e) {
                    e.bbox.set(e.particleBoxLeft, e.particleBoxTop, e.particleBoxRight, e.particleBoxBottom), e.bquad.set_from_rect(e.bbox), e.bbox_changed = !1, e.update_collision_cell(), e.update_render_cell()
                }), this.recycled || (this.particles = []), this.runtime.tickMe(this), this.type.loadTextures(), 1 === this.spraytype)
                for (var t = 0; t < this.rate; t++) this.allocateParticle().opacity = 0;
            this.first_tick = !0
        }, i.saveToJSON = function() {
            var e = {
                    r: this.rate,
                    sc: this.spraycone,
                    st: this.spraytype,
                    s: this.spraying,
                    isp: this.initspeed,
                    isz: this.initsize,
                    io: this.initopacity,
                    gr: this.growrate,
                    xr: this.xrandom,
                    yr: this.yrandom,
                    spr: this.speedrandom,
                    szr: this.sizerandom,
                    grnd: this.growrandom,
                    acc: this.acc,
                    g: this.g,
                    lar: this.lifeanglerandom,
                    lsr: this.lifespeedrandom,
                    lor: this.lifeopacityrandom,
                    dm: this.destroymode,
                    to: this.timeout,
                    pcc: this.particleCreateCounter,
                    ft: this.first_tick,
                    p: []
                },
                t = e.p,
                r, n, a;
            for (r = 0, n = this.particles.length; r < n; r++) a = this.particles[r], t.push([a.x, a.y, a.speed, a.angle, a.opacity, a.grow, a.size, a.gs, a.age]);
            return e
        }, i.loadFromJSON = function(e) {
            this.rate = e.r, this.spraycone = e.sc, this.spraytype = e.st, this.spraying = e.s, this.initspeed = e.isp, this.initsize = e.isz, this.initopacity = e.io, this.growrate = e.gr, this.xrandom = e.xr, this.yrandom = e.yr, this.speedrandom = e.spr, this.sizerandom = e.szr, this.growrandom = e.grnd, this.acc = e.acc, this.g = e.g, this.lifeanglerandom = e.lar, this.lifespeedrandom = e.lsr, this.lifeopacityrandom = e.lor, this.destroymode = e.dm, this.timeout = e.to, this.particleCreateCounter = e.pcc, this.first_tick = e.ft, s.push.apply(s, this.particles), cr.clearArray(this.particles);
            var t = e.p,
                r, n, a, o;
            for (r = 0, n = t.length; r < n; r++) a = this.allocateParticle(), o = t[r], a.x = o[0], a.y = o[1], a.speed = o[2], a.angle = o[3], a.opacity = o[4], a.grow = o[5], a.size = o[6], a.gs = o[7], a.age = o[8]
        }, i.onDestroy = function() {
            s.push.apply(s, this.particles), cr.clearArray(this.particles)
        }, i.allocateParticle = function() {
            var t;
            return s.length ? (t = s.pop(), t.owner = this) : t = new e(this), this.particles.push(t), t.active = !0, t
        }, i.tick = function() {
            var e = this.runtime.getDt(this),
                t, r, a, o, l;
            if (0 === this.spraytype && this.spraying)
                for (this.particleCreateCounter += e * this.rate, o = cr.floor(this.particleCreateCounter), this.particleCreateCounter -= o, t = 0; t < o; t++) a = this.allocateParticle(), a.init();
            for (this.particleBoxLeft = this.x, this.particleBoxTop = this.y, this.particleBoxRight = this.x, this.particleBoxBottom = this.y, (t = 0, l = 0, r = this.particles.length); t < r; t++) {
                if (a = this.particles[t], this.particles[l] = a, this.runtime.redraw = !0, 1 === this.spraytype && this.first_tick && a.init(), a.tick(e), !a.active) {
                    s.push(a);
                    continue
                }
                a.left() < this.particleBoxLeft && (this.particleBoxLeft = a.left()), a.right() > this.particleBoxRight && (this.particleBoxRight = a.right()), a.top() < this.particleBoxTop && (this.particleBoxTop = a.top()), a.bottom() > this.particleBoxBottom && (this.particleBoxBottom = a.bottom()), l++
            }
            cr.truncateArray(this.particles, l), this.set_bbox_changed(), this.first_tick = !1, 1 === this.spraytype && 0 === this.particles.length && this.runtime.DestroyInstance(this)
        }, i.draw = function(e) {
            var t = this.layer,
                r, n, a;
            for (r = 0, n = this.particles.length; r < n; r++) a = this.particles[r], a.right() >= t.viewLeft && a.bottom() >= t.viewTop && a.left() <= t.viewRight && a.top() <= t.viewBottom && a.draw(e)
        }, i.drawGL = function(e) {
            this.particlescale = this.layer.getScale(), e.setTexture(this.type.webGL_texture);
            var t = this.layer,
                r, n, a;
            for (r = 0, n = this.particles.length; r < n; r++) a = this.particles[r], a.right() >= t.viewLeft && a.bottom() >= t.viewTop && a.left() <= t.viewRight && a.top() <= t.viewBottom && a.drawGL(e)
        };
        t.prototype.IsSpraying = function() {
            return this.spraying
        }, a.cnds = new t;
        r.prototype.SetSpraying = function(e) {
            this.spraying = 0 !== e
        }, r.prototype.SetEffect = function(e) {
            this.blend_mode = e, this.compositeOp = cr.effectToCompositeOp(e), cr.setGLBlend(this, e, this.runtime.gl), this.runtime.redraw = !0
        }, r.prototype.SetRate = function(e) {
            this.rate = e;
            var t, r;
            if (1 === this.spraytype && this.first_tick)
                if (e < this.particles.length)
                    for (t = this.particles.length - e, r = 0; r < t; r++) s.push(this.particles.pop());
                else if (e > this.particles.length)
                for (t = e - this.particles.length, r = 0; r < t; r++) this.allocateParticle().opacity = 0
        }, r.prototype.SetSprayCone = function(e) {
            this.spraycone = cr.to_radians(e)
        }, r.prototype.SetInitSpeed = function(e) {
            this.initspeed = e
        }, r.prototype.SetInitSize = function(e) {
            this.initsize = e
        }, r.prototype.SetInitOpacity = function(e) {
            this.initopacity = e / 100
        }, r.prototype.SetGrowRate = function(e) {
            this.growrate = e
        }, r.prototype.SetXRandomiser = function(e) {
            this.xrandom = e
        }, r.prototype.SetYRandomiser = function(e) {
            this.yrandom = e
        }, r.prototype.SetSpeedRandomiser = function(e) {
            this.speedrandom = e
        }, r.prototype.SetSizeRandomiser = function(e) {
            this.sizerandom = e
        }, r.prototype.SetGrowRateRandomiser = function(e) {
            this.growrandom = e
        }, r.prototype.SetParticleAcc = function(e) {
            this.acc = e
        }, r.prototype.SetGravity = function(e) {
            this.g = e
        }, r.prototype.SetAngleRandomiser = function(e) {
            this.lifeanglerandom = e
        }, r.prototype.SetLifeSpeedRandomiser = function(e) {
            this.lifespeedrandom = e
        }, r.prototype.SetOpacityRandomiser = function(e) {
            this.lifeopacityrandom = e
        }, r.prototype.SetTimeout = function(e) {
            this.timeout = e
        }, a.acts = new r;
        n.prototype.ParticleCount = function(e) {
            e.set_int(this.particles.length)
        }, n.prototype.Rate = function(e) {
            e.set_float(this.rate)
        }, n.prototype.SprayCone = function(e) {
            e.set_float(cr.to_degrees(this.spraycone))
        }, n.prototype.InitSpeed = function(e) {
            e.set_float(this.initspeed)
        }, n.prototype.InitSize = function(e) {
            e.set_float(this.initsize)
        }, n.prototype.InitOpacity = function(e) {
            e.set_float(100 * this.initopacity)
        }, n.prototype.InitGrowRate = function(e) {
            e.set_float(this.growrate)
        }, n.prototype.XRandom = function(e) {
            e.set_float(this.xrandom)
        }, n.prototype.YRandom = function(e) {
            e.set_float(this.yrandom)
        }, n.prototype.InitSpeedRandom = function(e) {
            e.set_float(this.speedrandom)
        }, n.prototype.InitSizeRandom = function(e) {
            e.set_float(this.sizerandom)
        }, n.prototype.InitGrowRandom = function(e) {
            e.set_float(this.growrandom)
        }, n.prototype.ParticleAcceleration = function(e) {
            e.set_float(this.acc)
        }, n.prototype.Gravity = function(e) {
            e.set_float(this.g)
        }, n.prototype.ParticleAngleRandom = function(e) {
            e.set_float(this.lifeanglerandom)
        }, n.prototype.ParticleSpeedRandom = function(e) {
            e.set_float(this.lifespeedrandom)
        }, n.prototype.ParticleOpacityRandom = function(e) {
            e.set_float(this.lifeopacityrandom)
        }, n.prototype.Timeout = function(e) {
            e.set_float(this.timeout)
        }, a.exps = new n
    }();
var localForageInitFailed = !1;
try {
    ! function(e) {
        if ("object" == typeof exports && "undefined" != typeof module) module.exports = e();
        else if ("function" == typeof define && define.amd) define([], e);
        else {
            var t;
            t = "undefined" == typeof window ? "undefined" == typeof global ? "undefined" == typeof self ? this : self : global : window, t.localforage = e()
        }
    }(function() {
        return function t(r, n, a) {
            function o(s, l) {
                if (!n[s]) {
                    if (!r[s]) {
                        var p = "function" == typeof require && require;
                        if (!l && p) return p(s, !0);
                        if (e) return e(s, !0);
                        var i = new Error("Cannot find module '" + s + "'");
                        throw i.code = "MODULE_NOT_FOUND", i
                    }
                    var d = n[s] = {
                        exports: {}
                    };
                    r[s][0].call(d.exports, function(e) {
                        var t = r[s][1][e];
                        return o(t ? t : e)
                    }, d, d.exports, t, r, n, a)
                }
                return n[s].exports
            }
            for (var e = "function" == typeof require && require, i = 0; i < a.length; i++) o(a[i]);
            return o
        }({
            1: [function(e, a) {
                "use strict";

                function c(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }

                function d() {
                    try {
                        return "undefined" != typeof localStorage && "setItem" in localStorage && localStorage.setItem
                    } catch (e) {
                        return !1
                    }
                }

                function g(t, r) {
                    t = t || [], r = r || {};
                    try {
                        return new Blob(t, r)
                    } catch (a) {
                        if ("TypeError" !== a.name) throw a;
                        for (var n = "undefined" == typeof BlobBuilder ? "undefined" == typeof MSBlobBuilder ? "undefined" == typeof MozBlobBuilder ? WebKitBlobBuilder : MozBlobBuilder : MSBlobBuilder : BlobBuilder, o = new n, e = 0; e < t.length; e += 1) o.append(t[e]);
                        return o.getBlob(r.type)
                    }
                }

                function i(e, t) {
                    t && e.then(function(e) {
                        t(null, e)
                    }, function(e) {
                        t(e)
                    })
                }

                function _(e, t, r) {
                    "function" == typeof t && e.then(t), "function" == typeof r && e["catch"](r)
                }

                function h(t) {
                    for (var r = t.length, n = new ArrayBuffer(r), a = new Uint8Array(n), o = 0; r > o; o++) a[o] = t.charCodeAt(o);
                    return n
                }

                function l(e) {
                    return new P(function(t) {
                        var r = e.transaction(L, "readwrite"),
                            n = g([""]);
                        r.objectStore(L).put(n, "key"), r.onabort = function(e) {
                            e.preventDefault(), e.stopPropagation(), t(!1)
                        }, r.oncomplete = function() {
                            var e = navigator.userAgent.match(/Chrome\/(\d+)/),
                                r = navigator.userAgent.match(/Edge\//);
                            t(r || !e || 43 <= parseInt(e[1], 10))
                        }
                    })["catch"](function() {
                        return !1
                    })
                }

                function m(e) {
                    return "boolean" == typeof oe ? P.resolve(oe) : l(e).then(function(e) {
                        return oe = e
                    })
                }

                function n(e) {
                    var t = ie[e.name],
                        r = {};
                    r.promise = new P(function(e) {
                        r.resolve = e
                    }), t.deferredOperations.push(r), t.dbReady = t.dbReady ? t.dbReady.then(function() {
                        return r.promise
                    }) : r.promise
                }

                function o(e) {
                    var t = ie[e.name],
                        r = t.deferredOperations.pop();
                    r && r.resolve()
                }

                function p(t, r) {
                    return new P(function(a, i) {
                        if (t.db) {
                            if (!r) return a(t.db);
                            n(t), t.db.close()
                        }
                        var s = [t.name];
                        r && s.push(t.version);
                        var e = A.open.apply(A, s);
                        r && (e.onupgradeneeded = function(r) {
                            var n = e.result;
                            try {
                                n.createObjectStore(t.storeName), 1 >= r.oldVersion && n.createObjectStore(L)
                            } catch (e) {
                                if ("ConstraintError" !== e.name) throw e;
                                console.warn("The database \"" + t.name + "\" has been upgraded from version " + r.oldVersion + " to version " + r.newVersion + ", but the storage \"" + t.storeName + "\" already exists.")
                            }
                        }), e.onerror = function(t) {
                            t.preventDefault(), i(e.error)
                        }, e.onsuccess = function() {
                            a(e.result), o(t)
                        }
                    })
                }

                function b(e) {
                    return p(e, !1)
                }

                function r(e) {
                    return p(e, !0)
                }

                function s(t, r) {
                    if (!t.db) return !0;
                    var n = !t.db.objectStoreNames.contains(t.storeName),
                        a = t.version < t.db.version,
                        o = t.version > t.db.version;
                    if (a && (t.version !== r && console.warn("The database \"" + t.name + "\" can't be downgraded from version " + t.db.version + " to version " + t.version + "."), t.version = t.db.version), o || n) {
                        if (n) {
                            var e = t.db.version + 1;
                            e > t.version && (t.version = e)
                        }
                        return !0
                    }
                    return !1
                }

                function t(e) {
                    return new P(function(t, r) {
                        var n = new FileReader;
                        n.onerror = r, n.onloadend = function(r) {
                            var n = btoa(r.target.result || "");
                            t({
                                __local_forage_encoded_blob: !0,
                                data: n,
                                type: e.type
                            })
                        }, n.readAsBinaryString(e)
                    })
                }

                function u(e) {
                    var t = h(atob(e.data));
                    return g([t], {
                        type: e.type
                    })
                }

                function f(e) {
                    return e && e.__local_forage_encoded_blob
                }

                function v(e) {
                    var t = this,
                        r = t._initReady().then(function() {
                            var e = ie[t._dbInfo.name];
                            return e && e.dbReady ? e.dbReady : void 0
                        });
                    return _(r, e, e), r
                }

                function x(t) {
                    function n() {
                        return P.resolve()
                    }
                    var o = this,
                        l = {
                            db: null
                        };
                    if (t)
                        for (var a in t) l[a] = t[a];
                    ie || (ie = {});
                    var p = ie[l.name];
                    p || (p = {
                        forages: [],
                        db: null,
                        dbReady: null,
                        deferredOperations: []
                    }, ie[l.name] = p), p.forages.push(o), o._initReady || (o._initReady = o.ready, o.ready = v);
                    for (var e = [], d = 0, c; d < p.forages.length; d++) c = p.forages[d], c !== o && e.push(c._initReady()["catch"](n));
                    var u = p.forages.slice(0);
                    return P.all(e).then(function() {
                        return l.db = p.db, b(l)
                    }).then(function(e) {
                        return l.db = e, s(l, o._defaultConfig.version) ? r(l) : e
                    }).then(function(t) {
                        l.db = p.db = t, o._dbInfo = l;
                        for (var r = 0, n; r < u.length; r++) n = u[r], n !== o && (n._dbInfo.db = l.db, n._dbInfo.version = l.version)
                    })
                }

                function y(t) {
                    var r = .75 * t.length,
                        n = t.length,
                        a = 0,
                        o, s, l, p, u;
                    "=" === t[t.length - 1] && (r--, "=" === t[t.length - 2] && r--);
                    var y = new ArrayBuffer(r),
                        m = new Uint8Array(y);
                    for (o = 0; n > o; o += 4) s = B.indexOf(t[o]), l = B.indexOf(t[o + 1]), p = B.indexOf(t[o + 2]), u = B.indexOf(t[o + 3]), m[a++] = s << 2 | l >> 4, m[a++] = (15 & l) << 4 | p >> 2, m[a++] = (3 & p) << 6 | 63 & u;
                    return y
                }

                function w(e) {
                    var t = new Uint8Array(e),
                        r = "",
                        n;
                    for (n = 0; n < t.length; n += 3) r += B[t[n] >> 2], r += B[(3 & t[n]) << 4 | t[n + 1] >> 4], r += B[(15 & t[n + 1]) << 2 | t[n + 2] >> 6], r += B[63 & t[n + 2]];
                    return 2 == t.length % 3 ? r = r.substring(0, r.length - 1) + "=" : 1 == t.length % 3 && (r = r.substring(0, r.length - 2) + "=="), r
                }

                function S(t, r, n, o) {
                    var s = this;
                    "string" != typeof t && (console.warn(t + " used as a key, but it is not a string."), t = t + "");
                    var e = new P(function(e, l) {
                        s.ready().then(function() {
                            void 0 === r && (r = null);
                            var a = r,
                                p = s._dbInfo;
                            p.serializer.serialize(r, function(r, i) {
                                i ? l(i) : p.db.transaction(function(n) {
                                    n.executeSql("INSERT OR REPLACE INTO " + p.storeName + " (key, value) VALUES (?, ?)", [t, r], function() {
                                        e(a)
                                    }, function(e, t) {
                                        l(t)
                                    })
                                }, function(r) {
                                    if (r.code === r.QUOTA_ERR) {
                                        if (0 < o) return void e(S.apply(s, [t, a, n, o - 1]));
                                        l(r)
                                    }
                                })
                            })
                        })["catch"](l)
                    });
                    return i(e, n), e
                }

                function T(e, t) {
                    e[t] = function() {
                        var r = arguments;
                        return e.ready().then(function() {
                            return e[t].apply(e, r)
                        })
                    }
                }

                function O() {
                    for (var e = 1, t; e < arguments.length; e++)
                        if (t = arguments[e], t)
                            for (var r in t) t.hasOwnProperty(r) && (se(t[r]) ? arguments[0][r] = t[r].slice() : arguments[0][r] = t[r]);
                    return arguments[0]
                }

                function E(e) {
                    for (var t in ee)
                        if (ee.hasOwnProperty(t) && ee[t] === e) return !0;
                    return !1
                }
                var C = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    } : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol ? "symbol" : typeof e
                    },
                    A = function() {
                        try {
                            if ("undefined" != typeof indexedDB) return indexedDB;
                            if ("undefined" != typeof webkitIndexedDB) return webkitIndexedDB;
                            if ("undefined" != typeof mozIndexedDB) return mozIndexedDB;
                            if ("undefined" != typeof OIndexedDB) return OIndexedDB;
                            if ("undefined" != typeof msIndexedDB) return msIndexedDB
                        } catch (e) {}
                    }();
                "undefined" == typeof Promise && e("lie/polyfill");
                var P = Promise,
                    L = "local-forage-detect-blob-support",
                    I = Object.prototype.toString,
                    R = {
                        _driver: "asyncStorage",
                        _initStorage: x,
                        iterate: function(t, e) {
                            var r = this,
                                n = new P(function(n, e) {
                                    r.ready().then(function() {
                                        var a = r._dbInfo,
                                            o = a.db.transaction(a.storeName, "readonly").objectStore(a.storeName),
                                            i = o.openCursor(),
                                            s = 1;
                                        i.onsuccess = function() {
                                            var r = i.result;
                                            if (r) {
                                                var a = r.value;
                                                f(a) && (a = u(a));
                                                var o = t(a, r.key, s++);
                                                void 0 === o ? r["continue"]() : n(o)
                                            } else n()
                                        }, i.onerror = function() {
                                            e(i.error)
                                        }
                                    })["catch"](e)
                                });
                            return i(n, e), n
                        },
                        getItem: function(t, e) {
                            var r = this;
                            "string" != typeof t && (console.warn(t + " used as a key, but it is not a string."), t = t + "");
                            var n = new P(function(e, n) {
                                r.ready().then(function() {
                                    var a = r._dbInfo,
                                        o = a.db.transaction(a.storeName, "readonly").objectStore(a.storeName),
                                        i = o.get(t);
                                    i.onsuccess = function() {
                                        var t = i.result;
                                        void 0 === t && (t = null), f(t) && (t = u(t)), e(t)
                                    }, i.onerror = function() {
                                        n(i.error)
                                    }
                                })["catch"](n)
                            });
                            return i(n, e), n
                        },
                        setItem: function(r, n, o) {
                            var s = this;
                            "string" != typeof r && (console.warn(r + " used as a key, but it is not a string."), r = r + "");
                            var l = new P(function(a, o) {
                                var e;
                                s.ready().then(function() {
                                    return e = s._dbInfo, "[object Blob]" === I.call(n) ? m(e.db).then(function(e) {
                                        return e ? n : t(n)
                                    }) : n
                                }).then(function(t) {
                                    var n = e.db.transaction(e.storeName, "readwrite"),
                                        i = n.objectStore(e.storeName),
                                        s = i.put(t, r);
                                    null === t && (t = void 0), n.oncomplete = function() {
                                        void 0 === t && (t = null), a(t)
                                    }, n.onabort = n.onerror = function() {
                                        var e = s.error ? s.error : s.transaction.error;
                                        o(e)
                                    }
                                })["catch"](o)
                            });
                            return i(l, o), l
                        },
                        removeItem: function(t, e) {
                            var r = this;
                            "string" != typeof t && (console.warn(t + " used as a key, but it is not a string."), t = t + "");
                            var n = new P(function(e, n) {
                                r.ready().then(function() {
                                    var a = r._dbInfo,
                                        o = a.db.transaction(a.storeName, "readwrite"),
                                        i = o.objectStore(a.storeName),
                                        s = i["delete"](t);
                                    o.oncomplete = function() {
                                        e()
                                    }, o.onerror = function() {
                                        n(s.error)
                                    }, o.onabort = function() {
                                        var e = s.error ? s.error : s.transaction.error;
                                        n(e)
                                    }
                                })["catch"](n)
                            });
                            return i(n, e), n
                        },
                        clear: function(e) {
                            var t = this,
                                r = new P(function(e, r) {
                                    t.ready().then(function() {
                                        var n = t._dbInfo,
                                            a = n.db.transaction(n.storeName, "readwrite"),
                                            o = a.objectStore(n.storeName),
                                            i = o.clear();
                                        a.oncomplete = function() {
                                            e()
                                        }, a.onabort = a.onerror = function() {
                                            var e = i.error ? i.error : i.transaction.error;
                                            r(e)
                                        }
                                    })["catch"](r)
                                });
                            return i(r, e), r
                        },
                        length: function(e) {
                            var t = this,
                                r = new P(function(e, r) {
                                    t.ready().then(function() {
                                        var n = t._dbInfo,
                                            a = n.db.transaction(n.storeName, "readonly").objectStore(n.storeName),
                                            o = a.count();
                                        o.onsuccess = function() {
                                            e(o.result)
                                        }, o.onerror = function() {
                                            r(o.error)
                                        }
                                    })["catch"](r)
                                });
                            return i(r, e), r
                        },
                        key: function(e, t) {
                            var r = this,
                                n = new P(function(t, n) {
                                    return 0 > e ? void t(null) : void r.ready().then(function() {
                                        var a = r._dbInfo,
                                            o = a.db.transaction(a.storeName, "readonly").objectStore(a.storeName),
                                            i = !1,
                                            s = o.openCursor();
                                        s.onsuccess = function() {
                                            var r = s.result;
                                            return r ? void(0 === e ? t(r.key) : i ? t(r.key) : (i = !0, r.advance(e))) : void t(null)
                                        }, s.onerror = function() {
                                            n(s.error)
                                        }
                                    })["catch"](n)
                                });
                            return i(n, t), n
                        },
                        keys: function(e) {
                            var t = this,
                                r = new P(function(e, r) {
                                    t.ready().then(function() {
                                        var n = t._dbInfo,
                                            a = n.db.transaction(n.storeName, "readonly").objectStore(n.storeName),
                                            o = a.openCursor(),
                                            i = [];
                                        o.onsuccess = function() {
                                            var t = o.result;
                                            return t ? (i.push(t.key), void t["continue"]()) : void e(i)
                                        }, o.onerror = function() {
                                            r(o.error)
                                        }
                                    })["catch"](r)
                                });
                            return i(r, e), r
                        }
                    },
                    B = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
                    k = /^~~local_forage_type~([^~]+)~/,
                    F = "__lfsc__:",
                    N = "__lfsc__:".length,
                    j = "arbf",
                    D = "blob",
                    M = "si08",
                    z = "ui08",
                    G = "uic8",
                    W = "si16",
                    U = "si32",
                    V = "ur16",
                    X = "ui32",
                    q = "fl32",
                    Y = "fl64",
                    H = 9 + "arbf".length,
                    J = Object.prototype.toString,
                    Z = {
                        serialize: function(t, r) {
                            var n = "";
                            if (t && (n = J.call(t)), t && ("[object ArrayBuffer]" === n || t.buffer && "[object ArrayBuffer]" === J.call(t.buffer))) {
                                var a = F,
                                    o;
                                t instanceof ArrayBuffer ? (o = t, a += j) : (o = t.buffer, "[object Int8Array]" === n ? a += M : "[object Uint8Array]" === n ? a += z : "[object Uint8ClampedArray]" === n ? a += G : "[object Int16Array]" === n ? a += W : "[object Uint16Array]" === n ? a += V : "[object Int32Array]" === n ? a += U : "[object Uint32Array]" === n ? a += X : "[object Float32Array]" === n ? a += q : "[object Float64Array]" === n ? a += Y : r(new Error("Failed to get type for BinaryArray"))), r(a + w(o))
                            } else if ("[object Blob]" === n) {
                                var i = new FileReader;
                                i.onload = function() {
                                    var e = "~~local_forage_type~" + t.type + "~" + w(this.result);
                                    r(F + D + e)
                                }, i.readAsArrayBuffer(t)
                            } else try {
                                r(JSON.stringify(t))
                            } catch (e) {
                                console.error("Couldn't convert value into a JSON string: ", t), r(null, e)
                            }
                        },
                        deserialize: function(t) {
                            if (t.substring(0, N) !== F) return JSON.parse(t);
                            var r = t.substring(H),
                                n = t.substring(N, H),
                                a;
                            if (n === D && k.test(r)) {
                                var o = r.match(k);
                                a = o[1], r = r.substring(o[0].length)
                            }
                            var e = y(r);
                            switch (n) {
                                case j:
                                    return e;
                                case D:
                                    return g([e], {
                                        type: a
                                    });
                                case M:
                                    return new Int8Array(e);
                                case z:
                                    return new Uint8Array(e);
                                case G:
                                    return new Uint8ClampedArray(e);
                                case W:
                                    return new Int16Array(e);
                                case V:
                                    return new Uint16Array(e);
                                case U:
                                    return new Int32Array(e);
                                case X:
                                    return new Uint32Array(e);
                                case q:
                                    return new Float32Array(e);
                                case Y:
                                    return new Float64Array(e);
                                default:
                                    throw new Error("Unkown type: " + n);
                            }
                        },
                        stringToBuffer: y,
                        bufferToString: w
                    },
                    Q = {
                        _driver: "webSQLStorage",
                        _initStorage: function(t) {
                            var r = this,
                                n = {
                                    db: null
                                };
                            if (t)
                                for (var a in t) n[a] = "string" == typeof t[a] ? t[a] : t[a].toString();
                            var o = new P(function(e, t) {
                                try {
                                    n.db = openDatabase(n.name, n.version + "", n.description, n.size)
                                } catch (r) {
                                    return t(r)
                                }
                                n.db.transaction(function(a) {
                                    a.executeSql("CREATE TABLE IF NOT EXISTS " + n.storeName + " (id INTEGER PRIMARY KEY, key unique, value)", [], function() {
                                        r._dbInfo = n, e()
                                    }, function(e, r) {
                                        t(r)
                                    })
                                })
                            });
                            return n.serializer = Z, o
                        },
                        iterate: function(t, e) {
                            var r = this,
                                n = new P(function(n, e) {
                                    r.ready().then(function() {
                                        var a = r._dbInfo;
                                        a.db.transaction(function(r) {
                                            r.executeSql("SELECT * FROM " + a.storeName, [], function(e, r) {
                                                for (var o = r.rows, s = o.length, l = 0; s > l; l++) {
                                                    var p = o.item(l),
                                                        i = p.value;
                                                    if (i && (i = a.serializer.deserialize(i)), i = t(i, p.key, l + 1), void 0 !== i) return void n(i)
                                                }
                                                n()
                                            }, function(t, r) {
                                                e(r)
                                            })
                                        })
                                    })["catch"](e)
                                });
                            return i(n, e), n
                        },
                        getItem: function(t, e) {
                            var r = this;
                            "string" != typeof t && (console.warn(t + " used as a key, but it is not a string."), t = t + "");
                            var n = new P(function(n, e) {
                                r.ready().then(function() {
                                    var o = r._dbInfo;
                                    o.db.transaction(function(r) {
                                        r.executeSql("SELECT * FROM " + o.storeName + " WHERE key = ? LIMIT 1", [t], function(e, t) {
                                            var r = t.rows.length ? t.rows.item(0).value : null;
                                            r && (r = o.serializer.deserialize(r)), n(r)
                                        }, function(t, r) {
                                            e(r)
                                        })
                                    })
                                })["catch"](e)
                            });
                            return i(n, e), n
                        },
                        setItem: function(e, t, r) {
                            return S.apply(this, [e, t, r, 1])
                        },
                        removeItem: function(t, e) {
                            var r = this;
                            "string" != typeof t && (console.warn(t + " used as a key, but it is not a string."), t = t + "");
                            var n = new P(function(e, n) {
                                r.ready().then(function() {
                                    var a = r._dbInfo;
                                    a.db.transaction(function(r) {
                                        r.executeSql("DELETE FROM " + a.storeName + " WHERE key = ?", [t], function() {
                                            e()
                                        }, function(e, t) {
                                            n(t)
                                        })
                                    })
                                })["catch"](n)
                            });
                            return i(n, e), n
                        },
                        clear: function(e) {
                            var t = this,
                                r = new P(function(e, r) {
                                    t.ready().then(function() {
                                        var n = t._dbInfo;
                                        n.db.transaction(function(t) {
                                            t.executeSql("DELETE FROM " + n.storeName, [], function() {
                                                e()
                                            }, function(e, t) {
                                                r(t)
                                            })
                                        })
                                    })["catch"](r)
                                });
                            return i(r, e), r
                        },
                        length: function(e) {
                            var t = this,
                                r = new P(function(e, r) {
                                    t.ready().then(function() {
                                        var n = t._dbInfo;
                                        n.db.transaction(function(t) {
                                            t.executeSql("SELECT COUNT(key) as c FROM " + n.storeName, [], function(t, r) {
                                                var n = r.rows.item(0).c;
                                                e(n)
                                            }, function(e, t) {
                                                r(t)
                                            })
                                        })
                                    })["catch"](r)
                                });
                            return i(r, e), r
                        },
                        key: function(t, e) {
                            var r = this,
                                n = new P(function(e, n) {
                                    r.ready().then(function() {
                                        var a = r._dbInfo;
                                        a.db.transaction(function(r) {
                                            r.executeSql("SELECT key FROM " + a.storeName + " WHERE id = ? LIMIT 1", [t + 1], function(t, r) {
                                                var n = r.rows.length ? r.rows.item(0).key : null;
                                                e(n)
                                            }, function(e, t) {
                                                n(t)
                                            })
                                        })
                                    })["catch"](n)
                                });
                            return i(n, e), n
                        },
                        keys: function(e) {
                            var t = this,
                                r = new P(function(r, e) {
                                    t.ready().then(function() {
                                        var n = t._dbInfo;
                                        n.db.transaction(function(t) {
                                            t.executeSql("SELECT key FROM " + n.storeName, [], function(t, n) {
                                                for (var a = [], o = 0; o < n.rows.length; o++) a.push(n.rows.item(o).key);
                                                r(a)
                                            }, function(t, r) {
                                                e(r)
                                            })
                                        })
                                    })["catch"](e)
                                });
                            return i(r, e), r
                        }
                    },
                    K = {
                        _driver: "localStorageWrapper",
                        _initStorage: function(e) {
                            var t = this,
                                r = {};
                            if (e)
                                for (var n in e) r[n] = e[n];
                            return r.keyPrefix = r.name + "/", r.storeName !== t._defaultConfig.storeName && (r.keyPrefix += r.storeName + "/"), t._dbInfo = r, r.serializer = Z, P.resolve()
                        },
                        iterate: function(t, e) {
                            var r = this,
                                n = r.ready().then(function() {
                                    for (var n = r._dbInfo, a = n.keyPrefix, o = a.length, e = localStorage.length, s = 1, l = 0, p; e > l; l++)
                                        if (p = localStorage.key(l), 0 === p.indexOf(a)) {
                                            var d = localStorage.getItem(p);
                                            if (d && (d = n.serializer.deserialize(d)), d = t(d, p.substring(o), s++), void 0 !== d) return d
                                        }
                                });
                            return i(n, e), n
                        },
                        getItem: function(e, t) {
                            var r = this;
                            "string" != typeof e && (console.warn(e + " used as a key, but it is not a string."), e = e + "");
                            var n = r.ready().then(function() {
                                var t = r._dbInfo,
                                    n = localStorage.getItem(t.keyPrefix + e);
                                return n && (n = t.serializer.deserialize(n)), n
                            });
                            return i(n, t), n
                        },
                        setItem: function(t, r, n) {
                            var o = this;
                            "string" != typeof t && (console.warn(t + " used as a key, but it is not a string."), t = t + "");
                            var s = o.ready().then(function() {
                                void 0 === r && (r = null);
                                var n = r;
                                return new P(function(a, e) {
                                    var i = o._dbInfo;
                                    i.serializer.serialize(r, function(r, o) {
                                        if (o) e(o);
                                        else try {
                                            localStorage.setItem(i.keyPrefix + t, r), a(n)
                                        } catch (t) {
                                            "QuotaExceededError" !== t.name && "NS_ERROR_DOM_QUOTA_REACHED" !== t.name || e(t), e(t)
                                        }
                                    })
                                })
                            });
                            return i(s, n), s
                        },
                        removeItem: function(e, t) {
                            var r = this;
                            "string" != typeof e && (console.warn(e + " used as a key, but it is not a string."), e = e + "");
                            var n = r.ready().then(function() {
                                var t = r._dbInfo;
                                localStorage.removeItem(t.keyPrefix + e)
                            });
                            return i(n, t), n
                        },
                        clear: function(e) {
                            var t = this,
                                r = t.ready().then(function() {
                                    for (var e = t._dbInfo.keyPrefix, r = localStorage.length - 1, n; 0 <= r; r--) n = localStorage.key(r), 0 === n.indexOf(e) && localStorage.removeItem(n)
                                });
                            return i(r, e), r
                        },
                        length: function(e) {
                            var t = this,
                                r = t.keys().then(function(e) {
                                    return e.length
                                });
                            return i(r, e), r
                        },
                        key: function(e, t) {
                            var r = this,
                                n = r.ready().then(function() {
                                    var t = r._dbInfo,
                                        n;
                                    try {
                                        n = localStorage.key(e)
                                    } catch (t) {
                                        n = null
                                    }
                                    return n && (n = n.substring(t.keyPrefix.length)), n
                                });
                            return i(n, t), n
                        },
                        keys: function(e) {
                            var t = this,
                                r = t.ready().then(function() {
                                    for (var r = t._dbInfo, n = localStorage.length, a = [], o = 0; n > o; o++) 0 === localStorage.key(o).indexOf(r.keyPrefix) && a.push(localStorage.key(o).substring(r.keyPrefix.length));
                                    return a
                                });
                            return i(r, e), r
                        }
                    },
                    $ = {},
                    ee = {
                        INDEXEDDB: "asyncStorage",
                        LOCALSTORAGE: "localStorageWrapper",
                        WEBSQL: "webSQLStorage"
                    },
                    te = [ee.INDEXEDDB, ee.WEBSQL, ee.LOCALSTORAGE],
                    re = ["clear", "getItem", "iterate", "key", "keys", "length", "removeItem", "setItem"],
                    ne = {
                        description: "",
                        driver: te.slice(),
                        name: "localforage",
                        size: 4980736,
                        storeName: "keyvaluepairs",
                        version: 1
                    },
                    ae = {},
                    oe, ie;
                ae[ee.INDEXEDDB] = function() {
                    try {
                        if (!A) return !1;
                        var e = "undefined" != typeof openDatabase && /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && !/BlackBerry/.test(navigator.platform),
                            t = "function" == typeof fetch && -1 !== fetch.toString().indexOf("[native code");
                        return (!e || t) && "undefined" != typeof indexedDB && "undefined" != typeof IDBKeyRange
                    } catch (e) {
                        return !1
                    }
                }(), ae[ee.WEBSQL] = function() {
                    return "function" == typeof openDatabase
                }(), ae[ee.LOCALSTORAGE] = d();
                var se = Array.isArray || function(e) {
                        return "[object Array]" === Object.prototype.toString.call(e)
                    },
                    le = function() {
                        function e(t) {
                            c(this, e), this.INDEXEDDB = ee.INDEXEDDB, this.LOCALSTORAGE = ee.LOCALSTORAGE, this.WEBSQL = ee.WEBSQL, this._defaultConfig = O({}, ne), this._config = O({}, this._defaultConfig, t), this._driverSet = null, this._initDriver = null, this._ready = !1, this._dbInfo = null, this._wrapLibraryMethodsWithReady(), this.setDriver(this._config.driver)["catch"](function() {})
                        }
                        return e.prototype.config = function(e) {
                            if ("object" === ("undefined" == typeof e ? "undefined" : C(e))) {
                                if (this._ready) return new Error("Can't call config() after localforage has been used.");
                                for (var t in e) {
                                    if ("storeName" == t && (e[t] = e[t].replace(/\W/g, "_")), "version" == t && "number" != typeof e[t]) return new Error("Database version must be a number.");
                                    this._config[t] = e[t]
                                }
                                return !("driver" in e && e.driver) || this.setDriver(this._config.driver)
                            }
                            return "string" == typeof e ? this._config[e] : this._config
                        }, e.prototype.defineDriver = function(t, e, r) {
                            var n = new P(function(r, n) {
                                try {
                                    var a = t._driver,
                                        o = new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),
                                        e = new Error("Custom driver name already in use: " + t._driver);
                                    if (!t._driver) return void n(o);
                                    if (E(t._driver)) return void n(e);
                                    for (var s = re.concat("_initStorage"), l = 0, p; l < s.length; l++)
                                        if (p = s[l], !p || !t[p] || "function" != typeof t[p]) return void n(o);
                                    var d = P.resolve(!0);
                                    "_support" in t && (d = t._support && "function" == typeof t._support ? t._support() : P.resolve(!!t._support)), d.then(function(e) {
                                        ae[a] = e, $[a] = t, r()
                                    }, n)
                                } catch (e) {
                                    n(e)
                                }
                            });
                            return _(n, e, r), n
                        }, e.prototype.driver = function() {
                            return this._driver || null
                        }, e.prototype.getDriver = function(t, r, n) {
                            var a = this,
                                o = P.resolve().then(function() {
                                    if (!E(t)) {
                                        if ($[t]) return $[t];
                                        throw new Error("Driver not found.")
                                    }
                                    return t === a.INDEXEDDB ? R : t === a.LOCALSTORAGE ? K : t === a.WEBSQL ? Q : void 0
                                });
                            return _(o, r, n), o
                        }, e.prototype.getSerializer = function(e) {
                            var t = P.resolve(Z);
                            return _(t, e), t
                        }, e.prototype.ready = function(e) {
                            var t = this,
                                r = t._driverSet.then(function() {
                                    return null === t._ready && (t._ready = t._initDriver()), t._ready
                                });
                            return _(r, e, e), r
                        }, e.prototype.setDriver = function(t, r, n) {
                            function o() {
                                l._config.driver = l.driver()
                            }

                            function s(e) {
                                return l._extend(e), o(), l._ready = l._initStorage(l._config), l._ready
                            }

                            function e(e) {
                                return function() {
                                    function t() {
                                        for (; r < e.length;) {
                                            var n = e[r];
                                            return r++, l._dbInfo = null, l._ready = null, l.getDriver(n).then(s)["catch"](t)
                                        }
                                        o();
                                        var a = new Error("No available storage method found.");
                                        return l._driverSet = P.reject(a), l._driverSet
                                    }
                                    var r = 0;
                                    return t()
                                }
                            }
                            var l = this;
                            se(t) || (t = [t]);
                            var p = this._getSupportedDrivers(t),
                                d = null === this._driverSet ? P.resolve() : this._driverSet["catch"](function() {
                                    return P.resolve()
                                });
                            return this._driverSet = d.then(function() {
                                var t = p[0];
                                return l._dbInfo = null, l._ready = null, l.getDriver(t).then(function(t) {
                                    l._driver = t._driver, o(), l._wrapLibraryMethodsWithReady(), l._initDriver = e(p)
                                })
                            })["catch"](function() {
                                o();
                                var e = new Error("No available storage method found.");
                                return l._driverSet = P.reject(e), l._driverSet
                            }), _(this._driverSet, r, n), this._driverSet
                        }, e.prototype.supports = function(e) {
                            return !!ae[e]
                        }, e.prototype._extend = function(e) {
                            O(this, e)
                        }, e.prototype._getSupportedDrivers = function(t) {
                            for (var r = [], n = 0, a = t.length, o; a > n; n++) o = t[n], this.supports(o) && r.push(o);
                            return r
                        }, e.prototype._wrapLibraryMethodsWithReady = function() {
                            for (var e = 0; e < re.length; e++) T(this, re[e])
                        }, e.prototype.createInstance = function(t) {
                            return new e(t)
                        }, e
                    }(),
                    pe = new le;
                a.exports = pe
            }, {
                undefined: void 0
            }]
        }, {}, [1])(1)
    })
} catch (t) {
    localForageInitFailed = !0
}
cr.plugins_.LocalStorage = function(e) {
        this.runtime = e
    },
    function() {
        function e(e) {
            return e ? "string" == typeof e ? e : "string" == typeof e.message ? e.message : "string" == typeof e.name ? e.name : "string" == typeof e.data ? e.data : "unknown error" : "unknown error"
        }

        function t(e, t) {
            d = t, e.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, e)
        }

        function r(e) {
            return !c || e.substr(0, c.length) === c
        }

        function n(e) {
            return c ? r(e) ? e.substr(c.length) : void 0 : e
        }

        function a() {}

        function o() {}

        function i() {}
        var s = "",
            l = "",
            p = [],
            d = "";
        var c = "",
            u = "undefined" != typeof window.is_scirra_arcade;
        u && (c = "sa" + window.scirra_arcade_id + "_");
        var g = cr.plugins_.LocalStorage.prototype;
        g.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var y = g.Type.prototype;
        y.onCreate = function() {}, g.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var m = g.Instance.prototype;
        m.onCreate = function() {
            this.pendingSets = 0, this.pendingGets = 0
        }, m.onDestroy = function() {}, m.saveToJSON = function() {
            return {}
        }, m.loadFromJSON = function() {};
        var _ = !0;
        a.prototype.OnItemSet = function(e) {
            return s === e
        }, a.prototype.OnAnyItemSet = function() {
            return !0
        }, a.prototype.OnItemGet = function(e) {
            return s === e
        }, a.prototype.OnAnyItemGet = function() {
            return !0
        }, a.prototype.OnItemRemoved = function(e) {
            return s === e
        }, a.prototype.OnAnyItemRemoved = function() {
            return !0
        }, a.prototype.OnCleared = function() {
            return !0
        }, a.prototype.OnAllKeyNamesLoaded = function() {
            return !0
        }, a.prototype.OnError = function() {
            return !0
        }, a.prototype.OnItemExists = function(e) {
            return s === e
        }, a.prototype.OnItemMissing = function(e) {
            return s === e
        }, a.prototype.CompareKey = function(e, t) {
            return cr.do_cmp(s, e, t)
        }, a.prototype.CompareValue = function(e, t) {
            return cr.do_cmp(l, e, t)
        }, a.prototype.IsProcessingSets = function() {
            return 0 < this.pendingSets
        }, a.prototype.IsProcessingGets = function() {
            return 0 < this.pendingGets
        }, a.prototype.OnAllSetsComplete = function() {
            return !0
        }, a.prototype.OnAllGetsComplete = function() {
            return !0
        }, g.cnds = new a;
        o.prototype.SetItem = function(r, n) {
            if (localForageInitFailed) return void t(this, "storage failed to initialise - may be disabled in browser settings");
            var a = c + r;
            this.pendingSets++;
            var o = this;
            localforage.setItem(a, n, function(t, n) {
                _ = !0, o.pendingSets--, t ? (d = e(t), o.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, o)) : (s = r, l = n, o.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemSet, o), o.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemSet, o), s = "", l = ""), 0 === o.pendingSets && o.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllSetsComplete, o)
            })
        }, o.prototype.GetItem = function(r) {
            if (localForageInitFailed) return void t(this, "storage failed to initialise - may be disabled in browser settings");
            var n = c + r;
            this.pendingGets++;
            var a = this;
            localforage.getItem(n, function(t, n) {
                a.pendingGets--, t ? (d = e(t), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, a)) : (s = r, l = n, ("undefined" == typeof l || null === l) && (l = ""), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemGet, a), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemGet, a), s = "", l = ""), 0 === a.pendingGets && a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllGetsComplete, a)
            })
        }, o.prototype.CheckItemExists = function(r) {
            if (localForageInitFailed) return void t(this, "storage failed to initialise - may be disabled in browser settings");
            var n = c + r,
                a = this;
            localforage.getItem(n, function(t, n) {
                t ? (d = e(t), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, a)) : (s = r, null === n ? (l = "", a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemMissing, a)) : (l = n, a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemExists, a)), s = "", l = "")
            })
        }, o.prototype.RemoveItem = function(r) {
            if (localForageInitFailed) return void t(this, "storage failed to initialise - may be disabled in browser settings");
            var n = c + r,
                a = this;
            localforage.removeItem(n, function(t) {
                _ = !0, t ? (d = e(t), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, a)) : (s = r, l = "", a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemRemoved, a), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemRemoved, a), s = "")
            })
        }, o.prototype.ClearStorage = function() {
            if (localForageInitFailed) return void t(this, "storage failed to initialise - may be disabled in browser settings");
            if (!u) {
                var r = this;
                localforage.clear(function(t) {
                    _ = !0, t ? (d = e(t), r.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, r)) : (s = "", l = "", cr.clearArray(p), r.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnCleared, r))
                })
            }
        }, o.prototype.GetAllKeyNames = function() {
            if (localForageInitFailed) return void t(this, "storage failed to initialise - may be disabled in browser settings");
            var a = this;
            localforage.keys(function(t, o) {
                var s, l, c;
                if (t) d = e(t), a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError, a);
                else {
                    for (cr.clearArray(p), s = 0, l = o.length; s < l; ++s) c = o[s], r(c) && p.push(n(c));
                    a.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllKeyNamesLoaded, a)
                }
            })
        }, g.acts = new o;
        i.prototype.ItemValue = function(e) {
            e.set_any(l)
        }, i.prototype.Key = function(e) {
            e.set_string(s)
        }, i.prototype.KeyCount = function(e) {
            e.set_int(p.length)
        }, i.prototype.KeyAt = function(e, t) {
            return t = Math.floor(t), 0 > t || t >= p.length ? void e.set_string("") : void e.set_string(p[t])
        }, i.prototype.ErrorMessage = function(e) {
            e.set_string(d)
        }, g.exps = new i
    }();
cr.plugins_.WebStorage = function(e) {
        this.runtime = e
    },
    function() {
        function e() {}

        function t() {}

        function r() {}
        var n = cr.plugins_.WebStorage.prototype;
        n.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var a = n.Type.prototype;
        a.onCreate = function() {}, n.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var o = n.Instance.prototype,
            s = "",
            l = "undefined" != typeof window.is_scirra_arcade;
        l && (s = "arcade" + window.scirra_arcade_id);
        var c = !1;
        try {
            localStorage.getItem("test"), c = !0
        } catch (t) {
            c = !1
        }
        o.onCreate = function() {
            c || cr.logexport("[Construct 2] Webstorage plugin: local storage is not supported on this platform.")
        };
        e.prototype.LocalStorageEnabled = function() {
            return c
        }, e.prototype.SessionStorageEnabled = function() {
            return c
        }, e.prototype.LocalStorageExists = function(e) {
            return !!c && null != localStorage.getItem(s + e)
        }, e.prototype.SessionStorageExists = function(e) {
            return !!c && null != sessionStorage.getItem(s + e)
        }, e.prototype.OnQuotaExceeded = function() {
            return !0
        }, e.prototype.CompareKeyText = function(e, t, r) {
            if (!c) return !1;
            var n = localStorage.getItem(s + e) || "";
            return r ? n == t : cr.equals_nocase(n, t)
        }, e.prototype.CompareKeyNumber = function(e, t, r) {
            if (!c) return !1;
            var n = localStorage.getItem(s + e) || "";
            return cr.do_cmp(parseFloat(n), t, r)
        }, n.cnds = new e;
        t.prototype.StoreLocal = function(e, t) {
            if (c) try {
                localStorage.setItem(s + e, t)
            } catch (t) {
                this.runtime.trigger(cr.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded, this)
            }
        }, t.prototype.StoreSession = function(e, t) {
            if (c) try {
                sessionStorage.setItem(s + e, t)
            } catch (t) {
                this.runtime.trigger(cr.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded, this)
            }
        }, t.prototype.RemoveLocal = function(e) {
            c && localStorage.removeItem(s + e)
        }, t.prototype.RemoveSession = function(e) {
            c && sessionStorage.removeItem(s + e)
        }, t.prototype.ClearLocal = function() {
            c && (l || localStorage.clear())
        }, t.prototype.ClearSession = function() {
            c && (l || sessionStorage.clear())
        }, t.prototype.JSONLoad = function(e, t) {
            if (c) {
                var r;
                try {
                    r = JSON.parse(e)
                } catch (t) {
                    return
                }
                if (r.c2dictionary) {
                    var n = r.data;
                    0 !== t || l || localStorage.clear();
                    for (var a in n)
                        if (n.hasOwnProperty(a)) try {
                            localStorage.setItem(s + a, n[a])
                        } catch (t) {
                            return void this.runtime.trigger(cr.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded, this)
                        }
                }
            }
        }, n.acts = new t;
        r.prototype.LocalValue = function(e, t) {
            return c ? void e.set_string(localStorage.getItem(s + t) || "") : void e.set_string("")
        }, r.prototype.SessionValue = function(e, t) {
            return c ? void e.set_string(sessionStorage.getItem(s + t) || "") : void e.set_string("")
        }, r.prototype.LocalCount = function(e) {
            return c ? void e.set_int(l ? 0 : localStorage.length) : void e.set_int(0)
        }, r.prototype.SessionCount = function(e) {
            return c ? void e.set_int(l ? 0 : sessionStorage.length) : void e.set_int(0)
        }, r.prototype.LocalAt = function(e, t) {
            l || !c ? e.set_string("") : e.set_string(localStorage.getItem(localStorage.key(t)) || "")
        }, r.prototype.SessionAt = function(e, t) {
            l || !c ? e.set_string("") : e.set_string(sessionStorage.getItem(sessionStorage.key(t)) || "")
        }, r.prototype.LocalKeyAt = function(e, t) {
            l || !c ? e.set_string("") : e.set_string(localStorage.key(t) || "")
        }, r.prototype.SessionKeyAt = function(e, t) {
            l || !c ? e.set_string("") : e.set_string(sessionStorage.key(t) || "")
        }, r.prototype.AsJSON = function(e) {
            if (!c) return void e.set_string("");
            var t = {},
                r, n, a;
            for (r = 0, n = localStorage.length; r < n; r++) a = localStorage.key(r), l ? a.substr(0, s.length) === s && (t[a.substr(s.length)] = localStorage.getItem(a)) : t[a] = localStorage.getItem(a);
            e.set_string(JSON.stringify({
                c2dictionary: !0,
                data: t
            }))
        }, n.exps = new r
    }();
cr.plugins_.Browser = function(e) {
        this.runtime = e
    },
    function() {
        function checkReady() {
            offlineScriptReady && browserPluginReady && window.OfflineClientInfo && window.OfflineClientInfo.SetMessageCallback(function(t) {
                browserInstance.onSWMessage(t)
            })
        }

        function maybeLoadBatteryManager() {
            if (!loadedBatteryManager && navigator.getBattery) {
                var e = navigator.getBattery();
                loadedBatteryManager = !0, e && e.then(function(e) {
                    batteryManager = e
                })
            }
        }

        function Cnds() {}

        function Acts() {}

        function onFullscreenError(t) {
            console && console.warn && console.warn("Fullscreen request failed: ", t), crruntime.setSize(window.innerWidth, window.innerHeight)
        }

        function Exps() {}
        var pluginProto = cr.plugins_.Browser.prototype;
        pluginProto.Type = function(e) {
            this.plugin = e, this.runtime = e.runtime
        };
        var typeProto = pluginProto.Type.prototype;
        typeProto.onCreate = function() {};
        var offlineScriptReady = !1,
            browserPluginReady = !1;
        document.addEventListener("DOMContentLoaded", function() {
            if (window.C3_RegisterSW && navigator.serviceWorker) {
                var e = document.createElement("script");
                e.onload = function() {
                    offlineScriptReady = !0, checkReady()
                }, e.src = "offlineclient.js", document.head.appendChild(e)
            }
        });
        var browserInstance = null;
        typeProto.onAppBegin = function() {
            browserPluginReady = !0, checkReady()
        };
        pluginProto.Instance = function(e) {
            this.type = e, this.runtime = e.runtime
        };
        var instanceProto = pluginProto.Instance.prototype;
        instanceProto.onCreate = function() {
            var t = this;
            window.addEventListener("resize", function() {
                t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize, t)
            }), browserInstance = this, "undefined" != typeof navigator.onLine && (window.addEventListener("online", function() {
                t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline, t)
            }), window.addEventListener("offline", function() {
                t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline, t)
            })), document.addEventListener("backbutton", function() {
                t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton, t)
            }), document.addEventListener("menubutton", function() {
                t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton, t)
            }), document.addEventListener("searchbutton", function() {
                t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton, t)
            }), document.addEventListener("tizenhwkey", function(r) {
                var e;
                switch (r.keyName) {
                    case "back":
                        e = t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton, t), !e && window.tizen && window.tizen.application.getCurrentApplication().exit();
                        break;
                    case "menu":
                        e = t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton, t), e || r.preventDefault();
                }
            }), this.runtime.isWindows10 && "undefined" != typeof Windows ? Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested", function(r) {
                var e = t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton, t);
                e && (r.handled = !0)
            }) : this.runtime.isWinJS && WinJS.Application && (WinJS.Application.onbackclick = function() {
                return !!t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton, t)
            }), this.runtime.addSuspendCallback(function(e) {
                e ? t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden, t) : t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible, t)
            }), this.is_arcade = "undefined" != typeof window.is_scirra_arcade
        }, instanceProto.onSWMessage = function(t) {
            var e = t.data.type;
            "downloading-update" === e ? this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound, this) : "update-ready" === e || "update-pending" === e ? this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady, this) : "offline-ready" === e && this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady, this)
        };
        var batteryManager = null,
            loadedBatteryManager = !1;
        Cnds.prototype.CookiesEnabled = function() {
            return !!navigator && navigator.cookieEnabled
        }, Cnds.prototype.IsOnline = function() {
            return !!navigator && navigator.onLine
        }, Cnds.prototype.HasJava = function() {
            return !!navigator && navigator.javaEnabled()
        }, Cnds.prototype.OnOnline = function() {
            return !0
        }, Cnds.prototype.OnOffline = function() {
            return !0
        }, Cnds.prototype.IsDownloadingUpdate = function() {
            return !1
        }, Cnds.prototype.PageVisible = function() {
            return !this.runtime.isSuspended
        }, Cnds.prototype.OnPageVisible = function() {
            return !0
        }, Cnds.prototype.OnPageHidden = function() {
            return !0
        }, Cnds.prototype.OnResize = function() {
            return !0
        }, Cnds.prototype.IsFullscreen = function() {
            return !!(document.mozFullScreen || document.webkitIsFullScreen || document.fullScreen)
        }, Cnds.prototype.OnBackButton = function() {
            return !0
        }, Cnds.prototype.OnMenuButton = function() {
            return !0
        }, Cnds.prototype.OnSearchButton = function() {
            return !0
        }, Cnds.prototype.IsMetered = function() {
            var e = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            return !!e && !!e.metered
        }, Cnds.prototype.IsCharging = function() {
            var e = navigator.battery || navigator.mozBattery || navigator.webkitBattery;
            return e ? !!e.charging : (maybeLoadBatteryManager(), !batteryManager || !!batteryManager.charging)
        }, Cnds.prototype.IsPortraitLandscape = function(e) {
            var t = window.innerWidth <= window.innerHeight ? 0 : 1;
            return t === e
        }, Cnds.prototype.SupportsFullscreen = function() {
            if (this.runtime.isNWjs) return !0;
            var e = this.runtime.canvas;
            return !!(e.requestFullscreen || e.mozRequestFullScreen || e.msRequestFullscreen || e.webkitRequestFullScreen)
        }, Cnds.prototype.OnUpdateFound = function() {
            return !0
        }, Cnds.prototype.OnUpdateReady = function() {
            return !0
        }, Cnds.prototype.OnOfflineReady = function() {
            return !0
        }, pluginProto.cnds = new Cnds;
        Acts.prototype.Alert = function(e) {
            alert(e.toString())
        }, Acts.prototype.Close = function() {
            window.tizen ? window.tizen.application.getCurrentApplication().exit() : navigator.app && navigator.app.exitApp ? navigator.app.exitApp() : navigator.device && navigator.device.exitApp ? navigator.device.exitApp() : !this.is_arcade && window.close()
        }, Acts.prototype.Focus = function() {
            if (this.runtime.isNWjs) {
                var e = nw.Window.get();
                e.focus()
            } else this.is_arcade || window.focus()
        }, Acts.prototype.Blur = function() {
            if (this.runtime.isNWjs) {
                var e = nw.Window.get();
                e.blur()
            } else this.is_arcade || window.blur()
        }, Acts.prototype.GoBack = function() {
            navigator.app && navigator.app.backHistory ? navigator.app.backHistory() : !this.is_arcade && window.back && window.back()
        }, Acts.prototype.GoForward = function() {
            !this.is_arcade && window.forward && window.forward()
        }, Acts.prototype.GoHome = function() {
            !this.is_arcade && window.home && window.home()
        }, Acts.prototype.GoToURL = function(e, t) {
            this.runtime.isWinJS ? Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(e)) : navigator.app && navigator.app.loadUrl ? navigator.app.loadUrl(e, {
                openExternal: !0
            }) : this.runtime.isCordova ? window.open(e, "_system") : this.runtime.isPreview ? window.open(e, "_blank") : !this.is_arcade && (2 !== t || this.is_arcade ? 1 !== t || this.is_arcade ? window.location = e : window.parent.location = e : window.top.location = e)
        }, Acts.prototype.GoToURLWindow = function(e, t) {
            this.runtime.isWinJS ? Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(e)) : navigator.app && navigator.app.loadUrl ? navigator.app.loadUrl(e, {
                openExternal: !0
            }) : this.runtime.isCordova ? window.open(e, "_system") : !this.is_arcade && window.open(e, t)
        }, Acts.prototype.Reload = function() {
            this.is_arcade || window.location.reload()
        };
        var firstRequestFullscreen = !0,
            crruntime = null;
        Acts.prototype.RequestFullScreen = function(e, t) {
            if (2 <= e && (e += 1), 6 === e && (e = 2), !(document.mozFullScreen || document.webkitIsFullScreen || !!document.msFullscreenElement || document.fullScreen || document.fullScreenElement)) {
                this.runtime.fullscreen_scaling = 2 <= e ? e : 0;
                var r = {
                    navigationUI: "auto"
                };
                1 === t ? r.navigationUI = "hide" : 2 == t && (r.navigationUI = "show");
                var n = document.documentElement;
                firstRequestFullscreen && (firstRequestFullscreen = !1, crruntime = this.runtime, n.addEventListener("mozfullscreenerror", onFullscreenError), n.addEventListener("webkitfullscreenerror", onFullscreenError), n.addEventListener("MSFullscreenError", onFullscreenError), n.addEventListener("fullscreenerror", onFullscreenError)), n.requestFullscreen ? n.requestFullscreen(r) : n.mozRequestFullScreen ? n.mozRequestFullScreen(r) : n.msRequestFullscreen ? n.msRequestFullscreen(r) : n.webkitRequestFullScreen && ("undefined" != typeof Element && "undefined" != typeof Element.ALLOW_KEYBOARD_INPUT ? n.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT) : n.webkitRequestFullScreen())
            }
        }, Acts.prototype.CancelFullScreen = function() {
            document.exitFullscreen ? document.exitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.webkitCancelFullScreen && document.webkitCancelFullScreen()
        }, Acts.prototype.Vibrate = function(e) {
            try {
                var t = e.split(","),
                    r, n;
                for (r = 0, n = t.length; r < n; r++) t[r] = parseInt(t[r], 10);
                navigator.vibrate ? navigator.vibrate(t) : navigator.mozVibrate ? navigator.mozVibrate(t) : navigator.webkitVibrate ? navigator.webkitVibrate(t) : navigator.msVibrate && navigator.msVibrate(t)
            } catch (t) {}
        }, Acts.prototype.InvokeDownload = function(e, t) {
            if (t) {
                var r = document.createElement("a");
                if ("undefined" == typeof r.download) window.open(e);
                else {
                    var n = document.getElementsByTagName("body")[0];
                    r.textContent = t, r.href = e, r.download = t, n.appendChild(r);
                    var a = new MouseEvent("click");
                    r.dispatchEvent(a), n.removeChild(r)
                }
            }
        }, Acts.prototype.InvokeDownloadString = function(e, t, r) {
            if (r) {
                var n = "data:" + t + "," + encodeURIComponent(e),
                    o = document.createElement("a");
                if ("undefined" == typeof o.download) window.open(n);
                else {
                    var a = document.getElementsByTagName("body")[0];
                    o.textContent = r, o.href = n, o.download = r, a.appendChild(o);
                    var i = new MouseEvent("click");
                    o.dispatchEvent(i), a.removeChild(o)
                }
            }
        }, Acts.prototype.ConsoleLog = function(e, t) {
            "undefined" == typeof console || (0 === e && console.log && console.log(t.toString()), 1 === e && console.warn && console.warn(t.toString()), 2 === e && console.error && console.error(t.toString()))
        }, Acts.prototype.ConsoleGroup = function(e) {
            console && console.group && console.group(e)
        }, Acts.prototype.ConsoleGroupEnd = function() {
            console && console.groupEnd && console.groupEnd()
        }, Acts.prototype.ExecJs = function(js_) {
            try {
                eval && eval(js_)
            } catch (t) {
                console && console.error && console.error("Error executing Javascript: ", t)
            }
        };
        var orientations = ["portrait", "landscape", "portrait-primary", "portrait-secondary", "landscape-primary", "landscape-secondary"];
        Acts.prototype.LockOrientation = function(e) {
            if (e = Math.floor(e), !(0 > e || e >= orientations.length)) {
                this.runtime.autoLockOrientation = !1;
                var t = orientations[e];
                screen.orientation && screen.orientation.lock ? screen.orientation.lock(t) : screen.lockOrientation ? screen.lockOrientation(t) : screen.webkitLockOrientation ? screen.webkitLockOrientation(t) : screen.mozLockOrientation ? screen.mozLockOrientation(t) : screen.msLockOrientation && screen.msLockOrientation(t)
            }
        }, Acts.prototype.UnlockOrientation = function() {
            this.runtime.autoLockOrientation = !1, screen.orientation && screen.orientation.unlock ? screen.orientation.unlock() : screen.unlockOrientation ? screen.unlockOrientation() : screen.webkitUnlockOrientation ? screen.webkitUnlockOrientation() : screen.mozUnlockOrientation ? screen.mozUnlockOrientation() : screen.msUnlockOrientation && screen.msUnlockOrientation()
        }, pluginProto.acts = new Acts;
        Exps.prototype.URL = function(e) {
            e.set_string(window.location.toString())
        }, Exps.prototype.Protocol = function(e) {
            e.set_string(window.location.protocol)
        }, Exps.prototype.Domain = function(e) {
            e.set_string(window.location.hostname)
        }, Exps.prototype.PathName = function(e) {
            e.set_string(window.location.pathname)
        }, Exps.prototype.Hash = function(e) {
            e.set_string(window.location.hash)
        }, Exps.prototype.Referrer = function(e) {
            e.set_string(document.referrer)
        }, Exps.prototype.Title = function(e) {
            e.set_string(document.title)
        }, Exps.prototype.Name = function(e) {
            e.set_string(navigator.appName)
        }, Exps.prototype.Version = function(e) {
            e.set_string(navigator.appVersion)
        }, Exps.prototype.Language = function(e) {
            navigator && navigator.language ? e.set_string(navigator.language) : e.set_string("")
        }, Exps.prototype.Platform = function(e) {
            e.set_string(navigator.platform)
        }, Exps.prototype.Product = function(e) {
            navigator && navigator.product ? e.set_string(navigator.product) : e.set_string("")
        }, Exps.prototype.Vendor = function(e) {
            navigator && navigator.vendor ? e.set_string(navigator.vendor) : e.set_string("")
        }, Exps.prototype.UserAgent = function(e) {
            e.set_string(navigator.userAgent)
        }, Exps.prototype.QueryString = function(e) {
            e.set_string(window.location.search)
        }, Exps.prototype.QueryParam = function(e, t) {
            var r = RegExp("[?&]" + t + "=([^&]*)").exec(window.location.search);
            r ? e.set_string(decodeURIComponent(r[1].replace(/\+/g, " "))) : e.set_string("")
        }, Exps.prototype.Bandwidth = function(e) {
            var t = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            t ? "undefined" == typeof t.bandwidth ? "undefined" == typeof t.downlinkMax ? e.set_float(Number.POSITIVE_INFINITY) : e.set_float(t.downlinkMax) : e.set_float(t.bandwidth) : e.set_float(Number.POSITIVE_INFINITY)
        }, Exps.prototype.ConnectionType = function(e) {
            var t = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            t ? e.set_string(t.type || "unknown") : e.set_string("unknown")
        }, Exps.prototype.BatteryLevel = function(e) {
            var t = navigator.battery || navigator.mozBattery || navigator.webkitBattery;
            t ? e.set_float(t.level) : (maybeLoadBatteryManager(), batteryManager ? e.set_float(batteryManager.level) : e.set_float(1))
        }, Exps.prototype.BatteryTimeLeft = function(e) {
            var t = navigator.battery || navigator.mozBattery || navigator.webkitBattery;
            t ? e.set_float(t.dischargingTime) : (maybeLoadBatteryManager(), batteryManager ? e.set_float(batteryManager.dischargingTime) : e.set_float(Number.POSITIVE_INFINITY))
        }, Exps.prototype.ExecJS = function(ret, js_) {
            if (!eval) return void ret.set_any(0);
            var result = 0;
            try {
                result = eval(js_)
            } catch (t) {
                console && console.error && console.error("Error executing Javascript: ", t)
            }
            "number" == typeof result ? ret.set_any(result) : "string" == typeof result ? ret.set_any(result) : "boolean" == typeof result ? ret.set_any(result ? 1 : 0) : ret.set_any(0)
        }, Exps.prototype.ScreenWidth = function(e) {
            e.set_int(screen.width)
        }, Exps.prototype.ScreenHeight = function(e) {
            e.set_int(screen.height)
        }, Exps.prototype.DevicePixelRatio = function(e) {
            e.set_float(this.runtime.devicePixelRatio)
        }, Exps.prototype.WindowInnerWidth = function(e) {
            e.set_int(window.innerWidth)
        }, Exps.prototype.WindowInnerHeight = function(e) {
            e.set_int(window.innerHeight)
        }, Exps.prototype.WindowOuterWidth = function(e) {
            e.set_int(window.outerWidth)
        }, Exps.prototype.WindowOuterHeight = function(e) {
            e.set_int(window.outerHeight)
        }, pluginProto.exps = new Exps
    }();
cr.behaviors.Platform = function(e) {
        this.runtime = e
    },
    function() {
        function e() {}

        function t() {}

        function r() {}
        var n = Math.abs,
            a = Math.sqrt,
            o = Math.max,
            i = Math.cos,
            s = Math.sin,
            l = Math.PI,
            p = cr.behaviors.Platform.prototype;
        p.Type = function(e, t) {
            this.behavior = e, this.objtype = t, this.runtime = e.runtime
        };
        var d = p.Type.prototype;
        d.onCreate = function() {};
        p.Instance = function(e, t) {
            this.type = e, this.behavior = e.behavior, this.inst = t, this.runtime = e.runtime, this.leftkey = !1, this.rightkey = !1, this.jumpkey = !1, this.jumped = !1, this.doubleJumped = !1, this.canDoubleJump = !1, this.ignoreInput = !1, this.simleft = !1, this.simright = !1, this.simjump = !1, this.lastFloorObject = null, this.loadFloorObject = -1, this.lastFloorX = 0, this.lastFloorY = 0, this.floorIsJumpthru = !1, this.ceilingCollisionMode = 0, this.animMode = 0, this.fallthrough = 0, this.firstTick = !0, this.dx = 0, this.dy = 0
        };
        var c = p.Instance.prototype;
        c.updateGravity = function() {
            this.downx = i(this.ga), this.downy = s(this.ga), this.rightx = i(this.ga - l / 2), this.righty = s(this.ga - l / 2), this.downx = cr.round6dp(this.downx), this.downy = cr.round6dp(this.downy), this.rightx = cr.round6dp(this.rightx), this.righty = cr.round6dp(this.righty), this.g1 = this.g, 0 > this.g && (this.downx *= -1, this.downy *= -1, this.g = n(this.g))
        }, c.onCreate = function() {
            this.maxspeed = this.properties[0], this.acc = this.properties[1], this.dec = this.properties[2], this.jumpStrength = this.properties[3], this.g = this.properties[4], this.g1 = this.g, this.maxFall = this.properties[5], this.enableDoubleJump = this.properties[6], this.jumpSustain = this.properties[7] / 1e3, this.defaultControls = this.properties[8], this.enabled = this.properties[9], this.wasOnFloor = !1, this.wasOverJumpthru = this.runtime.testOverlapJumpThru(this.inst), this.loadOverJumpthru = -1, this.sustainTime = 0, this.ga = cr.to_radians(90), this.updateGravity();
            var e = this;
            this.defaultControls && (document.addEventListener("keydown", function(t) {
                e.onKeyDown(t)
            }), document.addEventListener("keyup", function(t) {
                e.onKeyUp(t)
            })), this.recycled || (this.myDestroyCallback = function(t) {
                e.onInstanceDestroyed(t)
            }), this.runtime.addDestroyCallback(this.myDestroyCallback), this.inst.extra.isPlatformBehavior = !0
        }, c.saveToJSON = function() {
            return {
                ii: this.ignoreInput,
                lfx: this.lastFloorX,
                lfy: this.lastFloorY,
                lfo: this.lastFloorObject ? this.lastFloorObject.uid : -1,
                am: this.animMode,
                en: this.enabled,
                fall: this.fallthrough,
                ft: this.firstTick,
                dx: this.dx,
                dy: this.dy,
                ms: this.maxspeed,
                acc: this.acc,
                dec: this.dec,
                js: this.jumpStrength,
                g: this.g,
                g1: this.g1,
                mf: this.maxFall,
                wof: this.wasOnFloor,
                woj: this.wasOverJumpthru ? this.wasOverJumpthru.uid : -1,
                ga: this.ga,
                edj: this.enableDoubleJump,
                cdj: this.canDoubleJump,
                dj: this.doubleJumped,
                sus: this.jumpSustain,
                cc: this.ceilingCollisionMode
            }
        }, c.loadFromJSON = function(e) {
            this.ignoreInput = e.ii, this.lastFloorX = e.lfx, this.lastFloorY = e.lfy, this.loadFloorObject = e.lfo, this.animMode = e.am, this.enabled = e.en, this.fallthrough = e.fall, this.firstTick = e.ft, this.dx = e.dx, this.dy = e.dy, this.maxspeed = e.ms, this.acc = e.acc, this.dec = e.dec, this.jumpStrength = e.js, this.g = e.g, this.g1 = e.g1, this.maxFall = e.mf, this.wasOnFloor = e.wof, this.loadOverJumpthru = e.woj, this.ga = e.ga, this.enableDoubleJump = e.edj, this.canDoubleJump = e.cdj, this.doubleJumped = e.dj, this.jumpSustain = e.sus, this.ceilingCollisionMode = e.cc || 0, this.leftkey = !1, this.rightkey = !1, this.jumpkey = !1, this.jumped = !1, this.simleft = !1, this.simright = !1, this.simjump = !1, this.sustainTime = 0, this.updateGravity()
        }, c.afterLoad = function() {
            this.lastFloorObject = -1 === this.loadFloorObject ? null : this.runtime.getObjectByUID(this.loadFloorObject), this.wasOverJumpthru = -1 === this.loadOverJumpthru ? null : this.runtime.getObjectByUID(this.loadOverJumpthru)
        }, c.onInstanceDestroyed = function(e) {
            this.lastFloorObject == e && (this.lastFloorObject = null)
        }, c.onDestroy = function() {
            this.lastFloorObject = null, this.runtime.removeDestroyCallback(this.myDestroyCallback)
        }, c.onKeyDown = function(e) {
            switch (e.which) {
                case 38:
                    e.preventDefault(), this.jumpkey = !0;
                    break;
                case 37:
                    e.preventDefault(), this.leftkey = !0;
                    break;
                case 39:
                    e.preventDefault(), this.rightkey = !0;
            }
        }, c.onKeyUp = function(e) {
            switch (e.which) {
                case 38:
                    e.preventDefault(), this.jumpkey = !1, this.jumped = !1;
                    break;
                case 37:
                    e.preventDefault(), this.leftkey = !1;
                    break;
                case 39:
                    e.preventDefault(), this.rightkey = !1;
            }
        }, c.onWindowBlur = function() {
            this.leftkey = !1, this.rightkey = !1, this.jumpkey = !1
        }, c.getGDir = function() {
            return 0 > this.g ? -1 : 1
        }, c.isOnFloor = function() {
            var e = null,
                t = null,
                r = this.inst.x,
                n = this.inst.y,
                a, o, s;
            if (this.inst.x += this.downx, this.inst.y += this.downy, this.inst.set_bbox_changed(), this.lastFloorObject && this.runtime.testOverlap(this.inst, this.lastFloorObject) && (!this.runtime.typeHasBehavior(this.lastFloorObject.type, cr.behaviors.solid) || this.lastFloorObject.extra.solidEnabled)) return this.inst.x = r, this.inst.y = n, this.inst.set_bbox_changed(), this.lastFloorObject;
            if (e = this.runtime.testOverlapSolid(this.inst), e || 0 !== this.fallthrough || (t = this.runtime.testOverlapJumpThru(this.inst, !0)), this.inst.x = r, this.inst.y = n, this.inst.set_bbox_changed(), e) return this.runtime.testOverlap(this.inst, e) ? null : (this.floorIsJumpthru = !1, e);
            if (t && t.length) {
                for (a = 0, s = 0, o = t.length; a < o; a++) t[s] = t[a], this.runtime.testOverlap(this.inst, t[a]) || s++;
                if (1 <= s) return this.floorIsJumpthru = !0, t[0]
            }
            return null
        }, c.tick = function() {}, c.posttick = function() {
            var e = this.runtime.getDt(this.inst),
                t, r, s, l, p, d, c, u, g, y;
            this.jumpkey || this.simjump || (this.jumped = !1);
            var m = this.leftkey || this.simleft,
                _ = this.rightkey || this.simright,
                h = this.jumpkey || this.simjump,
                f = h && !this.jumped;
            if (this.simleft = !1, this.simright = !1, this.simjump = !1, !!this.enabled) {
                this.ignoreInput && (m = !1, _ = !1, h = !1, f = !1), h || (this.sustainTime = 0);
                var b = this.lastFloorObject,
                    x = !1;
                this.firstTick && ((this.runtime.testOverlapSolid(this.inst) || this.runtime.testOverlapJumpThru(this.inst)) && this.runtime.pushOutSolid(this.inst, -this.downx, -this.downy, 4, !0), this.firstTick = !1), b && 0 === this.dy && (b.y !== this.lastFloorY || b.x !== this.lastFloorX) && (t = b.x - this.lastFloorX, r = b.y - this.lastFloorY, this.inst.x += t, this.inst.y += r, this.inst.set_bbox_changed(), this.lastFloorX = b.x, this.lastFloorY = b.y, x = !0, this.runtime.testOverlapSolid(this.inst) && this.runtime.pushOutSolid(this.inst, -t, -r, 2.5 * a(t * t + r * r)));
                var v = this.isOnFloor(),
                    w = this.runtime.testOverlapSolid(this.inst);
                if (w) {
                    var S = n(this.inst.width),
                        T = n(this.inst.height);
                    if (this.inst.extra.inputPredicted) this.runtime.pushOutSolid(this.inst, -this.downx, -this.downy, 10, !1);
                    else if (this.runtime.pushOutSolidAxis(this.inst, -this.downx, -this.downy, T / 8)) this.runtime.registerCollision(this.inst, w);
                    else if (this.runtime.pushOutSolidAxis(this.inst, this.rightx, this.righty, S / 2)) this.runtime.registerCollision(this.inst, w);
                    else if (this.runtime.pushOutSolidAxis(this.inst, this.downx, this.downy, T / 2)) this.runtime.registerCollision(this.inst, w);
                    else if (this.runtime.pushOutSolidNearest(this.inst, o(S, T) / 2)) this.runtime.registerCollision(this.inst, w);
                    else return
                }
                v ? (this.doubleJumped = !1, this.canDoubleJump = !1, 0 < this.dy && (!this.wasOnFloor && (this.runtime.pushInFractional(this.inst, -this.downx, -this.downy, v, 16), this.wasOnFloor = !0), this.dy = 0), b == v ? x && (w = this.runtime.testOverlapSolid(this.inst), w && (this.runtime.registerCollision(this.inst, w), 0 !== t && (0 < t ? this.runtime.pushOutSolid(this.inst, -this.rightx, -this.righty) : this.runtime.pushOutSolid(this.inst, this.rightx, this.righty)), this.runtime.pushOutSolid(this.inst, -this.downx, -this.downy))) : (this.lastFloorObject = v, this.lastFloorX = v.x, this.lastFloorY = v.y, this.runtime.registerCollision(this.inst, v))) : !h && (this.canDoubleJump = !0), (v && f || !v && this.enableDoubleJump && h && this.canDoubleJump && !this.doubleJumped) && (g = this.inst.x, y = this.inst.y, this.inst.x -= this.downx, this.inst.y -= this.downy, this.inst.set_bbox_changed(), this.runtime.testOverlapSolid(this.inst) ? f = !1 : (this.sustainTime = this.jumpSustain, this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnJump, this.inst), this.animMode = 2, this.dy = -this.jumpStrength, f = !0, v ? this.jumped = !0 : this.doubleJumped = !0), this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed()), v || (h && 0 < this.sustainTime ? (this.dy = -this.jumpStrength, this.sustainTime -= e) : (this.lastFloorObject = null, this.dy += this.g * e, this.dy > this.maxFall && (this.dy = this.maxFall)), f && (this.jumped = !0)), this.wasOnFloor = !!v, m == _ && (0 > this.dx ? (this.dx += this.dec * e, 0 < this.dx && (this.dx = 0)) : 0 < this.dx && (this.dx -= this.dec * e, 0 > this.dx && (this.dx = 0)));
                var O = 0;
                m && !_ && (0 < this.dx ? O = -(this.acc + this.dec) : O = -this.acc), _ && !m && (0 > this.dx ? O = this.acc + this.dec : O = this.acc), this.dx += O * e, this.dx > this.maxspeed ? this.dx = this.maxspeed : this.dx < -this.maxspeed && (this.dx = -this.maxspeed);
                var E = !1;
                if (0 !== this.dx) {
                    g = this.inst.x, y = this.inst.y, t = this.runtime.accelerate(this.dx, -this.maxspeed, this.maxspeed, O, e) * this.rightx, r = this.runtime.accelerate(this.dx, -this.maxspeed, this.maxspeed, O, e) * this.righty, this.inst.x += this.rightx * (1 < this.dx ? 1 : -1) - this.downx, this.inst.y += this.righty * (1 < this.dx ? 1 : -1) - this.downy, this.inst.set_bbox_changed();
                    var C = !1,
                        A = this.runtime.testOverlapSolid(this.inst);
                    if (this.inst.x = g + t, this.inst.y = y + r, this.inst.set_bbox_changed(), s = this.runtime.testOverlapSolid(this.inst), !s && v && (s = this.runtime.testOverlapJumpThru(this.inst), s && (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed(), this.runtime.testOverlap(this.inst, s) ? (s = null, C = !1) : C = !0, this.inst.x = g + t, this.inst.y = y + r, this.inst.set_bbox_changed())), s) {
                        var P = n(this.dx * e) + 2;
                        A || !this.runtime.pushOutSolid(this.inst, -this.downx, -this.downy, P, C, s) ? (this.runtime.registerCollision(this.inst, s), P = o(n(2.5 * (this.dx * e)), 30), this.runtime.pushOutSolid(this.inst, this.rightx * (0 > this.dx ? 1 : -1), this.righty * (0 > this.dx ? 1 : -1), P, !1) ? v && !C && !this.floorIsJumpthru && (g = this.inst.x, y = this.inst.y, this.inst.x += this.downx, this.inst.y += this.downy, this.runtime.testOverlapSolid(this.inst) ? !this.runtime.pushOutSolid(this.inst, -this.downx, -this.downy, 3, !1) && (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed()) : (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed())) : (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed()), !C && (this.dx = 0)) : !A && !f && n(this.dy) < n(this.jumpStrength / 4) && (this.dy = 0, !v && (E = !0))
                    } else {
                        var L = this.isOnFloor();
                        v && !L ? (l = Math.ceil(n(this.dx * e)) + 2, g = this.inst.x, y = this.inst.y, this.inst.x += this.downx * l, this.inst.y += this.downy * l, this.inst.set_bbox_changed(), this.runtime.testOverlapSolid(this.inst) || this.runtime.testOverlapJumpThru(this.inst) ? this.runtime.pushOutSolid(this.inst, -this.downx, -this.downy, l + 2, !0) : (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed())) : L && (!v && this.floorIsJumpthru && (this.lastFloorObject = L, this.lastFloorX = L.x, this.lastFloorY = L.y, this.dy = 0, E = !0), 0 === this.dy && this.runtime.pushInFractional(this.inst, -this.downx, -this.downy, L, 16))
                    }
                }
                if (0 !== this.dy) {
                    g = this.inst.x, y = this.inst.y, this.inst.x += this.runtime.accelerate(this.dy, -Infinity, this.maxFall, this.g, e) * this.downx, this.inst.y += this.runtime.accelerate(this.dy, -Infinity, this.maxFall, this.g, e) * this.downy;
                    var I = this.inst.x,
                        R = this.inst.y;
                    this.inst.set_bbox_changed(), w = this.runtime.testOverlapSolid(this.inst);
                    var k = !1;
                    if (!w && 0 < this.dy && !v) {
                        if (p = 0 < this.fallthrough ? null : this.runtime.testOverlapJumpThru(this.inst, !0), p && p.length) {
                            if (this.wasOverJumpthru) {
                                for (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed(), (d = 0, u = 0, c = p.length); d < c; d++) p[u] = p[d], this.runtime.testOverlap(this.inst, p[d]) || u++;
                                p.length = u, this.inst.x = I, this.inst.y = R, this.inst.set_bbox_changed()
                            }
                            1 <= p.length && (w = p[0])
                        }
                        k = !!w
                    }
                    if (w) {
                        this.runtime.registerCollision(this.inst, w), this.sustainTime = 0;
                        var P = k ? n(2.5 * (this.dy * e) + 10) : o(n(2.5 * (this.dy * e) + 10), 30);
                        this.runtime.pushOutSolid(this.inst, this.downx * (0 > this.dy ? 1 : -1), this.downy * (0 > this.dy ? 1 : -1), P, k, w) ? (this.lastFloorObject = w, this.lastFloorX = w.x, this.lastFloorY = w.y, this.floorIsJumpthru = k, k && (E = !0), (0 < this.dy || 0 === this.ceilingCollisionMode) && (this.dy = 0), 0 > this.dy && 1 === this.ceilingCollisionMode && this.runtime.pushInFractional(this.inst, this.downx, this.downy, w, 32)) : (this.inst.x = g, this.inst.y = y, this.inst.set_bbox_changed(), this.wasOnFloor = !0, !k && (this.dy = 0))
                    }
                }
                3 !== this.animMode && 0 < this.dy && !v && (this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnFall, this.inst), this.animMode = 3), (v || E) && 0 <= this.dy && (3 === this.animMode || E || f && 0 === this.dy ? (this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnLand, this.inst), this.animMode = 0 === this.dx && 0 === this.dy ? 0 : 1) : (0 !== this.animMode && 0 === this.dx && 0 === this.dy && (this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnStop, this.inst), this.animMode = 0), 1 !== this.animMode && (0 !== this.dx || 0 !== this.dy) && !f && (this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnMove, this.inst), this.animMode = 1))), 0 < this.fallthrough && this.fallthrough--, this.wasOverJumpthru = this.runtime.testOverlapJumpThru(this.inst)
            }
        };
        e.prototype.IsMoving = function() {
            return 0 !== this.dx || 0 !== this.dy
        }, e.prototype.CompareSpeed = function(e, t) {
            var r = a(this.dx * this.dx + this.dy * this.dy);
            return cr.do_cmp(r, e, t)
        }, e.prototype.IsOnFloor = function() {
            if (0 !== this.dy) return !1;
            var e = null,
                t = null,
                r = this.inst.x,
                n = this.inst.y,
                a, o, s;
            if (this.inst.x += this.downx, this.inst.y += this.downy, this.inst.set_bbox_changed(), e = this.runtime.testOverlapSolid(this.inst), e || 0 !== this.fallthrough || (t = this.runtime.testOverlapJumpThru(this.inst, !0)), this.inst.x = r, this.inst.y = n, this.inst.set_bbox_changed(), e) return !this.runtime.testOverlap(this.inst, e);
            if (t && t.length) {
                for (a = 0, s = 0, o = t.length; a < o; a++) t[s] = t[a], this.runtime.testOverlap(this.inst, t[a]) || s++;
                if (1 <= s) return !0
            }
            return !1
        }, e.prototype.IsByWall = function(e) {
            var t = !1,
                r = this.inst.x,
                n = this.inst.y;
            return (0 === e ? (this.inst.x -= 2 * this.rightx, this.inst.y -= 2 * this.righty) : (this.inst.x += 2 * this.rightx, this.inst.y += 2 * this.righty), this.inst.set_bbox_changed(), !this.runtime.testOverlapSolid(this.inst)) ? (this.inst.x = r, this.inst.y = n, this.inst.set_bbox_changed(), !1) : (this.inst.x -= 3 * this.downx, this.inst.y -= 3 * this.downy, this.inst.set_bbox_changed(), t = this.runtime.testOverlapSolid(this.inst), this.inst.x = r, this.inst.y = n, this.inst.set_bbox_changed(), t)
        }, e.prototype.IsJumping = function() {
            return 0 > this.dy
        }, e.prototype.IsFalling = function() {
            return 0 < this.dy
        }, e.prototype.OnJump = function() {
            return !0
        }, e.prototype.OnFall = function() {
            return !0
        }, e.prototype.OnStop = function() {
            return !0
        }, e.prototype.OnMove = function() {
            return !0
        }, e.prototype.OnLand = function() {
            return !0
        }, e.prototype.IsDoubleJumpEnabled = function() {
            return this.enableDoubleJump
        }, e.prototype.IsEnabled = function() {
            return this.enabled
        }, p.cnds = new e;
        t.prototype.SetIgnoreInput = function(e) {
            this.ignoreInput = e
        }, t.prototype.SetMaxSpeed = function(e) {
            this.maxspeed = e, 0 > this.maxspeed && (this.maxspeed = 0)
        }, t.prototype.SetAcceleration = function(e) {
            this.acc = e, 0 > this.acc && (this.acc = 0)
        }, t.prototype.SetDeceleration = function(e) {
            this.dec = e, 0 > this.dec && (this.dec = 0)
        }, t.prototype.SetJumpStrength = function(e) {
            this.jumpStrength = e, 0 > this.jumpStrength && (this.jumpStrength = 0)
        }, t.prototype.SetGravity = function(e) {
            this.g1 === e || (this.g = e, this.updateGravity(), this.runtime.testOverlapSolid(this.inst) && (this.runtime.pushOutSolid(this.inst, this.downx, this.downy, 10), this.inst.x += 2 * this.downx, this.inst.y += 2 * this.downy, this.inst.set_bbox_changed()), this.lastFloorObject = null)
        }, t.prototype.SetMaxFallSpeed = function(e) {
            this.maxFall = e, 0 > this.maxFall && (this.maxFall = 0)
        }, t.prototype.SimulateControl = function(e) {
            0 === e ? this.simleft = !0 : 1 === e ? this.simright = !0 : 2 === e ? this.simjump = !0 : void 0
        }, t.prototype.SetVectorX = function(e) {
            this.dx = e
        }, t.prototype.SetVectorY = function(e) {
            this.dy = e
        }, t.prototype.SetGravityAngle = function(e) {
            e = cr.to_radians(e), e = cr.clamp_angle(e);
            this.ga === e || (this.ga = e, this.updateGravity(), this.lastFloorObject = null)
        }, t.prototype.SetEnabled = function(e) {
            this.enabled !== (1 === e) && (this.enabled = 1 === e, !this.enabled && (this.lastFloorObject = null))
        }, t.prototype.FallThrough = function() {
            var e = this.inst.x,
                t = this.inst.y;
            this.inst.x += this.downx, this.inst.y += this.downy, this.inst.set_bbox_changed();
            var r = this.runtime.testOverlapJumpThru(this.inst, !1);
            this.inst.x = e, this.inst.y = t, this.inst.set_bbox_changed();
            r && (this.fallthrough = 3, this.lastFloorObject = null)
        }, t.prototype.SetDoubleJumpEnabled = function(t) {
            this.enableDoubleJump = 0 !== t
        }, t.prototype.SetJumpSustain = function(e) {
            this.jumpSustain = e / 1e3
        }, t.prototype.SetCeilingCollision = function(e) {
            this.ceilingCollisionMode = e
        }, p.acts = new t;
        r.prototype.Speed = function(e) {
            e.set_float(a(this.dx * this.dx + this.dy * this.dy))
        }, r.prototype.MaxSpeed = function(e) {
            e.set_float(this.maxspeed)
        }, r.prototype.Acceleration = function(e) {
            e.set_float(this.acc)
        }, r.prototype.Deceleration = function(e) {
            e.set_float(this.dec)
        }, r.prototype.JumpStrength = function(e) {
            e.set_float(this.jumpStrength)
        }, r.prototype.Gravity = function(e) {
            e.set_float(this.g)
        }, r.prototype.GravityAngle = function(e) {
            e.set_float(cr.to_degrees(this.ga))
        }, r.prototype.MaxFallSpeed = function(e) {
            e.set_float(this.maxFall)
        }, r.prototype.MovingAngle = function(e) {
            e.set_float(cr.to_degrees(Math.atan2(this.dy, this.dx)))
        }, r.prototype.VectorX = function(e) {
            e.set_float(this.dx)
        }, r.prototype.VectorY = function(e) {
            e.set_float(this.dy)
        }, r.prototype.JumpSustain = function(e) {
            e.set_float(1e3 * this.jumpSustain)
        }, p.exps = new r
    }();
cr.behaviors.Fade = function(e) {
        this.runtime = e
    },
    function() {
        function e() {}

        function t() {}

        function r() {}
        var n = cr.behaviors.Fade.prototype;
        n.Type = function(e, t) {
            this.behavior = e, this.objtype = t, this.runtime = e.runtime
        };
        var a = n.Type.prototype;
        a.onCreate = function() {}, n.Instance = function(e, t) {
            this.type = e, this.behavior = e.behavior, this.inst = t, this.runtime = e.runtime
        };
        var o = n.Instance.prototype;
        o.onCreate = function() {
            this.fadeInTime = this.properties[0], this.waitTime = this.properties[1], this.fadeOutTime = this.properties[2], this.destroy = this.properties[3], this.activeAtStart = this.properties[4], this.setMaxOpacity = !1, this.stage = this.activeAtStart ? 0 : 3, this.recycled ? this.stageTime.reset() : this.stageTime = new cr.KahanAdder, this.maxOpacity = this.inst.opacity ? this.inst.opacity : 1, this.activeAtStart && (0 === this.fadeInTime ? (this.stage = 1, 0 === this.waitTime && (this.stage = 2)) : (this.inst.opacity = 0, this.runtime.redraw = !0))
        }, o.saveToJSON = function() {
            return {
                fit: this.fadeInTime,
                wt: this.waitTime,
                fot: this.fadeOutTime,
                s: this.stage,
                st: this.stageTime.sum,
                mo: this.maxOpacity
            }
        }, o.loadFromJSON = function(e) {
            this.fadeInTime = e.fit, this.waitTime = e.wt, this.fadeOutTime = e.fot, this.stage = e.s, this.stageTime.reset(), this.stageTime.sum = e.st, this.maxOpacity = e.mo
        }, o.tick = function() {
            this.stageTime.add(this.runtime.getDt(this.inst)), 0 === this.stage && (this.inst.opacity = this.stageTime.sum / this.fadeInTime * this.maxOpacity, this.runtime.redraw = !0, this.inst.opacity >= this.maxOpacity && (this.inst.opacity = this.maxOpacity, this.stage = 1, this.stageTime.reset(), this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeInEnd, this.inst))), 1 === this.stage && this.stageTime.sum >= this.waitTime && (this.stage = 2, this.stageTime.reset(), this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnWaitEnd, this.inst)), 2 === this.stage && 0 !== this.fadeOutTime && (this.inst.opacity = this.maxOpacity - this.stageTime.sum / this.fadeOutTime * this.maxOpacity, this.runtime.redraw = !0, 0 > this.inst.opacity && (this.inst.opacity = 0, this.stage = 3, this.stageTime.reset(), this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd, this.inst), this.destroy && this.runtime.DestroyInstance(this.inst)))
        }, o.doStart = function() {
            this.stage = 0, this.stageTime.reset(), 0 === this.fadeInTime ? (this.stage = 1, 0 === this.waitTime && (this.stage = 2)) : (this.inst.opacity = 0, this.runtime.redraw = !0)
        };
        e.prototype.OnFadeOutEnd = function() {
            return !0
        }, e.prototype.OnFadeInEnd = function() {
            return !0
        }, e.prototype.OnWaitEnd = function() {
            return !0
        }, n.cnds = new e;
        t.prototype.StartFade = function() {
            this.activeAtStart || this.setMaxOpacity || (this.maxOpacity = this.inst.opacity ? this.inst.opacity : 1, this.setMaxOpacity = !0), 3 === this.stage && this.doStart()
        }, t.prototype.RestartFade = function() {
            this.doStart()
        }, t.prototype.SetFadeInTime = function(e) {
            0 > e && (e = 0), this.fadeInTime = e
        }, t.prototype.SetWaitTime = function(e) {
            0 > e && (e = 0), this.waitTime = e
        }, t.prototype.SetFadeOutTime = function(e) {
            0 > e && (e = 0), this.fadeOutTime = e
        }, n.acts = new t;
        r.prototype.FadeInTime = function(e) {
            e.set_float(this.fadeInTime)
        }, r.prototype.WaitTime = function(e) {
            e.set_float(this.waitTime)
        }, r.prototype.FadeOutTime = function(e) {
            e.set_float(this.fadeOutTime)
        }, n.exps = new r
    }();
var easeOutBounceArray = [],
    easeInElasticArray = [],
    easeOutElasticArray = [],
    easeInOutElasticArray = [],
    easeInCircle = [],
    easeOutCircle = [],
    easeInOutCircle = [],
    easeInBack = [],
    easeOutBack = [],
    easeInOutBack = [],
    litetween_precision = 1e4,
    updateLimit = 0;

function easeOutBouncefunc(e) {
    return result = (e /= 1) < 1 / 2.75 ? 1 * (7.5625 * e * e) + 0 : e < 2 / 2.75 ? 1 * (7.5625 * (e -= 1.5 / 2.75) * e + .75) + 0 : e < 2.5 / 2.75 ? 1 * (7.5625 * (e -= 2.25 / 2.75) * e + .9375) + 0 : 1 * (7.5625 * (e -= 2.625 / 2.75) * e + .984375) + 0, result
}

function integerize(e, t) {
    return Math.round(e / t * litetween_precision)
}

function easeFunc(e, r, n, o, i, l, d) {
    var c = Math.asin,
        u = Math.pow,
        g = Math.abs,
        y = Math.sqrt,
        m = Math.sin,
        _ = Math.PI,
        h = 0;
    switch (e) {
        case 0:
            h = o * r / i + n;
            break;
        case 1:
            h = o * (r /= i) * r + n;
            break;
        case 2:
            h = -o * (r /= i) * (r - 2) + n;
            break;
        case 3:
            h = 1 > (r /= i / 2) ? o / 2 * r * r + n : -o / 2 * (--r * (r - 2) - 1) + n;
            break;
        case 4:
            h = o * (r /= i) * r * r + n;
            break;
        case 5:
            h = o * ((r = r / i - 1) * r * r + 1) + n;
            break;
        case 6:
            h = 1 > (r /= i / 2) ? o / 2 * r * r * r + n : o / 2 * ((r -= 2) * r * r + 2) + n;
            break;
        case 7:
            h = o * (r /= i) * r * r * r + n;
            break;
        case 8:
            h = -o * ((r = r / i - 1) * r * r * r - 1) + n;
            break;
        case 9:
            h = 1 > (r /= i / 2) ? o / 2 * r * r * r * r + n : -o / 2 * ((r -= 2) * r * r * r - 2) + n;
            break;
        case 10:
            h = o * (r /= i) * r * r * r * r + n;
            break;
        case 11:
            h = o * ((r = r / i - 1) * r * r * r * r + 1) + n;
            break;
        case 12:
            h = 1 > (r /= i / 2) ? o / 2 * r * r * r * r * r + n : o / 2 * ((r -= 2) * r * r * r * r + 2) + n;
            break;
        case 13:
            h = d.optimized ? easeInCircle[integerize(r, i)] : -(y(1 - r * r) - 1);
            break;
        case 14:
            h = d.optimized ? easeOutCircle[integerize(r, i)] : y(1 - (r - 1) * (r - 1));
            break;
        case 15:
            h = d.optimized ? easeInOutCircle[integerize(r, i)] : 1 > (r /= i / 2) ? -o / 2 * (y(1 - r * r) - 1) + n : o / 2 * (y(1 - (r -= 2) * r) + 1) + n;
            break;
        case 16:
            if (d.optimized) h = easeInBack[integerize(r, i)];
            else {
                var f = d.s;
                h = o * (r /= i) * r * ((f + 1) * r - f) + n
            }
            break;
        case 17:
            if (d.optimized) h = easeOutBack[integerize(r, i)];
            else {
                var f = d.s;
                h = o * ((r = r / i - 1) * r * ((f + 1) * r + f) + 1) + n
            }
            break;
        case 18:
            if (d.optimized) h = easeInOutBack[integerize(r, i)];
            else {
                var f = d.s;
                h = 1 > (r /= i / 2) ? o / 2 * (r * r * (((f *= 1.525) + 1) * r - f)) + n : o / 2 * ((r -= 2) * r * (((f *= 1.525) + 1) * r + f) + 2) + n
            }
            break;
        case 19:
            if (d.optimized) h = easeInElasticArray[integerize(r, i)];
            else {
                var b = d.a,
                    x = d.p,
                    f = 0;
                if (0 == r && (h = n), 1 == (r /= i) && (h = n + o), 0 == x && (x = .3 * i), 0 == b || b < g(o)) b = o, f = x / 4;
                else var f = x / (2 * _) * c(o / b);
                h = -(b * u(2, 10 * (r -= 1)) * m((r * i - f) * (2 * _) / x)) + n
            }
            break;
        case 20:
            if (d.optimized) h = easeOutElasticArray[integerize(r, i)];
            else {
                var b = d.a,
                    x = d.p,
                    f = 0;
                if (0 == r && (h = n), 1 == (r /= i) && (h = n + o), 0 == x && (x = .3 * i), 0 == b || b < g(o)) {
                    b = o;
                    var f = x / 4
                } else var f = x / (2 * _) * c(o / b);
                h = b * u(2, -10 * r) * m((r * i - f) * (2 * _) / x) + o + n
            }
            break;
        case 21:
            if (d.optimized) h = easeInOutElasticArray[integerize(r, i)];
            else {
                var b = d.a,
                    x = d.p,
                    f = 0;
                if (0 == r && (h = n), 2 == (r /= i / 2) && (h = n + o), 0 == x && (x = i * (.3 * 1.5)), 0 == b || b < g(o)) {
                    b = o;
                    var f = x / 4
                } else var f = x / (2 * _) * c(o / b);
                h = 1 > r ? -.5 * (b * u(2, 10 * (r -= 1)) * m((r * i - f) * (2 * _) / x)) + n : .5 * (b * u(2, -10 * (r -= 1)) * m((r * i - f) * (2 * _) / x)) + o + n
            }
            break;
        case 22:
            h = d.optimized ? o - easeOutBounceArray[integerize(i - r, i)] + n : o - easeOutBouncefunc(i - r / i) + n;
            break;
        case 23:
            h = d.optimized ? easeOutBounceArray[integerize(r, i)] : easeOutBouncefunc(r / i);
            break;
        case 24:
            h = d.optimized ? r < i / 2 ? .5 * (o - easeOutBounceArray[integerize(i - 2 * r, i)] + n) + n : .5 * easeOutBounceArray[integerize(2 * r - i, i)] + .5 * o + n : r < i / 2 ? .5 * (o - easeOutBouncefunc(i - 2 * r) + n) + n : .5 * easeOutBouncefunc((2 * r - i) / i) + .5 * o + n;
            break;
        case 25:
            var v = r / i / 2;
            h = 2 * (v * v * (3 - 2 * v));
            break;
        case 26:
            var v = (r / i + 1) / 2;
            h = 2 * (v * v * (3 - 2 * v)) - 1;
            break;
        case 27:
            var v = r / i;
            h = v * v * (3 - 2 * v);
    }
    return l ? o - n - h : h
}(function() {
    for (var e = Math.asin, r = Math.pow, n = Math.sqrt, o = Math.sin, i = Math.PI, l = 0, d = 0, c = 0, u = 0, g = 0, y = 0; y <= litetween_precision; y++) {
        if (u = y / litetween_precision, l = (u /= 1) < 1 / 2.75 ? 1 * (7.5625 * u * u) + 0 : u < 2 / 2.75 ? 1 * (7.5625 * (u -= 1.5 / 2.75) * u + .75) + 0 : u < 2.5 / 2.75 ? 1 * (7.5625 * (u -= 2.25 / 2.75) * u + .9375) + 0 : 1 * (7.5625 * (u -= 2.625 / 2.75) * u + .984375) + 0, easeOutBounceArray[y] = l, u = y / litetween_precision, d = 0, c = 0, 0 == u && (l = 0), 1 == (u /= 1) && (l = 1), 0 == c && (c = 1 * .3), 0 == d || 1 > d) {
            d = 1;
            var g = c / 4
        } else var g = c / (2 * i) * e(1 / d);
        if (l = -(d * r(2, 10 * (u -= 1)) * o((1 * u - g) * (2 * i) / c)) + 0, easeInElasticArray[y] = l, u = y / litetween_precision, d = 0, c = 0, 0 == u && (l = 0), 1 == (u /= 1) && (l = 1), 0 == c && (c = .3 * 1), 0 == d || 1 > d) {
            d = 1;
            var g = c / 4
        } else var g = c / (2 * i) * e(1 / d);
        if (l = d * r(2, -10 * u) * o((1 * u - g) * (2 * i) / c) + 1 + 0, easeOutElasticArray[y] = l, u = y / litetween_precision, d = 0, c = 0, 0 == u && (l = 0), 2 == (u /= 1 / 2) && (l = 1), 0 == c && (c = 1 * (.3 * 1.5)), 0 == d || 1 > d) {
            d = 1;
            var g = c / 4
        } else var g = c / (2 * i) * e(1 / d);
        l = 1 > u ? -.5 * (d * r(2, 10 * (u -= 1)) * o((1 * u - g) * (2 * i) / c)) + 0 : .5 * (d * r(2, -10 * (u -= 1)) * o((1 * u - g) * (2 * i) / c)) + 1 + 0, easeInOutElasticArray[y] = l, u = y / litetween_precision, easeInCircle[y] = -(n(1 - u * u) - 1), u = y / litetween_precision, easeOutCircle[y] = n(1 - (u - 1) * (u - 1)), u = y / litetween_precision, l = 1 > (u /= 1 / 2) ? -1 / 2 * (n(1 - u * u) - 1) + 0 : 1 / 2 * (n(1 - (u -= 2) * u) + 1) + 0, easeInOutCircle[y] = l, u = y / litetween_precision, g = 0, 0 == g && (g = 1.70158), l = 1 * (u /= 1) * u * ((g + 1) * u - g) + 0, easeInBack[y] = l, u = y / litetween_precision, g = 0, 0 == g && (g = 1.70158), l = 1 * ((u = u / 1 - 1) * u * ((g + 1) * u + g) + 1) + 0, easeOutBack[y] = l, u = y / litetween_precision, g = 0, 0 == g && (g = 1.70158), l = 1 > (u /= 1 / 2) ? 1 / 2 * (u * u * (((g *= 1.525) + 1) * u - g)) + 0 : 1 / 2 * ((u -= 2) * u * (((g *= 1.525) + 1) * u + g) + 2) + 0, easeInOutBack[y] = l
    }
})();
var TweenObject = function() {
    return function(e, t, r, n, a, o, s) {
        this.name = e, this.value = 0, this.setInitial(n), this.setTarget(a), this.easefunc = r, this.tweened = t, this.duration = o, this.progress = 0, this.state = 0, this.onStart = !1, this.onEnd = !1, this.onReverseStart = !1, this.onReverseEnd = !1, this.lastKnownValue = 0, this.lastKnownValue2 = 0, this.enforce = s, this.pingpong = 1, this.flipEase = !1, this.easingparam = [], this.lastState = 1;
        for (var l = 0; 28 > l; l++) this.easingparam[l] = {}, this.easingparam[l].a = 0, this.easingparam[l].p = 0, this.easingparam[l].t = 0, this.easingparam[l].s = 0, this.easingparam[l].optimized = !0
    }
}();
(function() {
    TweenObject.prototype = {}, TweenObject.prototype.flipTarget = function() {
        var e = this.initialparam1,
            t = this.initialparam2;
        this.initialparam1 = this.targetparam1, this.initialparam2 = this.targetparam2, this.targetparam1 = e, this.targetparam2 = t, this.lastKnownValue = 0, this.lastKnownValue2 = 0
    }, TweenObject.prototype.setInitial = function(e) {
        this.initialparam1 = parseFloat(e.split(",")[0]), this.initialparam2 = parseFloat(e.split(",")[1]), this.lastKnownValue = 0, this.lastKnownValue2 = 0
    }, TweenObject.prototype.setTarget = function(e) {
        this.targetparam1 = parseFloat(e.split(",")[0]), this.targetparam2 = parseFloat(e.split(",")[1]), isNaN(this.targetparam2) && (this.targetparam2 = this.targetparam1)
    }, TweenObject.prototype.OnTick = function(e) {
        if (0 === this.state) return -1;
        if (1 === this.state && (this.progress += e), 2 === this.state && (this.progress -= e), 3 === this.state && (this.state = 0), (4 === this.state || 6 === this.state) && (this.progress += e * this.pingpong), 5 === this.state && (this.progress += e * this.pingpong), 0 > this.progress) return this.progress = 0, 4 === this.state ? this.pingpong = 1 : 6 === this.state ? (this.pingpong = 1, this.flipEase = !1) : this.state = 0, this.onReverseEnd = !0, 0;
        if (this.progress > this.duration) return this.progress = this.duration, 4 === this.state ? this.pingpong = -1 : 6 === this.state ? (this.pingpong = -1, this.flipEase = !0) : 5 === this.state ? this.progress = 0 : this.state = 0, this.onEnd = !0, 1;
        if (this.flipEase) var t = easeFunc(this.easefunc, this.duration - this.progress, 0, 1, this.duration, this.flipEase, this.easingparam[this.easefunc]);
        else var t = easeFunc(this.easefunc, this.progress, 0, 1, this.duration, this.flipEase, this.easingparam[this.easefunc]);
        return t
    }
})();

function trim(e) {
    return e.replace(/^\s\s*/, "").replace(/\s\s*$/, "")
}
cr.behaviors.lunarray_LiteTween = function(e) {
        this.runtime = e
    },
    function() {
        var e = cr.behaviors.lunarray_LiteTween.prototype;
        e.Type = function(e, t) {
            this.behavior = e, this.objtype = t, this.runtime = e.runtime
        };
        var t = e.Type.prototype;
        t.onCreate = function() {}, e.Instance = function(e, t) {
            this.type = e, this.behavior = e.behavior, this.inst = t, this.runtime = e.runtime, this.i = 0
        };
        var r = e.Instance.prototype;
        r.onCreate = function() {
            this.playmode = this.properties[0], this.active = 1 == this.playmode || 2 == this.playmode || 3 == this.playmode || 4 == this.playmode, this.tweened = this.properties[1], this.easing = this.properties[2], this.target = this.properties[3], this.targetmode = this.properties[4], this.useCurrent = !1, 1 === this.targetmode && (this.target = "relative(" + this.target + ")"), this.duration = this.properties[5], this.enforce = 1 === this.properties[6], this.value = 0, this.tween_list = {}, this.addToTweenList("default", this.tweened, this.easing, "current", this.target, this.duration, this.enforce), 1 === this.properties[0] && this.startTween(0), 2 === this.properties[0] && this.startTween(2), 3 === this.properties[0] && this.startTween(3), 4 === this.properties[0] && this.startTween(4)
        }, r.parseCurrent = function(e, t) {
            t === void 0 && (t = "current");
            var r = trim(t);
            t = trim(t);
            var n = this.value;
            if ("current" === t) switch (e) {
                case 0:
                    r = this.inst.x + "," + this.inst.y;
                    break;
                case 1:
                    r = this.inst.width + "," + this.inst.height;
                    break;
                case 2:
                    r = this.inst.width + "," + this.inst.height;
                    break;
                case 3:
                    r = this.inst.width + "," + this.inst.height;
                    break;
                case 4:
                    r = cr.to_degrees(this.inst.angle) + "," + cr.to_degrees(this.inst.angle);
                    break;
                case 5:
                    r = 100 * this.inst.opacity + "," + 100 * this.inst.opacity;
                    break;
                case 6:
                    r = n + "," + n;
                    break;
                case 7:
                    r = this.inst.x + "," + this.inst.y;
                    break;
                case 8:
                    r = this.inst.x + "," + this.inst.y;
                    break;
                case 9:
                    r = void 0 === this.inst.curFrame ? "1,1" : this.inst.width / this.inst.curFrame.width + "," + this.inst.height / this.inst.curFrame.height;
                    break;
                default:
            }
            if ("relative" === t.substring(0, 8)) {
                var a = t.match(/\((.*?)\)/);
                if (a) var o = parseFloat(a[1].split(",")[0]),
                    i = parseFloat(a[1].split(",")[1]);
                switch (isNaN(o) && (o = 0), isNaN(i) && (i = 0), e) {
                    case 0:
                        r = this.inst.x + o + "," + (this.inst.y + i);
                        break;
                    case 1:
                        r = this.inst.width + o + "," + (this.inst.height + i);
                        break;
                    case 2:
                        r = this.inst.width + o + "," + (this.inst.height + i);
                        break;
                    case 3:
                        r = this.inst.width + o + "," + (this.inst.height + i);
                        break;
                    case 4:
                        r = cr.to_degrees(this.inst.angle) + o + "," + (cr.to_degrees(this.inst.angle) + i);
                        break;
                    case 5:
                        r = 100 * this.inst.opacity + o + "," + (100 * this.inst.opacity + i);
                        break;
                    case 6:
                        r = n + o + "," + n + o;
                        break;
                    case 7:
                        r = this.inst.x + o + "," + this.inst.y;
                        break;
                    case 8:
                        r = this.inst.x + "," + (this.inst.y + o);
                        break;
                    case 9:
                        r = o + "," + i;
                        break;
                    default:
                }
            }
            return r
        }, r.addToTweenList = function(e, t, r, n, a, o, i) {
            n = this.parseCurrent(t, n), a = this.parseCurrent(t, a), this.tween_list[e] !== void 0 && delete this.tween_list[e], this.tween_list[e] = new TweenObject(e, t, r, n, a, o, i), this.tween_list[e].dt = 0
        }, r.saveToJSON = function() {
            JSON.stringify(this.tween_list["default"]);
            return {
                playmode: this.playmode,
                active: this.active,
                tweened: this.tweened,
                easing: this.easing,
                target: this.target,
                targetmode: this.targetmode,
                useCurrent: this.useCurrent,
                duration: this.duration,
                enforce: this.enforce,
                value: this.value,
                tweenlist: JSON.stringify(this.tween_list["default"])
            }
        }, TweenObject.Load = function(e, t, r, n, a, o, s, l) {
            var p = new TweenObject(t, r, n, a, o, s, l);
            for (var d in e) p[d] = e[d];
            return p
        }, r.loadFromJSON = function(e) {
            var t = JSON.parse(e.tweenlist),
                r = TweenObject.Load(t, t.name, t.tweened, t.easefunc, t.initialparam1 + "," + t.initialparam2, t.targetparam1 + "," + t.targetparam2, t.duration, t.enforce);
            this.tween_list["default"] = r, this.playmode = e.playmode, this.active = e.active, this.movement = e.tweened, this.easing = e.easing, this.target = e.target, this.targetmode = e.targetmode, this.useCurrent = e.useCurrent, this.duration = e.duration, this.enforce = e.enforce, this.value = e.value
        }, r.setProgressTo = function(e) {
            for (var t in 1 < e && (e = 1), 0 > e && (e = 0), this.tween_list) {
                var r = this.tween_list[t];
                r.lastKnownValue = 0, r.lastKnownValue2 = 0, r.state = 3, r.progress = e * r.duration;
                var n = r.OnTick(0);
                this.updateTween(r, n)
            }
        }, r.startTween = function(e) {
            for (var t in this.tween_list) {
                var r = this.tween_list[t];
                if (this.useCurrent) {
                    var n = this.parseCurrent(r.tweened, "current"),
                        a = this.parseCurrent(r.tweened, this.target);
                    r.setInitial(n), r.setTarget(a)
                }
                0 === e && (r.progress = 1e-6, r.lastKnownValue = 0, r.lastKnownValue2 = 0, r.onStart = !0, r.state = 1), 1 === e && (r.state = r.lastState), (2 === e || 4 === e) && (r.progress = 1e-6, r.lastKnownValue = 0, r.lastKnownValue2 = 0, r.onStart = !0, 2 == e && (r.state = 4), 4 == e && (r.state = 6)), 3 === e && (r.progress = 1e-6, r.lastKnownValue = 0, r.lastKnownValue2 = 0, r.onStart = !0, r.state = 5)
            }
        }, r.stopTween = function(e) {
            for (var t in this.tween_list) {
                var r = this.tween_list[t];
                3 != r.state && 0 != r.state && (r.lastState = r.state), 1 === e && (r.progress = 0), 2 === e && (r.progress = r.duration), r.state = 3;
                var n = r.OnTick(0);
                this.updateTween(r, n)
            }
        }, r.reverseTween = function(e) {
            for (var t in this.tween_list) {
                var r = this.tween_list[t];
                1 === e && (r.progress = r.duration, r.lastKnownValue = 0, r.lastKnownValue2 = 0, r.onReverseStart = !0), r.state = 2
            }
        }, r.updateTween = function(e, t) {
            if (0 === e.tweened) e.enforce ? (this.inst.x = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t, this.inst.y = e.initialparam2 + (e.targetparam2 - e.initialparam2) * t) : (this.inst.x += (e.targetparam1 - e.initialparam1) * t - e.lastKnownValue, this.inst.y += (e.targetparam2 - e.initialparam2) * t - e.lastKnownValue2, e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t, e.lastKnownValue2 = (e.targetparam2 - e.initialparam2) * t);
            else if (1 === e.tweened) e.enforce ? (this.inst.width = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t, this.inst.height = e.initialparam2 + (e.targetparam2 - e.initialparam2) * t) : (this.inst.width += (e.targetparam1 - e.initialparam1) * t - e.lastKnownValue, this.inst.height += (e.targetparam2 - e.initialparam2) * t - e.lastKnownValue2, e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t, e.lastKnownValue2 = (e.targetparam2 - e.initialparam2) * t);
            else if (2 === e.tweened) e.enforce ? this.inst.width = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t : (this.inst.width += (e.targetparam1 - e.initialparam1) * t - e.lastKnownValue, e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t);
            else if (3 === e.tweened) e.enforce ? this.inst.height = e.initialparam2 + (e.targetparam2 - e.initialparam2) * t : (this.inst.height += (e.targetparam2 - e.initialparam2) * t - e.lastKnownValue2, e.lastKnownValue2 = (e.targetparam2 - e.initialparam2) * t);
            else if (4 === e.tweened) {
                if (e.enforce) {
                    var r = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t;
                    this.inst.angle = cr.clamp_angle(cr.to_radians(r))
                } else {
                    var r = (e.targetparam1 - e.initialparam1) * t - e.lastKnownValue;
                    this.inst.angle = cr.clamp_angle(this.inst.angle + cr.to_radians(r)), e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t
                }
            } else if (5 === e.tweened) e.enforce ? this.inst.opacity = (e.initialparam1 + (e.targetparam1 - e.initialparam1) * t) / 100 : (this.inst.opacity += ((e.targetparam1 - e.initialparam1) * t - e.lastKnownValue) / 100, e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t);
            else if (6 === e.tweened) e.enforce ? this.value = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t : (this.value += (e.targetparam1 - e.initialparam1) * t - e.lastKnownValue, e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t);
            else if (7 === e.tweened) e.enforce ? this.inst.x = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t : (this.inst.x += (e.targetparam1 - e.initialparam1) * t - e.lastKnownValue, e.lastKnownValue = (e.targetparam1 - e.initialparam1) * t);
            else if (8 === e.tweened) e.enforce ? this.inst.y = e.initialparam2 + (e.targetparam2 - e.initialparam2) * t : (this.inst.y += (e.targetparam2 - e.initialparam2) * t - e.lastKnownValue2, e.lastKnownValue2 = (e.targetparam2 - e.initialparam2) * t);
            else if (9 === e.tweened) {
                var n = e.initialparam1 + (e.targetparam1 - e.initialparam1) * t,
                    a = e.initialparam2 + (e.targetparam2 - e.initialparam2) * t;
                0 > this.inst.width && (n = e.initialparam1 + (e.targetparam1 + e.initialparam1) * -t), 0 > this.inst.height && (a = e.initialparam2 + (e.targetparam2 + e.initialparam2) * -t), e.enforce ? (this.inst.width = this.inst.curFrame.width * n, this.inst.height = this.inst.curFrame.height * a) : (0 > this.inst.width ? (this.inst.width = n * (this.inst.width / (-1 + e.lastKnownValue)), e.lastKnownValue = n + 1) : (this.inst.width = n * (this.inst.width / (1 + e.lastKnownValue)), e.lastKnownValue = n - 1), 0 > this.inst.height ? (this.inst.height = a * (this.inst.height / (-1 + e.lastKnownValue2)), e.lastKnownValue2 = a + 1) : (this.inst.height = a * (this.inst.height / (1 + e.lastKnownValue2)), e.lastKnownValue2 = a - 1))
            }
            this.inst.set_bbox_changed()
        }, r.tick = function() {
            var e = this.runtime.getDt(this.inst),
                t = this.tween_list["default"];
            if (0 !== t.state) {
                t.onStart && (this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnStart, this.inst), t.onStart = !1), t.onReverseStart && (this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseStart, this.inst), t.onReverseStart = !1), this.active = 1 == t.state || 2 == t.state || 4 == t.state || 5 == t.state || 6 == t.state;
                var r = t.OnTick(e);
                this.updateTween(t, r), t.onEnd && (this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd, this.inst), t.onEnd = !1), t.onReverseEnd && (this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseEnd, this.inst), t.onReverseEnd = !1)
            }
        }, e.cnds = {};
        var n = e.cnds;
        n.IsActive = function() {
            return 0 !== this.tween_list["default"].state
        }, n.IsReversing = function() {
            return 2 == this.tween_list["default"].state
        }, n.CompareProgress = function(e, t) {
            var r = this.tween_list["default"];
            return cr.do_cmp(r.progress / r.duration, e, t)
        }, n.OnThreshold = function(e, t) {
            var r = this.tween_list["default"];
            this.threshold = cr.do_cmp(r.progress / r.duration, e, t);
            var n = this.oldthreshold != this.threshold && this.threshold;
            return n && (this.oldthreshold = this.threshold), n
        }, n.OnStart = function() {
            return void 0 !== this.tween_list["default"] && this.tween_list["default"].onStart
        }, n.OnReverseStart = function() {
            return void 0 !== this.tween_list["default"] && this.tween_list["default"].onReverseStart
        }, n.OnEnd = function() {
            return void 0 !== this.tween_list["default"] && this.tween_list["default"].onEnd
        }, n.OnReverseEnd = function() {
            return void 0 !== this.tween_list["default"] && this.tween_list["default"].onReverseEnd
        }, e.acts = {};
        var a = e.acts;
        a.Start = function(e, t) {
            this.threshold = !1, this.oldthreshold = !1, this.useCurrent = 1 == t, this.startTween(e)
        }, a.Stop = function(e) {
            this.stopTween(e)
        }, a.Reverse = function(e) {
            this.threshold = !1, this.oldthreshold = !1, this.reverseTween(e)
        }, a.ProgressTo = function(e) {
            this.setProgressTo(e)
        }, a.SetDuration = function(e) {
            isNaN(e) || 0 > e || void 0 === this.tween_list["default"] || (this.tween_list["default"].duration = e)
        }, a.SetEnforce = function(e) {
            void 0 === this.tween_list["default"] || (this.tween_list["default"].enforce = 1 === e)
        }, a.SetInitial = function(e) {
            if (void 0 !== this.tween_list["default"]) {
                var t = this.parseCurrent(this.tween_list["default"].tweened, e);
                this.tween_list["default"].setInitial(t)
            }
        }, a.SetTarget = function(e, t, r) {
            if (void 0 !== this.tween_list["default"] && !isNaN(r)) {
                var n = this.tween_list["default"],
                    a = r + "";
                this.targetmode = t;
                var o = "",
                    i = "";
                if (1 === t) {
                    switch (this.target = "relative(" + a + ")", e) {
                        case 0:
                            o = this.inst.x + r, i = n.targetparam2;
                            break;
                        case 1:
                            o = n.targetparam1, i = this.inst.y + r;
                            break;
                        case 2:
                            o = "" + cr.to_degrees(this.inst.angle + cr.to_radians(r)), i = o;
                            break;
                        case 3:
                            o = "" + 100 * this.inst.opacity + r, i = o;
                            break;
                        case 4:
                            o = this.inst.width + r, i = n.targetparam2;
                            break;
                        case 5:
                            o = n.targetparam1, i = this.inst.height + r;
                            break;
                        case 6:
                            o = r, i = r;
                            break;
                        default:
                    }
                    a = o + "," + i
                } else {
                    switch (e) {
                        case 0:
                            o = r, i = n.targetparam2;
                            break;
                        case 1:
                            o = n.targetparam1, i = r;
                            break;
                        case 2:
                            o = r, i = r;
                            break;
                        case 3:
                            o = r, i = r;
                            break;
                        case 4:
                            o = r, i = n.targetparam2;
                            break;
                        case 5:
                            o = n.targetparam1, i = r;
                            break;
                        case 6:
                            o = r, i = r;
                            break;
                        default:
                    }
                    a = o + "," + i, this.target = a
                }
                var s = this.parseCurrent(this.tween_list["default"].tweened, "current"),
                    l = this.parseCurrent(this.tween_list["default"].tweened, a);
                n.setInitial(s), n.setTarget(l)
            }
        }, a.SetTweenedProperty = function(e) {
            void 0 === this.tween_list["default"] || (this.tween_list["default"].tweened = e)
        }, a.SetEasing = function(e) {
            void 0 === this.tween_list["default"] || (this.tween_list["default"].easefunc = e)
        }, a.SetEasingParam = function(e, r, n, a, t) {
            void 0 === this.tween_list["default"] || (this.tween_list["default"].easingparam[e].optimized = !1, this.tween_list["default"].easingparam[e].a = r, this.tween_list["default"].easingparam[e].p = n, this.tween_list["default"].easingparam[e].t = a, this.tween_list["default"].easingparam[e].s = t)
        }, a.ResetEasingParam = function() {
            void 0 === this.tween_list["default"] || (this.tween_list["default"].optimized = !0)
        }, a.SetValue = function(e) {
            var t = this.tween_list["default"];
            this.value = e, 6 === t.tweened && t.setInitial(this.parseCurrent(t.tweened, "current"))
        }, a.SetParameter = function(e, t, r, n, a) {
            if (this.tween_list["default"] === void 0) this.addToTweenList("default", e, t, initial, r, n, a, 0);
            else {
                var o = this.tween_list["default"];
                o.tweened = e, o.easefunc = t, o.setInitial(this.parseCurrent(e, "current")), o.setTarget(this.parseCurrent(e, r)), o.duration = n, o.enforce = 1 === a
            }
        }, e.exps = {};
        var o = e.exps;
        o.State = function(e) {
            var t = "N/A";
            switch (this.tween_list["default"].state) {
                case 0:
                    t = "paused";
                    break;
                case 1:
                    t = "playing";
                    break;
                case 2:
                    t = "reversing";
                    break;
                case 3:
                    t = "seeking";
                    break;
                default:
            }
            e.set_string(t)
        }, o.Progress = function(e) {
            var t = this.tween_list["default"].progress / this.tween_list["default"].duration;
            e.set_float(t)
        }, o.Duration = function(e) {
            e.set_float(this.tween_list["default"].duration)
        }, o.Target = function(e) {
            var t = this.tween_list["default"],
                r = "N/A";
            switch (t.tweened) {
                case 0:
                    r = t.targetparam1;
                    break;
                case 1:
                    r = t.targetparam2;
                    break;
                case 2:
                    r = t.targetparam1;
                    break;
                case 3:
                    r = t.targetparam1;
                    break;
                case 4:
                    r = t.targetparam1;
                    break;
                case 5:
                    r = t.targetparam2;
                    break;
                case 6:
                    r = t.targetparam1;
                    break;
                default:
            }
            e.set_float(r)
        }, o.Value = function(e) {
            var t = this.value;
            e.set_float(t)
        }, o.Tween = function(e, t, r, n, a) {
            var o = 1 < n ? 1 : n,
                i = easeFunc(a, 0 > o ? 0 : o, 0, 1, 1, !1, !1);
            e.set_float(t + i * (r - t))
        }
    }();
cr.behaviors.solid = function(e) {
        this.runtime = e
    },
    function() {
        function e() {}

        function t() {}
        var r = cr.behaviors.solid.prototype;
        r.Type = function(e, t) {
            this.behavior = e, this.objtype = t, this.runtime = e.runtime
        };
        var n = r.Type.prototype;
        n.onCreate = function() {}, r.Instance = function(e, t) {
            this.type = e, this.behavior = e.behavior, this.inst = t, this.runtime = e.runtime
        };
        var a = r.Instance.prototype;
        a.onCreate = function() {
            this.inst.extra.solidEnabled = this.properties[0]
        }, a.tick = function() {};
        e.prototype.IsEnabled = function() {
            return this.inst.extra.solidEnabled
        }, r.cnds = new e;
        t.prototype.SetEnabled = function(t) {
            this.inst.extra.solidEnabled = !!t
        }, r.acts = new t
    }();
cr.behaviors.scrollto = function(e) {
        this.runtime = e, this.shakeMag = 0, this.shakeStart = 0, this.shakeEnd = 0, this.shakeMode = 0
    },
    function() {
        function e(e) {
            var t, r, n;
            for (t = 0, r = e.behavior_insts.length; t < r; ++t)
                if (n = e.behavior_insts[t], n.behavior instanceof cr.behaviors.scrollto) return n;
            return null
        }

        function t() {}

        function r() {}
        var n = cr.behaviors.scrollto.prototype;
        n.Type = function(e, t) {
            this.behavior = e, this.objtype = t, this.runtime = e.runtime
        };
        var a = n.Type.prototype;
        a.onCreate = function() {}, n.Instance = function(e, t) {
            this.type = e, this.behavior = e.behavior, this.inst = t, this.runtime = e.runtime
        };
        var o = n.Instance.prototype;
        o.onCreate = function() {
            this.enabled = this.properties[0]
        }, o.saveToJSON = function() {
            return {
                smg: this.behavior.shakeMag,
                ss: this.behavior.shakeStart,
                se: this.behavior.shakeEnd,
                smd: this.behavior.shakeMode
            }
        }, o.loadFromJSON = function(e) {
            this.behavior.shakeMag = e.smg, this.behavior.shakeStart = e.ss, this.behavior.shakeEnd = e.se, this.behavior.shakeMode = e.smd
        }, o.tick = function() {};
        o.tick2 = function() {
            if (this.enabled) {
                var t = this.behavior.my_instances.valuesRef(),
                    r = 0,
                    n = 0,
                    o = 0,
                    s, l, p;
                for (s = 0, l = t.length; s < l; s++) p = e(t[s]), !p || !p.enabled || (r += t[s].x, n += t[s].y, ++o);
                var c = this.inst.layer.layout,
                    u = this.runtime.kahanTime.sum,
                    g = 0,
                    y = 0;
                if (u >= this.behavior.shakeStart && u < this.behavior.shakeEnd) {
                    var m = this.behavior.shakeMag * Math.min(this.runtime.timescale, 1);
                    0 === this.behavior.shakeMode && (m *= 1 - (u - this.behavior.shakeStart) / (this.behavior.shakeEnd - this.behavior.shakeStart));
                    var _ = 2 * (Math.random() * Math.PI),
                        a = Math.random() * m;
                    g = Math.cos(_) * a, y = Math.sin(_) * a
                }
                c.scrollToX(r / o + g), c.scrollToY(n / o + y)
            }
        };
        t.prototype.IsEnabled = function() {
            return this.enabled
        }, n.cnds = new t;
        r.prototype.Shake = function(e, t, r) {
            this.behavior.shakeMag = e, this.behavior.shakeStart = this.runtime.kahanTime.sum, this.behavior.shakeEnd = this.behavior.shakeStart + t, this.behavior.shakeMode = r
        }, r.prototype.SetEnabled = function(t) {
            this.enabled = 0 !== t
        }, n.acts = new r
    }();
cr.behaviors.Anchor = function(e) {
        this.runtime = e
    },
    function() {
        function e() {}

        function t() {}
        var r = cr.behaviors.Anchor.prototype;
        r.Type = function(e, t) {
            this.behavior = e, this.objtype = t, this.runtime = e.runtime
        };
        var n = r.Type.prototype;
        n.onCreate = function() {}, r.Instance = function(e, t) {
            this.type = e, this.behavior = e.behavior, this.inst = t, this.runtime = e.runtime
        };
        var a = r.Instance.prototype;
        a.onCreate = function() {
            this.anch_left = this.properties[0], this.anch_top = this.properties[1], this.anch_right = this.properties[2], this.anch_bottom = this.properties[3], this.inst.update_bbox(), this.xleft = this.inst.bbox.left, this.ytop = this.inst.bbox.top, this.xright = this.runtime.original_width - this.inst.bbox.left, this.ybottom = this.runtime.original_height - this.inst.bbox.top, this.rdiff = this.runtime.original_width - this.inst.bbox.right, this.bdiff = this.runtime.original_height - this.inst.bbox.bottom, this.enabled = this.properties[4]
        }, a.saveToJSON = function() {
            return {
                xleft: this.xleft,
                ytop: this.ytop,
                xright: this.xright,
                ybottom: this.ybottom,
                rdiff: this.rdiff,
                bdiff: this.bdiff,
                enabled: this.enabled
            }
        }, a.loadFromJSON = function(e) {
            this.xleft = e.xleft, this.ytop = e.ytop, this.xright = e.xright, this.ybottom = e.ybottom, this.rdiff = e.rdiff, this.bdiff = e.bdiff, this.enabled = e.enabled
        }, a.tick = function() {
            if (this.enabled) {
                var e = this.inst.layer,
                    t = this.inst,
                    r = this.inst.bbox,
                    a;
                0 === this.anch_left ? (t.update_bbox(), a = e.viewLeft + this.xleft - r.left, 0 !== a && (t.x += a, t.set_bbox_changed())) : 1 === this.anch_left && (t.update_bbox(), a = e.viewRight - this.xright - r.left, 0 !== a && (t.x += a, t.set_bbox_changed())), 0 === this.anch_top ? (t.update_bbox(), a = e.viewTop + this.ytop - r.top, 0 !== a && (t.y += a, t.set_bbox_changed())) : 1 === this.anch_top && (t.update_bbox(), a = e.viewBottom - this.ybottom - r.top, 0 !== a && (t.y += a, t.set_bbox_changed())), 1 === this.anch_right && (t.update_bbox(), a = e.viewRight - this.rdiff - r.right, 0 !== a && (t.width += a, 0 > t.width && (t.width = 0), t.set_bbox_changed())), 1 === this.anch_bottom && (t.update_bbox(), a = e.viewBottom - this.bdiff - r.bottom, 0 !== a && (t.height += a, 0 > t.height && (t.height = 0), t.set_bbox_changed()))
            }
        };
        e.prototype.IsEnabled = function() {
            return this.enabled
        }, r.cnds = new e;
        t.prototype.SetEnabled = function(t) {
            this.enabled && 0 === t ? this.enabled = !1 : !this.enabled && 0 != t && (this.inst.update_bbox(), this.xleft = this.inst.bbox.left, this.ytop = this.inst.bbox.top, this.xright = this.runtime.original_width - this.inst.bbox.left, this.ybottom = this.runtime.original_height - this.inst.bbox.top, this.rdiff = this.runtime.original_width - this.inst.bbox.right, this.bdiff = this.runtime.original_height - this.inst.bbox.bottom, this.enabled = !0)
        }, r.acts = new t;
        r.exps = new function() {}
    }(), cr.getObjectRefTable = function() {
        return [cr.plugins_.Touch, cr.plugins_.Audio, cr.plugins_.Sprite, cr.behaviors.Platform, cr.plugins_.TiledBg, cr.behaviors.Fade, cr.behaviors.lunarray_LiteTween, cr.plugins_.Arr, cr.behaviors.solid, cr.plugins_.Spritefont2, cr.behaviors.scrollto, cr.plugins_.Particles, cr.behaviors.Anchor, cr.plugins_.LocalStorage, cr.plugins_.WebStorage, cr.plugins_.Browser, cr.system_object.prototype.cnds.OnLayoutStart, cr.system_object.prototype.acts.Scroll, cr.system_object.prototype.acts.SetVar, cr.system_object.prototype.acts.AddVar, cr.plugins_.WebStorage.prototype.acts.StoreLocal, cr.plugins_.TiledBg.prototype.acts.SetY, cr.system_object.prototype.exps.viewporttop, cr.system_object.prototype.exps.viewportbottom, cr.system_object.prototype.acts.Wait, cr.system_object.prototype.acts.SetGroupActive, cr.plugins_.WebStorage.prototype.cnds.LocalStorageExists, cr.plugins_.WebStorage.prototype.exps.LocalValue, cr.system_object.prototype.cnds.EveryTick, cr.plugins_.Arr.prototype.acts.SetX, cr.system_object.prototype.cnds.IsGroupActive, cr.plugins_.Touch.prototype.cnds.OnTouchEnd, cr.plugins_.Touch.prototype.cnds.IsTouchingObject, cr.behaviors.lunarray_LiteTween.prototype.acts.Reverse, cr.system_object.prototype.acts.GoToLayout, cr.plugins_.Touch.prototype.cnds.OnTouchObject, cr.plugins_.Sprite.prototype.acts.SetSize, cr.plugins_.Sprite.prototype.cnds.CompareFrame, cr.system_object.prototype.cnds.PickOverlappingPoint, cr.plugins_.Touch.prototype.exps.X, cr.plugins_.Touch.prototype.exps.Y, cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar, cr.plugins_.Arr.prototype.exps.At, cr.plugins_.Audio.prototype.acts.Play, cr.system_object.prototype.acts.GoToLayoutByName, cr.system_object.prototype.cnds.CompareVar, cr.system_object.prototype.cnds.TriggerOnce, cr.plugins_.Sprite.prototype.acts.SetAnimFrame, cr.plugins_.Sprite.prototype.cnds.OnCollision, cr.behaviors.lunarray_LiteTween.prototype.acts.Start, cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd, cr.plugins_.Sprite.prototype.cnds.IsOnScreen, cr.plugins_.Sprite.prototype.acts.SetCollisions, cr.plugins_.Sprite.prototype.cnds.IsOutsideLayout, cr.plugins_.Particles.prototype.acts.Destroy, cr.plugins_.TiledBg.prototype.acts.Destroy, cr.plugins_.Spritefont2.prototype.acts.Destroy, cr.behaviors.lunarray_LiteTween.prototype.acts.SetTweenedProperty, cr.behaviors.lunarray_LiteTween.prototype.acts.SetTarget, cr.plugins_.Sprite.prototype.acts.SetPosToObject, cr.plugins_.Sprite.prototype.acts.SetInstanceVar, cr.plugins_.Sprite.prototype.acts.SetX, cr.plugins_.Sprite.prototype.acts.SetY, cr.plugins_.Sprite.prototype.exps.AnimationFrame, cr.plugins_.Sprite.prototype.exps.X, cr.plugins_.Sprite.prototype.exps.Y, cr.plugins_.TiledBg.prototype.acts.SetInstanceVar, cr.plugins_.Sprite.prototype.cnds.IsOverlapping, cr.plugins_.TiledBg.prototype.cnds.CompareInstanceVar, cr.plugins_.Sprite.prototype.acts.Destroy, cr.behaviors.scrollto.prototype.acts.Shake, cr.behaviors.Platform.prototype.acts.SetMaxFallSpeed, cr.behaviors.Platform.prototype.exps.MaxFallSpeed, cr.plugins_.Particles.prototype.acts.SetRate, cr.system_object.prototype.acts.RestartLayout, cr.plugins_.Audio.prototype.acts.SetSilent, cr.plugins_.Audio.prototype.cnds.IsSilent, cr.plugins_.Sprite.prototype.acts.SetVisible, cr.system_object.prototype.cnds.OnLayoutEnd, cr.plugins_.LocalStorage.prototype.acts.SetItem, cr.plugins_.Spritefont2.prototype.acts.SetText, cr.system_object.prototype.exps.newline, cr.plugins_.Particles.prototype.acts.SetPosToObject, cr.behaviors.Platform.prototype.acts.SimulateControl, cr.system_object.prototype.acts.SetTimescale, cr.plugins_.Sprite.prototype.acts.SetPos, cr.system_object.prototype.acts.CreateObject, cr.plugins_.TiledBg.prototype.acts.SetSize, cr.plugins_.Sprite.prototype.acts.MoveToTop, cr.plugins_.Audio.prototype.acts.StopAll, cr.behaviors.lunarray_LiteTween.prototype.acts.SetDuration, cr.plugins_.Sprite.prototype.acts.Spawn]
    }, self.C3_JsPropNameTable = [{
        Touch: 0
    }, {
        Audio: 0
    }, {
        Platform: 0
    }, {
        player: 0
    }, {
        Fade: 0
    }, {
        b9: 0
    }, {
        level: 0
    }, {
        LiteTween: 0
    }, {
        complete: 0
    }, {
        b_skins: 0
    }, {
        level1: 0
    }, {
        level2: 0
    }, {
        Array: 0
    }, {
        b4: 0
    }, {
        b2: 0
    }, {
        Solid: 0
    }, {
        PlatformLeft: 0
    }, {
        text: 0
    }, {
        ScrollTo: 0
    }, {
        scroll: 0
    }, {
        level3: 0
    }, {
        level4: 0
    }, {
        level5: 0
    }, {
        level6: 0
    }, {
        b5: 0
    }, {
        b11: 0
    }, {
        b13: 0
    }, {
        selector: 0
    }, {
        b_sound: 0
    }, {
        b_resume: 0
    }, {
        b_home: 0
    }, {
        p1: 0
    }, {
        p2: 0
    }, {
        a3: 0
    }, {
        a10: 0
    }, {
        a5: 0
    }, {
        a6: 0
    }, {
        a9: 0
    }, {
        a12: 0
    }, {
        a16: 0
    }, {
        fade: 0
    }, {
        line_top: 0
    }, {
        Anchor: 0
    }, {
        b_pause: 0
    }, {
        b_back: 0
    }, {
        level7: 0
    }, {
        LocalStorage: 0
    }, {
        WebStorage: 0
    }, {
        PlatformRight: 0
    }, {
        line_bottom: 0
    }, {
        touch_s: 0
    }, {
        PlatformLeft2: 0
    }, {
        PlatformRight2: 0
    }, {
        PlatformLeft3: 0
    }, {
        PlatformRight3: 0
    }, {
        PlatformLeft4: 0
    }, {
        PlatformRight4: 0
    }, {
        PlatformLeft5: 0
    }, {
        PlatformRight5: 0
    }, {
        detector: 0
    }, {
        PlatformLeft6: 0
    }, {
        PlatformRight6: 0
    }, {
        PlatformLeft7: 0
    }, {
        PlatformRight7: 0
    }, {
        level8: 0
    }, {
        level9: 0
    }, {
        level10: 0
    }, {
        level11: 0
    }, {
        level12: 0
    }, {
        level13: 0
    }, {
        level14: 0
    }, {
        level15: 0
    }, {
        b_play: 0
    }, {
        gamename: 0
    }, {
        a4: 0
    }, {
        b15: 0
    }, {
        PlatformLeft8: 0
    }, {
        PlatformRight8: 0
    }, {
        b17: 0
    }, {
        PlatformLeft9: 0
    }, {
        PlatformRight9: 0
    }, {
        b19: 0
    }, {
        PlatformLeft10: 0
    }, {
        PlatformRight10: 0
    }, {
        b21: 0
    }, {
        PlatformLeft11: 0
    }, {
        PlatformRight11: 0
    }, {
        b23: 0
    }, {
        PlatformLeft12: 0
    }, {
        PlatformRight12: 0
    }, {
        b25: 0
    }, {
        PlatformLeft13: 0
    }, {
        PlatformRight13: 0
    }, {
        b27: 0
    }, {
        PlatformRight14: 0
    }, {
        PlatformLeft14: 0
    }, {
        b29: 0
    }, {
        PlatformLeft15: 0
    }, {
        PlatformRight15: 0
    }, {
        a1: 0
    }, {
        LiteTween2: 0
    }, {
        a2: 0
    }, {
        b3: 0
    }, {
        b1: 0
    }, {
        a7: 0
    }, {
        a8: 0
    }, {
        b8: 0
    }, {
        a17: 0
    }, {
        a20: 0
    }, {
        a18: 0
    }, {
        a19: 0
    }, {
        LiteTween3: 0
    }, {
        a11: 0
    }, {
        a23: 0
    }, {
        fon1: 0
    }, {
        fon2: 0
    }, {
        fon3: 0
    }, {
        fon4: 0
    }, {
        fon5: 0
    }, {
        fon6: 0
    }, {
        fon7: 0
    }, {
        fon8: 0
    }, {
        fon9: 0
    }, {
        fon10: 0
    }, {
        fon11: 0
    }, {
        fon12: 0
    }, {
        b6: 0
    }, {
        b7: 0
    }, {
        b10: 0
    }, {
        b12: 0
    }, {
        b14: 0
    }, {
        b16: 0
    }, {
        b18: 0
    }, {
        b20: 0
    }, {
        b22: 0
    }, {
        b24: 0
    }, {
        b26: 0
    }, {
        b28: 0
    }, {
        b30: 0
    }, {
        finish: 0
    }, {
        p3: 0
    }, {
        LiteTween4: 0
    }, {
        LiteTween5: 0
    }, {
        LiteTween6: 0
    }, {
        LiteTween7: 0
    }, {
        LiteTween8: 0
    }, {
        LiteTween9: 0
    }, {
        a29: 0
    }, {
        ironman_hand1: 0
    }, {
        collision: 0
    }, {
        lightine1: 0
    }, {
        ironman_hand2: 0
    }, {
        lightline2: 0
    }, {
        lightline3: 0
    }, {
        lightline4: 0
    }, {
        a33: 0
    }, {
        a32: 0
    }, {
        a34: 0
    }, {
        a35: 0
    }, {
        a36: 0
    }, {
        detector2: 0
    }, {
        a13: 0
    }, {
        a14: 0
    }, {
        a15: 0
    }, {
        a38: 0
    }, {
        a30: 0
    }, {
        a21: 0
    }, {
        a22: 0
    }, {
        a31: 0
    }, {
        a39: 0
    }, {
        a27: 0
    }, {
        a28: 0
    }, {
        a37: 0
    }, {
        p4: 0
    }, {
        Shadow: 0
    }, {
        ShadowBottom: 0
    }, {
        ShadowTop: 0
    }, {
        text2: 0
    }, {
        b_full: 0
    }, {
        Browser: 0
    }, {
        fon_skin: 0
    }, {
        b31: 0
    }, {
        a25: 0
    }, {
        a26: 0
    }, {
        a40: 0
    }, {
        a41: 0
    }, {
        Fons: 0
    }, {
        Obstacles: 0
    }, {
        CURRENT_LEVEL: 0
    }, {
        LEVEL: 0
    }, {
        SelctorX: 0
    }, {
        SelctorY: 0
    }, {
        Skin: 0
    }, {
        Fon: 0
    }, {
        number: 0
    }, {
        Score: 0
    }];